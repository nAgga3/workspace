/* Thinfinity(c) Workspaces Hyc v- */

(function(){function Environment(){var _ref=this;var _currentDevicePixelRatio=1;var _detectedWidth=window.screen.availWidth;var _availWidth=window.screen.availWidth;var _detectedHeight=window.screen.availHeight;var _availHeight=window.screen.availHeight;var _screenWidth=window.screen.availWidth;var _screenHeight=window.screen.availHeight;var _screenRawWidth=_screenWidth;var _screenRawHeight=_screenHeight;var _winHeight=window.innerHeight;var _viewportWidth=_detectedWidth;var _viewportHeight=_detectedHeight;
var _sizeCalculationHolderElem=null;var _sizeCalculationHolderElemId="sizeCalculationHolder";var _environmentReady=false;var _watchDog={"intervalId":null,"intervalTime":50,"width":null,"height":null,"isChanging":false,"isRunning":false,"currentDate":null,"lastEvent":null,"waitTime":50,"updateTime":50,"count":0};var _commandHandlerList=[];var _isResizingRunning=false;var _holderElemReady=false;var _orientationMedia=null;var _margin={"left":0,"top":0,"right":0,"bottom":0,"infullscreen":false,"notinfullscreen":false,
"original":{"left":0,"top":0,"right":0,"bottom":0}};var _crop={"width":0,"height":0,"infullscreen":false,"notinfullscreen":false,"original":{"width":0,"height":0}};function initialize(){let bodyInterval=null;var bodyReady=function(){if(document.body){clearInterval(bodyInterval);appendSizeCalculationHolder();document.body.appendChild(_sizeCalculationHolderElem);_holderElemReady=true;_orientationMedia="landscape";if(_detectedWidth==0&&_detectedHeight==0)startWatchDog();attachEvents();updateSizeValues();
_environmentReady=true}};bodyInterval=setInterval(bodyReady,100)}function appendSizeCalculationHolder(){_sizeCalculationHolderElem=document.createElement("div");_sizeCalculationHolderElem.id=_sizeCalculationHolderElemId;_sizeCalculationHolderElem.style.height="100%";_sizeCalculationHolderElem.style.width="100%";_sizeCalculationHolderElem.style.backgroundColor="transparent";_sizeCalculationHolderElem.style.opacity="0.5";_sizeCalculationHolderElem.style.position="fixed";_sizeCalculationHolderElem.style.margin=
"0px";_sizeCalculationHolderElem.style.padding="0px";_sizeCalculationHolderElem.style.top="0px";_sizeCalculationHolderElem.style.left="0px";_sizeCalculationHolderElem.style.right="0px";_sizeCalculationHolderElem.style.bottom="0px";_sizeCalculationHolderElem.style.zIndex=-9999999}function getOrientation(){return _orientationMedia}function attachEvents(){window.addEventListener("resize",onresize,false)}function updateSizeValues(){_screenWidth=window.screen.availWidth-_crop.width;_screenHeight=window.screen.availHeight-
_crop.height;_screenRawWidth=_screenWidth;_screenRawHeight=_screenHeight;_detectedWidth=window.innerWidth;_availWidth=_detectedWidth*_currentDevicePixelRatio-(_margin.left+_margin.right);_detectedHeight=window.innerHeight;_availHeight=_detectedHeight*_currentDevicePixelRatio-(_margin.top+_margin.bottom);if(_holderElemReady){_viewportWidth=_sizeCalculationHolderElem.offsetWidth;_viewportHeight=_sizeCalculationHolderElem.offsetHeight}else{_viewportWidth=_detectedWidth;_viewportHeight=_detectedHeight}}
function environmentReady(fCallback){if(_environmentReady&&_holderElemReady){updateSizeValues();fCallback()}else{var count=0;var tempInterval=setInterval(function(){if(count<25){if(_environmentReady&&_holderElemReady){clearInterval(tempInterval);updateSizeValues();fCallback()}}else{clearInterval(tempInterval);var str="Cannot trigger environment ready event";var ex=new Error(str);console.error(str,ex);_environmentReady=false;_holderElemReady=false;updateSizeValues();fCallback()}count++},25)}}function addEvent(event,
handler){if(event==undefined||event==null||event=="")return"Event is undefined or null.";if(handler==undefined||handler==null||handler=="")return"Handler is undefined or null.";event=event.toLowerCase();var item={"event":event,"handler":handler};var isContained=false;if(_commandHandlerList[event]==undefined)_commandHandlerList[event]=[];else for(var i=0;i<_commandHandlerList[event].length;i++)if(_commandHandlerList[event][i].handler==item.handler){isContained=true;break}if(!isContained)_commandHandlerList[event].push(item);
return true}function removeEvent(event,handler){var ret=false;if(event==undefined||event==null||event=="")return"Event is undefined or null.";if(handler==undefined||handler==null||handler=="")return"Handler is undefined or null.";event=event.toLowerCase();var item={"event":event,"handler":handler};if(_commandHandlerList[event]==undefined)return"Cannot find event. Event is not in the command list.";else for(var i=0;i<_commandHandlerList[event].length;i++)if(_commandHandlerList[event][i].handler.toString()==
item.handler.toString()){_commandHandlerList[event].splice(i,1);ret=true}return ret}function getCurrentWidth(){return _holderElemReady?_sizeCalculationHolderElem.offsetWidth:_screenRawWidth}function getCurrentHeight(){return _holderElemReady?_sizeCalculationHolderElem.offsetHeight:_screenRawHeight}function startWatchDog(e){_watchDog.currentDate=(new Date).getTime();_watchDog.lastEvent=e;watchDesktopSize()}function watchDesktopSize(){if(!_watchDog.isRunning&&!_watchDog.isChanging){_watchDog.isRunning=
true;_watchDog.count=0;triggerEvent(["resizestart"]);var elem=_holderElemReady?_sizeCalculationHolderElem:window;_watchDog.intervalId=setInterval(function(){if(_watchDog.height!=elem.offsetHeight||_watchDog.width!=elem.offsetWidth){_watchDog.height=elem.offsetHeight;_watchDog.width=elem.offsetWidth;stopWatchDog();changeScreenSize()}else{_watchDog.count++;if(_watchDog.count>10&&_watchDog.height==window.innerHeight&&_watchDog.width==window.innerWidth){stopWatchDog();changeScreenSize()}}},_watchDog.intervalTime)}}
function stopWatchDog(){clearInterval(_watchDog.intervalId);_watchDog.intervalId=null;_watchDog.isRunning=false}function changeScreenSize(){if(_watchDog.isChanging==false){_watchDog.isChanging=true;var cHeight=null;var maxWaitTime=1E3;function updateScreenSize(){_watchDog.height=null;_watchDog.width=null;_watchDog.isChanging=false;updateSizeValues();triggerEvent(["resize","resizeComplete","resizeend"])}function waitForSizeChanged(){var fHeight=window.innerHeight;if(fHeight!=_winHeight&&fHeight==cHeight)setTimeout(function(){updateScreenSize()},
_watchDog.waitTime);else{cHeight=fHeight;if(maxWaitTime<(new Date).getTime()-_watchDog.currentDate)setTimeout(function(){updateScreenSize()},_watchDog.waitTime);else setTimeout(function(){waitForSizeChanged()},_watchDog.updateTime)}}waitForSizeChanged()}}function onresize(e){updateSizeValues(e);triggerEvent(["resize"]);startWatchDog(e)}function triggerEvent(eventNames){var atLeastOne=false;if(eventNames){if(typeof eventNames=="string")eventNames=[eventNames];for(var k=0;k<eventNames.length;k++)if(_commandHandlerList[eventNames[k].toLowerCase()]!=
undefined)for(var i=0;i<_commandHandlerList[eventNames[k].toLowerCase()].length;i++){try{_commandHandlerList[eventNames[k].toLowerCase()][i]["handler"]({width:window.innerWidth,height:window.innerHeight})}catch(error){}atLeastOne=true}}return atLeastOne}initialize();Object.defineProperty(_ref,"currentOrientation",{"enumerable":true,"configurable":false,"get":function(){return getOrientation()}});Object.defineProperty(_ref,"detectedWidth",{"enumerable":true,"configurable":false,"get":function(){return parseInt(_detectedWidth,
10)}});Object.defineProperty(_ref,"detectedHeight",{"enumerable":true,"configurable":false,"get":function(){return parseInt(_detectedHeight,10)}});Object.defineProperty(_ref,"availWidth",{"enumerable":true,"configurable":false,"get":function(){return parseInt(_availWidth,10)}});Object.defineProperty(_ref,"availHeight",{"enumerable":true,"configurable":false,"get":function(){return parseInt(_availHeight,10)}});Object.defineProperty(_ref,"rawWidth",{"enumerable":true,"configurable":false,"get":function(){return _screenRawWidth}});
Object.defineProperty(_ref,"rawHeight",{"enumerable":true,"configurable":false,"get":function(){return _screenRawHeight}});Object.defineProperty(_ref,"width",{"enumerable":true,"configurable":false,"get":function(){return parseInt(_screenWidth,10)}});Object.defineProperty(_ref,"height",{"enumerable":true,"configurable":false,"get":function(){return parseInt(_screenHeight,10)}});Object.defineProperty(_ref,"currentWidth",{"enumerable":true,"configurable":false,"get":function(){return getCurrentWidth()}});
Object.defineProperty(_ref,"currentHeight",{"enumerable":true,"configurable":false,"get":function(){return getCurrentHeight()}});Object.defineProperty(_ref,"viewportWidth",{"enumerable":true,"configurable":false,"get":function(){return _viewportWidth}});Object.defineProperty(_ref,"viewportHeight",{"enumerable":true,"configurable":false,"get":function(){return _viewportHeight}});Object.defineProperty(_ref,"ready",{"enumerable":true,"configurable":false,"writable":false,"value":environmentReady});Object.defineProperty(_ref,
"on",{"enumerable":true,"configurable":false,"writable":false,"value":addEvent});Object.defineProperty(_ref,"off",{"enumerable":true,"configurable":false,"writable":false,"value":removeEvent});Object.defineProperty(_ref,"trigger",{"enumerable":true,"configurable":false,"writable":false,"value":function(eventNames){return triggerEvent(eventNames)}});Object.defineProperty(_ref,"update",{"enumerable":true,"configurable":false,"writable":false,"value":function(){return updateSizeValues()}});return _ref}
window.environment=new Environment})();
window.WebDavGrowl=(()=>{var _ref={};var _growls={"dialogs":[],"top":15,"height":30,"type":{"MESSAGE":0,"INFO":1,"WARNING":2,"ERROR":3}};var getExtraClass=value=>{for(var kvp in _growls.type)if(_growls.type[kvp]===value)return kvp};var replaceClass=(elem,oClass,nClass)=>{if(elem){let classes=elem.className.split(/ +/g);let sc="";classes.forEach(c=>{if(c!=oClass)sc+=c+" "});elem.className=`${sc} ${nClass}`}};var growlDialog=jData=>{if(jData){var ht=_growls.top+_growls.height;var top=_growls.top+ht*
_growls.dialogs.length;var type=jData?.type||_growls.type.MESSAGE;let destroyTimeId=null;var extraClass=getExtraClass(type).toLowerCase();var destroy=function(e,container){clearTimeout(destroyTimeId);if(e){e.preventDefault();e.stopPropagation();var src=e.srcElement||e.target;container=src.className.indexOf("growlDialogContainer")!=-1?src:src.parentElement}if(container.destroyed)return;var nTop=container.nTop;replaceClass(container,"hidden","visible");setTimeout(function(){container.parentElement.removeChild(container);
var dialog=null;var ridx=-1;for(var i=0,t=_growls.dialogs.length;i<t;i++){dialog=_growls.dialogs[i];if(dialog===container)ridx=i;else if(dialog.nTop>=nTop){dialog.nTop=_growls.dialogs[i].nTop-ht;dialog.style.top=dialog.nTop+"px"}}_growls.dialogs.splice(ridx,1)},500);container.destroyed=true};let growlClick=e=>{destroy(e);if(jData?.events?.click)jData.events.click(e)};let growlDialogContainer=document.createElement("div");growlDialogContainer.className="growlDialogContainer hidden "+extraClass;growlDialogContainer.style=
"top:"+top+"px";growlDialogContainer.setAttribute("nTop",top);growlDialogContainer.addEventListener("touchend",growlClick,false);growlDialogContainer.addEventListener("click",growlClick,false);destroyTimeId=setTimeout(()=>{destroy(null,growlDialogContainer)},3500);let messageContainer=document.createElement("div");messageContainer.className="messageContainer";messageContainer.title=jData.message;messageContainer.innerText=jData.message;growlDialogContainer.appendChild(messageContainer);let xContainer=
document.createElement("div");xContainer.className="xContainer thin-cancel-circled";growlDialogContainer.appendChild(xContainer);document.body.appendChild(growlDialogContainer);replaceClass(growlDialogContainer,"hidden","visible");_growls.dialogs.push(growlDialogContainer);growlDialogContainer.destroyed=false;var obj={};Object.defineProperty(obj,"destroy",{"enumerable":true,"configurable":false,"writable":false,"value":function(){destroy(null,growlDialogContainer)}});return obj}else return null};
Object.defineProperty(_ref,"show",{enumerable:true,configurable:false,writable:false,value:growlDialog});Object.defineProperty(_ref,"Types",{enumerable:true,configurable:false,get:()=>{return _growls.type}});return _ref})();
window.WebDavCustomError=(()=>{let _CE={};let _errors={};let _options={};let attachError=(key,err)=>{if(!_errors[key])_errors[key]=[];_errors[key].push(err)};let findHandlers=(err,msg)=>{let eMsg=err?.Error?.BodyText||msg||err?.Message||err?.Error?.Description||null;let sc=err?.Status?.Code||null;let filters={};for(var kvp in _errors)if(eMsg&&eMsg.indexOf(kvp)!==-1||!eMsg&&!_errors[kvp].context)filters[kvp]=_errors[kvp];if(sc&&filters[sc])filters=filters[sc];var r=[];for(var kvp in filters)r=r.concat(filters[kvp]);
return r};let fireError=(err,message,callback)=>{if(err){let handlers=findHandlers(err,message);if(handlers){handlers.forEach(evt=>{try{evt.handler(err,message,callback)}catch(e){console.warn("Uncaught error: "+e.message)}});return handlers.length}else return false}};let catchSimpleError=errorDef=>{if(errorDef){let context=errorDef.context||null;if(context)attachError(context,errorDef);else{let sc=errorDef.statusCode||null;if(sc)attachError("",sc)}}};let catchError=defs=>{if(defs&&defs instanceof
Array)defs.forEach(def=>{catchSimpleError(def)});else catchSimpleError(defs)};Object.defineProperty(_CE,"catchError",{enumerable:true,configurable:false,writable:false,value:catchError});Object.defineProperty(_CE,"fireError",{enumerable:true,configurable:false,writable:false,value:fireError});return _CE})();
WebDavCustomError.catchError([{statusCode:500,context:"UnauthorizedAccessException",handler:function(err,message,callback){let bodyText=err?.Error?.BodyText||err?.Message?._phrase||err?.Status?.Description||"";let msg="Unauthorized Access";console.warn(`${message} ${bodyText}`);WebDavGrowl.show({type:WebDavGrowl.Types.ERROR,message:msg});if(callback)callback()}},{statusCode:500,context:"Search is not supported",handler:function(err,message,callback){let bodyText=err?.Error?.BodyText||err?.Message?._phrase||
err?.Status?.Description||"";let msg="Search is not supported";console.warn(`${message} ${bodyText}`);WebDavGrowl.show({type:WebDavGrowl.Types.ERROR,message:msg});if(callback)callback()}},{statusCode:403,context:"Access to the path",handler:function(err,message,callback){var consoleMsg="",msg="Access denied.";if(err?.Error){if(err.Error.BodyText){consoleMsg=err.Error.BodyText;consoleMsg=consoleMsg.substr(consoleMsg.toLowerCase().indexOf("access to the path"));consoleMsg=consoleMsg.substr(0,consoleMsg.indexOf("\r\n"))}if(consoleMsg===
"")consoleMsg=err.Error.Description;consoleMsg=consoleMsg.replaceAll("%s",location.origin.toString())}console.warn(`${consoleMsg}`);WebDavGrowl.show({type:WebDavGrowl.Types.ERROR,message:msg});if(callback)callback()}},{statusCode:500,context:"used by another process",handler:function(err,message,callback){let bodyText=err?.Error?.BodyText||err?.Message?._phrase||err?.Status?.Description||"";let msg="The file is being used by another process.";console.warn(`${message} ${bodyText}`);WebDavGrowl.show({type:WebDavGrowl.Types.ERROR,
message:msg});if(callback)callback()}},{statusCode:404,context:"Access denied",handler:function(err,message,callback){let bodyText=err?.Error?.BodyText||err?.Message?._phrase||err?.Status?.Description||"";let msg="The file doesn't exist on the server.";console.warn(`${message} ${bodyText}`);WebDavGrowl.show({type:WebDavGrowl.Types.ERROR,message:msg});if(callback)callback()}}]);
window.WebdavCommon=function(){var sGSuitePreviewErrorMessage="Preview document with G Suite Online Tool error.";var sGSuiteEditErrorMessage="Edit document with G Suite Online Editor error.";var sFileNameSpecialCharactersRestrictionFormat="The name cannot contain any of the following characters: {0}";var sForbiddenNameChars='/:*?"<>|';var ns={};var Formatters=ns.Formatters={FileSize:function(iSize){if(!iSize)return"0.00 B";var i=Math.floor(Math.log(iSize)/Math.log(1024));return(iSize/Math.pow(1024,
i)).toFixed(2)+" "+["B","kB","MB","GB","TB"][i]},Date:function(oDate){return moment(oDate).fromNow()},Snippet:function(html){if(html){var safePrefix="__b__tag"+(new Date).getTime();html=html.replace(/<b>/g,safePrefix+"_0").replace(/<\/b>/g,safePrefix+"_1");html=$("<div />").text(html).text();html=html.replace(new RegExp(safePrefix+"_0","g"),"<b>").replace(new RegExp(safePrefix+"_1","g"),"</b>")}return $("<div />").addClass("snippet").html(html)},GetFileExtension:function(fileName){var index=fileName.lastIndexOf(".");
return index!==-1?fileName.substr(index+1).toLowerCase():""},GetFileNameWithoutExtension:function(fileName){var index=fileName.lastIndexOf(".");return index!==-1?fileName.slice(0,index):""},TimeSpan:function(iSeconds){var hours=Math.floor(iSeconds/3600);var minutes=Math.floor((iSeconds-hours*3600)/60);var seconds=iSeconds-hours*3600-minutes*60;var sResult="";if(hours)sResult+=hours+"h ";if(minutes)sResult+=minutes+"m ";sResult+=seconds+"s ";return sResult},HtmlEscape:function(sText){return String(sText).replace(/&/g,
"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}};var ClientError=ns.ClientError=function ClientError(sMessage,sUri){this.Message=sMessage;this.Uri=sUri};ns.Validators={ValidateName:function(sName){var oRegExp=new RegExp("["+sForbiddenNameChars+"]","g");if(oRegExp.test(sName)){var sMessage=WebdavCommon.PasteFormat(sFileNameSpecialCharactersRestrictionFormat,sForbiddenNameChars.replace(/\\?(.)/g,"$1 "));return sMessage}}};ns.PasteFormat=function pasteFormat(sPhrase){var callbackReplace=
function(oArguments){this._arguments=oArguments};callbackReplace.prototype.Replace=function(sPlaceholder){var iIndex=sPlaceholder.substr(1,sPlaceholder.length-2);return"undefined"!==typeof this._arguments[iIndex]?this._arguments[iIndex]:sPlaceholder};if(/\{\d+?\}/.test(sPhrase)){var oReplace=new callbackReplace(Array.prototype.slice.call(arguments,1));sPhrase=sPhrase.replace(/\{(\d+?)\}/g,function(args){return oReplace.Replace(args)})}return sPhrase};function ErrorModal(selector){this.$el=$(selector);
this.$el.on("hidden.bs.modal",this._onModalHideHandler.bind(this))}ErrorModal.prototype={Show:function(sMessage,oError,fCallback){if(!WebDavCustomError.fireError(oError,sMessage,fCallback)){this._closeCallback=fCallback||$.noop;this._SetErrorMessage(sMessage);this._SetUrl(oError.Uri);this._SetMessage(oError.Message);if(oError.Error){let sBody=(oError.Error.Description||oError.Error.BodyText).split(/\r\n/)[0];this._SetBody(sBody)}else if(oError.InnerException)this._SetBody(oError.InnerException.toString());
this.$el.modal("show")}},_SetErrorMessage:function(sMessage){this.$el.find(".error-message").html(sMessage)},_SetUrl:function(sUrl){this.$el.find(".error-details-url").html(Formatters.HtmlEscape(sUrl))},_SetMessage:function(sMessage){sMessage=Formatters.HtmlEscape(sMessage);sMessage=String(sMessage).replace(/\n/g,"<br />\n").replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;");this.$el.find(".error-details-message").html(sMessage)},_SetBody:function(sMessage){var iframe=this.$el.find("iframe")[0];var doc=iframe.contentDocument||
iframe.contentWindow.document;doc.open();doc.close();doc.body.innerHTML=sMessage},_onModalHideHandler:function(){this._closeCallback()}};ns.ErrorModal=new ErrorModal("#ErrorModal");return ns}();
function BaseButton(sName,cssClass){this.Name=sName;this.CssClass=cssClass;this.InnerHtmlContent="";this.Create=function($toolbarContainer){$toolbarContainer.append('<button class="'+this.CssClass+'" title="'+this.Name+'">'+this.InnerHtmlContent+"</button>");this.$Button=$("."+this.CssClass)};this.Disable=function(){this.$Button.attr("disabled",true)};this.Activate=function(){this.$Button.attr("disabled",false)};this.HideOnMobile=function(){this.$Button.addClass("d-none d-md-inline")};this.ShowOnMobile=
function(){this.$Button.removeClass("d-none d-md-inline")}}function HerarhyItemDeleteController(toolbar){this.Toolbar=toolbar}
HerarhyItemDeleteController.prototype={Delete:function(fCallback){var self=this;self.Toolbar.ConfirmModal.Confirm("Are you sure want to delete selected items?",function(){var countDeleted=0;self.Toolbar.WebDAV.AllowReloadGrid=false;$.each(self.Toolbar.FolderGrid.selectedItems,function(index){self.Toolbar.FolderGrid.selectedItems[index].DeleteAsync(null,function(oAsyncResult){if(++countDeleted==self.Toolbar.FolderGrid.selectedItems.length){self.Toolbar.WebDAV.AllowReloadGrid=true;self.Toolbar.WebDAV.Reload();
self.Toolbar.ResetToolbar();fCallback(oAsyncResult)}})})})}};
function ToolbarDeleteButton(name,cssClass,toolbar){var sDeleteErrorMessage="Access denied.";BaseButton.call(this,name,cssClass);this.InnerHtmlContent='<span class="d-none d-xl-inline">Delete</span>';this.Render=function(){this.$Button.on("click",function(){(new HerarhyItemDeleteController(toolbar)).Delete(function(oAsyncResult){if(!oAsyncResult.IsSuccess)WebdavCommon.ErrorModal.Show(oAsyncResult?.Error?.Error?.Description||sDeleteErrorMessage,oAsyncResult.Error)})})}}
const sCopyItemsErrorMessage="Copy items error.";const sCutItemsErrorMessage="Cut items error.";const sCutItemsSameNameErrorMessage="The source and destination file names are the same.";const sCutItemsLockedErrorMessage="Items are locked.";function HerarhyItemsCopyPasteController(toolbar,storedItems){this.storedItems=storedItems;this.isCopiedItems=false;this.Toolbar=toolbar}
HerarhyItemsCopyPasteController.prototype={Copy:function(oItem,oItemName,fCallback){this.Toolbar.WebDAV.CurrentFolder.CopyToMeAsync(oItem,oItemName,true,null,null,function(oAsyncResult){fCallback(oAsyncResult)})},Move:function(oItem,fCallback){this.Toolbar.WebDAV.CurrentFolder.MoveToMeAsync(oItem,oItem.DisplayName,null,null,function(oAsyncResult){fCallback(oAsyncResult)})},_PushStoreItems:function(){var self=this;if(self.storedItems.length!=0){sessionStorage.removeItem("StoreItems");$.each(self.storedItems,
function(index){self.storedItems.pop(this)})}$.each(self.Toolbar.FolderGrid.selectedItems,function(index){self.storedItems.push(self.Toolbar.FolderGrid.selectedItems[index])});sessionStorage.setItem("StoreItems",JSON.stringify(self.storedItems));sessionStorage.setItem("isCopiedItems",JSON.stringify(self.isCopiedItems));self.Toolbar.UpdateToolbarButtons()},_MoveOrPasteItems:function(){var self=this;self.isCopiedItems=JSON.parse(sessionStorage.getItem("isCopiedItems"));var StoreItemsStored=JSON.parse(sessionStorage.getItem("StoreItems"));
if(StoreItemsStored!=null&&StoreItemsStored.length!=0)this.storedItems=StoreItemsStored;if(self.isCopiedItems)$.each(self.storedItems,function(index){self._ExecuteCopy(self.storedItems[index])});else{$.each(self.storedItems,function(index){self.Move(self.storedItems[index],function(oAsyncResult){if(!oAsyncResult.IsSuccess)if(oAsyncResult.Error instanceof ITHit.WebDAV.Client.Exceptions.ForbiddenException)WebdavCommon.ErrorModal.Show(sCutItemsSameNameErrorMessage,oAsyncResult.Error);else if(oAsyncResult.Error instanceof
ITHit.WebDAV.Client.Exceptions.LockedException)WebdavCommon.ErrorModal.Show(sCutItemsLockedErrorMessage,oAsyncResult.Error);else WebdavCommon.ErrorModal.Show(sCutItemsErrorMessage,oAsyncResult.Error)})});$.each(self.storedItems,function(index){self.storedItems.pop(this)});sessionStorage.removeItem("StoreItems");sessionStorage.removeItem("isCopiedItems")}this.Toolbar.UpdateToolbarButtons()},_ExecuteCopy:function(oItem){var self=this;self._DoCopy(oItem,self._GetCopySuffix(oItem.DisplayName,false))},
_DoCopy:function(oItem,oItemName){var self=this;self.Copy(oItem,oItemName,function(oAsyncResult){if(!oAsyncResult.IsSuccess)if(oAsyncResult.Error instanceof ITHit.WebDAV.Client.Exceptions.PreconditionFailedException||oAsyncResult.Error instanceof window.ITHit.WebDAV.Client.Exceptions.ForbiddenException)self._DoCopy(oItem,self._GetCopySuffix(oItemName,true));else WebdavCommon.ErrorModal.Show(sCopyItemsErrorMessage,oAsyncResult.Error)})},_GetCopySuffix:function(oItemName,bWithCopySuffix){var sCopyPrefixName=
"Copy";var aExtensionMatches=/\.[^\.]+$/.exec(oItemName);var sName=aExtensionMatches!==null?oItemName.replace(aExtensionMatches[0],""):oItemName;var sDotAndExtension=aExtensionMatches!==null?aExtensionMatches[0]:"";var sLangCopy=sCopyPrefixName;var oSuffixPattern=new RegExp("- "+sLangCopy+"( \\(([0-9]+)\\))?$","i");var aSuffixMatches=oSuffixPattern.exec(sName);if(aSuffixMatches===null&&bWithCopySuffix)sName+=" - "+sLangCopy;else if(aSuffixMatches!==null&&!aSuffixMatches[1])sName+=" (2)";else if(aSuffixMatches!==
null){var iNextNumber=parseInt(aSuffixMatches[2])+1;sName=sName.replace(oSuffixPattern,"- "+sLangCopy+" ("+iNextNumber+")")}oItemName=sName+sDotAndExtension;return oItemName}};
function CopyPasteButtonsControl(toolbar){this.CopyButton=new BaseButton("Copy","btn-copy-items",toolbar);this.PasteButton=new BaseButton("Paste","btn-paste-items",toolbar);this.CutButton=new BaseButton("Cut","btn-cut-items",toolbar);this.storedItems=[];var oHerarhyItemsCopyPasteController=new HerarhyItemsCopyPasteController(toolbar,this.storedItems);this.Create=function(tolbarSection){this.CopyButton.Create(tolbarSection);this.CutButton.Create(tolbarSection);this.PasteButton.Create(tolbarSection)};
this.Disable=function(){this.CopyButton.Disable();this.CutButton.Disable();this.PasteButton.Disable()};this.Activate=function(){this.CopyButton.Activate();this.CutButton.Activate();this.PasteButton.Activate()};this.Render=function(){this.CopyButton.$Button.on("click",function(){oHerarhyItemsCopyPasteController.isCopiedItems=true;oHerarhyItemsCopyPasteController._PushStoreItems()});this.CutButton.$Button.on("click",function(){oHerarhyItemsCopyPasteController.isCopiedItems=false;oHerarhyItemsCopyPasteController._PushStoreItems()});
this.PasteButton.$Button.on("click",function(){oHerarhyItemsCopyPasteController._MoveOrPasteItems()})}}function HerarhyItemPrintController(toolbar){this.Toolbar=toolbar}
HerarhyItemPrintController.prototype={PrintDocs:function(sDocumentUrls){ITHit.WebDAV.Client.DocManager.DavProtocolEditDocument(sDocumentUrls,this.Toolbar.WebDAV.GetMountUrl(),this.Toolbar.WebDAV._ProtocolInstallMessage.bind(this.Toolbar.WebDAV),null,webDavSettings.EditDocAuth.SearchIn,webDavSettings.EditDocAuth.CookieNames,webDavSettings.EditDocAuth.LoginUrl,"Print")},ExecutePrint:function(){self=this;self.Toolbar.ConfirmModal.Confirm("Are you sure want to print "+self.Toolbar.FolderGrid.selectedItems.length.toString()+
" selected items?",function(){var filesUrls=[];$.each(self.Toolbar.FolderGrid.selectedItems,function(){if(!this.IsFolder())filesUrls.push(this.Href)});self.PrintDocs(filesUrls)})}};function ToolbarPrintButton(name,cssClass,toolbar){BaseButton.call(this,name,cssClass);this.InnerHtmlContent='<span class="d-none d-xl-inline">Print</span>';this.Render=function(){this.$Button.on("click",function(){(new HerarhyItemPrintController(toolbar)).ExecutePrint()})}}
function ToolbarReloadButton(name,cssClass,toolbar){BaseButton.call(this,name,cssClass);this.Render=function(){this.$Button.on("click",function(){toolbar.WebDAV.Reload()})}}const sRenameItemErrorMessage="Rename item error.";const sRenameItemLockedErrorMessage="Item is locked.";function RenameItemController(toolbar){this.Toolbar=toolbar}
RenameItemController.prototype={Rename:function(newItemName,fCallback){this.Toolbar.FolderGrid.selectedItems[0].MoveToAsync(this.Toolbar.WebDAV.CurrentFolder,newItemName,null,null,function(oAsyncResult){fCallback(oAsyncResult)})}};
function RenameItemModal(modalSelector,renameItemController){var self=this;this.$modal=$(modalSelector);this.$txt=$(modalSelector).find('input[type="text"]');this.$submitButton=$(modalSelector).find(".btn-submit");this.$alert=$(modalSelector).find(".alert-danger");this.oldItemName="";this.$modal.on("shown.bs.modal",function(){self.$txt.focus()});this.$modal.find("form").submit(function(){self.$alert.addClass("d-none");if(self.$txt.val()==self.oldItemName)self.$modal.modal("hide");else if(self.$txt.val()!==
null&&self.$txt.val().match(/^ *$/)===null){var oValidationMessage=WebdavCommon.Validators.ValidateName(self.$txt.val());if(oValidationMessage){self.$alert.removeClass("d-none").text(oValidationMessage);return false}self.$txt.blur();self.$submitButton.attr("disabled","disabled");renameItemController.Rename(self.$txt.val().trim(),function(oAsyncResult){if(!oAsyncResult.IsSuccess)if(oAsyncResult.Error instanceof ITHit.WebDAV.Client.Exceptions.LockedException)WebdavCommon.ErrorModal.Show(sRenameItemLockedErrorMessage,
oAsyncResult.Error);else WebdavCommon.ErrorModal.Show(sRenameItemErrorMessage,oAsyncResult.Error);self.$modal.modal("hide");self.$submitButton.removeAttr("disabled");renameItemController.Toolbar.ResetToolbar();self.$txt.val("")})}else self.$alert.removeClass("d-none").text("Name is required!");return false})}
function ToolbarRenameButton(name,cssClass,toolbar){BaseButton.call(this,name,cssClass);var oRenameItemModal=new RenameItemModal("#RenameItemModal",new RenameItemController(toolbar));this.Render=function(){this.$Button.on("click",function(){if(toolbar.FolderGrid.selectedItems.length){oRenameItemModal.$txt.val(toolbar.FolderGrid.selectedItems[0].DisplayName);oRenameItemModal.oldItemName=toolbar.FolderGrid.selectedItems[0].DisplayName}oRenameItemModal.$alert.addClass("d-none");oRenameItemModal.$modal.modal("show")})}}
function CreateFolderController(toolbar){this.Toolbar=toolbar}CreateFolderController.prototype={CreateFolder:function(sFolderName,fCallback){this.Toolbar.WebDAV.CurrentFolder.CreateFolderAsync(sFolderName,null,null,function(oAsyncResult){fCallback(oAsyncResult)})}};
function CreateFolderModal(modalSelector,createFolderController){var sCreateFolderErrorMessage="Create folder error.";var self=this;this.$modal=$(modalSelector);this.$txt=$(modalSelector).find('input[type="text"]');this.$submitButton=$(modalSelector).find(".btn-submit");this.$alert=$(modalSelector).find(".alert-danger");this.$modal.on("shown.bs.modal",function(){self.$txt.focus()});this.$modal.find("form").submit(function(){self.$alert.addClass("d-none");if(self.$txt.val()!==null&&self.$txt.val().match(/^ *$/)===
null){var oValidationMessage=WebdavCommon.Validators.ValidateName(self.$txt.val());if(oValidationMessage){self.$alert.removeClass("d-none").text(oValidationMessage);return false}self.$txt.blur();self.$submitButton.attr("disabled","disabled");createFolderController.CreateFolder(self.$txt.val().trim(),function(oAsyncResult){if(!oAsyncResult.IsSuccess)if(oAsyncResult.Error instanceof ITHit.WebDAV.Client.Exceptions.MethodNotAllowedException)self.$alert.removeClass("d-none").text(oAsyncResult.Error.Error.Description?
oAsyncResult.Error.Error.Description:"Folder already exists.");else WebdavCommon.ErrorModal.Show(sCreateFolderErrorMessage,oAsyncResult.Error);else self.$modal.modal("hide");self.$submitButton.removeAttr("disabled")})}else self.$alert.removeClass("d-none").text("Name is required!");return false})}
function ToolbarCreateFolderButton(name,cssClass,toolbar){BaseButton.call(this,name,cssClass);var oCreateFolderModal=new CreateFolderModal("#CreateFolderModal",new CreateFolderController(toolbar));this.InnerHtmlContent='<span class="d-none d-lg-inline text-nowrap">Create Folder</span>';this.Render=function(){this.$Button.on("click",function(){oCreateFolderModal.$txt.val("");oCreateFolderModal.$alert.addClass("d-none");oCreateFolderModal.$modal.modal("show")})}}
(function(){function MobileApp(){this.readyListenerTriggered=false;window.addEventListener("flutterInAppWebViewPlatformReady",()=>{this.readyListenerTriggered=true});this.onFileDownload=data=>{let link=document.createElement("a");link.href=data.url;window.flutter_inappwebview.callHandler("triggerFileDownload",{href:link.href,filename:data.downloadName})};this.ready=()=>{return new Promise((res,rej)=>{const onReady=()=>{window.thinMobileApp={};window.isThinMobileApp=window["thinMobileApp"]&&window["flutter_inappwebview"]&&
typeof flutter_inappwebview.callHandler==="function";window.flutter_inappwebview.callHandler("webReady").then(function(result){if(result===null)window.isThinMobileApp=false;res()}).catch(function(){window.isThinMobileApp=false;rej()})};if(!this.readyListenerTriggered)window.addEventListener("flutterInAppWebViewPlatformReady",onReady);else onReady()})}}try{Thinfinity!=undefined}catch(e){Thinfinity={}}Thinfinity.MobileApp=new MobileApp})();
function DownloadItemsController(toolbar){this.Toolbar=toolbar}DownloadWithVirtualLink=function(sUrl,sFileName){var link=document.createElement("a");link.href=sUrl.indexOf("://")?sUrl:this.Commands.GetAbsolutePath(sUrl,true);link.target="_blank";link.download=sFileName||sUrl.substring(sUrl.lastIndexOf("/")+1,sUrl.length);link.click()};Thinfinity?.MobileApp?.ready().then(()=>{DownloadWithVirtualLink=(url,downloadName)=>Thinfinity.MobileApp.onFileDownload({url,downloadName})});
DownloadItemsController.prototype={Download:function(){var self=this;self.Toolbar.ConfirmModal.Confirm("Are you sure want to download "+self.Toolbar.FolderGrid.selectedItems.length.toString()+" selected items?",function(){self.Toolbar.WebDAV.AllowReloadGrid=false;$.each(self.Toolbar.FolderGrid.selectedItems,function(index){DownloadWithVirtualLink(self.Toolbar.FolderGrid.selectedItems[index].Href,self.Toolbar.FolderGrid.selectedItems[index].DisplayName)});self.Toolbar.WebDAV.AllowReloadGrid=true;self.Toolbar.WebDAV.Reload();
self.Toolbar.ResetToolbar()})}};function ToolbarDownloadButton(name,cssClass,toolbar){BaseButton.call(this,name,cssClass);this.Render=function(){this.$Button.on("click",function(){(new DownloadItemsController(toolbar)).Download()})}}
function Toolbar(selectorTableToolbar,folderGrid,confirmModal,webDAVController){this.ToolbarName=selectorTableToolbar;this.$Toolbar=$(selectorTableToolbar);this.FolderGrid=folderGrid;this.ConfirmModal=confirmModal;this.WebDAV=webDAVController;this.buttons=[];var self=this;if(typeof ToolbarCreateFolderButton==="function"){var createFolderButton=new ToolbarCreateFolderButton("Create Folder","btn-create-folder",this);this.buttons.push(createFolderButton);createFolderButton.Create($(self.$Toolbar).find(".first-section"))}if(typeof ToolbarDownloadButton===
"function"){var downloadButton=new ToolbarDownloadButton("Download Items","btn-download-item",this);this.buttons.push(downloadButton);downloadButton.Create($(self.$Toolbar).find(".first-second-section"))}if(typeof ToolbarRenameButton=="function"){var renameButton=new ToolbarRenameButton("Rename","btn-rename-item",this);this.buttons.push(renameButton);renameButton.Create($(self.$Toolbar).find(".second-section"))}if(typeof CopyPasteButtonsControl==="function"){var copyPasteButtons=new CopyPasteButtonsControl(this);
this.buttons.push(copyPasteButtons);copyPasteButtons.Create($(self.$Toolbar).find(".third-section"))}if(typeof ToolbarReloadButton=="function"){var reloadButton=new ToolbarReloadButton("Reload","btn-reload-items",this);this.buttons.push(reloadButton);reloadButton.Create($(self.$Toolbar).find(".fourth-section"))}if(typeof ToolbarDeleteButton==="function"){var deleteButton=new ToolbarDeleteButton("Delete","btn-delete-items",this);this.buttons.push(deleteButton);deleteButton.Create($(self.$Toolbar).find(".fifth-section"))}$.each(self.buttons,
function(index){this.Render()});this.UpdateToolbarButtons()}
Toolbar.prototype={UpdateToolbarButtons:function(){var self=this;$.each(self.buttons,function(index){if(typeof ToolbarCreateFolderButton==="function"&&this instanceof ToolbarCreateFolderButton)self.FolderGrid.selectedItems.length==0?this.ShowOnMobile():this.HideOnMobile();if(typeof ToolbarDeleteButton==="function"&&this instanceof ToolbarDeleteButton)if(self.FolderGrid.selectedItems.length==0){this.Disable();this.HideOnMobile()}else{this.Activate();this.ShowOnMobile()}if(typeof ToolbarRenameButton===
"function"&&this instanceof ToolbarRenameButton)if(self.FolderGrid.selectedItems.length==0||self.FolderGrid.selectedItems.length!=1){this.Disable();this.HideOnMobile()}else{this.Activate();this.ShowOnMobile()}if(typeof ToolbarDownloadButton==="function"&&this instanceof ToolbarDownloadButton){let filesTypes=self.FolderGrid.selectedItems.reduce((obj,item)=>{let type=item.IsFolder()?"folder":"file";obj[type]++;return obj},{file:0,folder:0});if(filesTypes.folder===0&&filesTypes.file>0){this.Activate();
this.ShowOnMobile()}else{this.Disable();this.HideOnMobile()}}if(typeof CopyPasteButtonsControl==="function"&&this instanceof CopyPasteButtonsControl){if(self.FolderGrid.selectedItems.length==0){this.CopyButton.Disable();this.CopyButton.HideOnMobile();this.CutButton.Disable();this.CutButton.HideOnMobile()}else{this.CopyButton.Activate();this.CopyButton.ShowOnMobile();this.CutButton.Activate();this.CutButton.ShowOnMobile()}var StoreItemsStored=JSON.parse(sessionStorage.getItem("StoreItems"));if(this.storedItems.length!=
0||StoreItemsStored!=null&&StoreItemsStored.length!=0){this.PasteButton.Activate();this.PasteButton.ShowOnMobile()}else{this.PasteButton.Disable();this.PasteButton.HideOnMobile()}}if(ITHit.Environment.OS=="Windows"&&typeof ToolbarPrintButton==="function"&&this instanceof ToolbarPrintButton)if(self.FolderGrid.selectedItems.filter(function(item){return!item.IsFolder()}).length==0){this.Disable();this.HideOnMobile()}else{this.Activate();this.ShowOnMobile()}})},ResetToolbar:function(){this.FolderGrid.UncheckTableCheckboxs();
this.UpdateToolbarButtons()}};
(function(WebdavCommon){var sSearchErrorMessage="Search is not supported.";var sSupportedFeaturesErrorMessage="Supported Features error.";var sProfindErrorMessage="PROPFIND request error.";var fTimeStamp=null;var isDefApp=vPathServerRoot==="";var FolderGridView=function(selectorTableContainer,selectorTableToolbar){var self=this;this.$el=$(selectorTableContainer);this.selectedItems=[];this.storedItems=[];this.isCopiedItems=false;this.selectedItem=null;this.activeSelectedTab="preview";this.isSearchMode=
false;this._defaultEditor="OSEditor";this.$el.on({mouseenter:function(){if($(this).hasClass("tr-snippet-url"))$(this).addClass("hover").prev().addClass("hover");else $(this).addClass("hover").next().addClass("hover")},mouseleave:function(){if($(this).hasClass("tr-snippet-url"))$(this).removeClass("hover").prev().removeClass("hover");else $(this).removeClass("hover").next().removeClass("hover")}},"tr");this.$el.find('th input[type="checkbox"]').change(function(){self.selectedItems=[];if($(this).is(":checked"))self.$el.find('td input[type="checkbox"]').prop("checked",
true).change();else{oToolbar.ResetToolbar();self.$el.find('td input[type="checkbox"]').prop("checked",false)}});setInterval(function(){self.$el.find("td.modified-date").each(function(){$(this).text(WebdavCommon.Formatters.Date($(this).data("modified-date")))})},3E3)};FolderGridView.prototype={Render:function(aItems,bisSearchMode){var self=this;this.isSearchMode=bisSearchMode||false;this.$el.find("tbody").html(aItems.map(function(oItem){var locked=oItem.ActiveLocks.length>0?'<span class="ithit-grid-icon-locked"></span>'+
(oItem.ActiveLocks[0].LockScope==="Shared"?'<span class="badge badge-pill badge-dark">'+oItem.ActiveLocks.length+"</span>":""):"";var $customCheckbox=$('<label class="custom-checkbox"><input type="checkbox" /><span class="checkmark"></span></label>');$customCheckbox.find("input").on("change",function(){if($(this).is(":checked"))self._AddSelectedItem(oItem);else self._RemoveSelectedItem(oItem)}).attr("checked",this._IsSelectedItem(oItem));return $("<div/>").html([$("<tr />").html([$('<td class="select-disabled"/>').html([$customCheckbox]),
$("<td />").html(oItem.IsFolder()?'<span class="icon-folder">'+locked+"</span>":locked),this._RenderDisplayName(oItem),$('<td class="d-none d-xl-table-cell" />').text(oItem.IsFolder()?"Folder":"File "+WebdavCommon.Formatters.GetFileExtension(oItem.DisplayName)),$("<td />").text(!oItem.IsFolder()?WebdavCommon.Formatters.FileSize(oItem.ContentLength):"").css("text-align","right"),$('<td class="d-none d-lg-table-cell modified-date" />').text(WebdavCommon.Formatters.Date(oItem.LastModified)).data("modified-date",
oItem.LastModified),$('<td class="text-right select-disabled"/>').html(this._MyRenderActions(oItem))]).on("click",function(e){if(!oItem.IsFolder()&&!$(this).hasClass("active")&&(e.target.nodeName.toLowerCase()==="td"&&!$(e.target).hasClass("select-disabled")||e.target.nodeName.toLowerCase()!=="td"&&!$(e.target).parents("td").hasClass("select-disabled"))){$(this).addClass("active").siblings().removeClass("active");self.selectedItem=oItem}}).addClass(self.selectedItem!=null&&oItem.Href==self.selectedItem.Href?
"active":""),$('<tr class="tr-snippet-url"/>').html([$('<td class="d-none d-xl-table-cell" />'),$('<td class="d-none d-lg-table-cell" />'),this._RenderSnippetAndUrl(oItem)])]).children()}.bind(this)))},_RenderDisplayName:function(oItem){var oElement=oItem.IsFolder()?$('<td class="ellipsis" />').html($("<a />").text(oItem.DisplayName).attr("href",oItem.Href)):$('<td class="ellipsis" />').html($("<span />").text(oItem.DisplayName));return oElement},_RenderSnippetAndUrl:function(oItem){var oElement=
$('<td colspan="10"/>');if(this.isSearchMode){(new BreadcrumbsView($("<ol />").addClass("breadcrumb").appendTo(oElement))).SetHierarchyItem(oItem);oElement.append(WebdavCommon.Formatters.Snippet(oItem.Properties.Find(oWebDAV.SnippetPropertyName)))}return oElement},_RenderActions:function(oItem){var self=this;var actions=[];var isDavProtocolSupported=ITHit.WebDAV.Client.DocManager.IsDavProtocolSupported();var isMicrosoftOfficeDocument=ITHit.WebDAV.Client.DocManager.IsMicrosoftOfficeDocument(oItem.Href);
var isGSuiteDocument=ITHit.WebDAV.Client.DocManager.IsGSuiteDocument(oItem.Href);if(oItem.IsFolder())actions.push($('<button class="btn btn-primary btn-sm btn-labeled" type="button"/>').html('<span class="btn-label"><i class="icon-open-folder"></i></span> <span class="d-none d-lg-inline-block">Browse</span>').attr("title","Open this folder in Operating System file manager.").on("click",function(){oWebDAV.OpenFolderInOsFileManager(oItem.Href)}).prop("disabled",!isDavProtocolSupported));else{var $btnGroup=
$('<div class="btn-group"></div>');var displayRadioBtns=isMicrosoftOfficeDocument&&isGSuiteDocument;$('<button type="button" class="btn btn-primary btn-sm btn-labeled btn-default-edit" title="'+(displayRadioBtns?self._GetActionGroupBtnTooltipText():"Edit document with desktop associated application.")+'"><span class="btn-label"><i class="'+(displayRadioBtns?self._GetActionGroupBtnCssClass():"icon-edit")+'"></i></span><span class="d-none d-lg-inline-block btn-edit-label">Edit</span></button>').appendTo($btnGroup).on("click",
function(){var $radio=$(this).parent().find("input[type=radio]:checked");if($radio.length)$radio.parent().next().click();else oWebDAV.EditDoc(oItem.Href)}).prop("disabled",!isDavProtocolSupported&&!isMicrosoftOfficeDocument);var $dropdownToggle=$('<button type="button" class="btn btn-primary dropdown-toggle dropdown-toggle-split btn-sm" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="sr-only">Toggle Dropdown</span></button>').appendTo($btnGroup).prop("disabled",!isDavProtocolSupported&&
!isMicrosoftOfficeDocument);this._RenderContextMenu(oItem,$btnGroup,isMicrosoftOfficeDocument,isGSuiteDocument,isDavProtocolSupported);$btnGroup.on("shown.bs.dropdown",function(){self.ContextMenuID=oItem.Href});$btnGroup.on("hidden.bs.dropdown",function(){self.ContextMenuID=null});if(self.ContextMenuID&&self.ContextMenuID==oItem.Href)$dropdownToggle.dropdown("toggle");actions.push($btnGroup)}return actions},_MyRenderActions:function(oItem){var self=this;var actions=[];var isDavProtocolSupported=ITHit.WebDAV.Client.DocManager.IsDavProtocolSupported();
var isMicrosoftOfficeDocument=ITHit.WebDAV.Client.DocManager.IsMicrosoftOfficeDocument(oItem.Href);var isGSuiteDocument=ITHit.WebDAV.Client.DocManager.IsGSuiteDocument(oItem.Href);if(oItem.IsFolder())actions.push($('<button class="btn btn-primary btn-sm btn-labeled" type="button"/>').html('<span class="btn-label"><i class="icon-open-folder"></i></span>').attr("title","Open Folder.").on("click",function(){location.href=oItem.Href}).prop("disabled",!isDavProtocolSupported));else actions.push($('<button class="btn btn-primary btn-sm btn-labeled" type="button"/>').html('<span class="btn-label"><i class="icon-download-file"></i></span>').attr("title",
"Download File.").on("click",function(){DownloadWithVirtualLink(oItem.Href,oItem.DisplayName)}).prop("disabled",!isDavProtocolSupported));return actions},_GetActionGroupBtnTooltipText:function(){var tooltipText="Edit document with desktop associated application.";switch(this._defaultEditor){case "OSEditor":tooltipText="Edit with Microsoft Office Desktop.";break;case "GSuiteEditor":tooltipText="Edit document in G Suite Editor.";break}return tooltipText},_GetActionGroupBtnCssClass:function(){var cssClassName=
"icon-edit";switch(this._defaultEditor){case "OSEditor":cssClassName="icon-microsoft-edit";break;case "GSuiteEditor":cssClassName="icon-gsuite-edit";break}return cssClassName},_RenderContextMenu:function(oItem,$btnGroup,isMicrosoftOfficeDocument,isGSuiteDocument,isDavProtocolSupported){var self=this;var supportGSuiteFeature=oWebDAV.OptionsInfo.Features&ITHit.WebDAV.Client.Features.GSuite;var displayRadioBtns=isMicrosoftOfficeDocument&&isGSuiteDocument;var $dropdownMenu=$('<div class="dropdown-menu dropdown-menu-right actions '+
(displayRadioBtns?"dropdown-menu-radio-btns":"")+'"></div>').appendTo($btnGroup);if(isMicrosoftOfficeDocument){if(displayRadioBtns)$('<label class="custom-radiobtn"><input type="radio" name="defaultEditor'+oItem.DisplayName+'" value="OSEditor" '+self._GetContextMenuRadioBtnCheckedProperty("OSEditor")+' /><span class="checkmark"></span></label>').appendTo($dropdownMenu).find("input[type=radio]").change(function(){self._ChangeContextMenuRadionBtnHandler($(this))});$('<a class="dropdown-item '+(displayRadioBtns?
"dropdown-radio":"")+'" href="javascript:void()" title="Edit with Microsoft Office Desktop."><i class="icon-microsoft-edit"></i>Edit with Microsoft Office Desktop</a>').appendTo($dropdownMenu).on("click",function(){oWebDAV.EditDoc(oItem.Href)})}if(!isMicrosoftOfficeDocument)$('<a class="dropdown-item'+(isDavProtocolSupported?"":" disabled")+'" href="javascript:void()" title="Edit document with desktop associated application."><i class="icon-edit-associated"></i>Edit with Associated Desktop Application</a>').appendTo($dropdownMenu).on("click",
function(){oWebDAV.EditDoc(oItem.Href)});$('<div class="dropdown-divider"></div>').appendTo($dropdownMenu);$('<a class="dropdown-item desktop-app'+(isDavProtocolSupported?"":" disabled")+'" href="javascript:void()" title="Select application to open this file with.">Select Desktop Application</a>').appendTo($dropdownMenu).on("click",function(){oWebDAV.OpenDocWith(oItem.Href)})},_GetContextMenuRadioBtnCheckedProperty:function(editorName){return this._defaultEditor==editorName?'checked="checked"':""},
_ChangeContextMenuRadionBtnHandler:function($radioBtn){var self=this;var iconClassName=$radioBtn.parent().next().find("i:first").attr("class");this._defaultEditor=$radioBtn.val();$('input[value="'+self._defaultEditor+'"]').prop("checked",true);$(".btn-default-edit").each(function(){var $btn=$(this);if($btn.parent().find(".actions input[type=radio]").length)$btn.find("i:first").attr("class",iconClassName);$btn.attr("title",self._GetActionGroupBtnTooltipText())})},_AddSelectedItem:function(oItem){this.selectedItems.push(oItem);
oToolbar.UpdateToolbarButtons()},_RemoveSelectedItem:function(oItem){var self=this;$.each(this.selectedItems,function(index){if(self.selectedItems[index].Href===oItem.Href){self.selectedItems.splice(index,1);return false}});oToolbar.UpdateToolbarButtons()},_IsSelectedItem:function(oItem){var self=this;var isSelected=false;$.each(this.selectedItems,function(index){if(self.selectedItems[index].Href===oItem.Href){isSelected=true;return false}});return isSelected},UncheckTableCheckboxs:function(){this.selectedItems=
[];this.$el.find('input[type="checkbox"]').prop("checked",false)}};var SearchFormView=function(selector){this.$el=$(selector);this.Init()};SearchFormView.prototype={Init:function(){this.$el.find("button").on("click",this._OnSubmit.bind(this)).on("mouseover",this._OnMouseOver.bind(this)).on("mouseleave",this._OnMouseLeave.bind(this));this.$el.find("button").hide();this.$el.find("input").typeahead({},{name:"states",display:"DisplayName",limit:6,templates:{suggestion:this._RenderSuggestion.bind(this)},
async:true,source:this._Source.bind(this)}).on("keyup",this._OnKeyUp.bind(this)).on("typeahead:select",this._OnSelect.bind(this)).on("mouseover",this._OnMouseOver.bind(this)).on("mouseleave",this._OnMouseLeave.bind(this))},SetDisabled:function(bIsDisabled){this.$el.find("button").prop("disabled",bIsDisabled);this.$el.find("input").prop("disabled",bIsDisabled).attr("placeholder",!bIsDisabled?"":"The server does not support search")},GetValue:function(){return this.$el.find("input.tt-input").val()},
LoadFromHash:function(){this.$el.find("input.tt-input").val(oWebDAV.GetHashValue("search"));this._RenderFolderGrid(oWebDAV.GetHashValue("search"),oWebDAV.GetHashValue("page"))},_Source:function(sPhrase,c,fCallback){oWebDAV.NavigateSearch(sPhrase,false,1,false,true,function(oResult){if(oResult.IsSuccess)fCallback(oResult.Result.Page);else WebdavCommon.ErrorModal.Show(sSearchErrorMessage,oResult.Error)})},ClearValue:function(){this.$el.find("input.tt-input").val("");this._RenderFolderGrid("",oWebDAV.GetHashValue("page"))},
_OnMouseOver:function(oEvent){this.$el.find("button").show()},_OnMouseLeave:function(oEvent){this.$el.find("button").hide()},_OnKeyUp:function(oEvent){if(oEvent.keyCode===13){this._RenderFolderGrid(oSearchForm.GetValue(),1);this.$el.find("input").typeahead("close");this._HideKeyboard(this.$el.find("input"))}},_OnSelect:function(oEvent,oItem){oFolderGrid.Render([oItem],true);oPagination.Hide()},_OnSubmit:function(){this.ClearValue();this._RenderFolderGrid(oSearchForm.GetValue(),1)},_RenderFolderGrid:function(oSearchQuery,
nPageNumber){var oSearchFormView=this;oWebDAV.NavigateSearch(oSearchForm.GetValue(),false,nPageNumber,true,true,function(oResult){oFolderGrid.Render(oResult.Result.Page,true);oPagination.Render(nPageNumber,Math.ceil(oResult.Result.TotalItems/oWebDAV.PageSize),function(pageNumber){oSearchFormView._RenderFolderGrid(oSearchQuery,pageNumber)});if(oResult.Result.Page.length==0&&nPageNumber!=1)oSearchFormView._RenderFolderGrid(oSearchQuery,1)})},_RenderSuggestion:function(oItem){var oElement=$("<div />").text(oItem.DisplayName);
(new BreadcrumbsView($("<ol />").addClass("breadcrumb").appendTo(oElement))).SetHierarchyItem(oItem);oElement.append(WebdavCommon.Formatters.Snippet(oItem.Properties.Find(oWebDAV.SnippetPropertyName)));return oElement},_HideKeyboard:function(element){element.attr("readonly","readonly");element.attr("disabled","true");setTimeout(function(){element.blur();element.removeAttr("readonly");element.removeAttr("disabled")},100)}};var BreadcrumbsView=function(selector,upOneLevelBtn){this.$el=$(selector);this.$upOneLevelBtn=
$(upOneLevelBtn)};function resolveUrl(relativePath){var originalUrl=document.location.href;history.replaceState(history.state,"",relativePath);var resolvedUrl=document.location.href;history.replaceState(history.state,"",originalUrl);return resolvedUrl}BreadcrumbsView.prototype={SetHierarchyItem:function(oItem){var aParts=resolveUrl(oItem.Href).split("/").slice(2).filter(function(v){return v});var sIndex=isDefApp?1:2;this.$el.html(aParts.map(function(sPart,i){var bIsLast=aParts.length===i+1;if(webDavSettings.ApplicationPath.length>
1){var oLabel=i===sIndex?$("<span />").addClass("icon-home"):$("<span />").text(decodeURIComponent(sPart));if(i<sIndex)return""}else var oLabel=i===1?$("<span />").addClass("icon-home"):$("<span />").text(decodeURIComponent(sPart));return $('<li class="breadcrumb-item"/>').toggleClass("active",bIsLast).append(bIsLast?$("<span />").html(oLabel):$("<a />").attr("href",location.protocol+"//"+aParts.slice(0,i+1).join("/")+"/").html(oLabel))}));if(this.$upOneLevelBtn){var $lastLnk=this.$el.find("a").last();
if($lastLnk.length){this.$upOneLevelBtn.attr("href",$lastLnk.attr("href"));this.$upOneLevelBtn.removeClass("disabled")}else{this.$upOneLevelBtn.attr("href","javascript.void()");this.$upOneLevelBtn.addClass("disabled")}}}};var PaginationView=function(selector){this.$el=$(selector);this.maxItems=5};PaginationView.prototype={Render:function(pageNumber,countPages,changePageCallback){this.$el.empty();if(countPages&&countPages>1){$("<a />").addClass("page-link").appendTo($("<li/>").addClass("page-item "+
(pageNumber==1?"disabled":"")).appendTo(this.$el)).text("<<").click(function(){if(pageNumber!=1)changePageCallback(pageNumber-1);return false});var firstPage=countPages>this.maxItems&&pageNumber-Math.floor(this.maxItems/2)>0?pageNumber-Math.floor(this.maxItems/2):1;var lastPage=firstPage+this.maxItems-1<=countPages?firstPage+this.maxItems-1:countPages;if(countPages>this.maxItems&&lastPage-firstPage<this.maxItems)firstPage=lastPage-this.maxItems+1;if(firstPage>1&&countPages>this.maxItems){$("<a />").addClass("page-link").data("page-number",
1).appendTo($("<li/>").addClass("page-item "+(1==pageNumber?"active":"")).appendTo(this.$el)).text(1).click(function(){if(pageNumber!=$(this).data("page-number"))changePageCallback($(this).data("page-number"));return false});if(firstPage-1>1)$("<a />").addClass("page-link").data("page-number",i).appendTo($("<li/>").addClass("page-item disabled").appendTo(this.$el)).text("...")}for(var i=firstPage;i<=lastPage;i++)$("<a />").addClass("page-link").data("page-number",i).appendTo($("<li/>").addClass("page-item "+
(i==pageNumber?"active":"")).appendTo(this.$el)).text(i).click(function(){if(pageNumber!=$(this).data("page-number"))changePageCallback($(this).data("page-number"));return false});if(lastPage!=countPages&&countPages>this.maxItems){if(lastPage!=countPages-1)$("<a />").addClass("page-link").data("page-number",i).appendTo($("<li/>").addClass("page-item disabled").appendTo(this.$el)).text("...");$("<a />").addClass("page-link").data("page-number",countPages).appendTo($("<li/>").addClass("page-item "+
(countPages==pageNumber?"active":"")).appendTo(this.$el)).text(countPages).click(function(){if(pageNumber!=$(this).data("page-number"))changePageCallback($(this).data("page-number"));return false})}$("<a />").addClass("page-link").appendTo($("<li/>").addClass("page-item "+(countPages==pageNumber?"disabled":"")).appendTo(this.$el)).text(">>").click(function(){if(pageNumber!=countPages)changePageCallback(pageNumber+1);return false})}},Hide:function(){this.$el.empty()}};var TableSortingView=function(selector){this.$headerCols=
$(selector);this.Init()};TableSortingView.prototype={Init:function(){var $cols=this.$headerCols;$cols.click(function(){var className="ascending";if($(this).hasClass("ascending"))className="descending";oWebDAV.Sort($(this).data("sort-column"),className=="ascending")})},Set:function(sortColumn,sortAscending){var $col=this.$headerCols.filter('[data-sort-column="'+sortColumn+'"]');this.$headerCols.removeClass("ascending descending");if(sortAscending)$col.removeClass("descending").addClass("ascending");
else $col.removeClass("ascending").addClass("descending")},Disable:function(){this.$headerCols.addClass("disabled")},Enable:function(){this.$headerCols.removeClass("disabled")}};var HistoryApiController=function(selector){this.$container=$(selector);this.Init()};HistoryApiController.prototype={Init:function(){if(!this._IsBrowserSupport())return;window.addEventListener("popstate",this._OnPopState.bind(this),false);this.$container.on("click",this._OnLinkClick.bind(this))},PushState:function(){if(this._IsBrowserSupport())history.pushState("",
document.title,window.location.pathname+window.location.search)},_OnPopState:function(oEvent){if(oWebDAV.GetHashValue("search"))oSearchForm.LoadFromHash();else{var sUrl=oEvent.state&&oEvent.state.Url||window.location.href.split("#")[0];oWebDAV.NavigateFolder(sUrl,null,null,null,true)}},_OnLinkClick:function(oEvent){var sUrl=$(oEvent.target).closest("a").attr("href");if(!sUrl)return;if(sUrl.indexOf(location.origin||window.location.href.split("#")[0].replace(location.pathname,""))!==0)return;oEvent.preventDefault();
history.pushState({Url:sUrl},"",sUrl);oWebDAV.NavigateFolder(sUrl,null,null,null,true)},_IsBrowserSupport:function(){return!!(window.history&&history.pushState)}};var ConfirmModal=function(selector){var self=this;this.$el=$(selector);this.$el.find(".btn-ok").click(function(){if(self.successfulCallback)self.successfulCallback();self.$el.modal("hide")})};ConfirmModal.prototype={Confirm:function(htmlMessage,successfulCallback,options){var $modalDialog=this.$el.find(".modal-dialog");this.successfulCallback=
successfulCallback;this.$el.find(".message").html(htmlMessage);if(options&&options.size=="lg")$modalDialog.removeClass("modal-sm").addClass("modal-lg");else $modalDialog.removeClass("modal-lg").addClass("modal-sm");this.$el.modal("show")}};var getWindowSize=function(){let wh=window.innerHeight;let ah=wh;let pageRowHeight=49;let notVisibleRows=3;ah-=notVisibleRows*pageRowHeight;let headers=document.getElementsByTagName("header");if(headers)ah-=headers[0].offsetHeight;let dWrapper=document.getElementsByClassName("ithit-grid-wrapper");
if(dWrapper)ah-=dWrapper[0].offsetTop;return{height:wh,availHeight:ah,rowsperpage:parseInt(ah/pageRowHeight,10)}};var WebDAVController=function(){let wndSize=getWindowSize();this.PageSize=wndSize.rowsperpage;this.CurrentFolder=null;this.AllowReloadGrid=true;this.WebDavSession=new ITHit.WebDAV.Client.WebDavSession;this.SnippetPropertyName=new ITHit.WebDAV.Client.PropertyName("snippet","ithit");environment.on("resizecomplete",function(view){if(wndSize.height!=view.height)location.reload()})};WebDAVController.prototype=
{Reload:function(){if(this.CurrentFolder&&this.AllowReloadGrid)if(this.GetHashValue("search"))oSearchForm.LoadFromHash();else this.NavigateFolder(window.location.href.split("#")[0])},NavigateFolder:function(sPath,pageNumber,sortColumn,sortAscending,resetSelectedItem,fCallback){var pageSize=this.PageSize,currentPageNumber=1;var sortColumns=[new ITHit.WebDAV.Client.OrderProperty(new ITHit.WebDAV.Client.PropertyName("is-directory",ITHit.WebDAV.Client.DavConstants.NamespaceUri),this.CurrentSortColumnAscending)];
if(!sPath&&this.CurrentFolder)sPath=window.location.href.split("#")[0];if(typeof WebDAVUploaderGridView!=="undefined")WebDAVUploaderGridView.SetUploadUrl(sPath);if(resetSelectedItem)oToolbar.ResetToolbar();oTableSorting.Enable();if(sortColumn){this.CurrentSortColumn=sortColumn;this.CurrentSortAscending=sortAscending;this.SetHashValues([{Name:"sortcolumn",Value:sortColumn},{Name:"sortascending",Value:sortAscending.toString()}])}else if(this.GetHashValue("sortcolumn")){this.CurrentSortColumn=this.GetHashValue("sortcolumn");
this.CurrentSortAscending=this.GetHashValue("sortascending")=="true";oTableSorting.Set(this.CurrentSortColumn,this.CurrentSortAscending)}else{this.CurrentSortColumn="displayname";this.CurrentSortAscending=true;oTableSorting.Set(this.CurrentSortColumn,this.CurrentSortAscending)}if(this.CurrentSortColumn)sortColumns.push(new ITHit.WebDAV.Client.OrderProperty(new ITHit.WebDAV.Client.PropertyName(this.CurrentSortColumn,ITHit.WebDAV.Client.DavConstants.NamespaceUri),this.CurrentSortAscending));if(pageNumber)currentPageNumber=
pageNumber;else if(this.GetHashValue("page"))currentPageNumber=parseInt(this.GetHashValue("page"));if(currentPageNumber!=1)this.SetHashValue("page",currentPageNumber);else this.SetHashValue("page","");this.WebDavSession.OpenFolderAsync(sPath,[],function(oResponse){var self=this;if(oResponse.IsSuccess){self.CurrentFolder=oResponse.Result;oBreadcrumbs.SetHierarchyItem(self.CurrentFolder);this.CurrentFolder.GetSupportedFeaturesAsync(function(oResult){if(oResult.IsSuccess){self.OptionsInfo=oResult.Result;
oSearchForm.SetDisabled(!(self.OptionsInfo.Features&ITHit.WebDAV.Client.Features.Dasl))}else WebdavCommon.ErrorModal.Show(sSupportedFeaturesErrorMessage,oResult.Error)});this.CurrentFolder.GetPageAsync([],(currentPageNumber-1)*pageSize,pageSize,sortColumns,function(oResult){if(oResult.IsSuccess){var aItems=oResult.Result.Page;var aCountPages=Math.ceil(oResult.Result.TotalItems/pageSize);oFolderGrid.Render(aItems,false);oPagination.Render(currentPageNumber,aCountPages,function(pageNumber){oWebDAV.NavigateFolder(null,
pageNumber,null,null,true)});if(aItems.length==0&&pageNumber!=1)oWebDAV.NavigateFolder(null,1,null,null,true);if(fCallback)fCallback(aItems)}else WebdavCommon.ErrorModal.Show(sProfindErrorMessage,oResult.Error)})}else WebdavCommon.ErrorModal.Show(sProfindErrorMessage,oResponse.Error)}.bind(this))},NavigateSearch:function(sPhrase,bIsDynamic,pageNumber,updateUrlHash,resetSelectedItem,fCallback){var pageSize=this.PageSize,currentPageNumber=1;if(!this.CurrentFolder){fCallback&&fCallback({Items:[],TotalItems:0});
return}if(updateUrlHash)this.SetHashValue("search",sPhrase);if(sPhrase===""){this.Reload();return}if(resetSelectedItem)oToolbar.ResetToolbar();if(pageNumber)currentPageNumber=pageNumber;else if(this.GetHashValue("page"))currentPageNumber=parseInt(this.GetHashValue("page"));if(updateUrlHash&&currentPageNumber!=1)this.SetHashValue("page",currentPageNumber);else this.SetHashValue("page","");oTableSorting.Disable();var searchQuery=new ITHit.WebDAV.Client.SearchQuery;searchQuery.Phrase=sPhrase.replace(/\\/g,
"\\\\").replace(/%/g,"\\%").replace(/_/g,"\\_").replace(/\*/g,"%").replace(/\?/g,"_")+"%";searchQuery.EnableContains=!bIsDynamic;searchQuery.SelectProperties=[this.SnippetPropertyName];function _getSearchPageByQuery(){oWebDAV.CurrentFolder.GetSearchPageByQueryAsync(searchQuery,(currentPageNumber-1)*pageSize,pageSize,function(oResult){if(oResult.IsSuccess)fCallback&&fCallback(oResult);else WebdavCommon.ErrorModal.Show(sSearchErrorMessage,oResult.Error)})}if(window.location.href.split("#")[0]!=this.CurrentFolder.Href)this.WebDavSession.OpenFolderAsync(window.location.href.split("#")[0],
[],function(oResponse){oWebDAV.CurrentFolder=oResponse.Result;oBreadcrumbs.SetHierarchyItem(oWebDAV.CurrentFolder);_getSearchPageByQuery()});else _getSearchPageByQuery()},Sort:function(columnName,sortAscending){this.NavigateFolder(null,null,columnName,sortAscending,true)},EditDoc:function(sDocumentUrl){if(["cookies","ms-ofba"].indexOf(webDavSettings.EditDocAuth.Authentication.toLowerCase())!=-1)if(webDavSettings.EditDocAuth.Authentication.toLowerCase()=="ms-ofba"&&ITHit.WebDAV.Client.DocManager.IsMicrosoftOfficeDocument(sDocumentUrl))ITHit.WebDAV.Client.DocManager.EditDocument(sDocumentUrl,
this.GetMountUrl(),this._ProtocolInstallMessage.bind(this));else ITHit.WebDAV.Client.DocManager.DavProtocolEditDocument(sDocumentUrl,this.GetMountUrl(),this._ProtocolInstallMessage.bind(this),null,webDavSettings.EditDocAuth.SearchIn,webDavSettings.EditDocAuth.CookieNames,webDavSettings.EditDocAuth.LoginUrl);else ITHit.WebDAV.Client.DocManager.EditDocument(sDocumentUrl,this.GetMountUrl(),this._ProtocolInstallMessage.bind(this))},GSuiteEditDoc:function(sDocumentUrl,gSuiteEditPanel,errorCallback){ITHit.WebDAV.Client.DocManager.GSuiteEditDocument(sDocumentUrl,
gSuiteEditPanel,errorCallback)},GSuitePreviewDoc:function(sDocumentUrl,gSuitePreviewPanel,errorCallback){ITHit.WebDAV.Client.DocManager.GSuitePreviewDocument(sDocumentUrl,gSuitePreviewPanel,errorCallback)},OpenDocWith:function(sDocumentUrl){ITHit.WebDAV.Client.DocManager.DavProtocolEditDocument([sDocumentUrl],this.GetMountUrl(),this._ProtocolInstallMessage.bind(this),null,webDavSettings.EditDocAuth.SearchIn,webDavSettings.EditDocAuth.CookieNames,webDavSettings.EditDocAuth.LoginUrl,"OpenWith")},OpenCurrentFolderInOsFileManager:function(){this.OpenFolderInOsFileManager(this.CurrentFolder.Href)},
OpenFolderInOsFileManager:function(sFolderUrl){ITHit.WebDAV.Client.DocManager.OpenFolderInOsFileManager(sFolderUrl,this.GetMountUrl(),this._ProtocolInstallMessage.bind(this),null,webDavSettings.EditDocAuth.SearchIn,webDavSettings.EditDocAuth.CookieNames,webDavSettings.EditDocAuth.LoginUrl)},GetMountUrl:function(){var port=window.location.port||(window.location.protocol=="http:"?80:443);return window.location.protocol+"//"+window.location.hostname+":"+port+webDavSettings.ApplicationPath+"/"},GetHashValue:function(key){var hashConfig=
this._parseUrlHash();return hashConfig.hasOwnProperty(key)?hashConfig[key]:null},SetHashValues:function(arrayValues){var hashValue="";var params=[];var hashConfig=this._parseUrlHash();for(var i=0;i<arrayValues.length;i++)hashConfig=this._addParameterToArray(arrayValues[i].Name,arrayValues[i].Value,hashConfig);for(var key in hashConfig)params.push(key+"="+hashConfig[key]);hashValue=params.length>0?"#"+params.join("&"):"";if(hashValue!=location.hash)location.hash=hashValue;if(location.href[location.href.length-
1]=="#")oHistoryApi.PushState()},SetHashValue:function(name,value){this.SetHashValues([{Name:name,Value:value}])},GetInstallerFileUrl:function(){return webDavSettings.ApplicationProtocolsPath+ITHit.WebDAV.Client.DocManager.GetProtocolInstallFileNames()[0]},_addParameterToArray:function(name,value,arrayParams){var nameExist=false;for(var key in arrayParams)if(arrayParams.hasOwnProperty(key)){if(key==name){nameExist=true;arrayParams[key]=value}if(!arrayParams[key])continue}if(!nameExist&&value)arrayParams[name]=
value;return arrayParams},_parseUrlHash:function(){var hash={};if(location.hash.length>0){var hashParts=location.hash.substr(1).split("&");for(var i=0,l=hashParts.length;i<l;i++){var param=hashParts[i].split("=");hash[param[0]]=param[1]}}return hash},_ProtocolInstallMessage:function(){if(ITHit.WebDAV.Client.DocManager.IsDavProtocolSupported()){var $currentOS=$("#DownloadProtocolModal .current-os");var $currentBrowser=$("#DownloadProtocolModal .current-browser");if($currentBrowser.children().length===
0){let isChrome=!!window["chrome"]&&(!!window["chrome"]["webstore"]||!!window["chrome"]["runtime"]);if(isChrome&&navigator.userAgent.indexOf("Edg")!==-1)$("#DownloadProtocolModal .edge-chromium").appendTo($currentBrowser);else if(isChrome)$("#DownloadProtocolModal .goole-chrome").appendTo($currentBrowser);else if(typeof InstallTrigger!=="undefined")$("#DownloadProtocolModal .mozilla-firefox").appendTo($currentBrowser);else if(navigator.userAgent.indexOf("MSIE ")>0||!!navigator.userAgent.match(/Trident.*rv:11\./))$("#DownloadProtocolModal .not-required-internet-explorer").show()}if($currentOS.children().length===
0)if(ITHit.DetectOS.OS==="Windows")$("#DownloadProtocolModal .window").appendTo($currentOS);else if(ITHit.DetectOS.OS==="Linux")$("#DownloadProtocolModal .linux").appendTo($currentOS);else if(ITHit.DetectOS.OS==="MacOS")$("#DownloadProtocolModal .mac-os").appendTo($currentOS);$("#DownloadProtocolModal").modal("show");$("#DownloadProtocolModal .more-lnk").unbind().click(function(){var $pnl=$(this).next();if($pnl.is(":visible")){$(this).find("span").text("+");$pnl.hide()}else{$(this).find("span").text("-");
$pnl.show()}})}}};var oWebDAV=window.WebDAVController=new WebDAVController;var oConfirmModal=new ConfirmModal("#ConfirmModal");var oFolderGrid=new FolderGridView(".ithit-grid-container",".ithit-grid-toolbar");var oToolbar=new Toolbar(".ithit-grid-toolbar",oFolderGrid,oConfirmModal,oWebDAV);var oSearchForm=new SearchFormView(".ithit-search-container");var oBreadcrumbs=new BreadcrumbsView(".ithit-breadcrumb-container .breadcrumb",".btn-up-one-level");var oPagination=new PaginationView(".ithit-pagination-container");
var oTableSorting=new TableSortingView(".ithit-grid-container th.sort");var oHistoryApi=new HistoryApiController(".ithit-grid-container, .ithit-breadcrumb-container");if(oWebDAV.GetHashValue("search"))oWebDAV.NavigateFolder(window.location.href.split("#")[0],null,null,null,true,function(){oSearchForm.LoadFromHash()});else oWebDAV.NavigateFolder(window.location.href.split("#")[0]);if(ITHit.WebDAV.Client.DocManager.IsDavProtocolSupported())$(".ithit-version-value").html("v"+ITHit.WebDAV.Client.WebDavSession.Version+
' (<a href="'+oWebDAV.GetInstallerFileUrl()+'">Protocol v'+ITHit.WebDAV.Client.WebDavSession.ProtocolVersion+"</a>)");else $(".ithit-version-value").text("v"+ITHit.WebDAV.Client.WebDavSession.Version+" (Protocol v"+ITHit.WebDAV.Client.WebDavSession.ProtocolVersion+")");$(".ithit-current-folder-value").text(oWebDAV.GetMountUrl())})(WebdavCommon);
(function(WebdavCommon){var sOverwriteDialogueFormat="The following item(s) exist on the server:<br/><br/>{0}<br/><br/>Overwrite?";var sFailedCheckExistsMessage="Check for already exists item failed with error.";var sRetryMessageFormat="Retry in: {0}";var sWrongFileSizeFormat="File size should be less than {0}.";var sForbiddenExtensionFormat='Upload files with "{0}" extension is forbidden.';var sValidationError="Validation Error";var iMaxFileSize=10485760;var aForbiddenExtensions=["BAT","BIN","CMD",
"COM","EXE"];var ConfirmRewriteModal=function(selector){this.$el=$(selector);this.$el.find(".btn-ok").click(this._onOkClickHandler.bind(this));this.$el.find(".btn-no").click(this._onNoClickHandler.bind(this));this.$el.on("hide.bs.modal",this._onModalHideHandler.bind(this))};ConfirmRewriteModal.prototype={Confirm:function(message,successfulCallback,discardCallback,cancelCallback){this.isConfirmed=false;this.successfulCallback=successfulCallback||$.noop;this.discardCallback=discardCallback||$.noop;
this.cancelCallback=cancelCallback||$.noop;this.$el.find(".message").html(message);this.$el.find(".modal-dialog").addClass("modal-lg");this.$el.modal("show")},_onOkClickHandler:function(e){this.isConfirmed=true;this.successfulCallback();this.$el.modal("hide")},_onNoClickHandler:function(e){this.isDiscarded=true;this.discardCallback();this.$el.modal("hide")},_onModalHideHandler:function(){if(!this.isConfirmed&&!this.isDiscarded)this.cancelCallback()}};function ClientError(sMessage,sUri){this.Message=
sMessage;this.Uri=sUri}function UploaderGridView(sSelector){this.Uploader=new ITHit.WebDAV.Client.Upload.Uploader;this._dropCounter=0;this.Uploader.Inputs.AddById("ithit-button-input");this._dropZone=this.Uploader.DropZones.AddById("ithit-dropzone");this._dropZone.HtmlElement.addEventListener("dragenter",this._OnDragEnter.bind(this),false);this._dropZone.HtmlElement.addEventListener("dragleave",this._OnDragLeave.bind(this),false);this._dropZone.HtmlElement.addEventListener("drop",this._OnDrop.bind(this),
false);this.Uploader.SetUploadUrl(ITHit.WebDAV.Client.Encoder.Decode(window.location.href.split("#")[0]));this.Uploader.Queue.AddListener("OnQueueChanged","_QueueChange",this);this.Uploader.Queue.AddListener("OnUploadItemsCreated",this._OnUploadItemsCreated,this);var $container=this.$container=$(sSelector);this.$uploadingBlock=this.$container.find(".uploading-block");this.$uploadingDetails=this.$container.find(".uploading-details");this.$uploadingDetails.draggable();this.rows=[];this.fileLoadCompleted=
function(){if(this.$container.find(".uploading-item").length==0){this.$container.addClass("d-none");this.$container.find(".progress-wrapper .progress-bar").attr("aria-valuenow",0).css("width",0+"%");this.$uploadingBlock.find(".persent").text(0+"%")}window.WebDAVController.Reload()};window.addEventListener("beforeunload",function(event){if($container.find(".uploading-item").length!=0){var warnMessage="Uploader is running!";(event||window.event).returnValue=warnMessage;return warnMessage}});this._DataBindUploaderBlock()}
UploaderGridView.prototype.SetUploadUrl=function(sPath){this.Uploader.SetUploadUrl(sPath)};UploaderGridView.prototype._OnUploadItemsCreated=function(oUploadItemsCreated){var oValidationError=this._ValidateUploadItems(oUploadItemsCreated.Items);if(oValidationError){WebdavCommon.ErrorModal.Show(sValidationError,oValidationError);return}this._GetExistsAsync(oUploadItemsCreated.Items,function(oAsyncResult){if(oAsyncResult.IsSuccess&&oAsyncResult.Result.length===0){oUploadItemsCreated.Upload(oUploadItemsCreated.Items);
return}if(!oAsyncResult.IsSuccess){this._ShowExistsCheckError(oAsyncResult.Error,function(){oUploadItemsCreated.Items.forEach(function(oUploadItem){oUploadItem.SetFailed(oAsyncResult.Error)});oUploadItemsCreated.Upload(oUploadItemsCreated.Items)});return}var sItemsList="";var aExistsUploadItems=[];oAsyncResult.Result.forEach(function(oUploadItem){if(!oUploadItem.IsFolder())oUploadItem.SetDeleteOnCancel(false);oUploadItem.CustomData.FileExistanceVerified=true;sItemsList+=decodeURI(oUploadItem.GetRelativePath())+
"<br/>";aExistsUploadItems.push(oUploadItem)});oConfirmModal.Confirm(WebdavCommon.PasteFormat(sOverwriteDialogueFormat,sItemsList),function onOverwrite(){aExistsUploadItems.forEach(function(oUploadItem){if(oUploadItem.IsFolder())return;oUploadItem.SetOverwrite(true)});oUploadItemsCreated.Upload(oUploadItemsCreated.Items)},function onSkipExists(){var aNotExistsUploadItems=$.grep(oUploadItemsCreated.Items,function(oUploadItem){return!ITHit.Utils.Contains(aExistsUploadItems,oUploadItem)});oUploadItemsCreated.Upload(aNotExistsUploadItems)})}.bind(this))};
UploaderGridView.prototype._ValidateUploadItems=function(aUploadItems){for(var i=0;i<aUploadItems.length;i++){var oUploadItem=aUploadItems[i];var oValidationError=this._ValidateName(oUploadItem);if(oValidationError)return oValidationError}};UploaderGridView.prototype._ValidateSize=function(oUploadItem){if(oUploadItem.GetSize()>iMaxFileSize){var sMessage=WebdavCommon.PasteFormat(sWrongFileSizeFormat,WebdavCommon.Formatters.FileSize(iMaxFileSize));return new ClientError(sMessage,oUploadItem.GetUrl())}};
UploaderGridView.prototype._ValidateExtension=function(oUploadItem){var sExtension=WebdavCommon.Formatters.GetExtension(oUploadItem.GetUrl());if(aForbiddenExtensions.indexOf(sExtension.toUpperCase())>=0){var sMessage=WebdavCommon.PasteFormat(sForbiddenExtensionFormat,sExtension);return new ClientError(sMessage,oUploadItem.GetUrl())}};UploaderGridView.prototype._ValidateName=function(oUploadItem){var sValidationMessage=WebdavCommon.Validators.ValidateName(oUploadItem.GetName());if(sValidationMessage)return new ClientError(sValidationMessage,
oUploadItem.GetUrl())};UploaderGridView.prototype._GetExistsAsync=function(aUploadItems,fCallback){this._OpenItemsCollectionAsync(aUploadItems,function(aResultCollection){var oFailedResult=ITHit.Utils.FindBy(aResultCollection,function(oResult){return!(oResult.AsyncResult.IsSuccess||oResult.AsyncResult.Status.Code===404)},this);if(oFailedResult){fCallback(oFailedResult.AsyncResult);return}var aExistsItems=aResultCollection.filter(function(oResult){return oResult.AsyncResult.IsSuccess}).map(function(oResult){return oResult.UploadItem});
fCallback(new ITHit.WebDAV.Client.AsyncResult(aExistsItems,true,null))})};UploaderGridView.prototype._OpenItemsCollectionAsync=function(aUploadItems,fCallback){var iCounter=aUploadItems.length;var aResults=[];if(iCounter===0){fCallback(aResults);return}aUploadItems.forEach(function(oUploadItem){window.WebDAVController.WebDavSession.OpenItemAsync(ITHit.EncodeURI(oUploadItem.GetUrl()),[],function(oAsyncResult){iCounter--;aResults.push({UploadItem:oUploadItem,AsyncResult:oAsyncResult});if(iCounter===
0)fCallback(aResults)})})};UploaderGridView.prototype._QueueChange=function(oQueueChanged){oQueueChanged.AddedItems.forEach(function(value){var row=new UploaderGridRow(value,this.fileLoadCompleted.bind(this),this._ShowExistsCheckError.bind(this),this._DataBindAllProgress.bind(this),this._StateRowChange.bind(this));this.rows.push(row);this.$container.find(".uploading-items").append(row.$el)}.bind(this));oQueueChanged.RemovedItems.forEach(function(value){var aRows=$.grep(this.rows,function(oElem){return value===
oElem.UploadItem});if(aRows.length===0)return;var rowIndex=this.rows.indexOf(aRows[0]);this.rows.splice(rowIndex,1);aRows[0].$el.remove()}.bind(this));if(this.rows.length==0)this.$container.addClass("d-none");else{this.$container.removeClass("d-none");this.$uploadingBlock.addClass("show");var $uploading=this.$uploadingBlock;setTimeout(function(){$uploading.removeClass("show")},3E3)}this._StateRowChange()};UploaderGridView.prototype._StateRowChange=function(){let countPaused=0;let countCompleted=0;
this.rows.forEach(function(row){let rowState=row.UploadItem.GetState();if(rowState===window.ITHit.WebDAV.Client.Upload.State.Paused)countPaused++;else if(rowState===window.ITHit.WebDAV.Client.Upload.State.Completed||rowState===window.ITHit.WebDAV.Client.Upload.State.Canceled)countCompleted++});if(countPaused==0)this._UpdateActions(false);else if(countPaused==this.rows.length-countCompleted)this._UpdateActions(true)};UploaderGridView.prototype._DataBindAllProgress=function(){var currProgress=0;var count=
0;this.rows.forEach(function(value){if(value.UploadItem.GetState()!==window.ITHit.WebDAV.Client.Upload.State.Canceled){var valueProgress=value.UploadItem.GetProgress().Completed;if(valueProgress<100)currProgress+=valueProgress;else currProgress+=100;count++}});currProgress/=count;if(currProgress>=0){var $progress=this.$container.find(".progress-wrapper .progress-bar");$progress.attr("aria-valuenow",currProgress).css("width",currProgress+"%");this.$uploadingBlock.find(".persent").text(Math.round(currProgress)+
"%")}};UploaderGridView.prototype._DataBindUploaderBlock=function(){this.$container.find(".pause-all-button").click(this._PauseAllClickHandler.bind(this));this.$container.find(".play-all-button").click(this._StartAllClickHandler.bind(this));this.$uploadingBlock.find(".details-button").click(this._DetailsClickHandler.bind(this));this.$uploadingDetails.find(".close-button").click(this._CloseClickHandler.bind(this));this.$container.find(".cancel-all-button").click(this._CancelAllClickHandler.bind(this));
this._UpdateActions(false)};UploaderGridView.prototype._UpdateActions=function(isPaused){var $playButton=this.$container.find(".play-all-button");var $pauseButton=this.$container.find(".pause-all-button");if(isPaused){if($playButton.hasClass("d-none"))$playButton.removeClass("d-none");if(!$pauseButton.hasClass("d-none"))$pauseButton.addClass("d-none")}else{if($pauseButton.hasClass("d-none"))$pauseButton.removeClass("d-none");if(!$playButton.hasClass("d-none"))$playButton.addClass("d-none")}};UploaderGridView.prototype._DetailsClickHandler=
function(){this.$uploadingBlock.addClass("hide");this.$uploadingDetails.removeClass("d-none");this.$uploadingDetails.focus()};UploaderGridView.prototype._CloseClickHandler=function(){this.$uploadingBlock.removeClass("hide");this.$uploadingDetails.addClass("d-none")};UploaderGridView.prototype._DisableActions=function(){this.$container.find(".cancel-all-button").attr("disabled","disabled");this.$container.find(".play-all-button").attr("disabled","disabled");this.$container.find(".pause-all-button").attr("disabled",
"disabled")};UploaderGridView.prototype._EnableActions=function(){this.$container.find(".cancel-all-button").removeAttr("disabled");this.$container.find(".play-all-button").removeAttr("disabled");this.$container.find(".pause-all-button").removeAttr("disabled")};UploaderGridView.prototype._StartAllClickHandler=function(){this._DisableActions();this.rows.forEach(function(value){if(value.UploadItem.GetState()===window.ITHit.WebDAV.Client.Upload.State.Paused)value._StartClickHandler()});this._EnableActions()};
UploaderGridView.prototype._PauseAllClickHandler=function(){this._DisableActions();this.rows.forEach(function(value){value._PauseClickHandler()});this._EnableActions()};UploaderGridView.prototype._CancelAllClickHandler=function(){this._DisableActions();this.rows.forEach(function(value){value._CancelClickHandler()});this._UpdateActions(false);this._EnableActions()};UploaderGridView.prototype._OnDragEnter=function(oEvent){this._dropCounter++;$(oEvent.target).closest("#ithit-dropzone").addClass("dropzone")};
UploaderGridView.prototype._OnDragLeave=function(oEvent){this._dropCounter--;if(this._dropCounter<=0){this._dropCounter=0;oEvent.currentTarget.classList.remove("dropzone")}};UploaderGridView.prototype._OnDrop=function(oEvent){this._dropCounter=0;this._dropZone.HtmlElement.classList.remove("dropzone");this._dropZone.HtmlElement.querySelectorAll("*").forEach(function(value){value.classList.remove("dropzone")})};UploaderGridView.prototype._ShowExistsCheckError=function(oError,fCallback){WebdavCommon.ErrorModal.Show(sFailedCheckExistsMessage,
oError,fCallback)};function UploaderGridRow(oUploadItem,fileLoadCompletedCallback,fileUploadFailedCallback,progressChangedCallback,stateChangedCallback){this.$el=$('<div class="row uploading-item" />');this.UploadItem=oUploadItem;this.UploadItem.AddListener("OnProgressChanged","_OnProgress",this);this.UploadItem.AddListener("OnStateChanged","_OnStateChange",this);this.UploadItem.AddListener("OnBeforeUploadStarted",this._OnBeforeUploadStarted,this);this.UploadItem.AddListener("OnUploadError",this._OnUploadError,
this);this._Render(oUploadItem);this._MaxRetry=10;this._CurrentRetry=0;this._RetryDelay=10;this.fileLoadCompletedCallback=fileLoadCompletedCallback;this.fileUploadFailedCallback=fileUploadFailedCallback;this.progressChangedCallback=progressChangedCallback;this.stateChangedCallback=stateChangedCallback}UploaderGridRow.prototype._Render=function(oUploadItem){var $cancelBlock=$('<div class="col-auto px-0" />').append($('<button class="cancel-button float-left" title="Cancel" />').click(this._CancelClickHandler.bind(this)));
var $itemIcon=$('<div class="col-auto px-0 file-wrapper" />').append($('<div class="file-icon" />'));var $itemData=$('<div class="col" />').append($('<div class="row align-items-center" />').html('<div class="col item-name ellipsis"></div>'+'<div class="col-auto item-size"></div>'+'<div class="col-auto retry-message d-none"></div>')).append($('<div class="row" />').html('<div class="col">'+'<div class="progress">'+'<div class= "progress-bar" rol="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>'+
"</div>"+"</div>")).append($('<div class="row justify-content-between mt-1" />').html('<div class="col-auto item-progress"></div>'+'<div class="col-auto item-speed"></div>'));var $actions=$('<div class="col-auto px-0" />').append($('<button class="pause-button float-right" title="Pause upload" />').click(this._PauseClickHandler.bind(this))).append($('<button class="play-button float-right" title="Resume upload" />').click(this._StartClickHandler.bind(this)));this.$el.empty();this.$el.append($cancelBlock).append($itemIcon).append($itemData).append($actions);
this._DataBind(oUploadItem)};UploaderGridRow.prototype._DataBindActions=function(oUploadItem){if(oUploadItem.GetState()===window.ITHit.WebDAV.Client.Upload.State.Paused){this.$el.find(".play-button").show();this.$el.find(".pause-button").hide()}else{this.$el.find(".play-button").hide();this.$el.find(".pause-button").show()}};UploaderGridRow.prototype._DataBind=function(oUploadItem){var $container=this.$el;var sFileExtansion=WebdavCommon.Formatters.GetFileExtension(oUploadItem.GetName());var $itemIcon=
$container.find(".file-icon");var oProgress=oUploadItem.GetProgress();if(sFileExtansion.length<5){$itemIcon.addClass("file-"+sFileExtansion);$itemIcon.html('<span class="file-extension">'+sFileExtansion.toUpperCase()+"</span>")}$container.find(".item-name").html('<span title="'+decodeURI(oUploadItem.GetName())+'">'+decodeURI(oUploadItem.GetName())+"</span>");$container.find(".item-size").text(WebdavCommon.Formatters.FileSize(oProgress.TotalBytes));$container.find(".item-speed").text(oProgress.Completed+
" % done");$container.find(".item-progress").text(WebdavCommon.Formatters.FileSize(oProgress.Speed)+"/sec");this._DataBindActions(oUploadItem);var sCurrentState=oUploadItem.GetState();if(sCurrentState===window.ITHit.WebDAV.Client.Upload.State.Completed||sCurrentState===window.ITHit.WebDAV.Client.Upload.State.Canceled){this.$el.remove();this.fileLoadCompletedCallback();this.stateChangedCallback()}};UploaderGridRow.prototype._DataBindProgressRow=function(oUploadItem){var oProgress=oUploadItem.GetProgress();
this.$el.find(".progress-bar").attr("aria-valuenow",oProgress.Completed).css("width",oProgress.Completed+"%");this.progressChangedCallback()};UploaderGridRow.prototype._OnStateChange=function(oStateChanged){this._EnableActions();this._RemoveRetryMessage();this._DataBindProgressRow(oStateChanged.Sender);this._DataBind(oStateChanged.Sender)};UploaderGridRow.prototype._OnProgress=function(oProgressEvent){this._DataBindProgressRow(oProgressEvent.Sender);this._DataBind(oProgressEvent.Sender)};UploaderGridRow.prototype._StartClickHandler=
function(){this._DisableActions();this._CurrentRetry=0;var self=this;this.UploadItem.StartAsync(function(){self.stateChangedCallback();self._EnableActions.bind(self)})};UploaderGridRow.prototype._PauseClickHandler=function(){this._DisableActions();this._CancelRetry();var self=this;this.UploadItem.PauseAsync(function(){self.stateChangedCallback();self._EnableActions.bind(self)})};UploaderGridRow.prototype._CancelClickHandler=function(){this._CancelRetry();this._DisableActions();this.UploadItem.CancelAsync(null,
null,this._EnableActions.bind(this))};UploaderGridRow.prototype._DisableActions=function(){this.$el.find(".cancel-button").attr("disabled","disabled");this.$el.find(".play-button").attr("disabled","disabled");this.$el.find(".pause-button").attr("disabled","disabled")};UploaderGridRow.prototype._EnableActions=function(){this.$el.find(".cancel-button").removeAttr("disabled");this.$el.find(".play-button").removeAttr("disabled");this.$el.find(".pause-button").removeAttr("disabled")};UploaderGridRow.prototype._OnBeforeUploadStarted=
function(oBeforeUploadStarted){var oItem=oBeforeUploadStarted.Sender;if(oItem.GetOverwrite()||oItem.IsFolder()||oItem.CustomData.FileExistanceVerified){oBeforeUploadStarted.Upload();return}var sHref=ITHit.EncodeURI(oItem.GetUrl());window.WebDAVController.WebDavSession.OpenItemAsync(sHref,[],function(oAsyncResult){if(!oAsyncResult.IsSuccess&&oAsyncResult.Status.Code===404){oBeforeUploadStarted.Upload();return}if(!oAsyncResult.IsSuccess){this.fileUploadFailedCallback(oAsyncResult.Error,function(){oBeforeUploadStarted.Sender.SetFailed(oAsyncResult.Error)});
return}var sMessage=WebdavCommon.PasteFormat(sOverwriteDialogueFormat,oItem.GetRelativePath());oConfirmModal.Confirm(sMessage,function onOverwrite(){oBeforeUploadStarted.Sender.SetDeleteOnCancel(false);oBeforeUploadStarted.Sender.SetOverwrite(true);oBeforeUploadStarted.Upload()})}.bind(this))};UploaderGridRow.prototype._SetRetryMessage=function(timeLeft){var sMessage=WebdavCommon.PasteFormat(sRetryMessageFormat,WebdavCommon.Formatters.TimeSpan(Math.ceil(timeLeft/1E3)));this.$el.find(".retry-message").html(sMessage).addClass("text-danger d-block");
this.$el.find(".progress-bar").addClass("bg-danger")};UploaderGridRow.prototype._RemoveRetryMessage=function(){this.$el.find(".retry-message").html("");this.$el.find(".progress-bar").removeClass("bg-danger d-none");this._DataBind(this.UploadItem)};UploaderGridRow.prototype._CancelRetry=function(){if(this.CancelRetryCallback)this.CancelRetryCallback.call(this)};UploaderGridRow.prototype._OnUploadError=function(oUploadError){if(this._MaxRetry<=this._CurrentRetry){oUploadError.Skip();return}var retryTime=
(new Date).getTime()+this._RetryDelay*1E3;var retryTimerId=setInterval(function(){var timeLeft=retryTime-(new Date).getTime();if(timeLeft>0){this._SetRetryMessage(timeLeft);return}clearInterval(retryTimerId);this._CurrentRetry++;this._RemoveRetryMessage();oUploadError.Retry()}.bind(this),1E3);this.CancelRetryCallback=function(){clearInterval(retryTimerId);this._RemoveRetryMessage()}};var oConfirmModal=new ConfirmRewriteModal("#ConfirmRewriteModal");window.WebDAVUploaderGridView=new UploaderGridView(".ithit-grid-uploads")})(WebdavCommon);
var _wvpn_=webDavSettings.ApplicationAccessKey!==""?"/__wvpn__":"";let wsUrl=`${location.protocol.replace("http","ws")}${location.host}${_wvpn_}${webDavSettings.ApplicationPath}/dav`;let socketSource=new WebSocket(wsUrl);
socketSource.addEventListener("message",function(e){var notifyObject=JSON.parse(e.data);var currentLocation=location.pathname.replace(/^\/|\/$/g,"");currentLocation=currentLocation.toUpperCase().replace(webDavSettings.ApplicationPath.replace(/^\/|\/$/g,"").toUpperCase(),"").replace(/^\/|\/$/g,"");if(notifyObject.EventType==="refresh"){if(currentLocation.toUpperCase()===notifyObject.FolderPath.toUpperCase())WebDAVController.Reload()}else if(notifyObject.EventType==="delete")if(notifyObject.FolderPath.substring(0,
notifyObject.FolderPath.lastIndexOf("/")).toUpperCase()===currentLocation.toUpperCase())WebDAVController.Reload();else if(currentLocation.toUpperCase().indexOf(notifyObject.FolderPath.toUpperCase())===0){var originPath=location.origin+"/";history.pushState({Url:originPath},"",originPath);WebDAVController.NavigateFolder(originPath)}},false);
