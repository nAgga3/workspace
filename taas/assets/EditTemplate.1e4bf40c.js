var I=Object.defineProperty,T=Object.defineProperties;var M=Object.getOwnPropertyDescriptors;var k=Object.getOwnPropertySymbols;var N=Object.prototype.hasOwnProperty,U=Object.prototype.propertyIsEnumerable;var x=(e,t,i)=>t in e?I(e,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):e[t]=i,C=(e,t)=>{for(var i in t||(t={}))N.call(t,i)&&x(e,i,t[i]);if(k)for(var i of k(t))U.call(t,i)&&x(e,i,t[i]);return e},V=(e,t)=>T(e,M(t));/* empty css                          */import{_ as q,s as D,x as R,C as h,r as v,i as F,o as n,c as r,a as s,t as o,k as S,e as A,w as g,h as m,f as c,F as j,b as W}from"../main.js";import{C as z,e as f,u as L,r as u,p as G}from"./validators.31c1fb33.js";import{C as H}from"./CodeField.5fc4a798.js";import"./DialogMixin.c05a30f4.js";const y="templates",J={name:"EditTemplate",mixins:[z],components:{CodeField:H},setup(){return{editorModes:f,pageBase:y,v$:L()}},data:()=>({name:"",description:"",provider:"",id:null,template:"",parameters:"",credentialsId:null,submitted:!1,saving:!1,_readOnly:!1}),validations(){return{name:{required:u,providerIdRegExpValidatorWMessage:G},description:{required:u},template:{required:u},parameters:{required:u},credential:{required:u}}},computed:V(C({},D(R,["credentials"])),{credential:{get(){return this.credentials.find(e=>e.id===this.credentialsId)},set(e){var t;this.credentialsId=(t=e==null?void 0:e.id)!=null?t:null}}}),watch:{},methods:{async load({id:e}){var i,a,p;let t=(a=(i=await h.get(e))==null?void 0:i.items)!=null?a:{};Object.assign(this.$data,{id:t.id,name:t.name,description:t.desc,credentialsId:t.credentialsId,template:t.template,parameters:t.parameters,_readOnly:(p=t.inUse)!=null?p:!1})},async save(){var t,i,a,p;let e=!1;try{if(this.submitted=!0,!await this.v$.$validate())return e;this.saving=!0;const d={name:this.name,desc:this.description,provider:this.provider,template:this.template,parameters:this.parameters,credentialsId:this.credentialsId,id:this.id};this._mode===f.CREATE?await h.create(d):await h.update(d),this.toasts&&this.$toast.add({group:"br",severity:"success",summary:this.$t(`${y}.toasts.events.${this._mode===f.CREATE?"created":"updated"}.summary`),detail:this.$t(`${y}.toasts.events.${this._mode===f.CREATE?"created":"updated"}.detail`,{name:this.name}),life:3e3}),e=!0,this.$emit("saved"),this.back()}catch(d){this.$toast.add({group:"br",severity:"error",summary:this.$t("common.toasts.events.error.summary"),detail:this.$t("common.toasts.events.error.detail",{error:(p=(a=(i=(t=d==null?void 0:d.response)==null?void 0:t.data)==null?void 0:i.error)==null?void 0:a.message)!=null?p:d}),life:3e3}),this.$emit("error")}finally{this.saving=!1}return e}}},K={class:"grid grid-nogutter flex flex-column flex-1 overflow-hidden custom-scrollbars h-full edit-template side-panel"},Q={class:"grid grid-nogutter flex-1 overflow-hidden flex-column flex-nowrap"},X={class:"overflow-hidden flex-1 flex-column"},Y={class:"overflow-hidden flex-1 h-full"},Z={class:"overflow-auto h-full flex-1 px-4"},P={class:"flex flex-column flex-1 flex-nowrap h-full"},ee={class:"col flex-1 mt-2 overflow-auto"},se={class:"grid grid-nogutter flex-column"},te={class:"col mb-2"},ae={class:"grid grid-nogutter my-2 align-items-center"},ie={class:"col col flex justify-content-start align-items-center"},le={class:"text-xl m-0"},oe={class:"col"},de={class:"formgrid grid"},ne={class:"field col"},re={for:"name"},ce={key:0,class:"p-error"},me={class:"formgrid grid"},pe={class:"field col"},ve={for:"description"},ue={key:0,class:"p-error"},fe={class:"formgrid grid"},_e={class:"field col"},he={for:"credential"},ge={key:0,class:"p-dropdown-option flex"},ye={class:"flex-1"},$e={key:1},be={class:"p-dropdown-option flex"},we={class:"flex-1"},ke={key:0,class:"p-error"},xe={class:"text-xl"},Ce={class:"formgrid grid"},Ve={class:"field col"},Oe={class:"flex"},Be={class:"flex-1 flex align-items-center"},Ee={for:"template"},Ie={class:"flex-1"},Te={key:0,class:"p-error"},Me={class:"formgrid grid"},Ne={class:"field col"},Ue={class:"flex"},qe={class:"flex-1 flex align-items-center"},De={for:"parameters"},Re={class:"flex-1"},Fe={key:0,class:"p-error"},Se={class:"footer-buttons flex w-full py-5 justify-content-end"},Ae={class:"grid grid-nogutter mx-2"},je={key:0,class:"flex flex-1 mx-2"},We={class:"flex flex-1 mx-2"},ze={class:"flex flex-1 mx-2"};function Le(e,t,i,a,p,d){const O=v("InlineMessage"),$=v("InputText"),b=v("Tag"),B=v("Dropdown"),w=v("code-field"),_=v("Button"),E=F("tooltip");return n(),r("div",K,[s("div",Q,[s("div",X,[s("div",Y,[s("div",Z,[s("div",P,[s("div",ee,[s("div",se,[s("div",te,[s("div",ae,[s("div",ie,[s("p",le,o(e.$t(`${a.pageBase}.${this._mode==a.editorModes.CREATE?"add":"edit"}_title`)),1)]),e._readOnly?S((n(),A(O,{key:0,class:"cursor-pointer",severity:"warn"},{default:g(()=>[W(o(e.$t("common.entityInUse",{type:"model"})),1)]),_:1})),[[E,e.$t("common.entityInUseDetails"),void 0,{bottom:!0}]]):m("",!0)])]),s("div",oe,[s("div",de,[s("div",ne,[s("label",re,o(e.$t(`${a.pageBase}.name`)),1),c($,{autofocus:"autofocus",id:"name",class:"w-full mb-2",modelValue:e.name,"onUpdate:modelValue":t[0]||(t[0]=l=>e.name=l),readOnly:e._readOnly},null,8,["modelValue","readOnly"]),a.v$.name.$invalid&&e.submitted||a.v$.name.$pending.$response?(n(),r("small",ce,o(a.v$.name.required.$invalid?a.v$.name.required.$message.replace("Value","Name"):"")+" "+o(a.v$.name.providerIdRegExpValidatorWMessage.$invalid?a.v$.name.providerIdRegExpValidatorWMessage.$message:""),1)):m("",!0)])]),s("div",me,[s("div",pe,[s("label",ve,o(e.$t(`${a.pageBase}.description`)),1),c($,{id:"description",class:"w-full mb-2",modelValue:e.description,"onUpdate:modelValue":t[1]||(t[1]=l=>e.description=l),readOnly:e._readOnly},null,8,["modelValue","readOnly"]),a.v$.description.$invalid&&e.submitted||a.v$.description.$pending.$response?(n(),r("small",ue,o(a.v$.description.required.$message.replace("Value","Description")),1)):m("",!0)])]),s("div",fe,[s("div",_e,[s("label",he,o(e.$t(`${a.pageBase}.credential`)),1),c(B,{id:"credential",class:"w-full mb-2",optionLabel:"Name",placeholder:"Select credential",options:e.credentials,modelValue:d.credential,"onUpdate:modelValue":t[2]||(t[2]=l=>d.credential=l),disabled:e._readOnly},{value:g(l=>[l.value?(n(),r("div",ge,[s("div",ye,[s("span",null,o(l.value.name),1)]),c(b,{class:"ml-2",value:l.value.provider},null,8,["value"])])):(n(),r("span",$e,o(l.placeholder),1))]),option:g(l=>[s("div",be,[s("div",we,[s("span",null,o(l.option.name),1)]),c(b,{class:"ml-2",value:l.option.provider},null,8,["value"])])]),_:1},8,["options","modelValue","disabled"]),a.v$.credential.$invalid&&e.submitted||a.v$.credential.$pending.$response?(n(),r("small",ke,o(a.v$.credential.required.$message.replace("Value","Credential")),1)):m("",!0)])]),s("p",xe,o(e.$t(`${a.pageBase}.template_files`)),1),s("div",Ce,[s("div",Ve,[s("div",Oe,[s("div",Be,[s("label",Ee,o(e.$t(`${a.pageBase}.template`)),1)]),s("div",Ie,[c(w,{entityName:e.$t(`${a.pageBase}.template`),readOnly:e._readOnly,code:e.template,"onUpdate:code":t[3]||(t[3]=l=>e.template=l)},null,8,["entityName","readOnly","code"])])]),a.v$.template.$invalid&&e.submitted||a.v$.template.$pending.$response?(n(),r("small",Te,o(a.v$.template.required.$message.replace("Value","Template")),1)):m("",!0)])]),s("div",Me,[s("div",Ne,[s("div",Ue,[s("div",qe,[s("label",De,o(e.$t(`${a.pageBase}.parameters`)),1)]),s("div",Re,[c(w,{entityName:e.$t(`${a.pageBase}.parameters`),readOnly:e._readOnly,code:e.parameters,"onUpdate:code":t[4]||(t[4]=l=>e.parameters=l)},null,8,["entityName","readOnly","code"])])]),a.v$.parameters.$invalid&&e.submitted||a.v$.parameters.$pending.$response?(n(),r("small",Fe,o(a.v$.parameters.required.$message.replace("Value","Parameters")),1)):m("",!0)])])])])]),s("div",Se,[s("div",Ae,[e._readOnly?(n(),r("div",je,[c(_,{label:e.$t("common.back"),icon:"thin-back",class:"p-button-secondary w-full",onClick:e.cancel},null,8,["label","onClick"])])):m("",!0),e._readOnly?m("",!0):(n(),r(j,{key:1},[s("div",We,[c(_,{label:e.$t("common.cancel"),icon:"pi pi-times",class:"p-button-secondary",disabled:e.saving,onClick:e.cancel},null,8,["label","disabled","onClick"])]),s("div",ze,[c(_,{label:e.$t("common.save"),icon:"pi pi-check",class:"p-button-success",loading:e.saving,onClick:d.save},null,8,["label","loading","onClick"])])],64))])])])])])])])])}var Ye=q(J,[["render",Le]]);export{Ye as default};
