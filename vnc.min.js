/* Thinfinity(c) Remote Desktop Server v7.0.3.114 */
/*
 zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License  @overview es6-promise - a tiny implementation of Promises/A+.
 @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 @license   Licensed under MIT license
            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 @version   v4.2.8+1e68dce6
 jQuery v3.7.1 | (c) OpenJS Foundation and other contributors | jquery.org/license  jQuery UI - v1.13.3 - 2024-04-26
 https://jqueryui.com
 Includes: widget.js, position.js, data.js, disable-selection.js, effect.js, effects/effect-blind.js, effects/effect-bounce.js, effects/effect-clip.js, effects/effect-drop.js, effects/effect-explode.js, effects/effect-fade.js, effects/effect-fold.js, effects/effect-highlight.js, effects/effect-puff.js, effects/effect-pulsate.js, effects/effect-scale.js, effects/effect-shake.js, effects/effect-size.js, effects/effect-slide.js, effects/effect-transfer.js, focusable.js, form-reset-mixin.js, jquery-patch.js, keycode.js, labels.js, scroll-parent.js, tabbable.js, unique-id.js, widgets/accordion.js, widgets/autocomplete.js, widgets/button.js, widgets/checkboxradio.js, widgets/controlgroup.js, widgets/datepicker.js, widgets/dialog.js, widgets/draggable.js, widgets/droppable.js, widgets/menu.js, widgets/mouse.js, widgets/progressbar.js, widgets/resizable.js, widgets/selectable.js, widgets/selectmenu.js, widgets/slider.js, widgets/sortable.js, widgets/spinner.js, widgets/tabs.js, widgets/tooltip.js
 Copyright OpenJS Foundation and other contributors; Licensed MIT  jQuery blockUI plugin
 Version 2.70.0-2014.11.23
 Requires jQuery v1.7 or later

 Examples at: http://malsup.com/jquery/block/
 Copyright (c) 2007-2013 M. Alsup
 Dual licensed under the MIT and GPL licenses:
 http://www.opensource.org/licenses/mit-license.php
 http://www.gnu.org/licenses/gpl.html

 Thanks to Amir-Hossein Sobhi for some excellent contributions!
 jQuery AjaxQ - AJAX request queueing for jQuery

 Version: 0.0.1
 Date: July 22, 2008

 Copyright (c) 2008 Oleg Podolsky (oleg.podolsky@gmail.com)
 Licensed under the MIT (MIT-LICENSE.txt) license.

 http://plugins.jquery.com/project/ajaxq
 http://code.google.com/p/jquery-ajaxq/
 Original code (c) 2010 Nick Galbreath
 http://code.google.com/p/stringencoders/source/browse/#svn/trunk/javascript

 jQuery port (c) 2010 Carlo Zottmann
 http://github.com/carlo/jquery-base64

 Permission is hereby granted, free of charge, to any person
 obtaining a copy of this software and associated documentation
 files (the "Software"), to deal in the Software without
 restriction, including without limitation the rights to use,
 copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the
 Software is furnished to do so, subject to the following
 conditions:

 The above copyright notice and this permission notice shall be
 included in all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND,
 EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES
 OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND
 NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT
 HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,
 WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
 FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR
 OTHER DEALINGS IN THE SOFTWARE.
 Hammer.JS - v2.0.8 - 2016-04-23
 http://hammerjs.github.io/

 Copyright (c) 2016 Jorik Tangelder;
 Licensed under the MIT license  @source http://purl.eligrey.com/github/canvas-toBlob.js/blob/master/canvas-toBlob.js */
(function(){function StatusAPI(){var _ref=this;var _wnd=null;var _propKey="__#statusapi__";var _variables={};var _variablesDef={};function initialize(){_wnd=getTopWindow(window);var instance=_wnd[_propKey];if(instance)_ref=instance;else createInstance()}function getTopWindow(wnd){if(wnd.parent&&wnd.parent!=wnd)try{var hasError=true;if(wnd.parent.location.href){hasError=false;return getTopWindow(wnd.parent)}}catch(error){hasError=true}finally{if(hasError)return wnd}else return wnd}function createInstance(){attachHandlers();
defineProperties();_wnd[_propKey]=_ref}function attachHandlers(){window.addEventListener("addStatusAPIVariables",function(e){if(e&&e.detail)add(e.detail)})}function add(variables){if(variables){if(!variables.forEach)variables=[variables];var newOnes=false;variables.forEach(function(variable){if(_variables[variable.name]===undefined){newOnes=true;_variablesDef[variable.name]=variable;_variablesDef[variable.name].__attached={};Object.defineProperty(_variables,variable.name,{"enumerable":true,"configurable":false,
"get":variable.get})}else helper.console.log(helper.string.format("This variable is already registered [{0}]",variable.name),arguments)});if(newOnes)window.dispatchEvent(new CustomEvent("newStatusAPIVariables",null))}}function getValue(name){if(_variablesDef[name])return _variablesDef[name].get();else return undefined}function dump(name){var variablesToAdd=[];for(var kvp in _variablesDef){var variable=_variablesDef[kvp];if(name===undefined||!variable.__attached[name]){variablesToAdd.push(variable);
if(name!==undefined)variable.__attached[name]=true}}return variablesToAdd}function defineProperties(){Object.defineProperty(_ref,"add",{"enumerable":true,"configurable":false,"writable":false,"value":add});Object.defineProperty(_ref,"get",{"enumerable":true,"configurable":false,"writable":false,"value":getValue});Object.defineProperty(_ref,"dump",{"enumerable":true,"configurable":false,"writable":false,"value":dump});Object.defineProperty(_ref,"variables",{"enumerable":true,"configurable":false,"get":function(){return _variables}})}
initialize();return _ref}try{Thinfinity!=undefined}catch(e){Thinfinity={}}Thinfinity.StatusAPI=new StatusAPI})();
(function(){var _binding=[{"base":"common","propName":"defaultSettings","scraper":false,"search":"customSettings"},{"base":"settings","propName":"customSettings","scraper":true},{"base":"editorSettings","propName":"customProfileDefaults","scraper":true}];var _warn=console.warn||console.log;function initialize(){if(window.cookiePrefix)_binding.forEach(function(item){if(window.userSettings&&(userSettings[window.cookiePrefix]&&userSettings[window.cookiePrefix][item.propName]||userSettings[item.base]&&
userSettings[item.base][item.search])){_warn("Loading settings ["+item.base+"] from deprecated customSettings instead of web.settings.");var _get=userSettings[window.cookiePrefix]&&userSettings[window.cookiePrefix][item.propName]?userSettings[window.cookiePrefix][item.propName]:userSettings[item.base][item.search];if(!window[item.propName])Object.defineProperty(window,item.propName,{"enumerable":true,"configurable":false,"get":function(){return _get}});else _warn("Cannot create web settings, ["+_definePropertyName+
"] property is already defined")}else if(window[item.base])if(item.scraper)if(window[item.base][window.cookiePrefix])if(!window[item.propName])Object.defineProperty(window,item.propName,{"enumerable":true,"configurable":false,"get":function(){return window[item.base][window.cookiePrefix]}});else _warn("Cannot create web settings, ["+_definePropertyName+"] property is already defined");else _warn(JSON.stringify(window[item.base])+" definitions is empty for this scraper ["+window.cookiePrefix+"], please complete the requested info.");
else{if(!window[item.propName])Object.defineProperty(window,item.propName,{"enumerable":true,"configurable":false,"get":function(){return window[item.base]}})}else _warn(item.base+" is not defined, please check web.settings file in DB folder")});else _warn("cookiePrefix is not defined");window.addEventListener("load",function(){if(typeof customSettings!="undefined")Object.defineProperty(customSettings,"defaultValues",{"enumerable":true,"configurable":false,"get":function(){return{"mobile":{"gestures":Thinfinity&&
Thinfinity.Mobile?Thinfinity.Mobile.defaultTouchGestures:[]}}}})})}initialize()})();
(function(){function BrowserTracking(){var _ref=this;var _gatewayId="";var _windowId="";var _elapsedTimes={};var _countType={"none":0,"start":1,"end":2};var _events={};var _elapsed=0;function initialize(){_windowId=getGUID();_gatewayId=Thinfinity.global.variables.gwsid}function getGUID(){function uuidv4(){return"WNDID-xxxxxxxx-xxxx-ZMQ-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=="x"?r:r&3|8;return v.toString(16)})}return uuidv4().toUpperCase()}function _log(action,
name,data,statusCode,cType){if(_gatewayId==="")_gatewayId=Thinfinity.global.variables.gwsid;if(cType===_countType.start)_elapsedTimes[action]=(new Date).getTime();else if(cType===_countType.end){_elapsed=_elapsedTimes[action]?(new Date).getTime()-_elapsedTimes[action]:-999;delete _elapsedTimes[action]}var strAction=action+(name!=""?"."+name:"");try{if(cType!==_countType.end)window.external.LogEvent(_gatewayId,_windowId,strAction,data,statusCode);else window.external.LogElapsed(_gatewayId,_windowId,
strAction,data,_elapsed)}catch(error){if(cType!==_countType.end)console.log("GatewayId: "+_gatewayId+", event: "+strAction+" ,data: "+data+" ,status: "+statusCode);else console.log("GatewayId: "+_gatewayId+", event: "+strAction+" ,data: "+data+" ,status: "+statusCode+" ,elapsed: "+_elapsed+"ms")}}function closeBrowserFn(){try{}catch(error){window.console.log("Close Browser")}finally{_log("Page.Window","Close","thinfinity.browsertracking.js","",eCountType.none);window.close()}}function requireUnloadFn(){triggerEvent(["disconnect"]);
setTimeout(function(){closeBrowserFn()},1E3)}function addEvent(name,handler){if(name==undefined||name==null||name=="")return"Name is undefined or null.";if(handler==undefined||handler==null||handler=="")return"Handler is undefined or null.";name=name.toLowerCase();var item={"name":name,"handler":handler};var isContained=false;if(_events[name]==undefined)_events[name]=[];else for(var i=0;i<_events[name].length;i++)if(_events[name][i].handler==item.handler){isContained=true;break}if(!isContained)_events[name].push(item);
return true}function removeEvent(name,event){var ret=false;if(name==undefined||name==null||name=="")return"Name is undefined or null.";if(handler==undefined||handler==null||handler=="")return"Handler is undefined or null.";name=name.toLowerCase();var item={"name":name,"handler":handler};if(_events[name]==undefined)return"Cannot find event. Event is not in the command list.";else for(var i=0;i<_events[name].length;i++)if(_events[name][i].handler.toString()==item.handler.toString()){_events[name].splice(i,
1);ret=true}return ret}function triggerEvent(eventNames){var atLeastOne=false;if(eventNames){if(typeof eventNames=="string")eventNames=[eventNames];for(var k=0;k<eventNames.length;k++)if(_events[eventNames[k].toLowerCase()]!=undefined)for(var i=0;i<_events[eventNames[k].toLowerCase()].length;i++)try{_events[eventNames[k].toLowerCase()][i].handler()}catch(error){}}}function findActiveElapseTimes(){var l=[];for(var k in _elapsedTimes)l.push(k);return l}function terminateFn(action,msg,code){setTimeout(function(){_log("Page.Terminate",
action,msg,code,_countType.none);setTimeout(function(){closeBrowserFn()},1E3)},500)}initialize();Object.defineProperty(_ref,"countType",{"configurable":false,"enumerable":true,"get":function(){return _countType}});Object.defineProperty(_ref,"gatewayId",{"configurable":false,"enumerable":true,"get":function(){return _gatewayId},"set":function(gatewayId){return _gatewayId=gatewayId}});Object.defineProperty(_ref,"windowId",{"configurable":false,"enumerable":true,"get":function(){return _windowId}});
Object.defineProperty(_ref,"log",{"configurable":false,"enumerable":true,"writable":false,"value":_log});Object.defineProperty(_ref,"closeBrowser",{"configurable":false,"enumerable":true,"writable":false,"value":closeBrowserFn});Object.defineProperty(_ref,"requireUnload",{"configurable":false,"enumerable":true,"writable":false,"value":requireUnloadFn});Object.defineProperty(_ref,"on",{"configurable":false,"enumerable":true,"writable":false,"value":addEvent});Object.defineProperty(_ref,"off",{"configurable":false,
"enumerable":true,"writable":false,"value":removeEvent});Object.defineProperty(_ref,"terminate",{"configurable":false,"enumerable":true,"writable":false,"value":terminateFn})}try{Thinfinity!=undefined}catch(e){Thinfinity={}}Thinfinity.BrowserTracking=BrowserTracking;try{var r=window.external.eventTrackingAvailable;if(r){window.browserTracking=new Thinfinity.BrowserTracking;window.eCountType=browserTracking.countType;browserTracking.log("Page.Load","Start",location.href,"",eCountType.start);window.onload=
function(){browserTracking.log("Page.Load","End",location.href,"",eCountType.end)}}}catch(error){}})();
(function(){function EmbedScript(args){var _ref=this;function initialize(args){}function findInitialBracket(s){var p={"idx":null,"row":null};var idx=-1;var row=0;if(s){var found=false;while(!found&&row<s.length){idx=s[row].indexOf("{");if(idx!=-1){p.row=row;p.idx=idx+1;found=true}row++}}return p}function findFinalBracket(s){var p={"idx":null,"row":null};var idx=-1;var row=0;if(s){row=s.length-1;var found=false;while(!found&&row>=0){idx=s[row].lastIndexOf("}");if(idx!=-1){p.row=row;p.idx=Math.max(0,
idx-1);found=true}row++}}return p}function convertToString(fn){var s=fn.toString().split("\n");var ib=findInitialBracket(s);var fb=findFinalBracket(s);var row=ib.row+1;var str=s[ib.row].substr(ib.idx);while(row<s.length&&row<fb.row){str+=s[row];row++}str+=s[fb.row].substr(0,fb.idx);return str.replace(/^\s+/,"").replace(/\s+$/,"")}function findLocation(s,loc,ib){var r={"row":null,"idx":null};var row=ib.row,idx=ib.idx;if(loc.row!=undefined){r.row=loc.row+ib.row;if(loc.idx==undefined)r.idx=0;if(loc.row==
ib.row)r.idx+=ib.idx}else if(loc.text){loc.text=loc.text.replace(/^\s+/,"").replace(/\s+$/,"");var found=false;while(!found&&row<s.length){if(row==ib.row&&s[row].substr(idx).indexOf(loc.text)!=-1){found=true;r.row=row;r.idx=s[row].indexOf(loc.text)}else if(s[row].indexOf(loc.text)!=-1){found=true;r.row=row;r.idx=s[row].indexOf(loc.text)}row++}}else if(loc.position==="beforeEnd"){var fb=findFinalBracket(s);r.idx=fb.idx;if(fb.idx==0&&fb.row>0){r.idx=s[fb.row-1].length;r.row=fb.row-1}}if(loc.position)if(loc.position===
"after"&&r.row<s.length){r.row++;r.idx=0}else if(loc.position==="before"&&r.row>0){r.row--;r.idx=s[r.row].length}return r}function getFunctionName(args){try{var fName="";if(args!=null&&args!=undefined&&args.callee!=undefined){var calleeName=args.callee&&args.callee.name?args.callee.name:"[anonymous]";var callerName=args.callee&&args.callee.caller&&args.callee.caller.name?args.callee.caller.name:"[anonymous]";fName=calleeName+" from "+callerName}return fName}catch(error){genericLog(error,arguments);
return"[unknown]"}}function isAnonymous(s){}function uuidv4(){return"TMPFN_xxxxxxxx".replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=="x"?r:r&3|8;return v.toString(16)})+"_"+(new Date).getTime()}function getTempName(){return uuidv4().toUpperCase()}function addFnName(name,s,alias){if(name!=""&&s)if(s instanceof Array)s.splice(0,0,(alias&&alias!=""?alias+".":"var ")+name+" = ");else return(alias&&alias!=""?alias+".":"var ")+name+" = "+s}function embedScript(code,sourceFn,loc,scope,alias){var sFn=
null;var name=null;var isAnonymous=false;if(sourceFn===""&&scope.eval){scope.eval(code);return}else if(typeof sourceFn=="string"&&scope){sFn=sourceFn.indexOf(".")==-1?scope[sourceFn]:eval("scope."+sourceFn);name=getFunctionName(sFn);isAnonymous=name=="";name=sourceFn;sFn=sFn.toString()}else if(sourceFn instanceof Function){name=getFunctionName(sFn);isAnonymous=name=="";sFn=sourceFn.toString()}else if(code)eval(code);if(sFn&&code){if(code instanceof Function)code=convertToString(code);if(loc.btp&&
loc.btp!=""&&sFn.indexOf(loc.btp)!=-1){var s=sFn.indexOf(loc.btp);var tFn=sFn.substr(s);var ep=tFn.indexOf(";")+1;var output=sFn.substr(0,s)+code+sFn.substr(s+ep);if(isAnonymous&&scope.eval){output=addFnName(name,output,alias);scope.eval(output)}else window.eval(output)}else{sFn=sFn.split("\n");var added=false;var i=0;var ib=findInitialBracket(sFn);if(ib&&ib.row!=undefined){ib=findLocation(sFn,loc,ib);if(ib){sFn[ib.row]=[sFn[ib.row].slice(0,ib.idx),code,sFn[ib.row].slice(ib.idx)].join("\n");var tempName=
null;if(isAnonymous)tempName=addFnName(name,sFn,alias);var output=sFn.join("\n");if(isAnonymous&&scope.eval)scope.eval(output);else window.eval(output)}else console.log("Cannot insert code")}}}else return"sourceFn is not a valid Function"}function embedScripts(eScripts,scope){if(eScripts&&scope)for(var i=0;i<eScripts.length;i++)embedScript(eScripts[i].code,eScripts[i].sourceFn,eScripts[i].position,scope,eScripts[i].alias)}initialize(args);Object.defineProperty(_ref,"embed",{"enumerable":true,"configurable":false,
"writable":false,"value":embedScript});Object.defineProperty(_ref,"add",{"enumerable":true,"configurable":false,"writable":false,"value":embedScripts});return this}try{Thinfinity!=undefined}catch(e){Thinfinity={}}Thinfinity.EmbedScript=EmbedScript;try{var r=window.external.eventTrackingAvailable;if(r)window.eScript=new Thinfinity.EmbedScript}catch(error){}})();
if(window.browserTracking){var logs={"thinvnc.sdk":[{"sourceFn":"connect","code":"browserTracking.log('Page.Connect.GetServerURL', 'Start', '', '', eCountType.start);","position":{"btp":"BTP_PCG_STR","text":"if (_fromBroker) {","position":"after"},"alias":"TVNC"},{"sourceFn":"connect","code":"browserTracking.log('Page.Connect.GetServerURL', 'End', _location, '', eCountType.end);","position":{"btp":"BTP_PCG_END","text":"_location = TVNC.getAjaxUrl();","position":"after"},"alias":"TVNC"},{"sourceFn":"connect",
"code":"browserTracking.log('Page.Connect.GetServerURL', 'Error', 'emtpy response, calling connect again ', '-1', eCountType.end);","position":{"btp":"BTP_PCG_ERR","text":"TVNC.connect(userid, password);","position":"before"},"alias":"TVNC"},{"sourceFn":"postConnect","code":"browserTracking.log('Page.CheckSize', 'Start', _location, '', eCountType.start);","position":{"btp":"BTP_PCS_STR","text":"TVNC.checkSizeAndResolution(function () {","position":"before"},"alias":"TVNC"},{"sourceFn":"postConnect",
"code":"browserTracking.log('Page.CheckSize', 'End', _location, '', eCountType.end);","position":{"btp":"BTP_PCS_END","text":"TVNC.checkSizeAndResolution(function () {","position":"after"},"alias":"TVNC"},{"sourceFn":"postConnect","code":"browserTracking.log('Page.Connect.Request', 'Start', _location, '', eCountType.start);","position":{"btp":"BTP_PCR_STR","text":"serverCmdResultOrientation = null;","position":"before"},"alias":"TVNC"},{"sourceFn":"onConnectResult","code":"browserTracking.log('Page.Connect.Request','End', helper.string.format('LogFile: {0}, ServerProcessId: {1}', (obj && obj.logFile ? obj.logFile : ''), (obj && obj.serverProcessId ? obj.serverProcessId : '')),'' , eCountType.end);",
"position":{"btp":"BTP_PCR_END1","text":'if (obj.status && typeof obj.status != "undefined") {',"position":"before"},"alias":"TVNC"},{"sourceFn":"postConnect","code":"browserTracking.log('Page.Connect.Request', 'End', 'Redirect', '200', eCountType.end);","position":{"btp":"BTP_PCR_END2","text":"top.location.href = redirect;","position":"before"},"alias":"TVNC"},{"sourceFn":"postConnect","code":"browserTracking.log('Page.Connect.Request', 'Retry', 'Connect was fail, trying to connect again.' ,'', eCountType.none);",
"position":{"btp":"BTP_PCR_RTY","text":"if (TVNC.reconnecting) {","position":"after"},"alias":"TVNC"},{"sourceFn":"postConnect","code":"browserTracking.log('Page.Connect.Request', 'Error', jqXHR.statusText, jqXHR.status.toString(), eCountType.end);","position":{"btp":"BTP_PCR_ERR3","text":"error: function (jqXHR, err) {","position":"after"},"alias":"TVNC"},{"sourceFn":"postConnect","code":"browserTracking.log('Page.Connect.Request', 'End', 'Reload - Is not a valid HTML', '', eCountType.end);","position":{"btp":"BTP_PCR_ERR4",
"text":"$(window).off('onbeforeunload');","position":"after"},"alias":"TVNC"},{"sourceFn":"processDrawCmds","code":"if (cmd && cmd.ec != '') { browserTracking.log('Page.Connect.Logon','Error', helper.string.format('Logon Error - code: {0}, data: {1}, description: {2}', (cmd.ec)?cmd.ec:'', (cmd.d)? cmd.d:'', (cmd.s)?cmd.s:''),'' , eCountType.none); }","position":{"btp":"BTP_PCL_ERR","text":'} else if (cmd.c == "LE") {',"position":"after"},"alias":"TVNC"},{"sourceFn":"serverCmdResult","code":"browserTracking.log('Page.Session', 'Start', '', '', eCountType.start);",
"position":{"btp":"BTP_PS_STR","text":'if ((typeof TVNC.rcParams.events == "undefined") || (TVNC.rcParams.events.onSessionStart == null)) {',"position":"before"},"alias":"TVNC"},{"sourceFn":"serverCmdResult","code":"if (!window._sessionEnd) {window._sessionEnd = true; browserTracking.log('Page.Session', 'End', '', '', eCountType.start);}","position":{"btp":"BTP_PS_STP","text":'if ((typeof TVNC.rcParams.events == "undefined") || (TVNC.rcParams.events.onSessionStop == null)) {',"position":"before"},
"alias":"TVNC"},{"sourceFn":"receiveScreen","code":"if (!window._sessionEnd) {window._sessionEnd = true;browserTracking.log('Page.Session', 'End', 'obj.status == 9', '', eCountType.end);}","position":{"btp":"BTP_PS_END1","text":"_isSessionEnded = true;","position":"after"},"alias":"TVNC"},{"sourceFn":"disconnect","code":"if (window._remoteApp_) browserTracking.log('Page.RemoteApp', 'End', '', '', eCountType.end);\n window._remoteApp_=false;\n browserTracking.log('Page.Session', 'End', '', '', eCountType.end);",
"position":{"btp":"BTP_PS_END2","text":"TVNC.fromReconnection = false;","position":"before"},"alias":"TVNC"},{"sourceFn":"onConnectResult","code":"browserTracking.log('Page.Ajax', 'Start', 'Switching to Ajax', '', eCountType.none);","position":{"btp":"BTP_PA_STR","text":"TVNC.start();","position":"before"},"alias":"TVNC"},{"sourceFn":"connectWebSocket","code":"browserTracking.log('Page.WebSocket', 'Initialize', '', '', eCountType.none);","position":{"btp":"BTP_WS_INIT","row":0},"alias":"TVNC"},{"sourceFn":"connectWebSocket",
"code":"browserTracking.log('Page.WebSocket', 'Open', '', '', eCountType.start);","position":{"btp":"BTP_WS_OPEN","text":"resetLastError();","position":"before"},"alias":"TVNC"},{"sourceFn":"connectWebSocket","code":"browserTracking.log('Page.WebSocket', 'Close', helper.string.format('Event - Code: {0}, EventPhase: {1}, Reason: {2}, Type: {3}', e.code, e.eventPhase, e.reason, e.type),'', eCountType.end);","position":{"btp":"BTP_WS_CLOSE1","text":"TVNC.ws.onclose = function (e) { ","position":"after"},
"alias":"TVNC"},{"sourceFn":"connectWebSocket","code":"browserTracking.log('Page.WebSocket', 'Timeout', 'Switching to AJAX mode', '', eCountType.end);","position":{"btp":"BTP_WS_TOUT","text":"var wstimer = setTimeout(function () {","position":"after"},"alias":"TVNC"},{"sourceFn":"connectWebSocket","code":"browserTracking.log('Page.WebSocket', 'Error', helper.string.format('Event - Code: {0}, EventPhase: {1}, Reason: {2}, Type: {3}', e.code, e.eventPhase, e.reason, e.type), e.code, eCountType.end);",
"position":{"btp":"BTP_WS_ERR","text":"TVNC.ws.onerror = function (e) {","position":"after"},"alias":"TVNC"},{"sourceFn":"connectWebSocket","code":"browserTracking.log('Page.WebSocket', 'Error', 'Reconnecting', '', eCountType.none);","position":{"btp":"BTP_WS_ERR1","text":"if (TVNC.wsEnabled && !TVNC.useAjax) {","position":"after"},"alias":"TVNC"},{"sourceFn":"connectWebSocket","code":"browserTracking.log('Page.WebSocket', 'Error', 'Switch to Ajax', '', eCountType.none);","position":{"btp":"BTP_WS_ERR2",
"text":'helper.console.log("TVNC.start. useAjax: " + TVNC.useAjax + ", wsEnabled: " + TVNC.wsEnabled, arguments);',"position":"after"},"alias":"TVNC"},{"sourceFn":"onConnectResult","code":"browserTracking.terminate('Need.Credentials','',-1);\nreturn;","position":{"btp":"BTP_PT_NC","text":"} else if (obj.authStatus == 4) {","position":"after"},"alias":"TVNC"},{"sourceFn":"serverCmdResult","code":"browserTracking.log('Page.Session','Error', (errormsg) ? errormsg.msg || errormsg : '',-1);\nbrowserTracking.terminate('Error',(errormsg) ? errormsg.msg || errormsg : '',-1);\nreturn;",
"position":{"btp":"BTP_PS_ERR","text":'var errormsg = (typeof obj.errormsg != "undefined") ? obj.errormsg : "";',"position":"after"},"alias":"TVNC"},{"sourceFn":"processDrawCmds","code":"window._remoteApp_ = true;\n browserTracking.log('Page.RemoteApp', 'Start', (cmd.exename ? cmd.exename.replace(/||/g,'') :''), '', eCountType.start);","position":{"btp":"BTP_PRA_SRT","text":'} else if (cmd.c == "EA") {',"position":"after"},"alias":"TVNC"},{"sourceFn":"processDrawCmds","code":"browserTracking.log('Page.RemoteApp', 'Status', (cmd)?cmd.rctext:'', (cmd)?cmd.rc:0, eCountType.none);",
"position":{"btp":"BTP_PRA_STS","text":'} else if (cmd.c == "EX") { // -- EXECUTE RESULT',"position":"after"},"alias":"TVNC"},{"sourceFn":"receiveScreen","code":"if (window._remoteApp_) browserTracking.log('Page.RemoteApp', 'End', '', '', eCountType.end);window._remoteApp_=false;\n","position":{"btp":"BTP_PRA_END","text":"_isSessionEnded = true;","position":"before"},"alias":"TVNC"},{"sourceFn":"showReconnectDiv","code":"browserTracking.log('Page.Connection', 'Unstable', '', '', eCountType.none);",
"position":{"btp":"BTP_PC_UNS","text":"var cs = { 'code': 1, 'message': consts.connUnstable };","position":"after"},"alias":"TVNC"},{"sourceFn":"showReconnectDiv","code":"browserTracking.log('Page.Connection', 'Lost', '', '', eCountType.none);","position":{"btp":"BTP_PC_LST","text":"var cs = { 'code': 2, 'message': consts.connLostReconnecting };","position":"after"},"alias":"TVNC"},{"sourceFn":"closeReconnectDiv","code":"browserTracking.log('Page.Connection', 'Restored', '', '', eCountType.none);",
"position":{"btp":"BTP_PC_RST","text":"var cs = { 'code': 3, 'message': consts.connRestored };","position":"after"},"alias":"TVNC"},{"sourceFn":"connect","code":"helper.utils.removeCookie(cookiePrefix+'_SID', TVNC.baseUrl);","position":{"btp":"BTP_REM_CO","row":1,"position":"before"},"alias":"TVNC"},{"sourceFn":"","code":"ID = { 'key': function () {return location.pathname.replace(/\\//g, '') + ((!!window.name) ? window.name.replace('__Thinfinity.Broker__', '_') : '') + '_sid';},'get': function () {return null;},'set': function (id) {return null;}};"},
{"sourceFn":"start","code":"browserTracking.log('Page.Request', 'Start', 'Sending start command', '', eCountType.none);","position":{"btp":"BTP_PR_STR","text":"TVNC.sendStart(cmdv);","position":"before"},"alias":"TVNC"},{"sourceFn":"connectWebSocket","code":"browserTracking.log('Page.WebSocket', 'Close', 'Calling ws.close(); --\x3e from connectWebSocket method, an old web socket.', '', eCountType.none);","position":{"btp":"BTP_PWS_CLS1","text":"// -- Close old webSocket","position":"after"},"alias":"TVNC"},
{"sourceFn":"connectWebSocket","code":"browserTracking.log('Page.WebSocket', 'Close', 'Calling ws.close(); --\x3e from connectWebSocket method, switching to ajax (timeout)', '', eCountType.none);","position":{"btp":"BTP_PWS_CLS2","text":'logDebug("WebSocket: no response. Switching to Ajax mode.");',"position":"after"},"alias":"TVNC"},{"sourceFn":"dispose","code":"browserTracking.log('Page.WebSocket', 'Close', 'Calling ws.close(); --\x3e from dispose method.', '', eCountType.none);","position":{"btp":"BTP_PWS_CLS3",
"text":"TVNC.ws.close();","position":"after"},"alias":"TVNC"}],"webfmx.sdk":[{"sourceFn":"events.onServerSceneRender","code":"browserTracking.log('Page.Application', 'Start', '', '', eCountType.start);","position":{"btp":"BTP_FMX_AS","text":"isFirstTime = false;","position":"after"},"alias":"self"},{"sourceFn":"events.onSessionEnd","code":"browserTracking.log('Page.Application', 'End', '', '', eCountType.end);","position":{"btp":"BTP_FMX_AE","text":"self.disconnect();","position":"before"},"alias":"self"}]};
if(!window.embedScriptLog)window.embedScriptLog={};if(!window.embedScriptLog["thinvnc.sdk"])window.embedScriptLog["thinvnc.sdk"]=[];if(!window.embedScriptLog["webfmx.sdk"])window.embedScriptLog["webfmx.sdk"]=[];window.embedScriptLog["thinvnc.sdk"]=window.embedScriptLog["thinvnc.sdk"].concat(logs["thinvnc.sdk"]);window.embedScriptLog["webfmx.sdk"]=window.embedScriptLog["webfmx.sdk"].concat(logs["webfmx.sdk"])}
if(!Element.prototype.matches)Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector;if(!Element.prototype.closest)Element.prototype.closest=function(s){var el=this;if(!document.documentElement.contains(el))return null;do{if(el.matches(s))return el;el=el.parentElement||el.parentNode}while(el!==null&&el.nodeType===1);return null};
if(!Array.prototype.find){Object.defineProperty(Array.prototype,"_customFind",{value:function(predicate){if(this==null)throw new TypeError('"this" is null or not defined');if(typeof predicate!=="function")throw new TypeError("predicate must be a function");var o=Object(this);var len=o.length>>>0;var thisArg=arguments[1];var k=0;var result=null;var kValue;while(k<len&&result==null){var kValue=o[k];if(predicate.call(thisArg,kValue,k,o))result={"index":k,"value":kValue};else k++}return result||{}}});
Object.defineProperty(Array.prototype,"find",{value:function(predicate){return this._customFind(predicate)["value"]}});Object.defineProperty(Array.prototype,"findIndex",{value:function(predicate){return this._customFind(predicate)["index"]||-1}})}if(window.NodeList&&!NodeList.prototype.forEach)NodeList.prototype.forEach=function(callback,thisArg){thisArg=thisArg||window;for(var i=0;i<this.length;i++)callback.call(thisArg,this[i],i,this)};
if(!String.prototype.startsWith)String.prototype.startsWith=function(searchString,position){position=position||0;return this.substr(position,searchString.length)===searchString};
if(!String.prototype.endsWith)String.prototype.endsWith=function(searchString,position){var subjectString=this.toString();if(typeof position!=="number"||!isFinite(position)||Math.floor(position)!==position||position>subjectString.length)position=subjectString.length;position-=searchString.length;var lastIndex=subjectString.indexOf(searchString,position);return lastIndex!==-1&&lastIndex===position};
if(!String.prototype.replaceAll)String.prototype.replaceAll=function(str,newStr){if(str==null||str==undefined)return this.toString();if(Object.prototype.toString.call(str).toLowerCase()==="[object regexp]")if(str.global)return this.replace(str,newStr);else throw new TypeError("String.prototype.replaceAll called with a non-global RegExp argument");str=str.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return this.replace(new RegExp(str,"g"),newStr)};
if(!Object.values)Object.defineProperty(Object.__proto__,"values",{"configurable":false,"writable":false,"value":function(predicate){return Object.keys(predicate).map(function(k){return predicate[k]})}});
if(!String.prototype.padStart)String.prototype.padStart=function padStart(targetLength,padString){targetLength=targetLength>>0;padString=String(typeof padString!=="undefined"?padString:" ");if(this.length>=targetLength)return String(this);else{targetLength=targetLength-this.length;if(targetLength>padString.length)padString+=padString.repeat(targetLength/padString.length);return padString.slice(0,targetLength)+String(this)}};
if(!String.prototype.padEnd)String.prototype.padEnd=function padEnd(targetLength,padString){targetLength=targetLength>>0;padString=String(typeof padString!=="undefined"?padString:" ");if(this.length>targetLength)return String(this);else{targetLength=targetLength-this.length;if(targetLength>padString.length)padString+=padString.repeat(targetLength/padString.length);return String(this)+padString.slice(0,targetLength)}};
(function(){if(typeof window.CustomEvent==="function")return false;function CustomEvent(event,params){params=params||{bubbles:false,cancelable:false,detail:undefined};var evt=document.createEvent("CustomEvent");evt.initCustomEvent(event,params.bubbles,params.cancelable,params.detail);return evt}CustomEvent.prototype=window.Event.prototype;window.CustomEvent=CustomEvent})();(function(){if(!Number.isNaN)Number.isNaN=function(value){return typeof value==="number"&&isNaN(value)}})();
(function(global,factory){typeof exports==="object"&&typeof module!=="undefined"?module.exports=factory():typeof define==="function"&&define.amd?define(factory):global.ES6Promise=factory()})(this,function(){function objectOrFunction(x){var type=typeof x;return x!==null&&(type==="object"||type==="function")}function isFunction(x){return typeof x==="function"}var _isArray=void 0;if(Array.isArray)_isArray=Array.isArray;else _isArray=function(x){return Object.prototype.toString.call(x)==="[object Array]"};
var isArray=_isArray;var len=0;var vertxNext=void 0;var customSchedulerFn=void 0;var asap=function asap(callback,arg){queue[len]=callback;queue[len+1]=arg;len+=2;if(len===2)if(customSchedulerFn)customSchedulerFn(flush);else scheduleFlush()};function setScheduler(scheduleFn){customSchedulerFn=scheduleFn}function setAsap(asapFn){asap=asapFn}var browserWindow=typeof window!=="undefined"?window:undefined;var browserGlobal=browserWindow||{};var BrowserMutationObserver=browserGlobal.MutationObserver||browserGlobal.WebKitMutationObserver;
var isNode=typeof self==="undefined"&&typeof process!=="undefined"&&{}.toString.call(process)==="[object process]";var isWorker=typeof Uint8ClampedArray!=="undefined"&&typeof importScripts!=="undefined"&&typeof MessageChannel!=="undefined";function useNextTick(){return function(){return process.nextTick(flush)}}function useVertxTimer(){if(typeof vertxNext!=="undefined")return function(){vertxNext(flush)};return useSetTimeout()}function useMutationObserver(){var iterations=0;var observer=new BrowserMutationObserver(flush);
var node=document.createTextNode("");observer.observe(node,{characterData:true});return function(){node.data=iterations=++iterations%2}}function useMessageChannel(){var channel=new MessageChannel;channel.port1.onmessage=flush;return function(){return channel.port2.postMessage(0)}}function useSetTimeout(){var globalSetTimeout=setTimeout;return function(){return globalSetTimeout(flush,1)}}var queue=new Array(1E3);function flush(){for(var i=0;i<len;i+=2){var callback=queue[i];var arg=queue[i+1];callback(arg);
queue[i]=undefined;queue[i+1]=undefined}len=0}function attemptVertx(){try{var vertx=Function("return this")().require("vertx");vertxNext=vertx.runOnLoop||vertx.runOnContext;return useVertxTimer()}catch(e){return useSetTimeout()}}var scheduleFlush=void 0;if(isNode)scheduleFlush=useNextTick();else if(BrowserMutationObserver)scheduleFlush=useMutationObserver();else if(isWorker)scheduleFlush=useMessageChannel();else if(browserWindow===undefined&&typeof require==="function")scheduleFlush=attemptVertx();
else scheduleFlush=useSetTimeout();function then(onFulfillment,onRejection){var parent=this;var child=new this.constructor(noop);if(child[PROMISE_ID]===undefined)makePromise(child);var _state=parent._state;if(_state){var callback=arguments[_state-1];asap(function(){return invokeCallback(_state,child,callback,parent._result)})}else subscribe(parent,child,onFulfillment,onRejection);return child}function resolve$1(object){var Constructor=this;if(object&&typeof object==="object"&&object.constructor===
Constructor)return object;var promise=new Constructor(noop);resolve(promise,object);return promise}var PROMISE_ID=Math.random().toString(36).substring(2);function noop(){}var PENDING=void 0;var FULFILLED=1;var REJECTED=2;function selfFulfillment(){return new TypeError("You cannot resolve a promise with itself")}function cannotReturnOwn(){return new TypeError("A promises callback cannot return that same promise.")}function tryThen(then$$1,value,fulfillmentHandler,rejectionHandler){try{then$$1.call(value,
fulfillmentHandler,rejectionHandler)}catch(e){return e}}function handleForeignThenable(promise,thenable,then$$1){asap(function(promise){var sealed=false;var error=tryThen(then$$1,thenable,function(value){if(sealed)return;sealed=true;if(thenable!==value)resolve(promise,value);else fulfill(promise,value)},function(reason){if(sealed)return;sealed=true;reject(promise,reason)},"Settle: "+(promise._label||" unknown promise"));if(!sealed&&error){sealed=true;reject(promise,error)}},promise)}function handleOwnThenable(promise,
thenable){if(thenable._state===FULFILLED)fulfill(promise,thenable._result);else if(thenable._state===REJECTED)reject(promise,thenable._result);else subscribe(thenable,undefined,function(value){return resolve(promise,value)},function(reason){return reject(promise,reason)})}function handleMaybeThenable(promise,maybeThenable,then$$1){if(maybeThenable.constructor===promise.constructor&&then$$1===then&&maybeThenable.constructor.resolve===resolve$1)handleOwnThenable(promise,maybeThenable);else if(then$$1===
undefined)fulfill(promise,maybeThenable);else if(isFunction(then$$1))handleForeignThenable(promise,maybeThenable,then$$1);else fulfill(promise,maybeThenable)}function resolve(promise,value){if(promise===value)reject(promise,selfFulfillment());else if(objectOrFunction(value)){var then$$1=void 0;try{then$$1=value.then}catch(error){reject(promise,error);return}handleMaybeThenable(promise,value,then$$1)}else fulfill(promise,value)}function publishRejection(promise){if(promise._onerror)promise._onerror(promise._result);
publish(promise)}function fulfill(promise,value){if(promise._state!==PENDING)return;promise._result=value;promise._state=FULFILLED;if(promise._subscribers.length!==0)asap(publish,promise)}function reject(promise,reason){if(promise._state!==PENDING)return;promise._state=REJECTED;promise._result=reason;asap(publishRejection,promise)}function subscribe(parent,child,onFulfillment,onRejection){var _subscribers=parent._subscribers;var length=_subscribers.length;parent._onerror=null;_subscribers[length]=
child;_subscribers[length+FULFILLED]=onFulfillment;_subscribers[length+REJECTED]=onRejection;if(length===0&&parent._state)asap(publish,parent)}function publish(promise){var subscribers=promise._subscribers;var settled=promise._state;if(subscribers.length===0)return;var child=void 0,callback=void 0,detail=promise._result;for(var i=0;i<subscribers.length;i+=3){child=subscribers[i];callback=subscribers[i+settled];if(child)invokeCallback(settled,child,callback,detail);else callback(detail)}promise._subscribers.length=
0}function invokeCallback(settled,promise,callback,detail){var hasCallback=isFunction(callback),value=void 0,error=void 0,succeeded=true;if(hasCallback){try{value=callback(detail)}catch(e){succeeded=false;error=e}if(promise===value){reject(promise,cannotReturnOwn());return}}else value=detail;if(promise._state!==PENDING);else if(hasCallback&&succeeded)resolve(promise,value);else if(succeeded===false)reject(promise,error);else if(settled===FULFILLED)fulfill(promise,value);else if(settled===REJECTED)reject(promise,
value)}function initializePromise(promise,resolver){try{resolver(function resolvePromise(value){resolve(promise,value)},function rejectPromise(reason){reject(promise,reason)})}catch(e){reject(promise,e)}}var id=0;function nextId(){return id++}function makePromise(promise){promise[PROMISE_ID]=id++;promise._state=undefined;promise._result=undefined;promise._subscribers=[]}function validationError(){return new Error("Array Methods must be provided an Array")}var Enumerator=function(){function Enumerator(Constructor,
input){this._instanceConstructor=Constructor;this.promise=new Constructor(noop);if(!this.promise[PROMISE_ID])makePromise(this.promise);if(isArray(input)){this.length=input.length;this._remaining=input.length;this._result=new Array(this.length);if(this.length===0)fulfill(this.promise,this._result);else{this.length=this.length||0;this._enumerate(input);if(this._remaining===0)fulfill(this.promise,this._result)}}else reject(this.promise,validationError())}Enumerator.prototype._enumerate=function _enumerate(input){for(var i=
0;this._state===PENDING&&i<input.length;i++)this._eachEntry(input[i],i)};Enumerator.prototype._eachEntry=function _eachEntry(entry,i){var c=this._instanceConstructor;var resolve$$1=c.resolve;if(resolve$$1===resolve$1){var _then=void 0;var error=void 0;var didError=false;try{_then=entry.then}catch(e){didError=true;error=e}if(_then===then&&entry._state!==PENDING)this._settledAt(entry._state,i,entry._result);else if(typeof _then!=="function"){this._remaining--;this._result[i]=entry}else if(c===Promise$2){var promise=
new c(noop);if(didError)reject(promise,error);else handleMaybeThenable(promise,entry,_then);this._willSettleAt(promise,i)}else this._willSettleAt(new c(function(resolve$$1){return resolve$$1(entry)}),i)}else this._willSettleAt(resolve$$1(entry),i)};Enumerator.prototype._settledAt=function _settledAt(state,i,value){var promise=this.promise;if(promise._state===PENDING){this._remaining--;if(state===REJECTED)reject(promise,value);else this._result[i]=value}if(this._remaining===0)fulfill(promise,this._result)};
Enumerator.prototype._willSettleAt=function _willSettleAt(promise,i){var enumerator=this;subscribe(promise,undefined,function(value){return enumerator._settledAt(FULFILLED,i,value)},function(reason){return enumerator._settledAt(REJECTED,i,reason)})};return Enumerator}();function all(entries){return(new Enumerator(this,entries)).promise}function race(entries){var Constructor=this;if(!isArray(entries))return new Constructor(function(_,reject){return reject(new TypeError("You must pass an array to race."))});
else return new Constructor(function(resolve,reject){var length=entries.length;for(var i=0;i<length;i++)Constructor.resolve(entries[i]).then(resolve,reject)})}function reject$1(reason){var Constructor=this;var promise=new Constructor(noop);reject(promise,reason);return promise}function needsResolver(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor");}function needsNew(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");
}var Promise$2=function(){function Promise(resolver){this[PROMISE_ID]=nextId();this._result=this._state=undefined;this._subscribers=[];if(noop!==resolver){typeof resolver!=="function"&&needsResolver();this instanceof Promise?initializePromise(this,resolver):needsNew()}}Promise.prototype.catch=function _catch(onRejection){return this.then(null,onRejection)};Promise.prototype.finally=function _finally(callback){var promise=this;var constructor=promise.constructor;if(isFunction(callback))return promise.then(function(value){return constructor.resolve(callback()).then(function(){return value})},
function(reason){return constructor.resolve(callback()).then(function(){throw reason;})});return promise.then(callback,callback)};return Promise}();Promise$2.prototype.then=then;Promise$2.all=all;Promise$2.race=race;Promise$2.resolve=resolve$1;Promise$2.reject=reject$1;Promise$2._setScheduler=setScheduler;Promise$2._setAsap=setAsap;Promise$2._asap=asap;function polyfill(){var local=void 0;if(typeof global!=="undefined")local=global;else if(typeof self!=="undefined")local=self;else try{local=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment");
}var P=local.Promise;if(P){var promiseToString=null;try{promiseToString=Object.prototype.toString.call(P.resolve())}catch(e){}if(promiseToString==="[object Promise]"&&!P.cast)return}local.Promise=Promise$2}Promise$2.polyfill=polyfill;Promise$2.Promise=Promise$2;Promise$2.polyfill();return Promise$2});
!function(e,t){"object"==typeof module&&"object"==typeof module.exports?module.exports=e.document?t(e,!0):function(e){if(!e.document)throw new Error("jQuery requires a window with a document");return t(e)}:t(e)}("undefined"!=typeof window?window:this,function(ie,e){var oe=[],r=Object.getPrototypeOf,ae=oe.slice,g=oe.flat?function(e){return oe.flat.call(e)}:function(e){return oe.concat.apply([],e)},s=oe.push,se=oe.indexOf,n={},i=n.toString,ue=n.hasOwnProperty,o=ue.toString,a=o.call(Object),le={},v=
function(e){return"function"==typeof e&&"number"!=typeof e.nodeType&&"function"!=typeof e.item},y=function(e){return null!=e&&e===e.window},C=ie.document,u={type:!0,src:!0,nonce:!0,noModule:!0};function m(e,t,n){var r,i,o=(n=n||C).createElement("script");if(o.text=e,t)for(r in u)(i=t[r]||t.getAttribute&&t.getAttribute(r))&&o.setAttribute(r,i);n.head.appendChild(o).parentNode.removeChild(o)}function x(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?n[i.call(e)]||"object":typeof e}var t=
"3.7.1",l=/HTML$/i,ce=function(e,t){return new ce.fn.init(e,t)};function c(e){var t=!!e&&"length"in e&&e.length,n=x(e);return!v(e)&&!y(e)&&("array"===n||0===t||"number"==typeof t&&0<t&&t-1 in e)}function fe(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()}ce.fn=ce.prototype={jquery:t,constructor:ce,length:0,toArray:function(){return ae.call(this)},get:function(e){return null==e?ae.call(this):e<0?this[e+this.length]:this[e]},pushStack:function(e){var t=ce.merge(this.constructor(),
e);return t.prevObject=this,t},each:function(e){return ce.each(this,e)},map:function(n){return this.pushStack(ce.map(this,function(e,t){return n.call(e,t,e)}))},slice:function(){return this.pushStack(ae.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(ce.grep(this,function(e,t){return(t+1)%2}))},odd:function(){return this.pushStack(ce.grep(this,function(e,t){return t%2}))},eq:function(e){var t=this.length,n=+e+(e<
0?t:0);return this.pushStack(0<=n&&n<t?[this[n]]:[])},end:function(){return this.prevObject||this.constructor()},push:s,sort:oe.sort,splice:oe.splice},ce.extend=ce.fn.extend=function(){var e,t,n,r,i,o,a=arguments[0]||{},s=1,u=arguments.length,l=!1;for("boolean"==typeof a&&(l=a,a=arguments[s]||{},s++),"object"==typeof a||v(a)||(a={}),s===u&&(a=this,s--);s<u;s++)if(null!=(e=arguments[s]))for(t in e)r=e[t],"__proto__"!==t&&a!==r&&(l&&r&&(ce.isPlainObject(r)||(i=Array.isArray(r)))?(n=a[t],o=i&&!Array.isArray(n)?
[]:i||ce.isPlainObject(n)?n:{},i=!1,a[t]=ce.extend(l,o,r)):void 0!==r&&(a[t]=r));return a},ce.extend({expando:"jQuery"+(t+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e);},noop:function(){},isPlainObject:function(e){var t,n;return!(!e||"[object Object]"!==i.call(e))&&(!(t=r(e))||"function"==typeof(n=ue.call(t,"constructor")&&t.constructor)&&o.call(n)===a)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},globalEval:function(e,t,n){m(e,{nonce:t&&t.nonce},
n)},each:function(e,t){var n,r=0;if(c(e))for(n=e.length;r<n;r++){if(!1===t.call(e[r],r,e[r]))break}else for(r in e)if(!1===t.call(e[r],r,e[r]))break;return e},text:function(e){var t,n="",r=0,i=e.nodeType;if(!i)while(t=e[r++])n+=ce.text(t);return 1===i||11===i?e.textContent:9===i?e.documentElement.textContent:3===i||4===i?e.nodeValue:n},makeArray:function(e,t){var n=t||[];return null!=e&&(c(Object(e))?ce.merge(n,"string"==typeof e?[e]:e):s.call(n,e)),n},inArray:function(e,t,n){return null==t?-1:se.call(t,
e,n)},isXMLDoc:function(e){var t=e&&e.namespaceURI,n=e&&(e.ownerDocument||e).documentElement;return!l.test(t||n&&n.nodeName||"HTML")},merge:function(e,t){for(var n=+t.length,r=0,i=e.length;r<n;r++)e[i++]=t[r];return e.length=i,e},grep:function(e,t,n){for(var r=[],i=0,o=e.length,a=!n;i<o;i++)!t(e[i],i)!==a&&r.push(e[i]);return r},map:function(e,t,n){var r,i,o=0,a=[];if(c(e))for(r=e.length;o<r;o++)null!=(i=t(e[o],o,n))&&a.push(i);else for(o in e)null!=(i=t(e[o],o,n))&&a.push(i);return g(a)},guid:1,
support:le}),"function"==typeof Symbol&&(ce.fn[Symbol.iterator]=oe[Symbol.iterator]),ce.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(e,t){n["[object "+t+"]"]=t.toLowerCase()});var pe=oe.pop,de=oe.sort,he=oe.splice,ge="[\\x20\\t\\r\\n\\f]",ve=new RegExp("^"+ge+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ge+"+$","g");ce.contains=function(e,t){var n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(e.contains?e.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))};
var f=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g;function p(e,t){return t?"\x00"===e?"\ufffd":e.slice(0,-1)+"\\"+e.charCodeAt(e.length-1).toString(16)+" ":"\\"+e}ce.escapeSelector=function(e){return(e+"").replace(f,p)};var ye=C,me=s;!function(){var e,b,w,o,a,T,r,C,d,i,k=me,S=ce.expando,E=0,n=0,s=W(),c=W(),u=W(),h=W(),l=function(e,t){return e===t&&(a=!0),0},f="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",t="(?:\\\\[\\da-fA-F]{1,6}"+
ge+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\x00-\\x7f])+",p="\\["+ge+"*("+t+")(?:"+ge+"*([*^$|!~]?=)"+ge+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+t+"))|)"+ge+"*\\]",g=":("+t+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+p+")*)|.*)\\)|)",v=new RegExp(ge+"+","g"),y=new RegExp("^"+ge+"*,"+ge+"*"),m=new RegExp("^"+ge+"*([>+~]|"+ge+")"+ge+"*"),x=new RegExp(ge+"|>"),j=new RegExp(g),A=new RegExp("^"+t+"$"),D={ID:new RegExp("^#("+t+")"),CLASS:new RegExp("^\\.("+
t+")"),TAG:new RegExp("^("+t+"|[*])"),ATTR:new RegExp("^"+p),PSEUDO:new RegExp("^"+g),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ge+"*(even|odd|(([+-]|)(\\d*)n|)"+ge+"*(?:([+-]|)"+ge+"*(\\d+)|))"+ge+"*\\)|)","i"),bool:new RegExp("^(?:"+f+")$","i"),needsContext:new RegExp("^"+ge+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ge+"*((?:-\\d)?\\d*)"+ge+"*\\)|)(?=[^-]|$)","i")},N=/^(?:input|select|textarea|button)$/i,q=/^h\d$/i,L=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,H=
/[+~]/,O=new RegExp("\\\\[\\da-fA-F]{1,6}"+ge+"?|\\\\([^\\r\\n\\f])","g"),P=function(e,t){var n="0x"+e.slice(1)-65536;return t||(n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320))},M=function(){V()},R=J(function(e){return!0===e.disabled&&fe(e,"fieldset")},{dir:"parentNode",next:"legend"});try{k.apply(oe=ae.call(ye.childNodes),ye.childNodes),oe[ye.childNodes.length].nodeType}catch(e){k={apply:function(e,t){me.apply(e,ae.call(t))},call:function(e){me.apply(e,ae.call(arguments,
1))}}}function I(t,e,n,r){var i,o,a,s,u,l,c,f=e&&e.ownerDocument,p=e?e.nodeType:9;if(n=n||[],"string"!=typeof t||!t||1!==p&&9!==p&&11!==p)return n;if(!r&&(V(e),e=e||T,C)){if(11!==p&&(u=L.exec(t)))if(i=u[1])if(9===p){if(!(a=e.getElementById(i)))return n;if(a.id===i)return k.call(n,a),n}else{if(f&&(a=f.getElementById(i))&&I.contains(e,a)&&a.id===i)return k.call(n,a),n}else{if(u[2])return k.apply(n,e.getElementsByTagName(t)),n;if((i=u[3])&&e.getElementsByClassName)return k.apply(n,e.getElementsByClassName(i)),
n}if(!(h[t+" "]||d&&d.test(t))){if(c=t,f=e,1===p&&(x.test(t)||m.test(t))){(f=H.test(t)&&U(e.parentNode)||e)==e&&le.scope||((s=e.getAttribute("id"))?s=ce.escapeSelector(s):e.setAttribute("id",s=S)),o=(l=Y(t)).length;while(o--)l[o]=(s?"#"+s:":scope")+" "+Q(l[o]);c=l.join(",")}try{return k.apply(n,f.querySelectorAll(c)),n}catch(e){h(t,!0)}finally{s===S&&e.removeAttribute("id")}}}return re(t.replace(ve,"$1"),e,n,r)}function W(){var r=[];return function e(t,n){return r.push(t+" ")>b.cacheLength&&delete e[r.shift()],
e[t+" "]=n}}function F(e){return e[S]=!0,e}function $(e){var t=T.createElement("fieldset");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function B(t){return function(e){return fe(e,"input")&&e.type===t}}function _(t){return function(e){return(fe(e,"input")||fe(e,"button"))&&e.type===t}}function z(t){return function(e){return"form"in e?e.parentNode&&!1===e.disabled?"label"in e?"label"in e.parentNode?e.parentNode.disabled===t:e.disabled===t:e.isDisabled===
t||e.isDisabled!==!t&&R(e)===t:e.disabled===t:"label"in e&&e.disabled===t}}function X(a){return F(function(o){return o=+o,F(function(e,t){var n,r=a([],e.length,o),i=r.length;while(i--)e[n=r[i]]&&(e[n]=!(t[n]=e[n]))})})}function U(e){return e&&"undefined"!=typeof e.getElementsByTagName&&e}function V(e){var t,n=e?e.ownerDocument||e:ye;return n!=T&&9===n.nodeType&&n.documentElement&&(r=(T=n).documentElement,C=!ce.isXMLDoc(T),i=r.matches||r.webkitMatchesSelector||r.msMatchesSelector,r.msMatchesSelector&&
ye!=T&&(t=T.defaultView)&&t.top!==t&&t.addEventListener("unload",M),le.getById=$(function(e){return r.appendChild(e).id=ce.expando,!T.getElementsByName||!T.getElementsByName(ce.expando).length}),le.disconnectedMatch=$(function(e){return i.call(e,"*")}),le.scope=$(function(){return T.querySelectorAll(":scope")}),le.cssHas=$(function(){try{return T.querySelector(":has(*,:jqfake)"),!1}catch(e){return!0}}),le.getById?(b.filter.ID=function(e){var t=e.replace(O,P);return function(e){return e.getAttribute("id")===
t}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&C){var n=t.getElementById(e);return n?[n]:[]}}):(b.filter.ID=function(e){var n=e.replace(O,P);return function(e){var t="undefined"!=typeof e.getAttributeNode&&e.getAttributeNode("id");return t&&t.value===n}},b.find.ID=function(e,t){if("undefined"!=typeof t.getElementById&&C){var n,r,i,o=t.getElementById(e);if(o){if((n=o.getAttributeNode("id"))&&n.value===e)return[o];i=t.getElementsByName(e),r=0;while(o=i[r++])if((n=o.getAttributeNode("id"))&&
n.value===e)return[o]}return[]}}),b.find.TAG=function(e,t){return"undefined"!=typeof t.getElementsByTagName?t.getElementsByTagName(e):t.querySelectorAll(e)},b.find.CLASS=function(e,t){if("undefined"!=typeof t.getElementsByClassName&&C)return t.getElementsByClassName(e)},d=[],$(function(e){var t;r.appendChild(e).innerHTML="<a id='"+S+"' href='' disabled='disabled'></a><select id='"+S+"-\r\\' disabled='disabled'><option selected=''></option></select>",e.querySelectorAll("[selected]").length||d.push("\\["+
ge+"*(?:value|"+f+")"),e.querySelectorAll("[id~="+S+"-]").length||d.push("~="),e.querySelectorAll("a#"+S+"+*").length||d.push(".#.+[+~]"),e.querySelectorAll(":checked").length||d.push(":checked"),(t=T.createElement("input")).setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),r.appendChild(e).disabled=!0,2!==e.querySelectorAll(":disabled").length&&d.push(":enabled",":disabled"),(t=T.createElement("input")).setAttribute("name",""),e.appendChild(t),e.querySelectorAll("[name='']").length||
d.push("\\["+ge+"*name"+ge+"*="+ge+"*(?:''|\"\")")}),le.cssHas||d.push(":has"),d=d.length&&new RegExp(d.join("|")),l=function(e,t){if(e===t)return a=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(1&(n=(e.ownerDocument||e)==(t.ownerDocument||t)?e.compareDocumentPosition(t):1)||!le.sortDetached&&t.compareDocumentPosition(e)===n?e===T||e.ownerDocument==ye&&I.contains(ye,e)?-1:t===T||t.ownerDocument==ye&&I.contains(ye,t)?1:o?se.call(o,e)-se.call(o,t):0:4&n?-1:1)}),T}for(e in I.matches=
function(e,t){return I(e,null,null,t)},I.matchesSelector=function(e,t){if(V(e),C&&!h[t+" "]&&(!d||!d.test(t)))try{var n=i.call(e,t);if(n||le.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){h(t,!0)}return 0<I(t,T,null,[e]).length},I.contains=function(e,t){return(e.ownerDocument||e)!=T&&V(e),ce.contains(e,t)},I.attr=function(e,t){(e.ownerDocument||e)!=T&&V(e);var n=b.attrHandle[t.toLowerCase()],r=n&&ue.call(b.attrHandle,t.toLowerCase())?n(e,t,!C):void 0;return void 0!==r?r:
e.getAttribute(t)},I.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e);},ce.uniqueSort=function(e){var t,n=[],r=0,i=0;if(a=!le.sortStable,o=!le.sortStable&&ae.call(e,0),de.call(e,l),a){while(t=e[i++])t===e[i]&&(r=n.push(i));while(r--)he.call(e,n[r],1)}return o=null,e},ce.fn.uniqueSort=function(){return this.pushStack(ce.uniqueSort(ae.apply(this)))},(b=ce.expr={cacheLength:50,createPseudo:F,match:D,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},
"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(O,P),e[3]=(e[3]||e[4]||e[5]||"").replace(O,P),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||I.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&I.error(e[0]),e},PSEUDO:function(e){var t,n=!e[6]&&e[2];return D.CHILD.test(e[0])?null:(e[3]?e[2]=
e[4]||e[5]||"":n&&j.test(n)&&(t=Y(n,!0))&&(t=n.indexOf(")",n.length-t)-n.length)&&(e[0]=e[0].slice(0,t),e[2]=n.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(O,P).toLowerCase();return"*"===e?function(){return!0}:function(e){return fe(e,t)}},CLASS:function(e){var t=s[e+" "];return t||(t=new RegExp("(^|"+ge+")"+e+"("+ge+"|$)"))&&s(e,function(e){return t.test("string"==typeof e.className&&e.className||"undefined"!=typeof e.getAttribute&&e.getAttribute("class")||"")})},ATTR:function(n,
r,i){return function(e){var t=I.attr(e,n);return null==t?"!="===r:!r||(t+="","="===r?t===i:"!="===r?t!==i:"^="===r?i&&0===t.indexOf(i):"*="===r?i&&-1<t.indexOf(i):"$="===r?i&&t.slice(-i.length)===i:"~="===r?-1<(" "+t.replace(v," ")+" ").indexOf(i):"|="===r&&(t===i||t.slice(0,i.length+1)===i+"-"))}},CHILD:function(d,e,t,h,g){var v="nth"!==d.slice(0,3),y="last"!==d.slice(-4),m="of-type"===e;return 1===h&&0===g?function(e){return!!e.parentNode}:function(e,t,n){var r,i,o,a,s,u=v!==y?"nextSibling":"previousSibling",
l=e.parentNode,c=m&&e.nodeName.toLowerCase(),f=!n&&!m,p=!1;if(l){if(v){while(u){o=e;while(o=o[u])if(m?fe(o,c):1===o.nodeType)return!1;s=u="only"===d&&!s&&"nextSibling"}return!0}if(s=[y?l.firstChild:l.lastChild],y&&f){p=(a=(r=(i=l[S]||(l[S]={}))[d]||[])[0]===E&&r[1])&&r[2],o=a&&l.childNodes[a];while(o=++a&&o&&o[u]||(p=a=0)||s.pop())if(1===o.nodeType&&++p&&o===e){i[d]=[E,a,p];break}}else if(f&&(p=a=(r=(i=e[S]||(e[S]={}))[d]||[])[0]===E&&r[1]),!1===p)while(o=++a&&o&&o[u]||(p=a=0)||s.pop())if((m?fe(o,
c):1===o.nodeType)&&++p&&(f&&((i=o[S]||(o[S]={}))[d]=[E,p]),o===e))break;return(p-=g)===h||p%h==0&&0<=p/h}}},PSEUDO:function(e,o){var t,a=b.pseudos[e]||b.setFilters[e.toLowerCase()]||I.error("unsupported pseudo: "+e);return a[S]?a(o):1<a.length?(t=[e,e,"",o],b.setFilters.hasOwnProperty(e.toLowerCase())?F(function(e,t){var n,r=a(e,o),i=r.length;while(i--)e[n=se.call(e,r[i])]=!(t[n]=r[i])}):function(e){return a(e,0,t)}):a}},pseudos:{not:F(function(e){var r=[],i=[],s=ne(e.replace(ve,"$1"));return s[S]?
F(function(e,t,n,r){var i,o=s(e,null,r,[]),a=e.length;while(a--)(i=o[a])&&(e[a]=!(t[a]=i))}):function(e,t,n){return r[0]=e,s(r,null,n,i),r[0]=null,!i.pop()}}),has:F(function(t){return function(e){return 0<I(t,e).length}}),contains:F(function(t){return t=t.replace(O,P),function(e){return-1<(e.textContent||ce.text(e)).indexOf(t)}}),lang:F(function(n){return A.test(n||"")||I.error("unsupported lang: "+n),n=n.replace(O,P).toLowerCase(),function(e){var t;do if(t=C?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return(t=
t.toLowerCase())===n||0===t.indexOf(n+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var t=ie.location&&ie.location.hash;return t&&t.slice(1)===e.id},root:function(e){return e===r},focus:function(e){return e===function(){try{return T.activeElement}catch(e){}}()&&T.hasFocus()&&!!(e.type||e.href||~e.tabIndex)},enabled:z(!1),disabled:z(!0),checked:function(e){return fe(e,"input")&&!!e.checked||fe(e,"option")&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,
!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!b.pseudos.empty(e)},header:function(e){return q.test(e.nodeName)},input:function(e){return N.test(e.nodeName)},button:function(e){return fe(e,"input")&&"button"===e.type||fe(e,"button")},text:function(e){var t;return fe(e,"input")&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:X(function(){return[0]}),last:X(function(e,t){return[t-
1]}),eq:X(function(e,t,n){return[n<0?n+t:n]}),even:X(function(e,t){for(var n=0;n<t;n+=2)e.push(n);return e}),odd:X(function(e,t){for(var n=1;n<t;n+=2)e.push(n);return e}),lt:X(function(e,t,n){var r;for(r=n<0?n+t:t<n?t:n;0<=--r;)e.push(r);return e}),gt:X(function(e,t,n){for(var r=n<0?n+t:n;++r<t;)e.push(r);return e})}}).pseudos.nth=b.pseudos.eq,{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})b.pseudos[e]=B(e);for(e in{submit:!0,reset:!0})b.pseudos[e]=_(e);function G(){}function Y(e,t){var n,r,
i,o,a,s,u,l=c[e+" "];if(l)return t?0:l.slice(0);a=e,s=[],u=b.preFilter;while(a){for(o in n&&!(r=y.exec(a))||(r&&(a=a.slice(r[0].length)||a),s.push(i=[])),n=!1,(r=m.exec(a))&&(n=r.shift(),i.push({value:n,type:r[0].replace(ve," ")}),a=a.slice(n.length)),b.filter)!(r=D[o].exec(a))||u[o]&&!(r=u[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),a=a.slice(n.length));if(!n)break}return t?a.length:a?I.error(e):c(e,s).slice(0)}function Q(e){for(var t=0,n=e.length,r="";t<n;t++)r+=e[t].value;return r}
function J(a,e,t){var s=e.dir,u=e.next,l=u||s,c=t&&"parentNode"===l,f=n++;return e.first?function(e,t,n){while(e=e[s])if(1===e.nodeType||c)return a(e,t,n);return!1}:function(e,t,n){var r,i,o=[E,f];if(n)while(e=e[s]){if((1===e.nodeType||c)&&a(e,t,n))return!0}else while(e=e[s])if(1===e.nodeType||c)if(i=e[S]||(e[S]={}),u&&fe(e,u))e=e[s]||e;else{if((r=i[l])&&r[0]===E&&r[1]===f)return o[2]=r[2];if((i[l]=o)[2]=a(e,t,n))return!0}return!1}}function K(i){return 1<i.length?function(e,t,n){var r=i.length;while(r--)if(!i[r](e,
t,n))return!1;return!0}:i[0]}function Z(e,t,n,r,i){for(var o,a=[],s=0,u=e.length,l=null!=t;s<u;s++)(o=e[s])&&(n&&!n(o,r,i)||(a.push(o),l&&t.push(s)));return a}function ee(d,h,g,v,y,e){return v&&!v[S]&&(v=ee(v)),y&&!y[S]&&(y=ee(y,e)),F(function(e,t,n,r){var i,o,a,s,u=[],l=[],c=t.length,f=e||function(e,t,n){for(var r=0,i=t.length;r<i;r++)I(e,t[r],n);return n}(h||"*",n.nodeType?[n]:n,[]),p=!d||!e&&h?f:Z(f,u,d,n,r);if(g?g(p,s=y||(e?d:c||v)?[]:t,n,r):s=p,v){i=Z(s,l),v(i,[],n,r),o=i.length;while(o--)(a=
i[o])&&(s[l[o]]=!(p[l[o]]=a))}if(e){if(y||d){if(y){i=[],o=s.length;while(o--)(a=s[o])&&i.push(p[o]=a);y(null,s=[],i,r)}o=s.length;while(o--)(a=s[o])&&-1<(i=y?se.call(e,a):u[o])&&(e[i]=!(t[i]=a))}}else s=Z(s===t?s.splice(c,s.length):s),y?y(null,t,s,r):k.apply(t,s)})}function te(e){for(var i,t,n,r=e.length,o=b.relative[e[0].type],a=o||b.relative[" "],s=o?1:0,u=J(function(e){return e===i},a,!0),l=J(function(e){return-1<se.call(i,e)},a,!0),c=[function(e,t,n){var r=!o&&(n||t!=w)||((i=t).nodeType?u(e,t,
n):l(e,t,n));return i=null,r}];s<r;s++)if(t=b.relative[e[s].type])c=[J(K(c),t)];else{if((t=b.filter[e[s].type].apply(null,e[s].matches))[S]){for(n=++s;n<r;n++)if(b.relative[e[n].type])break;return ee(1<s&&K(c),1<s&&Q(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(ve,"$1"),t,s<n&&te(e.slice(s,n)),n<r&&te(e=e.slice(n)),n<r&&Q(e))}c.push(t)}return K(c)}function ne(e,t){var n,v,y,m,x,r,i=[],o=[],a=u[e+" "];if(!a){t||(t=Y(e)),n=t.length;while(n--)(a=te(t[n]))[S]?i.push(a):o.push(a);(a=
u(e,(v=o,m=0<(y=i).length,x=0<v.length,r=function(e,t,n,r,i){var o,a,s,u=0,l="0",c=e&&[],f=[],p=w,d=e||x&&b.find.TAG("*",i),h=E+=null==p?1:Math.random()||.1,g=d.length;for(i&&(w=t==T||t||i);l!==g&&null!=(o=d[l]);l++){if(x&&o){a=0,t||o.ownerDocument==T||(V(o),n=!C);while(s=v[a++])if(s(o,t||T,n)){k.call(r,o);break}i&&(E=h)}m&&((o=!s&&o)&&u--,e&&c.push(o))}if(u+=l,m&&l!==u){a=0;while(s=y[a++])s(c,f,t,n);if(e){if(0<u)while(l--)c[l]||f[l]||(f[l]=pe.call(r));f=Z(f)}k.apply(r,f),i&&!e&&0<f.length&&1<u+y.length&&
ce.uniqueSort(r)}return i&&(E=h,w=p),c},m?F(r):r))).selector=e}return a}function re(e,t,n,r){var i,o,a,s,u,l="function"==typeof e&&e,c=!r&&Y(e=l.selector||e);if(n=n||[],1===c.length){if(2<(o=c[0]=c[0].slice(0)).length&&"ID"===(a=o[0]).type&&9===t.nodeType&&C&&b.relative[o[1].type]){if(!(t=(b.find.ID(a.matches[0].replace(O,P),t)||[])[0]))return n;l&&(t=t.parentNode),e=e.slice(o.shift().value.length)}i=D.needsContext.test(e)?0:o.length;while(i--){if(a=o[i],b.relative[s=a.type])break;if((u=b.find[s])&&
(r=u(a.matches[0].replace(O,P),H.test(o[0].type)&&U(t.parentNode)||t))){if(o.splice(i,1),!(e=r.length&&Q(o)))return k.apply(n,r),n;break}}}return(l||ne(e,c))(r,t,!C,n,!t||H.test(e)&&U(t.parentNode)||t),n}G.prototype=b.filters=b.pseudos,b.setFilters=new G,le.sortStable=S.split("").sort(l).join("")===S,V(),le.sortDetached=$(function(e){return 1&e.compareDocumentPosition(T.createElement("fieldset"))}),ce.find=I,ce.expr[":"]=ce.expr.pseudos,ce.unique=ce.uniqueSort,I.compile=ne,I.select=re,I.setDocument=
V,I.tokenize=Y,I.escape=ce.escapeSelector,I.getText=ce.text,I.isXML=ce.isXMLDoc,I.selectors=ce.expr,I.support=ce.support,I.uniqueSort=ce.uniqueSort}();var d=function(e,t,n){var r=[],i=void 0!==n;while((e=e[t])&&9!==e.nodeType)if(1===e.nodeType){if(i&&ce(e).is(n))break;r.push(e)}return r},h=function(e,t){for(var n=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n},b=ce.expr.match.needsContext,w=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function T(e,n,r){return v(n)?
ce.grep(e,function(e,t){return!!n.call(e,t,e)!==r}):n.nodeType?ce.grep(e,function(e){return e===n!==r}):"string"!=typeof n?ce.grep(e,function(e){return-1<se.call(n,e)!==r}):ce.filter(n,e,r)}ce.filter=function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?ce.find.matchesSelector(r,e)?[r]:[]:ce.find.matches(e,ce.grep(t,function(e){return 1===e.nodeType}))},ce.fn.extend({find:function(e){var t,n,r=this.length,i=this;if("string"!=typeof e)return this.pushStack(ce(e).filter(function(){for(t=
0;t<r;t++)if(ce.contains(i[t],this))return!0}));for(n=this.pushStack([]),t=0;t<r;t++)ce.find(e,i[t],n);return 1<r?ce.uniqueSort(n):n},filter:function(e){return this.pushStack(T(this,e||[],!1))},not:function(e){return this.pushStack(T(this,e||[],!0))},is:function(e){return!!T(this,"string"==typeof e&&b.test(e)?ce(e):e||[],!1).length}});var k,S=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/;(ce.fn.init=function(e,t,n){var r,i;if(!e)return this;if(n=n||k,"string"==typeof e){if(!(r="<"===e[0]&&">"===e[e.length-
1]&&3<=e.length?[null,e,null]:S.exec(e))||!r[1]&&t)return!t||t.jquery?(t||n).find(e):this.constructor(t).find(e);if(r[1]){if(t=t instanceof ce?t[0]:t,ce.merge(this,ce.parseHTML(r[1],t&&t.nodeType?t.ownerDocument||t:C,!0)),w.test(r[1])&&ce.isPlainObject(t))for(r in t)v(this[r])?this[r](t[r]):this.attr(r,t[r]);return this}return(i=C.getElementById(r[2]))&&(this[0]=i,this.length=1),this}return e.nodeType?(this[0]=e,this.length=1,this):v(e)?void 0!==n.ready?n.ready(e):e(ce):ce.makeArray(e,this)}).prototype=
ce.fn,k=ce(C);var E=/^(?:parents|prev(?:Until|All))/,j={children:!0,contents:!0,next:!0,prev:!0};function A(e,t){while((e=e[t])&&1!==e.nodeType);return e}ce.fn.extend({has:function(e){var t=ce(e,this),n=t.length;return this.filter(function(){for(var e=0;e<n;e++)if(ce.contains(this,t[e]))return!0})},closest:function(e,t){var n,r=0,i=this.length,o=[],a="string"!=typeof e&&ce(e);if(!b.test(e))for(;r<i;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(n.nodeType<11&&(a?-1<a.index(n):1===n.nodeType&&ce.find.matchesSelector(n,
e))){o.push(n);break}return this.pushStack(1<o.length?ce.uniqueSort(o):o)},index:function(e){return e?"string"==typeof e?se.call(ce(e),this[0]):se.call(this,e.jquery?e[0]:e):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(ce.uniqueSort(ce.merge(this.get(),ce(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),ce.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return d(e,
"parentNode")},parentsUntil:function(e,t,n){return d(e,"parentNode",n)},next:function(e){return A(e,"nextSibling")},prev:function(e){return A(e,"previousSibling")},nextAll:function(e){return d(e,"nextSibling")},prevAll:function(e){return d(e,"previousSibling")},nextUntil:function(e,t,n){return d(e,"nextSibling",n)},prevUntil:function(e,t,n){return d(e,"previousSibling",n)},siblings:function(e){return h((e.parentNode||{}).firstChild,e)},children:function(e){return h(e.firstChild)},contents:function(e){return null!=
e.contentDocument&&r(e.contentDocument)?e.contentDocument:(fe(e,"template")&&(e=e.content||e),ce.merge([],e.childNodes))}},function(r,i){ce.fn[r]=function(e,t){var n=ce.map(this,i,e);return"Until"!==r.slice(-5)&&(t=e),t&&"string"==typeof t&&(n=ce.filter(t,n)),1<this.length&&(j[r]||ce.uniqueSort(n),E.test(r)&&n.reverse()),this.pushStack(n)}});var D=/[^\x20\t\r\n\f]+/g;function N(e){return e}function q(e){throw e;}function L(e,t,n,r){var i;try{e&&v(i=e.promise)?i.call(e).done(t).fail(n):e&&v(i=e.then)?
i.call(e,t,n):t.apply(void 0,[e].slice(r))}catch(e){n.apply(void 0,[e])}}ce.Callbacks=function(r){var e,n;r="string"==typeof r?(e=r,n={},ce.each(e.match(D)||[],function(e,t){n[t]=!0}),n):ce.extend({},r);var i,t,o,a,s=[],u=[],l=-1,c=function(){for(a=a||r.once,o=i=!0;u.length;l=-1){t=u.shift();while(++l<s.length)!1===s[l].apply(t[0],t[1])&&r.stopOnFalse&&(l=s.length,t=!1)}r.memory||(t=!1),i=!1,a&&(s=t?[]:"")},f={add:function(){return s&&(t&&!i&&(l=s.length-1,u.push(t)),function n(e){ce.each(e,function(e,
t){v(t)?r.unique&&f.has(t)||s.push(t):t&&t.length&&"string"!==x(t)&&n(t)})}(arguments),t&&!i&&c()),this},remove:function(){return ce.each(arguments,function(e,t){var n;while(-1<(n=ce.inArray(t,s,n)))s.splice(n,1),n<=l&&l--}),this},has:function(e){return e?-1<ce.inArray(e,s):0<s.length},empty:function(){return s&&(s=[]),this},disable:function(){return a=u=[],s=t="",this},disabled:function(){return!s},lock:function(){return a=u=[],t||i||(s=t=""),this},locked:function(){return!!a},fireWith:function(e,
t){return a||(t=[e,(t=t||[]).slice?t.slice():t],u.push(t),i||c()),this},fire:function(){return f.fireWith(this,arguments),this},fired:function(){return!!o}};return f},ce.extend({Deferred:function(e){var o=[["notify","progress",ce.Callbacks("memory"),ce.Callbacks("memory"),2],["resolve","done",ce.Callbacks("once memory"),ce.Callbacks("once memory"),0,"resolved"],["reject","fail",ce.Callbacks("once memory"),ce.Callbacks("once memory"),1,"rejected"]],i="pending",a={state:function(){return i},always:function(){return s.done(arguments).fail(arguments),
this},"catch":function(e){return a.then(null,e)},pipe:function(){var i=arguments;return ce.Deferred(function(r){ce.each(o,function(e,t){var n=v(i[t[4]])&&i[t[4]];s[t[1]](function(){var e=n&&n.apply(this,arguments);e&&v(e.promise)?e.promise().progress(r.notify).done(r.resolve).fail(r.reject):r[t[0]+"With"](this,n?[e]:arguments)})}),i=null}).promise()},then:function(t,n,r){var u=0;function l(i,o,a,s){return function(){var n=this,r=arguments,e=function(){var e,t;if(!(i<u)){if((e=a.apply(n,r))===o.promise())throw new TypeError("Thenable self-resolution");
t=e&&("object"==typeof e||"function"==typeof e)&&e.then,v(t)?s?t.call(e,l(u,o,N,s),l(u,o,q,s)):(u++,t.call(e,l(u,o,N,s),l(u,o,q,s),l(u,o,N,o.notifyWith))):(a!==N&&(n=void 0,r=[e]),(s||o.resolveWith)(n,r))}},t=s?e:function(){try{e()}catch(e){ce.Deferred.exceptionHook&&ce.Deferred.exceptionHook(e,t.error),u<=i+1&&(a!==q&&(n=void 0,r=[e]),o.rejectWith(n,r))}};i?t():(ce.Deferred.getErrorHook?t.error=ce.Deferred.getErrorHook():ce.Deferred.getStackHook&&(t.error=ce.Deferred.getStackHook()),ie.setTimeout(t))}}
return ce.Deferred(function(e){o[0][3].add(l(0,e,v(r)?r:N,e.notifyWith)),o[1][3].add(l(0,e,v(t)?t:N)),o[2][3].add(l(0,e,v(n)?n:q))}).promise()},promise:function(e){return null!=e?ce.extend(e,a):a}},s={};return ce.each(o,function(e,t){var n=t[2],r=t[5];a[t[1]]=n.add,r&&n.add(function(){i=r},o[3-e][2].disable,o[3-e][3].disable,o[0][2].lock,o[0][3].lock),n.add(t[3].fire),s[t[0]]=function(){return s[t[0]+"With"](this===s?void 0:this,arguments),this},s[t[0]+"With"]=n.fireWith}),a.promise(s),e&&e.call(s,
s),s},when:function(e){var n=arguments.length,t=n,r=Array(t),i=ae.call(arguments),o=ce.Deferred(),a=function(t){return function(e){r[t]=this,i[t]=1<arguments.length?ae.call(arguments):e,--n||o.resolveWith(r,i)}};if(n<=1&&(L(e,o.done(a(t)).resolve,o.reject,!n),"pending"===o.state()||v(i[t]&&i[t].then)))return o.then();while(t--)L(i[t],a(t),o.reject);return o.promise()}});var H=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;ce.Deferred.exceptionHook=function(e,t){ie.console&&ie.console.warn&&
e&&H.test(e.name)&&ie.console.warn("jQuery.Deferred exception: "+e.message,e.stack,t)},ce.readyException=function(e){ie.setTimeout(function(){throw e;})};var O=ce.Deferred();function P(){C.removeEventListener("DOMContentLoaded",P),ie.removeEventListener("load",P),ce.ready()}ce.fn.ready=function(e){return O.then(e)["catch"](function(e){ce.readyException(e)}),this},ce.extend({isReady:!1,readyWait:1,ready:function(e){(!0===e?--ce.readyWait:ce.isReady)||(ce.isReady=!0)!==e&&0<--ce.readyWait||O.resolveWith(C,
[ce])}}),ce.ready.then=O.then,"complete"===C.readyState||"loading"!==C.readyState&&!C.documentElement.doScroll?ie.setTimeout(ce.ready):(C.addEventListener("DOMContentLoaded",P),ie.addEventListener("load",P));var M=function(e,t,n,r,i,o,a){var s=0,u=e.length,l=null==n;if("object"===x(n))for(s in i=!0,n)M(e,t,s,n[s],!0,o,a);else if(void 0!==r&&(i=!0,v(r)||(a=!0),l&&(a?(t.call(e,r),t=null):(l=t,t=function(e,t,n){return l.call(ce(e),n)})),t))for(;s<u;s++)t(e[s],n,a?r:r.call(e[s],s,t(e[s],n)));return i?
e:l?t.call(e):u?t(e[0],n):o},R=/^-ms-/,I=/-([a-z])/g;function W(e,t){return t.toUpperCase()}function F(e){return e.replace(R,"ms-").replace(I,W)}var $=function(e){return 1===e.nodeType||9===e.nodeType||!+e.nodeType};function B(){this.expando=ce.expando+B.uid++}B.uid=1,B.prototype={cache:function(e){var t=e[this.expando];return t||(t={},$(e)&&(e.nodeType?e[this.expando]=t:Object.defineProperty(e,this.expando,{value:t,configurable:!0}))),t},set:function(e,t,n){var r,i=this.cache(e);if("string"==typeof t)i[F(t)]=
n;else for(r in t)i[F(r)]=t[r];return i},get:function(e,t){return void 0===t?this.cache(e):e[this.expando]&&e[this.expando][F(t)]},access:function(e,t,n){return void 0===t||t&&"string"==typeof t&&void 0===n?this.get(e,t):(this.set(e,t,n),void 0!==n?n:t)},remove:function(e,t){var n,r=e[this.expando];if(void 0!==r){if(void 0!==t){n=(t=Array.isArray(t)?t.map(F):(t=F(t))in r?[t]:t.match(D)||[]).length;while(n--)delete r[t[n]]}(void 0===t||ce.isEmptyObject(r))&&(e.nodeType?e[this.expando]=void 0:delete e[this.expando])}},
hasData:function(e){var t=e[this.expando];return void 0!==t&&!ce.isEmptyObject(t)}};var _=new B,z=new B,X=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,U=/[A-Z]/g;function V(e,t,n){var r,i;if(void 0===n&&1===e.nodeType)if(r="data-"+t.replace(U,"-$&").toLowerCase(),"string"==typeof(n=e.getAttribute(r))){try{n="true"===(i=n)||"false"!==i&&("null"===i?null:i===+i+""?+i:X.test(i)?JSON.parse(i):i)}catch(e){}z.set(e,t,n)}else n=void 0;return n}ce.extend({hasData:function(e){return z.hasData(e)||_.hasData(e)},data:function(e,
t,n){return z.access(e,t,n)},removeData:function(e,t){z.remove(e,t)},_data:function(e,t,n){return _.access(e,t,n)},_removeData:function(e,t){_.remove(e,t)}}),ce.fn.extend({data:function(n,e){var t,r,i,o=this[0],a=o&&o.attributes;if(void 0===n){if(this.length&&(i=z.get(o),1===o.nodeType&&!_.get(o,"hasDataAttrs"))){t=a.length;while(t--)a[t]&&0===(r=a[t].name).indexOf("data-")&&(r=F(r.slice(5)),V(o,r,i[r]));_.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof n?this.each(function(){z.set(this,
n)}):M(this,function(e){var t;if(o&&void 0===e)return void 0!==(t=z.get(o,n))?t:void 0!==(t=V(o,n))?t:void 0;this.each(function(){z.set(this,n,e)})},null,e,1<arguments.length,null,!0)},removeData:function(e){return this.each(function(){z.remove(this,e)})}}),ce.extend({queue:function(e,t,n){var r;if(e)return t=(t||"fx")+"queue",r=_.get(e,t),n&&(!r||Array.isArray(n)?r=_.access(e,t,ce.makeArray(n)):r.push(n)),r||[]},dequeue:function(e,t){t=t||"fx";var n=ce.queue(e,t),r=n.length,i=n.shift(),o=ce._queueHooks(e,
t);"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete o.stop,i.call(e,function(){ce.dequeue(e,t)},o)),!r&&o&&o.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return _.get(e,n)||_.access(e,n,{empty:ce.Callbacks("once memory").add(function(){_.remove(e,[t+"queue",n])})})}}),ce.fn.extend({queue:function(t,n){var e=2;return"string"!=typeof t&&(n=t,t="fx",e--),arguments.length<e?ce.queue(this[0],t):void 0===n?this:this.each(function(){var e=ce.queue(this,t,n);
ce._queueHooks(this,t),"fx"===t&&"inprogress"!==e[0]&&ce.dequeue(this,t)})},dequeue:function(e){return this.each(function(){ce.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var n,r=1,i=ce.Deferred(),o=this,a=this.length,s=function(){--r||i.resolveWith(o,[o])};"string"!=typeof e&&(t=e,e=void 0),e=e||"fx";while(a--)(n=_.get(o[a],e+"queueHooks"))&&n.empty&&(r++,n.empty.add(s));return s(),i.promise(t)}});var G=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,
Y=new RegExp("^(?:([+-])=|)("+G+")([a-z%]*)$","i"),Q=["Top","Right","Bottom","Left"],J=C.documentElement,K=function(e){return ce.contains(e.ownerDocument,e)},Z={composed:!0};J.getRootNode&&(K=function(e){return ce.contains(e.ownerDocument,e)||e.getRootNode(Z)===e.ownerDocument});var ee=function(e,t){return"none"===(e=t||e).style.display||""===e.style.display&&K(e)&&"none"===ce.css(e,"display")};function te(e,t,n,r){var i,o,a=20,s=r?function(){return r.cur()}:function(){return ce.css(e,t,"")},u=s(),
l=n&&n[3]||(ce.cssNumber[t]?"":"px"),c=e.nodeType&&(ce.cssNumber[t]||"px"!==l&&+u)&&Y.exec(ce.css(e,t));if(c&&c[3]!==l){u/=2,l=l||c[3],c=+u||1;while(a--)ce.style(e,t,c+l),(1-o)*(1-(o=s()/u||.5))<=0&&(a=0),c/=o;c*=2,ce.style(e,t,c+l),n=n||[]}return n&&(c=+c||+u||0,i=n[1]?c+(n[1]+1)*n[2]:+n[2],r&&(r.unit=l,r.start=c,r.end=i)),i}var ne={};function re(e,t){for(var n,r,i,o,a,s,u,l=[],c=0,f=e.length;c<f;c++)(r=e[c]).style&&(n=r.style.display,t?("none"===n&&(l[c]=_.get(r,"display")||null,l[c]||(r.style.display=
"")),""===r.style.display&&ee(r)&&(l[c]=(u=a=o=void 0,a=(i=r).ownerDocument,s=i.nodeName,(u=ne[s])||(o=a.body.appendChild(a.createElement(s)),u=ce.css(o,"display"),o.parentNode.removeChild(o),"none"===u&&(u="block"),ne[s]=u)))):"none"!==n&&(l[c]="none",_.set(r,"display",n)));for(c=0;c<f;c++)null!=l[c]&&(e[c].style.display=l[c]);return e}ce.fn.extend({show:function(){return re(this,!0)},hide:function(){return re(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){ee(this)?
ce(this).show():ce(this).hide()})}});var xe,be,we=/^(?:checkbox|radio)$/i,Te=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Ce=/^$|^module$|\/(?:java|ecma)script/i;xe=C.createDocumentFragment().appendChild(C.createElement("div")),(be=C.createElement("input")).setAttribute("type","radio"),be.setAttribute("checked","checked"),be.setAttribute("name","t"),xe.appendChild(be),le.checkClone=xe.cloneNode(!0).cloneNode(!0).lastChild.checked,xe.innerHTML="<textarea>x</textarea>",le.noCloneChecked=!!xe.cloneNode(!0).lastChild.defaultValue,
xe.innerHTML="<option></option>",le.option=!!xe.lastChild;var ke={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};function Se(e,t){var n;return n="undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t||"*"):"undefined"!=typeof e.querySelectorAll?e.querySelectorAll(t||"*"):[],void 0===t||t&&fe(e,t)?ce.merge([e],n):n}function Ee(e,t){for(var n=
0,r=e.length;n<r;n++)_.set(e[n],"globalEval",!t||_.get(t[n],"globalEval"))}ke.tbody=ke.tfoot=ke.colgroup=ke.caption=ke.thead,ke.th=ke.td,le.option||(ke.optgroup=ke.option=[1,"<select multiple='multiple'>","</select>"]);var je=/<|&#?\w+;/;function Ae(e,t,n,r,i){for(var o,a,s,u,l,c,f=t.createDocumentFragment(),p=[],d=0,h=e.length;d<h;d++)if((o=e[d])||0===o)if("object"===x(o))ce.merge(p,o.nodeType?[o]:o);else if(je.test(o)){a=a||f.appendChild(t.createElement("div")),s=(Te.exec(o)||["",""])[1].toLowerCase(),
u=ke[s]||ke._default,a.innerHTML=u[1]+ce.htmlPrefilter(o)+u[2],c=u[0];while(c--)a=a.lastChild;ce.merge(p,a.childNodes),(a=f.firstChild).textContent=""}else p.push(t.createTextNode(o));f.textContent="",d=0;while(o=p[d++])if(r&&-1<ce.inArray(o,r))i&&i.push(o);else if(l=K(o),a=Se(f.appendChild(o),"script"),l&&Ee(a),n){c=0;while(o=a[c++])Ce.test(o.type||"")&&n.push(o)}return f}var De=/^([^.]*)(?:\.(.+)|)/;function Ne(){return!0}function qe(){return!1}function Le(e,t,n,r,i,o){var a,s;if("object"==typeof t){for(s in"string"!=
typeof n&&(r=r||n,n=void 0),t)Le(e,s,n,r,t[s],o);return e}if(null==r&&null==i?(i=n,r=n=void 0):null==i&&("string"==typeof n?(i=r,r=void 0):(i=r,r=n,n=void 0)),!1===i)i=qe;else if(!i)return e;return 1===o&&(a=i,(i=function(e){return ce().off(e),a.apply(this,arguments)}).guid=a.guid||(a.guid=ce.guid++)),e.each(function(){ce.event.add(this,t,i,r,n)})}function He(e,r,t){t?(_.set(e,r,!1),ce.event.add(e,r,{namespace:!1,handler:function(e){var t,n=_.get(this,r);if(1&e.isTrigger&&this[r])if(n)(ce.event.special[r]||
{}).delegateType&&e.stopPropagation();else{if(n=ae.call(arguments),_.set(this,r,n),this[r](),t=_.get(this,r),_.set(this,r,!1),n!==t)return e.stopImmediatePropagation(),e.preventDefault(),t}else n&&(_.set(this,r,ce.event.trigger(n[0],n.slice(1),this)),e.stopPropagation(),e.isImmediatePropagationStopped=Ne)}})):void 0===_.get(e,r)&&ce.event.add(e,r,Ne)}ce.event={global:{},add:function(t,e,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=_.get(t);if($(t)){n.handler&&(n=(o=n).handler,i=o.selector),i&&ce.find.matchesSelector(J,
i),n.guid||(n.guid=ce.guid++),(u=v.events)||(u=v.events=Object.create(null)),(a=v.handle)||(a=v.handle=function(e){return"undefined"!=typeof ce&&ce.event.triggered!==e.type?ce.event.dispatch.apply(t,arguments):void 0}),l=(e=(e||"").match(D)||[""]).length;while(l--)d=g=(s=De.exec(e[l])||[])[1],h=(s[2]||"").split(".").sort(),d&&(f=ce.event.special[d]||{},d=(i?f.delegateType:f.bindType)||d,f=ce.event.special[d]||{},c=ce.extend({type:d,origType:g,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&
ce.expr.match.needsContext.test(i),namespace:h.join(".")},o),(p=u[d])||((p=u[d]=[]).delegateCount=0,f.setup&&!1!==f.setup.call(t,r,h,a)||t.addEventListener&&t.addEventListener(d,a)),f.add&&(f.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),ce.event.global[d]=!0)}},remove:function(e,t,n,r,i){var o,a,s,u,l,c,f,p,d,h,g,v=_.hasData(e)&&_.get(e);if(v&&(u=v.events)){l=(t=(t||"").match(D)||[""]).length;while(l--)if(d=g=(s=De.exec(t[l])||[])[1],h=(s[2]||
"").split(".").sort(),d){f=ce.event.special[d]||{},p=u[d=(r?f.delegateType:f.bindType)||d]||[],s=s[2]&&new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=o=p.length;while(o--)c=p[o],!i&&g!==c.origType||n&&n.guid!==c.guid||s&&!s.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,f.remove&&f.remove.call(e,c));a&&!p.length&&(f.teardown&&!1!==f.teardown.call(e,h,v.handle)||ce.removeEvent(e,d,v.handle),delete u[d])}else for(d in u)ce.event.remove(e,
d+t[l],n,r,!0);ce.isEmptyObject(u)&&_.remove(e,"handle events")}},dispatch:function(e){var t,n,r,i,o,a,s=new Array(arguments.length),u=ce.event.fix(e),l=(_.get(this,"events")||Object.create(null))[u.type]||[],c=ce.event.special[u.type]||{};for(s[0]=u,t=1;t<arguments.length;t++)s[t]=arguments[t];if(u.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,u)){a=ce.event.handlers.call(this,u,l),t=0;while((i=a[t++])&&!u.isPropagationStopped()){u.currentTarget=i.elem,n=0;while((o=i.handlers[n++])&&
!u.isImmediatePropagationStopped())u.rnamespace&&!1!==o.namespace&&!u.rnamespace.test(o.namespace)||(u.handleObj=o,u.data=o.data,void 0!==(r=((ce.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,s))&&!1===(u.result=r)&&(u.preventDefault(),u.stopPropagation()))}return c.postDispatch&&c.postDispatch.call(this,u),u.result}},handlers:function(e,t){var n,r,i,o,a,s=[],u=t.delegateCount,l=e.target;if(u&&l.nodeType&&!("click"===e.type&&1<=e.button))for(;l!==this;l=l.parentNode||this)if(1===
l.nodeType&&("click"!==e.type||!0!==l.disabled)){for(o=[],a={},n=0;n<u;n++)void 0===a[i=(r=t[n]).selector+" "]&&(a[i]=r.needsContext?-1<ce(i,this).index(l):ce.find(i,this,null,[l]).length),a[i]&&o.push(r);o.length&&s.push({elem:l,handlers:o})}return l=this,u<t.length&&s.push({elem:l,handlers:t.slice(u)}),s},addProp:function(t,e){Object.defineProperty(ce.Event.prototype,t,{enumerable:!0,configurable:!0,get:v(e)?function(){if(this.originalEvent)return e(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[t]},
set:function(e){Object.defineProperty(this,t,{enumerable:!0,configurable:!0,writable:!0,value:e})}})},fix:function(e){return e[ce.expando]?e:new ce.Event(e)},special:{load:{noBubble:!0},click:{setup:function(e){var t=this||e;return we.test(t.type)&&t.click&&fe(t,"input")&&He(t,"click",!0),!1},trigger:function(e){var t=this||e;return we.test(t.type)&&t.click&&fe(t,"input")&&He(t,"click"),!0},_default:function(e){var t=e.target;return we.test(t.type)&&t.click&&fe(t,"input")&&_.get(t,"click")||fe(t,
"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&e.originalEvent&&(e.originalEvent.returnValue=e.result)}}}},ce.removeEvent=function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n)},ce.Event=function(e,t){if(!(this instanceof ce.Event))return new ce.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&!1===e.returnValue?Ne:qe,this.target=e.target&&3===e.target.nodeType?e.target.parentNode:e.target,
this.currentTarget=e.currentTarget,this.relatedTarget=e.relatedTarget):this.type=e,t&&ce.extend(this,t),this.timeStamp=e&&e.timeStamp||Date.now(),this[ce.expando]=!0},ce.Event.prototype={constructor:ce.Event,isDefaultPrevented:qe,isPropagationStopped:qe,isImmediatePropagationStopped:qe,isSimulated:!1,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=Ne,e&&!this.isSimulated&&e.preventDefault()},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=Ne,
e&&!this.isSimulated&&e.stopPropagation()},stopImmediatePropagation:function(){var e=this.originalEvent;this.isImmediatePropagationStopped=Ne,e&&!this.isSimulated&&e.stopImmediatePropagation(),this.stopPropagation()}},ce.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,"char":!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,
screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},ce.event.addProp),ce.each({focus:"focusin",blur:"focusout"},function(r,i){function o(e){if(C.documentMode){var t=_.get(this,"handle"),n=ce.event.fix(e);n.type="focusin"===e.type?"focus":"blur",n.isSimulated=!0,t(e),n.target===n.currentTarget&&t(n)}else ce.event.simulate(i,e.target,ce.event.fix(e))}ce.event.special[r]={setup:function(){var e;if(He(this,r,!0),!C.documentMode)return!1;(e=_.get(this,i))||this.addEventListener(i,
o),_.set(this,i,(e||0)+1)},trigger:function(){return He(this,r),!0},teardown:function(){var e;if(!C.documentMode)return!1;(e=_.get(this,i)-1)?_.set(this,i,e):(this.removeEventListener(i,o),_.remove(this,i))},_default:function(e){return _.get(e.target,r)},delegateType:i},ce.event.special[i]={setup:function(){var e=this.ownerDocument||this.document||this,t=C.documentMode?this:e,n=_.get(t,i);n||(C.documentMode?this.addEventListener(i,o):e.addEventListener(r,o,!0)),_.set(t,i,(n||0)+1)},teardown:function(){var e=
this.ownerDocument||this.document||this,t=C.documentMode?this:e,n=_.get(t,i)-1;n?_.set(t,i,n):(C.documentMode?this.removeEventListener(i,o):e.removeEventListener(r,o,!0),_.remove(t,i))}}}),ce.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(e,i){ce.event.special[e]={delegateType:i,bindType:i,handle:function(e){var t,n=e.relatedTarget,r=e.handleObj;return n&&(n===this||ce.contains(this,n))||(e.type=r.origType,t=r.handler.apply(this,arguments),
e.type=i),t}}}),ce.fn.extend({on:function(e,t,n,r){return Le(this,e,t,n,r)},one:function(e,t,n,r){return Le(this,e,t,n,r,1)},off:function(e,t,n){var r,i;if(e&&e.preventDefault&&e.handleObj)return r=e.handleObj,ce(e.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof e){for(i in e)this.off(i,t,e[i]);return this}return!1!==t&&"function"!=typeof t||(n=t,t=void 0),!1===n&&(n=qe),this.each(function(){ce.event.remove(this,e,n,t)})}});var Oe=
/<script|<style|<link/i,Pe=/checked\s*(?:[^=]|=\s*.checked.)/i,Me=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function Re(e,t){return fe(e,"table")&&fe(11!==t.nodeType?t:t.firstChild,"tr")&&ce(e).children("tbody")[0]||e}function Ie(e){return e.type=(null!==e.getAttribute("type"))+"/"+e.type,e}function We(e){return"true/"===(e.type||"").slice(0,5)?e.type=e.type.slice(5):e.removeAttribute("type"),e}function Fe(e,t){var n,r,i,o,a,s;if(1===t.nodeType){if(_.hasData(e)&&(s=_.get(e).events))for(i in _.remove(t,"handle events"),
s)for(n=0,r=s[i].length;n<r;n++)ce.event.add(t,i,s[i][n]);z.hasData(e)&&(o=z.access(e),a=ce.extend({},o),z.set(t,a))}}function $e(n,r,i,o){r=g(r);var e,t,a,s,u,l,c=0,f=n.length,p=f-1,d=r[0],h=v(d);if(h||1<f&&"string"==typeof d&&!le.checkClone&&Pe.test(d))return n.each(function(e){var t=n.eq(e);h&&(r[0]=d.call(this,e,t.html())),$e(t,r,i,o)});if(f&&(t=(e=Ae(r,n[0].ownerDocument,!1,n,o)).firstChild,1===e.childNodes.length&&(e=t),t||o)){for(s=(a=ce.map(Se(e,"script"),Ie)).length;c<f;c++)u=e,c!==p&&(u=
ce.clone(u,!0,!0),s&&ce.merge(a,Se(u,"script"))),i.call(n[c],u,c);if(s)for(l=a[a.length-1].ownerDocument,ce.map(a,We),c=0;c<s;c++)u=a[c],Ce.test(u.type||"")&&!_.access(u,"globalEval")&&ce.contains(l,u)&&(u.src&&"module"!==(u.type||"").toLowerCase()?ce._evalUrl&&!u.noModule&&ce._evalUrl(u.src,{nonce:u.nonce||u.getAttribute("nonce")},l):m(u.textContent.replace(Me,""),u,l))}return n}function Be(e,t,n){for(var r,i=t?ce.filter(t,e):e,o=0;null!=(r=i[o]);o++)n||1!==r.nodeType||ce.cleanData(Se(r)),r.parentNode&&
(n&&K(r)&&Ee(Se(r,"script")),r.parentNode.removeChild(r));return e}ce.extend({htmlPrefilter:function(e){return e},clone:function(e,t,n){var r,i,o,a,s,u,l,c=e.cloneNode(!0),f=K(e);if(!(le.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||ce.isXMLDoc(e)))for(a=Se(c),r=0,i=(o=Se(e)).length;r<i;r++)s=o[r],u=a[r],void 0,"input"===(l=u.nodeName.toLowerCase())&&we.test(s.type)?u.checked=s.checked:"input"!==l&&"textarea"!==l||(u.defaultValue=s.defaultValue);if(t)if(n)for(o=o||Se(e),a=a||Se(c),r=0,i=o.length;r<
i;r++)Fe(o[r],a[r]);else Fe(e,c);return 0<(a=Se(c,"script")).length&&Ee(a,!f&&Se(e,"script")),c},cleanData:function(e){for(var t,n,r,i=ce.event.special,o=0;void 0!==(n=e[o]);o++)if($(n)){if(t=n[_.expando]){if(t.events)for(r in t.events)i[r]?ce.event.remove(n,r):ce.removeEvent(n,r,t.handle);n[_.expando]=void 0}n[z.expando]&&(n[z.expando]=void 0)}}}),ce.fn.extend({detach:function(e){return Be(this,e,!0)},remove:function(e){return Be(this,e)},text:function(e){return M(this,function(e){return void 0===
e?ce.text(this):this.empty().each(function(){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||(this.textContent=e)})},null,e,arguments.length)},append:function(){return $e(this,arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||Re(this,e).appendChild(e)})},prepend:function(){return $e(this,arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Re(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return $e(this,arguments,
function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return $e(this,arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},empty:function(){for(var e,t=0;null!=(e=this[t]);t++)1===e.nodeType&&(ce.cleanData(Se(e,!1)),e.textContent="");return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return ce.clone(this,e,t)})},html:function(e){return M(this,function(e){var t=this[0]||{},n=0,r=this.length;if(void 0===
e&&1===t.nodeType)return t.innerHTML;if("string"==typeof e&&!Oe.test(e)&&!ke[(Te.exec(e)||["",""])[1].toLowerCase()]){e=ce.htmlPrefilter(e);try{for(;n<r;n++)1===(t=this[n]||{}).nodeType&&(ce.cleanData(Se(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var n=[];return $e(this,arguments,function(e){var t=this.parentNode;ce.inArray(this,n)<0&&(ce.cleanData(Se(this)),t&&t.replaceChild(e,this))},n)}}),ce.each({appendTo:"append",prependTo:"prepend",
insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,a){ce.fn[e]=function(e){for(var t,n=[],r=ce(e),i=r.length-1,o=0;o<=i;o++)t=o===i?this:this.clone(!0),ce(r[o])[a](t),s.apply(n,t.get());return this.pushStack(n)}});var _e=new RegExp("^("+G+")(?!px)[a-z%]+$","i"),ze=/^--/,Xe=function(e){var t=e.ownerDocument.defaultView;return t&&t.opener||(t=ie),t.getComputedStyle(e)},Ue=function(e,t,n){var r,i,o={};for(i in t)o[i]=e.style[i],e.style[i]=t[i];for(i in r=n.call(e),t)e.style[i]=
o[i];return r},Ve=new RegExp(Q.join("|"),"i");function Ge(e,t,n){var r,i,o,a,s=ze.test(t),u=e.style;return(n=n||Xe(e))&&(a=n.getPropertyValue(t)||n[t],s&&a&&(a=a.replace(ve,"$1")||void 0),""!==a||K(e)||(a=ce.style(e,t)),!le.pixelBoxStyles()&&_e.test(a)&&Ve.test(t)&&(r=u.width,i=u.minWidth,o=u.maxWidth,u.minWidth=u.maxWidth=u.width=a,a=n.width,u.width=r,u.minWidth=i,u.maxWidth=o)),void 0!==a?a+"":a}function Ye(e,t){return{get:function(){if(!e())return(this.get=t).apply(this,arguments);delete this.get}}}
!function(){function e(){if(l){u.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",l.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",J.appendChild(u).appendChild(l);var e=ie.getComputedStyle(l);n="1%"!==e.top,s=12===t(e.marginLeft),l.style.right="60%",o=36===t(e.right),r=36===t(e.width),l.style.position="absolute",i=12===t(l.offsetWidth/3),J.removeChild(u),l=null}}function t(e){return Math.round(parseFloat(e))}
var n,r,i,o,a,s,u=C.createElement("div"),l=C.createElement("div");l.style&&(l.style.backgroundClip="content-box",l.cloneNode(!0).style.backgroundClip="",le.clearCloneStyle="content-box"===l.style.backgroundClip,ce.extend(le,{boxSizingReliable:function(){return e(),r},pixelBoxStyles:function(){return e(),o},pixelPosition:function(){return e(),n},reliableMarginLeft:function(){return e(),s},scrollboxSize:function(){return e(),i},reliableTrDimensions:function(){var e,t,n,r;return null==a&&(e=C.createElement("table"),
t=C.createElement("tr"),n=C.createElement("div"),e.style.cssText="position:absolute;left:-11111px;border-collapse:separate",t.style.cssText="box-sizing:content-box;border:1px solid",t.style.height="1px",n.style.height="9px",n.style.display="block",J.appendChild(e).appendChild(t).appendChild(n),r=ie.getComputedStyle(t),a=parseInt(r.height,10)+parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)===t.offsetHeight,J.removeChild(e)),a}}))}();var Qe=["Webkit","Moz","ms"],Je=C.createElement("div").style,
Ke={};function Ze(e){var t=ce.cssProps[e]||Ke[e];return t||(e in Je?e:Ke[e]=function(e){var t=e[0].toUpperCase()+e.slice(1),n=Qe.length;while(n--)if((e=Qe[n]+t)in Je)return e}(e)||e)}var et=/^(none|table(?!-c[ea]).+)/,tt={position:"absolute",visibility:"hidden",display:"block"},nt={letterSpacing:"0",fontWeight:"400"};function rt(e,t,n){var r=Y.exec(t);return r?Math.max(0,r[2]-(n||0))+(r[3]||"px"):t}function it(e,t,n,r,i,o){var a="width"===t?1:0,s=0,u=0,l=0;if(n===(r?"border":"content"))return 0;for(;a<
4;a+=2)"margin"===n&&(l+=ce.css(e,n+Q[a],!0,i)),r?("content"===n&&(u-=ce.css(e,"padding"+Q[a],!0,i)),"margin"!==n&&(u-=ce.css(e,"border"+Q[a]+"Width",!0,i))):(u+=ce.css(e,"padding"+Q[a],!0,i),"padding"!==n?u+=ce.css(e,"border"+Q[a]+"Width",!0,i):s+=ce.css(e,"border"+Q[a]+"Width",!0,i));return!r&&0<=o&&(u+=Math.max(0,Math.ceil(e["offset"+t[0].toUpperCase()+t.slice(1)]-o-u-s-.5))||0),u+l}function ot(e,t,n){var r=Xe(e),i=(!le.boxSizingReliable()||n)&&"border-box"===ce.css(e,"boxSizing",!1,r),o=i,a=Ge(e,
t,r),s="offset"+t[0].toUpperCase()+t.slice(1);if(_e.test(a)){if(!n)return a;a="auto"}return(!le.boxSizingReliable()&&i||!le.reliableTrDimensions()&&fe(e,"tr")||"auto"===a||!parseFloat(a)&&"inline"===ce.css(e,"display",!1,r))&&e.getClientRects().length&&(i="border-box"===ce.css(e,"boxSizing",!1,r),(o=s in e)&&(a=e[s])),(a=parseFloat(a)||0)+it(e,t,n||(i?"border":"content"),o,r,a)+"px"}function at(e,t,n,r,i){return new at.prototype.init(e,t,n,r,i)}ce.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=
Ge(e,"opacity");return""===n?"1":n}}}},cssNumber:{animationIterationCount:!0,aspectRatio:!0,borderImageSlice:!0,columnCount:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,scale:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeMiterlimit:!0,strokeOpacity:!0},cssProps:{},style:function(e,t,n,r){if(e&&3!==e.nodeType&&8!==e.nodeType&&
e.style){var i,o,a,s=F(t),u=ze.test(t),l=e.style;if(u||(t=Ze(s)),a=ce.cssHooks[t]||ce.cssHooks[s],void 0===n)return a&&"get"in a&&void 0!==(i=a.get(e,!1,r))?i:l[t];"string"===(o=typeof n)&&(i=Y.exec(n))&&i[1]&&(n=te(e,t,i),o="number"),null!=n&&n==n&&("number"!==o||u||(n+=i&&i[3]||(ce.cssNumber[s]?"":"px")),le.clearCloneStyle||""!==n||0!==t.indexOf("background")||(l[t]="inherit"),a&&"set"in a&&void 0===(n=a.set(e,n,r))||(u?l.setProperty(t,n):l[t]=n))}},css:function(e,t,n,r){var i,o,a,s=F(t);return ze.test(t)||
(t=Ze(s)),(a=ce.cssHooks[t]||ce.cssHooks[s])&&"get"in a&&(i=a.get(e,!0,n)),void 0===i&&(i=Ge(e,t,r)),"normal"===i&&t in nt&&(i=nt[t]),""===n||n?(o=parseFloat(i),!0===n||isFinite(o)?o||0:i):i}}),ce.each(["height","width"],function(e,u){ce.cssHooks[u]={get:function(e,t,n){if(t)return!et.test(ce.css(e,"display"))||e.getClientRects().length&&e.getBoundingClientRect().width?ot(e,u,n):Ue(e,tt,function(){return ot(e,u,n)})},set:function(e,t,n){var r,i=Xe(e),o=!le.scrollboxSize()&&"absolute"===i.position,
a=(o||n)&&"border-box"===ce.css(e,"boxSizing",!1,i),s=n?it(e,u,n,a,i):0;return a&&o&&(s-=Math.ceil(e["offset"+u[0].toUpperCase()+u.slice(1)]-parseFloat(i[u])-it(e,u,"border",!1,i)-.5)),s&&(r=Y.exec(t))&&"px"!==(r[3]||"px")&&(e.style[u]=t,t=ce.css(e,u)),rt(0,t,s)}}}),ce.cssHooks.marginLeft=Ye(le.reliableMarginLeft,function(e,t){if(t)return(parseFloat(Ge(e,"marginLeft"))||e.getBoundingClientRect().left-Ue(e,{marginLeft:0},function(){return e.getBoundingClientRect().left}))+"px"}),ce.each({margin:"",
padding:"",border:"Width"},function(i,o){ce.cssHooks[i+o]={expand:function(e){for(var t=0,n={},r="string"==typeof e?e.split(" "):[e];t<4;t++)n[i+Q[t]+o]=r[t]||r[t-2]||r[0];return n}},"margin"!==i&&(ce.cssHooks[i+o].set=rt)}),ce.fn.extend({css:function(e,t){return M(this,function(e,t,n){var r,i,o={},a=0;if(Array.isArray(t)){for(r=Xe(e),i=t.length;a<i;a++)o[t[a]]=ce.css(e,t[a],!1,r);return o}return void 0!==n?ce.style(e,t,n):ce.css(e,t)},e,t,1<arguments.length)}}),((ce.Tween=at).prototype={constructor:at,
init:function(e,t,n,r,i,o){this.elem=e,this.prop=n,this.easing=i||ce.easing._default,this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=o||(ce.cssNumber[n]?"":"px")},cur:function(){var e=at.propHooks[this.prop];return e&&e.get?e.get(this):at.propHooks._default.get(this)},run:function(e){var t,n=at.propHooks[this.prop];return this.options.duration?this.pos=t=ce.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,
this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):at.propHooks._default.set(this),this}}).init.prototype=at.prototype,(at.propHooks={_default:{get:function(e){var t;return 1!==e.elem.nodeType||null!=e.elem[e.prop]&&null==e.elem.style[e.prop]?e.elem[e.prop]:(t=ce.css(e.elem,e.prop,""))&&"auto"!==t?t:0},set:function(e){ce.fx.step[e.prop]?ce.fx.step[e.prop](e):1!==e.elem.nodeType||!ce.cssHooks[e.prop]&&null==e.elem.style[Ze(e.prop)]?e.elem[e.prop]=e.now:ce.style(e.elem,
e.prop,e.now+e.unit)}}}).scrollTop=at.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ce.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2},_default:"swing"},ce.fx=at.prototype.init,ce.fx.step={};var st,ut,lt,ct,ft=/^(?:toggle|show|hide)$/,pt=/queueHooks$/;function dt(){ut&&(!1===C.hidden&&ie.requestAnimationFrame?ie.requestAnimationFrame(dt):ie.setTimeout(dt,ce.fx.interval),ce.fx.tick())}function ht(){return ie.setTimeout(function(){st=
void 0}),st=Date.now()}function gt(e,t){var n,r=0,i={height:e};for(t=t?1:0;r<4;r+=2-t)i["margin"+(n=Q[r])]=i["padding"+n]=e;return t&&(i.opacity=i.width=e),i}function vt(e,t,n){for(var r,i=(yt.tweeners[t]||[]).concat(yt.tweeners["*"]),o=0,a=i.length;o<a;o++)if(r=i[o].call(n,t,e))return r}function yt(o,e,t){var n,a,r=0,i=yt.prefilters.length,s=ce.Deferred().always(function(){delete u.elem}),u=function(){if(a)return!1;for(var e=st||ht(),t=Math.max(0,l.startTime+l.duration-e),n=1-(t/l.duration||0),r=
0,i=l.tweens.length;r<i;r++)l.tweens[r].run(n);return s.notifyWith(o,[l,n,t]),n<1&&i?t:(i||s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l]),!1)},l=s.promise({elem:o,props:ce.extend({},e),opts:ce.extend(!0,{specialEasing:{},easing:ce.easing._default},t),originalProperties:e,originalOptions:t,startTime:st||ht(),duration:t.duration,tweens:[],createTween:function(e,t){var n=ce.Tween(o,l.opts,e,t,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(n),n},stop:function(e){var t=0,n=e?l.tweens.length:
0;if(a)return this;for(a=!0;t<n;t++)l.tweens[t].run(1);return e?(s.notifyWith(o,[l,1,0]),s.resolveWith(o,[l,e])):s.rejectWith(o,[l,e]),this}}),c=l.props;for(!function(e,t){var n,r,i,o,a;for(n in e)if(i=t[r=F(n)],o=e[n],Array.isArray(o)&&(i=o[1],o=e[n]=o[0]),n!==r&&(e[r]=o,delete e[n]),(a=ce.cssHooks[r])&&"expand"in a)for(n in o=a.expand(o),delete e[r],o)n in e||(e[n]=o[n],t[n]=i);else t[r]=i}(c,l.opts.specialEasing);r<i;r++)if(n=yt.prefilters[r].call(l,o,c,l.opts))return v(n.stop)&&(ce._queueHooks(l.elem,
l.opts.queue).stop=n.stop.bind(n)),n;return ce.map(c,vt,l),v(l.opts.start)&&l.opts.start.call(o,l),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always),ce.fx.timer(ce.extend(u,{elem:o,anim:l,queue:l.opts.queue})),l}ce.Animation=ce.extend(yt,{tweeners:{"*":[function(e,t){var n=this.createTween(e,t);return te(n.elem,e,Y.exec(t),n),n}]},tweener:function(e,t){v(e)?(t=e,e=["*"]):e=e.match(D);for(var n,r=0,i=e.length;r<i;r++)n=e[r],yt.tweeners[n]=yt.tweeners[n]||
[],yt.tweeners[n].unshift(t)},prefilters:[function(e,t,n){var r,i,o,a,s,u,l,c,f="width"in t||"height"in t,p=this,d={},h=e.style,g=e.nodeType&&ee(e),v=_.get(e,"fxshow");for(r in n.queue||(null==(a=ce._queueHooks(e,"fx")).unqueued&&(a.unqueued=0,s=a.empty.fire,a.empty.fire=function(){a.unqueued||s()}),a.unqueued++,p.always(function(){p.always(function(){a.unqueued--,ce.queue(e,"fx").length||a.empty.fire()})})),t)if(i=t[r],ft.test(i)){if(delete t[r],o=o||"toggle"===i,i===(g?"hide":"show")){if("show"!==
i||!v||void 0===v[r])continue;g=!0}d[r]=v&&v[r]||ce.style(e,r)}if((u=!ce.isEmptyObject(t))||!ce.isEmptyObject(d))for(r in f&&1===e.nodeType&&(n.overflow=[h.overflow,h.overflowX,h.overflowY],null==(l=v&&v.display)&&(l=_.get(e,"display")),"none"===(c=ce.css(e,"display"))&&(l?c=l:(re([e],!0),l=e.style.display||l,c=ce.css(e,"display"),re([e]))),("inline"===c||"inline-block"===c&&null!=l)&&"none"===ce.css(e,"float")&&(u||(p.done(function(){h.display=l}),null==l&&(c=h.display,l="none"===c?"":c)),h.display=
"inline-block")),n.overflow&&(h.overflow="hidden",p.always(function(){h.overflow=n.overflow[0],h.overflowX=n.overflow[1],h.overflowY=n.overflow[2]})),u=!1,d)u||(v?"hidden"in v&&(g=v.hidden):v=_.access(e,"fxshow",{display:l}),o&&(v.hidden=!g),g&&re([e],!0),p.done(function(){for(r in g||re([e]),_.remove(e,"fxshow"),d)ce.style(e,r,d[r])})),u=vt(g?v[r]:0,r,p),r in v||(v[r]=u.start,g&&(u.end=u.start,u.start=0))}],prefilter:function(e,t){t?yt.prefilters.unshift(e):yt.prefilters.push(e)}}),ce.speed=function(e,
t,n){var r=e&&"object"==typeof e?ce.extend({},e):{complete:n||!n&&t||v(e)&&e,duration:e,easing:n&&t||t&&!v(t)&&t};return ce.fx.off?r.duration=0:"number"!=typeof r.duration&&(r.duration in ce.fx.speeds?r.duration=ce.fx.speeds[r.duration]:r.duration=ce.fx.speeds._default),null!=r.queue&&!0!==r.queue||(r.queue="fx"),r.old=r.complete,r.complete=function(){v(r.old)&&r.old.call(this),r.queue&&ce.dequeue(this,r.queue)},r},ce.fn.extend({fadeTo:function(e,t,n,r){return this.filter(ee).css("opacity",0).show().end().animate({opacity:t},
e,n,r)},animate:function(t,e,n,r){var i=ce.isEmptyObject(t),o=ce.speed(e,n,r),a=function(){var e=yt(this,ce.extend({},t),o);(i||_.get(this,"finish"))&&e.stop(!0)};return a.finish=a,i||!1===o.queue?this.each(a):this.queue(o.queue,a)},stop:function(i,e,o){var a=function(e){var t=e.stop;delete e.stop,t(o)};return"string"!=typeof i&&(o=e,e=i,i=void 0),e&&this.queue(i||"fx",[]),this.each(function(){var e=!0,t=null!=i&&i+"queueHooks",n=ce.timers,r=_.get(this);if(t)r[t]&&r[t].stop&&a(r[t]);else for(t in r)r[t]&&
r[t].stop&&pt.test(t)&&a(r[t]);for(t=n.length;t--;)n[t].elem!==this||null!=i&&n[t].queue!==i||(n[t].anim.stop(o),e=!1,n.splice(t,1));!e&&o||ce.dequeue(this,i)})},finish:function(a){return!1!==a&&(a=a||"fx"),this.each(function(){var e,t=_.get(this),n=t[a+"queue"],r=t[a+"queueHooks"],i=ce.timers,o=n?n.length:0;for(t.finish=!0,ce.queue(this,a,[]),r&&r.stop&&r.stop.call(this,!0),e=i.length;e--;)i[e].elem===this&&i[e].queue===a&&(i[e].anim.stop(!0),i.splice(e,1));for(e=0;e<o;e++)n[e]&&n[e].finish&&n[e].finish.call(this);
delete t.finish})}}),ce.each(["toggle","show","hide"],function(e,r){var i=ce.fn[r];ce.fn[r]=function(e,t,n){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(gt(r,!0),e,t,n)}}),ce.each({slideDown:gt("show"),slideUp:gt("hide"),slideToggle:gt("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,r){ce.fn[e]=function(e,t,n){return this.animate(r,e,t,n)}}),ce.timers=[],ce.fx.tick=function(){var e,t=0,n=ce.timers;for(st=Date.now();t<
n.length;t++)(e=n[t])()||n[t]!==e||n.splice(t--,1);n.length||ce.fx.stop(),st=void 0},ce.fx.timer=function(e){ce.timers.push(e),ce.fx.start()},ce.fx.interval=13,ce.fx.start=function(){ut||(ut=!0,dt())},ce.fx.stop=function(){ut=null},ce.fx.speeds={slow:600,fast:200,_default:400},ce.fn.delay=function(r,e){return r=ce.fx&&ce.fx.speeds[r]||r,e=e||"fx",this.queue(e,function(e,t){var n=ie.setTimeout(e,r);t.stop=function(){ie.clearTimeout(n)}})},lt=C.createElement("input"),ct=C.createElement("select").appendChild(C.createElement("option")),
lt.type="checkbox",le.checkOn=""!==lt.value,le.optSelected=ct.selected,(lt=C.createElement("input")).value="t",lt.type="radio",le.radioValue="t"===lt.value;var mt,xt=ce.expr.attrHandle;ce.fn.extend({attr:function(e,t){return M(this,ce.attr,e,t,1<arguments.length)},removeAttr:function(e){return this.each(function(){ce.removeAttr(this,e)})}}),ce.extend({attr:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return"undefined"==typeof e.getAttribute?ce.prop(e,t,n):(1===o&&ce.isXMLDoc(e)||(i=
ce.attrHooks[t.toLowerCase()]||(ce.expr.match.bool.test(t)?mt:void 0)),void 0!==n?null===n?void ce.removeAttr(e,t):i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:(e.setAttribute(t,n+""),n):i&&"get"in i&&null!==(r=i.get(e,t))?r:null==(r=ce.find.attr(e,t))?void 0:r)},attrHooks:{type:{set:function(e,t){if(!le.radioValue&&"radio"===t&&fe(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},removeAttr:function(e,t){var n,r=0,i=t&&t.match(D);if(i&&1===e.nodeType)while(n=i[r++])e.removeAttribute(n)}}),
mt={set:function(e,t,n){return!1===t?ce.removeAttr(e,n):e.setAttribute(n,n),n}},ce.each(ce.expr.match.bool.source.match(/\w+/g),function(e,t){var a=xt[t]||ce.find.attr;xt[t]=function(e,t,n){var r,i,o=t.toLowerCase();return n||(i=xt[o],xt[o]=r,r=null!=a(e,t,n)?o:null,xt[o]=i),r}});var bt=/^(?:input|select|textarea|button)$/i,wt=/^(?:a|area)$/i;function Tt(e){return(e.match(D)||[]).join(" ")}function Ct(e){return e.getAttribute&&e.getAttribute("class")||""}function kt(e){return Array.isArray(e)?e:"string"==
typeof e&&e.match(D)||[]}ce.fn.extend({prop:function(e,t){return M(this,ce.prop,e,t,1<arguments.length)},removeProp:function(e){return this.each(function(){delete this[ce.propFix[e]||e]})}}),ce.extend({prop:function(e,t,n){var r,i,o=e.nodeType;if(3!==o&&8!==o&&2!==o)return 1===o&&ce.isXMLDoc(e)||(t=ce.propFix[t]||t,i=ce.propHooks[t]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(e,n,t))?r:e[t]=n:i&&"get"in i&&null!==(r=i.get(e,t))?r:e[t]},propHooks:{tabIndex:{get:function(e){var t=ce.find.attr(e,"tabindex");
return t?parseInt(t,10):bt.test(e.nodeName)||wt.test(e.nodeName)&&e.href?0:-1}}},propFix:{"for":"htmlFor","class":"className"}}),le.optSelected||(ce.propHooks.selected={get:function(e){var t=e.parentNode;return t&&t.parentNode&&t.parentNode.selectedIndex,null},set:function(e){var t=e.parentNode;t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex)}}),ce.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ce.propFix[this.toLowerCase()]=
this}),ce.fn.extend({addClass:function(t){var e,n,r,i,o,a;return v(t)?this.each(function(e){ce(this).addClass(t.call(this,e,Ct(this)))}):(e=kt(t)).length?this.each(function(){if(r=Ct(this),n=1===this.nodeType&&" "+Tt(r)+" "){for(o=0;o<e.length;o++)i=e[o],n.indexOf(" "+i+" ")<0&&(n+=i+" ");a=Tt(n),r!==a&&this.setAttribute("class",a)}}):this},removeClass:function(t){var e,n,r,i,o,a;return v(t)?this.each(function(e){ce(this).removeClass(t.call(this,e,Ct(this)))}):arguments.length?(e=kt(t)).length?this.each(function(){if(r=
Ct(this),n=1===this.nodeType&&" "+Tt(r)+" "){for(o=0;o<e.length;o++){i=e[o];while(-1<n.indexOf(" "+i+" "))n=n.replace(" "+i+" "," ")}a=Tt(n),r!==a&&this.setAttribute("class",a)}}):this:this.attr("class","")},toggleClass:function(t,n){var e,r,i,o,a=typeof t,s="string"===a||Array.isArray(t);return v(t)?this.each(function(e){ce(this).toggleClass(t.call(this,e,Ct(this),n),n)}):"boolean"==typeof n&&s?n?this.addClass(t):this.removeClass(t):(e=kt(t),this.each(function(){if(s)for(o=ce(this),i=0;i<e.length;i++)r=
e[i],o.hasClass(r)?o.removeClass(r):o.addClass(r);else void 0!==t&&"boolean"!==a||((r=Ct(this))&&_.set(this,"__className__",r),this.setAttribute&&this.setAttribute("class",r||!1===t?"":_.get(this,"__className__")||""))}))},hasClass:function(e){var t,n,r=0;t=" "+e+" ";while(n=this[r++])if(1===n.nodeType&&-1<(" "+Tt(Ct(n))+" ").indexOf(t))return!0;return!1}});var St=/\r/g;ce.fn.extend({val:function(n){var r,e,i,t=this[0];return arguments.length?(i=v(n),this.each(function(e){var t;1===this.nodeType&&
(null==(t=i?n.call(this,e,ce(this).val()):n)?t="":"number"==typeof t?t+="":Array.isArray(t)&&(t=ce.map(t,function(e){return null==e?"":e+""})),(r=ce.valHooks[this.type]||ce.valHooks[this.nodeName.toLowerCase()])&&"set"in r&&void 0!==r.set(this,t,"value")||(this.value=t))})):t?(r=ce.valHooks[t.type]||ce.valHooks[t.nodeName.toLowerCase()])&&"get"in r&&void 0!==(e=r.get(t,"value"))?e:"string"==typeof(e=t.value)?e.replace(St,""):null==e?"":e:void 0}}),ce.extend({valHooks:{option:{get:function(e){var t=
ce.find.attr(e,"value");return null!=t?t:Tt(ce.text(e))}},select:{get:function(e){var t,n,r,i=e.options,o=e.selectedIndex,a="select-one"===e.type,s=a?null:[],u=a?o+1:i.length;for(r=o<0?u:a?o:0;r<u;r++)if(((n=i[r]).selected||r===o)&&!n.disabled&&(!n.parentNode.disabled||!fe(n.parentNode,"optgroup"))){if(t=ce(n).val(),a)return t;s.push(t)}return s},set:function(e,t){var n,r,i=e.options,o=ce.makeArray(t),a=i.length;while(a--)((r=i[a]).selected=-1<ce.inArray(ce.valHooks.option.get(r),o))&&(n=!0);return n||
(e.selectedIndex=-1),o}}}}),ce.each(["radio","checkbox"],function(){ce.valHooks[this]={set:function(e,t){if(Array.isArray(t))return e.checked=-1<ce.inArray(ce(e).val(),t)}},le.checkOn||(ce.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Et=ie.location,jt={guid:Date.now()},At=/\?/;ce.parseXML=function(e){var t,n;if(!e||"string"!=typeof e)return null;try{t=(new ie.DOMParser).parseFromString(e,"text/xml")}catch(e){}return n=t&&t.getElementsByTagName("parsererror")[0],
t&&!n||ce.error("Invalid XML: "+(n?ce.map(n.childNodes,function(e){return e.textContent}).join("\n"):e)),t};var Dt=/^(?:focusinfocus|focusoutblur)$/,Nt=function(e){e.stopPropagation()};ce.extend(ce.event,{trigger:function(e,t,n,r){var i,o,a,s,u,l,c,f,p=[n||C],d=ue.call(e,"type")?e.type:e,h=ue.call(e,"namespace")?e.namespace.split("."):[];if(o=f=a=n=n||C,3!==n.nodeType&&8!==n.nodeType&&!Dt.test(d+ce.event.triggered)&&(-1<d.indexOf(".")&&(d=(h=d.split(".")).shift(),h.sort()),u=d.indexOf(":")<0&&"on"+
d,(e=e[ce.expando]?e:new ce.Event(d,"object"==typeof e&&e)).isTrigger=r?2:3,e.namespace=h.join("."),e.rnamespace=e.namespace?new RegExp("(^|\\.)"+h.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=n),t=null==t?[e]:ce.makeArray(t,[e]),c=ce.event.special[d]||{},r||!c.trigger||!1!==c.trigger.apply(n,t))){if(!r&&!c.noBubble&&!y(n)){for(s=c.delegateType||d,Dt.test(s+d)||(o=o.parentNode);o;o=o.parentNode)p.push(o),a=o;a===(n.ownerDocument||C)&&p.push(a.defaultView||a.parentWindow||
ie)}i=0;while((o=p[i++])&&!e.isPropagationStopped())f=o,e.type=1<i?s:c.bindType||d,(l=(_.get(o,"events")||Object.create(null))[e.type]&&_.get(o,"handle"))&&l.apply(o,t),(l=u&&o[u])&&l.apply&&$(o)&&(e.result=l.apply(o,t),!1===e.result&&e.preventDefault());return e.type=d,r||e.isDefaultPrevented()||c._default&&!1!==c._default.apply(p.pop(),t)||!$(n)||u&&v(n[d])&&!y(n)&&((a=n[u])&&(n[u]=null),ce.event.triggered=d,e.isPropagationStopped()&&f.addEventListener(d,Nt),n[d](),e.isPropagationStopped()&&f.removeEventListener(d,
Nt),ce.event.triggered=void 0,a&&(n[u]=a)),e.result}},simulate:function(e,t,n){var r=ce.extend(new ce.Event,n,{type:e,isSimulated:!0});ce.event.trigger(r,null,t)}}),ce.fn.extend({trigger:function(e,t){return this.each(function(){ce.event.trigger(e,t,this)})},triggerHandler:function(e,t){var n=this[0];if(n)return ce.event.trigger(e,t,n,!0)}});var qt=/\[\]$/,Lt=/\r?\n/g,Ht=/^(?:submit|button|image|reset|file)$/i,Ot=/^(?:input|select|textarea|keygen)/i;function Pt(n,e,r,i){var t;if(Array.isArray(e))ce.each(e,
function(e,t){r||qt.test(n)?i(n,t):Pt(n+"["+("object"==typeof t&&null!=t?e:"")+"]",t,r,i)});else if(r||"object"!==x(e))i(n,e);else for(t in e)Pt(n+"["+t+"]",e[t],r,i)}ce.param=function(e,t){var n,r=[],i=function(e,t){var n=v(t)?t():t;r[r.length]=encodeURIComponent(e)+"="+encodeURIComponent(null==n?"":n)};if(null==e)return"";if(Array.isArray(e)||e.jquery&&!ce.isPlainObject(e))ce.each(e,function(){i(this.name,this.value)});else for(n in e)Pt(n,e[n],t,i);return r.join("&")},ce.fn.extend({serialize:function(){return ce.param(this.serializeArray())},
serializeArray:function(){return this.map(function(){var e=ce.prop(this,"elements");return e?ce.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!ce(this).is(":disabled")&&Ot.test(this.nodeName)&&!Ht.test(e)&&(this.checked||!we.test(e))}).map(function(e,t){var n=ce(this).val();return null==n?null:Array.isArray(n)?ce.map(n,function(e){return{name:t.name,value:e.replace(Lt,"\r\n")}}):{name:t.name,value:n.replace(Lt,"\r\n")}}).get()}});var Mt=/%20/g,Rt=/#.*$/,It=/([?&])_=[^&]*/,
Wt=/^(.*?):[ \t]*([^\r\n]*)$/gm,Ft=/^(?:GET|HEAD)$/,$t=/^\/\//,Bt={},_t={},zt="*/".concat("*"),Xt=C.createElement("a");function Ut(o){return function(e,t){"string"!=typeof e&&(t=e,e="*");var n,r=0,i=e.toLowerCase().match(D)||[];if(v(t))while(n=i[r++])"+"===n[0]?(n=n.slice(1)||"*",(o[n]=o[n]||[]).unshift(t)):(o[n]=o[n]||[]).push(t)}}function Vt(t,i,o,a){var s={},u=t===_t;function l(e){var r;return s[e]=!0,ce.each(t[e]||[],function(e,t){var n=t(i,o,a);return"string"!=typeof n||u||s[n]?u?!(r=n):void 0:
(i.dataTypes.unshift(n),l(n),!1)}),r}return l(i.dataTypes[0])||!s["*"]&&l("*")}function Gt(e,t){var n,r,i=ce.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((i[n]?e:r||(r={}))[n]=t[n]);return r&&ce.extend(!0,e,r),e}Xt.href=Et.href,ce.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Et.href,type:"GET",isLocal:/^(?:about|app|app-storage|.+-extension|file|res|widget):$/.test(Et.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",
accepts:{"*":zt,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":ce.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Gt(Gt(e,ce.ajaxSettings),t):Gt(ce.ajaxSettings,e)},ajaxPrefilter:Ut(Bt),ajaxTransport:Ut(_t),
ajax:function(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var c,f,p,n,d,r,h,g,i,o,v=ce.ajaxSetup({},t),y=v.context||v,m=v.context&&(y.nodeType||y.jquery)?ce(y):ce.event,x=ce.Deferred(),b=ce.Callbacks("once memory"),w=v.statusCode||{},a={},s={},u="canceled",T={readyState:0,getResponseHeader:function(e){var t;if(h){if(!n){n={};while(t=Wt.exec(p))n[t[1].toLowerCase()+" "]=(n[t[1].toLowerCase()+" "]||[]).concat(t[2])}t=n[e.toLowerCase()+" "]}return null==t?null:t.join(", ")},getAllResponseHeaders:function(){return h?
p:null},setRequestHeader:function(e,t){return null==h&&(e=s[e.toLowerCase()]=s[e.toLowerCase()]||e,a[e]=t),this},overrideMimeType:function(e){return null==h&&(v.mimeType=e),this},statusCode:function(e){var t;if(e)if(h)T.always(e[T.status]);else for(t in e)w[t]=[w[t],e[t]];return this},abort:function(e){var t=e||u;return c&&c.abort(t),l(0,t),this}};if(x.promise(T),v.url=((e||v.url||Et.href)+"").replace($t,Et.protocol+"//"),v.type=t.method||t.type||v.method||v.type,v.dataTypes=(v.dataType||"*").toLowerCase().match(D)||
[""],null==v.crossDomain){r=C.createElement("a");try{r.href=v.url,r.href=r.href,v.crossDomain=Xt.protocol+"//"+Xt.host!=r.protocol+"//"+r.host}catch(e){v.crossDomain=!0}}if(v.data&&v.processData&&"string"!=typeof v.data&&(v.data=ce.param(v.data,v.traditional)),Vt(Bt,v,t,T),h)return T;for(i in(g=ce.event&&v.global)&&0==ce.active++&&ce.event.trigger("ajaxStart"),v.type=v.type.toUpperCase(),v.hasContent=!Ft.test(v.type),f=v.url.replace(Rt,""),v.hasContent?v.data&&v.processData&&0===(v.contentType||"").indexOf("application/x-www-form-urlencoded")&&
(v.data=v.data.replace(Mt,"+")):(o=v.url.slice(f.length),v.data&&(v.processData||"string"==typeof v.data)&&(f+=(At.test(f)?"&":"?")+v.data,delete v.data),!1===v.cache&&(f=f.replace(It,"$1"),o=(At.test(f)?"&":"?")+"_="+jt.guid++ +o),v.url=f+o),v.ifModified&&(ce.lastModified[f]&&T.setRequestHeader("If-Modified-Since",ce.lastModified[f]),ce.etag[f]&&T.setRequestHeader("If-None-Match",ce.etag[f])),(v.data&&v.hasContent&&!1!==v.contentType||t.contentType)&&T.setRequestHeader("Content-Type",v.contentType),
T.setRequestHeader("Accept",v.dataTypes[0]&&v.accepts[v.dataTypes[0]]?v.accepts[v.dataTypes[0]]+("*"!==v.dataTypes[0]?", "+zt+"; q=0.01":""):v.accepts["*"]),v.headers)T.setRequestHeader(i,v.headers[i]);if(v.beforeSend&&(!1===v.beforeSend.call(y,T,v)||h))return T.abort();if(u="abort",b.add(v.complete),T.done(v.success),T.fail(v.error),c=Vt(_t,v,t,T)){if(T.readyState=1,g&&m.trigger("ajaxSend",[T,v]),h)return T;v.async&&0<v.timeout&&(d=ie.setTimeout(function(){T.abort("timeout")},v.timeout));try{h=!1,
c.send(a,l)}catch(e){if(h)throw e;l(-1,e)}}else l(-1,"No Transport");function l(e,t,n,r){var i,o,a,s,u,l=t;h||(h=!0,d&&ie.clearTimeout(d),c=void 0,p=r||"",T.readyState=0<e?4:0,i=200<=e&&e<300||304===e,n&&(s=function(e,t,n){var r,i,o,a,s=e.contents,u=e.dataTypes;while("*"===u[0])u.shift(),void 0===r&&(r=e.mimeType||t.getResponseHeader("Content-Type"));if(r)for(i in s)if(s[i]&&s[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||e.converters[i+" "+u[0]]){o=i;break}a||(a=i)}o=
o||a}if(o)return o!==u[0]&&u.unshift(o),n[o]}(v,T,n)),!i&&-1<ce.inArray("script",v.dataTypes)&&ce.inArray("json",v.dataTypes)<0&&(v.converters["text script"]=function(){}),s=function(e,t,n,r){var i,o,a,s,u,l={},c=e.dataTypes.slice();if(c[1])for(a in e.converters)l[a.toLowerCase()]=e.converters[a];o=c.shift();while(o)if(e.responseFields[o]&&(n[e.responseFields[o]]=t),!u&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(!(a=l[u+" "+o]||l["* "+
o]))for(i in l)if((s=i.split(" "))[1]===o&&(a=l[u+" "+s[0]]||l["* "+s[0]])){!0===a?a=l[i]:!0!==l[i]&&(o=s[0],c.unshift(s[1]));break}if(!0!==a)if(a&&e["throws"])t=a(t);else try{t=a(t)}catch(e){return{state:"parsererror",error:a?e:"No conversion from "+u+" to "+o}}}return{state:"success",data:t}}(v,s,T,i),i?(v.ifModified&&((u=T.getResponseHeader("Last-Modified"))&&(ce.lastModified[f]=u),(u=T.getResponseHeader("etag"))&&(ce.etag[f]=u)),204===e||"HEAD"===v.type?l="nocontent":304===e?l="notmodified":(l=
s.state,o=s.data,i=!(a=s.error))):(a=l,!e&&l||(l="error",e<0&&(e=0))),T.status=e,T.statusText=(t||l)+"",i?x.resolveWith(y,[o,l,T]):x.rejectWith(y,[T,l,a]),T.statusCode(w),w=void 0,g&&m.trigger(i?"ajaxSuccess":"ajaxError",[T,v,i?o:a]),b.fireWith(y,[T,l]),g&&(m.trigger("ajaxComplete",[T,v]),--ce.active||ce.event.trigger("ajaxStop")))}return T},getJSON:function(e,t,n){return ce.get(e,t,n,"json")},getScript:function(e,t){return ce.get(e,void 0,t,"script")}}),ce.each(["get","post"],function(e,i){ce[i]=
function(e,t,n,r){return v(t)&&(r=r||n,n=t,t=void 0),ce.ajax(ce.extend({url:e,type:i,dataType:r,data:t,success:n},ce.isPlainObject(e)&&e))}}),ce.ajaxPrefilter(function(e){var t;for(t in e.headers)"content-type"===t.toLowerCase()&&(e.contentType=e.headers[t]||"")}),ce._evalUrl=function(e,t,n){return ce.ajax({url:e,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(e){ce.globalEval(e,t,n)}})},ce.fn.extend({wrapAll:function(e){var t;return this[0]&&
(v(e)&&(e=e.call(this[0])),t=ce(e,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstElementChild)e=e.firstElementChild;return e}).append(this)),this},wrapInner:function(n){return v(n)?this.each(function(e){ce(this).wrapInner(n.call(this,e))}):this.each(function(){var e=ce(this),t=e.contents();t.length?t.wrapAll(n):e.append(n)})},wrap:function(t){var n=v(t);return this.each(function(e){ce(this).wrapAll(n?t.call(this,e):t)})},
unwrap:function(e){return this.parent(e).not("body").each(function(){ce(this).replaceWith(this.childNodes)}),this}}),ce.expr.pseudos.hidden=function(e){return!ce.expr.pseudos.visible(e)},ce.expr.pseudos.visible=function(e){return!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length)},ce.ajaxSettings.xhr=function(){try{return new ie.XMLHttpRequest}catch(e){}};var Yt={0:200,1223:204},Qt=ce.ajaxSettings.xhr();le.cors=!!Qt&&"withCredentials"in Qt,le.ajax=Qt=!!Qt,ce.ajaxTransport(function(i){var o,
a;if(le.cors||Qt&&!i.crossDomain)return{send:function(e,t){var n,r=i.xhr();if(r.open(i.type,i.url,i.async,i.username,i.password),i.xhrFields)for(n in i.xhrFields)r[n]=i.xhrFields[n];for(n in i.mimeType&&r.overrideMimeType&&r.overrideMimeType(i.mimeType),i.crossDomain||e["X-Requested-With"]||(e["X-Requested-With"]="XMLHttpRequest"),e)r.setRequestHeader(n,e[n]);o=function(e){return function(){o&&(o=a=r.onload=r.onerror=r.onabort=r.ontimeout=r.onreadystatechange=null,"abort"===e?r.abort():"error"===
e?"number"!=typeof r.status?t(0,"error"):t(r.status,r.statusText):t(Yt[r.status]||r.status,r.statusText,"text"!==(r.responseType||"text")||"string"!=typeof r.responseText?{binary:r.response}:{text:r.responseText},r.getAllResponseHeaders()))}},r.onload=o(),a=r.onerror=r.ontimeout=o("error"),void 0!==r.onabort?r.onabort=a:r.onreadystatechange=function(){4===r.readyState&&ie.setTimeout(function(){o&&a()})},o=o("abort");try{r.send(i.hasContent&&i.data||null)}catch(e){if(o)throw e;}},abort:function(){o&&
o()}}}),ce.ajaxPrefilter(function(e){e.crossDomain&&(e.contents.script=!1)}),ce.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(e){return ce.globalEval(e),e}}}),ce.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET")}),ce.ajaxTransport("script",function(n){var r,i;if(n.crossDomain||n.scriptAttrs)return{send:function(e,
t){r=ce("<script>").attr(n.scriptAttrs||{}).prop({charset:n.scriptCharset,src:n.url}).on("load error",i=function(e){r.remove(),i=null,e&&t("error"===e.type?404:200,e.type)}),C.head.appendChild(r[0])},abort:function(){i&&i()}}});var Jt,Kt=[],Zt=/(=)\?(?=&|$)|\?\?/;ce.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Kt.pop()||ce.expando+"_"+jt.guid++;return this[e]=!0,e}}),ce.ajaxPrefilter("json jsonp",function(e,t,n){var r,i,o,a=!1!==e.jsonp&&(Zt.test(e.url)?"url":"string"==typeof e.data&&
0===(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Zt.test(e.data)&&"data");if(a||"jsonp"===e.dataTypes[0])return r=e.jsonpCallback=v(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Zt,"$1"+r):!1!==e.jsonp&&(e.url+=(At.test(e.url)?"&":"?")+e.jsonp+"="+r),e.converters["script json"]=function(){return o||ce.error(r+" was not called"),o[0]},e.dataTypes[0]="json",i=ie[r],ie[r]=function(){o=arguments},n.always(function(){void 0===i?ce(ie).removeProp(r):ie[r]=i,
e[r]&&(e.jsonpCallback=t.jsonpCallback,Kt.push(r)),o&&v(i)&&i(o[0]),o=i=void 0}),"script"}),le.createHTMLDocument=((Jt=C.implementation.createHTMLDocument("").body).innerHTML="<form></form><form></form>",2===Jt.childNodes.length),ce.parseHTML=function(e,t,n){return"string"!=typeof e?[]:("boolean"==typeof t&&(n=t,t=!1),t||(le.createHTMLDocument?((r=(t=C.implementation.createHTMLDocument("")).createElement("base")).href=C.location.href,t.head.appendChild(r)):t=C),o=!n&&[],(i=w.exec(e))?[t.createElement(i[1])]:
(i=Ae([e],t,o),o&&o.length&&ce(o).remove(),ce.merge([],i.childNodes)));var r,i,o},ce.fn.load=function(e,t,n){var r,i,o,a=this,s=e.indexOf(" ");return-1<s&&(r=Tt(e.slice(s)),e=e.slice(0,s)),v(t)?(n=t,t=void 0):t&&"object"==typeof t&&(i="POST"),0<a.length&&ce.ajax({url:e,type:i||"GET",dataType:"html",data:t}).done(function(e){o=arguments,a.html(r?ce("<div>").append(ce.parseHTML(e)).find(r):e)}).always(n&&function(e,t){a.each(function(){n.apply(this,o||[e.responseText,t,e])})}),this},ce.expr.pseudos.animated=
function(t){return ce.grep(ce.timers,function(e){return t===e.elem}).length},ce.offset={setOffset:function(e,t,n){var r,i,o,a,s,u,l=ce.css(e,"position"),c=ce(e),f={};"static"===l&&(e.style.position="relative"),s=c.offset(),o=ce.css(e,"top"),u=ce.css(e,"left"),("absolute"===l||"fixed"===l)&&-1<(o+u).indexOf("auto")?(a=(r=c.position()).top,i=r.left):(a=parseFloat(o)||0,i=parseFloat(u)||0),v(t)&&(t=t.call(e,n,ce.extend({},s))),null!=t.top&&(f.top=t.top-s.top+a),null!=t.left&&(f.left=t.left-s.left+i),
"using"in t?t.using.call(e,f):c.css(f)}},ce.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){ce.offset.setOffset(this,t,e)});var e,n,r=this[0];return r?r.getClientRects().length?(e=r.getBoundingClientRect(),n=r.ownerDocument.defaultView,{top:e.top+n.pageYOffset,left:e.left+n.pageXOffset}):{top:0,left:0}:void 0},position:function(){if(this[0]){var e,t,n,r=this[0],i={top:0,left:0};if("fixed"===ce.css(r,"position"))t=r.getBoundingClientRect();else{t=this.offset(),
n=r.ownerDocument,e=r.offsetParent||n.documentElement;while(e&&(e===n.body||e===n.documentElement)&&"static"===ce.css(e,"position"))e=e.parentNode;e&&e!==r&&1===e.nodeType&&((i=ce(e).offset()).top+=ce.css(e,"borderTopWidth",!0),i.left+=ce.css(e,"borderLeftWidth",!0))}return{top:t.top-i.top-ce.css(r,"marginTop",!0),left:t.left-i.left-ce.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent;while(e&&"static"===ce.css(e,"position"))e=e.offsetParent;return e||
J})}}),ce.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(t,i){var o="pageYOffset"===i;ce.fn[t]=function(e){return M(this,function(e,t,n){var r;if(y(e)?r=e:9===e.nodeType&&(r=e.defaultView),void 0===n)return r?r[i]:e[t];r?r.scrollTo(o?r.pageXOffset:n,o?n:r.pageYOffset):e[t]=n},t,e,arguments.length)}}),ce.each(["top","left"],function(e,n){ce.cssHooks[n]=Ye(le.pixelPosition,function(e,t){if(t)return t=Ge(e,n),_e.test(t)?ce(e).position()[n]+"px":t})}),ce.each({Height:"height",Width:"width"},
function(a,s){ce.each({padding:"inner"+a,content:s,"":"outer"+a},function(r,o){ce.fn[o]=function(e,t){var n=arguments.length&&(r||"boolean"!=typeof e),i=r||(!0===e||!0===t?"margin":"border");return M(this,function(e,t,n){var r;return y(e)?0===o.indexOf("outer")?e["inner"+a]:e.document.documentElement["client"+a]:9===e.nodeType?(r=e.documentElement,Math.max(e.body["scroll"+a],r["scroll"+a],e.body["offset"+a],r["offset"+a],r["client"+a])):void 0===n?ce.css(e,t,i):ce.style(e,t,n,i)},s,n?e:void 0,n)}})}),
ce.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){ce.fn[t]=function(e){return this.on(t,e)}}),ce.fn.extend({bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)},hover:function(e,t){return this.on("mouseenter",e).on("mouseleave",t||e)}}),ce.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),
function(e,n){ce.fn[n]=function(e,t){return 0<arguments.length?this.on(n,null,e,t):this.trigger(n)}});var en=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;ce.proxy=function(e,t){var n,r,i;if("string"==typeof t&&(n=e[t],t=e,e=n),v(e))return r=ae.call(arguments,2),(i=function(){return e.apply(t||this,r.concat(ae.call(arguments)))}).guid=e.guid=e.guid||ce.guid++,i},ce.holdReady=function(e){e?ce.readyWait++:ce.ready(!0)},ce.isArray=Array.isArray,ce.parseJSON=JSON.parse,ce.nodeName=fe,ce.isFunction=
v,ce.isWindow=y,ce.camelCase=F,ce.type=x,ce.now=Date.now,ce.isNumeric=function(e){var t=ce.type(e);return("number"===t||"string"===t)&&!isNaN(e-parseFloat(e))},ce.trim=function(e){return null==e?"":(e+"").replace(en,"$1")},"function"==typeof define&&define.amd&&define("jquery",[],function(){return ce});var tn=ie.jQuery,nn=ie.$;return ce.noConflict=function(e){return ie.$===ce&&(ie.$=nn),e&&ie.jQuery===ce&&(ie.jQuery=tn),ce},"undefined"==typeof e&&(ie.jQuery=ie.$=ce),ce});
!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)}(function(V){V.ui=V.ui||{};V.ui.version="1.13.3";var n,s,x,k,o,a,r,l,h,i,N=0,E=Array.prototype.hasOwnProperty,c=Array.prototype.slice;V.cleanData=(n=V.cleanData,function(t){for(var e,i,s=0;null!=(i=t[s]);s++)(e=V._data(i,"events"))&&e.remove&&V(i).triggerHandler("remove");n(t)}),V.widget=function(t,i,e){var s,n,o,a={},r=t.split(".")[0],l=r+"-"+(t=t.split(".")[1]);return e||(e=i,i=V.Widget),Array.isArray(e)&&(e=V.extend.apply(null,
[{}].concat(e))),V.expr.pseudos[l.toLowerCase()]=function(t){return!!V.data(t,l)},V[r]=V[r]||{},s=V[r][t],n=V[r][t]=function(t,e){if(!this||!this._createWidget)return new n(t,e);arguments.length&&this._createWidget(t,e)},V.extend(n,s,{version:e.version,_proto:V.extend({},e),_childConstructors:[]}),(o=new i).options=V.widget.extend({},o.options),V.each(e,function(e,s){function n(){return i.prototype[e].apply(this,arguments)}function o(t){return i.prototype[e].apply(this,t)}a[e]="function"!=typeof s?
s:function(){var t,e=this._super,i=this._superApply;return this._super=n,this._superApply=o,t=s.apply(this,arguments),this._super=e,this._superApply=i,t}}),n.prototype=V.widget.extend(o,{widgetEventPrefix:s&&o.widgetEventPrefix||t},a,{constructor:n,namespace:r,widgetName:t,widgetFullName:l}),s?(V.each(s._childConstructors,function(t,e){var i=e.prototype;V.widget(i.namespace+"."+i.widgetName,n,e._proto)}),delete s._childConstructors):i._childConstructors.push(n),V.widget.bridge(t,n),n},V.widget.extend=
function(t){for(var e,i,s=c.call(arguments,1),n=0,o=s.length;n<o;n++)for(e in s[n])i=s[n][e],E.call(s[n],e)&&void 0!==i&&(V.isPlainObject(i)?t[e]=V.isPlainObject(t[e])?V.widget.extend({},t[e],i):V.widget.extend({},i):t[e]=i);return t},V.widget.bridge=function(o,e){var a=e.prototype.widgetFullName||o;V.fn[o]=function(i){var t="string"==typeof i,s=c.call(arguments,1),n=this;return t?this.length||"instance"!==i?this.each(function(){var t,e=V.data(this,a);return"instance"===i?(n=e,!1):e?"function"!=typeof e[i]||
"_"===i.charAt(0)?V.error("no such method '"+i+"' for "+o+" widget instance"):(t=e[i].apply(e,s))!==e&&void 0!==t?(n=t&&t.jquery?n.pushStack(t.get()):t,!1):void 0:V.error("cannot call methods on "+o+" prior to initialization; attempted to call method '"+i+"'")}):n=void 0:(s.length&&(i=V.widget.extend.apply(null,[i].concat(s))),this.each(function(){var t=V.data(this,a);t?(t.option(i||{}),t._init&&t._init()):V.data(this,a,new e(i,this))})),n}},V.Widget=function(){},V.Widget._childConstructors=[],V.Widget.prototype=
{widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{classes:{},disabled:!1,create:null},_createWidget:function(t,e){e=V(e||this.defaultElement||this)[0],this.element=V(e),this.uuid=N++,this.eventNamespace="."+this.widgetName+this.uuid,this.bindings=V(),this.hoverable=V(),this.focusable=V(),this.classesElementLookup={},e!==this&&(V.data(e,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===e&&this.destroy()}}),this.document=V(e.style?e.ownerDocument:
e.document||e),this.window=V(this.document[0].defaultView||this.document[0].parentWindow)),this.options=V.widget.extend({},this.options,this._getCreateOptions(),t),this._create(),this.options.disabled&&this._setOptionDisabled(this.options.disabled),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:function(){return{}},_getCreateEventData:V.noop,_create:V.noop,_init:V.noop,destroy:function(){var i=this;this._destroy(),V.each(this.classesElementLookup,function(t,
e){i._removeClass(e,t)}),this.element.off(this.eventNamespace).removeData(this.widgetFullName),this.widget().off(this.eventNamespace).removeAttr("aria-disabled"),this.bindings.off(this.eventNamespace)},_destroy:V.noop,widget:function(){return this.element},option:function(t,e){var i,s,n,o=t;if(0===arguments.length)return V.widget.extend({},this.options);if("string"==typeof t)if(o={},t=(i=t.split(".")).shift(),i.length){for(s=o[t]=V.widget.extend({},this.options[t]),n=0;n<i.length-1;n++)s[i[n]]=s[i[n]]||
{},s=s[i[n]];if(t=i.pop(),1===arguments.length)return void 0===s[t]?null:s[t];s[t]=e}else{if(1===arguments.length)return void 0===this.options[t]?null:this.options[t];o[t]=e}return this._setOptions(o),this},_setOptions:function(t){for(var e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return"classes"===t&&this._setOptionClasses(e),this.options[t]=e,"disabled"===t&&this._setOptionDisabled(e),this},_setOptionClasses:function(t){var e,i,s;for(e in t)s=this.classesElementLookup[e],
t[e]!==this.options.classes[e]&&s&&s.length&&(i=V(s.get()),this._removeClass(s,e),i.addClass(this._classes({element:i,keys:e,classes:t,add:!0})))},_setOptionDisabled:function(t){this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!!t),t&&(this._removeClass(this.hoverable,null,"ui-state-hover"),this._removeClass(this.focusable,null,"ui-state-focus"))},enable:function(){return this._setOptions({disabled:!1})},disable:function(){return this._setOptions({disabled:!0})},_classes:function(n){var o=
[],a=this;function t(t,e){for(var i,s=0;s<t.length;s++)i=a.classesElementLookup[t[s]]||V(),i=n.add?(function(){var i=[];n.element.each(function(t,e){V.map(a.classesElementLookup,function(t){return t}).some(function(t){return t.is(e)})||i.push(e)}),a._on(V(i),{remove:"_untrackClassesElement"})}(),V(V.uniqueSort(i.get().concat(n.element.get())))):V(i.not(n.element).get()),a.classesElementLookup[t[s]]=i,o.push(t[s]),e&&n.classes[t[s]]&&o.push(n.classes[t[s]])}return(n=V.extend({element:this.element,
classes:this.options.classes||{}},n)).keys&&t(n.keys.match(/\S+/g)||[],!0),n.extra&&t(n.extra.match(/\S+/g)||[]),o.join(" ")},_untrackClassesElement:function(i){var s=this;V.each(s.classesElementLookup,function(t,e){-1!==V.inArray(i.target,e)&&(s.classesElementLookup[t]=V(e.not(i.target).get()))}),this._off(V(i.target))},_removeClass:function(t,e,i){return this._toggleClass(t,e,i,!1)},_addClass:function(t,e,i){return this._toggleClass(t,e,i,!0)},_toggleClass:function(t,e,i,s){var n="string"==typeof t||
null===t,e={extra:n?e:i,keys:n?t:e,element:n?this.element:t,add:s="boolean"==typeof s?s:i};return e.element.toggleClass(this._classes(e),s),this},_on:function(n,o,t){var a,r=this;"boolean"!=typeof n&&(t=o,o=n,n=!1),t?(o=a=V(o),this.bindings=this.bindings.add(o)):(t=o,o=this.element,a=this.widget()),V.each(t,function(t,e){function i(){if(n||!0!==r.options.disabled&&!V(this).hasClass("ui-state-disabled"))return("string"==typeof e?r[e]:e).apply(r,arguments)}"string"!=typeof e&&(i.guid=e.guid=e.guid||
i.guid||V.guid++);var t=t.match(/^([\w:-]*)\s*(.*)$/),s=t[1]+r.eventNamespace,t=t[2];t?a.on(s,t,i):o.on(s,i)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.off(e),this.bindings=V(this.bindings.not(t).get()),this.focusable=V(this.focusable.not(t).get()),this.hoverable=V(this.hoverable.not(t).get())},_delay:function(t,e){var i=this;return setTimeout(function(){return("string"==typeof t?i[t]:t).apply(i,arguments)},e||0)},_hoverable:function(t){this.hoverable=
this.hoverable.add(t),this._on(t,{mouseenter:function(t){this._addClass(V(t.currentTarget),null,"ui-state-hover")},mouseleave:function(t){this._removeClass(V(t.currentTarget),null,"ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){this._addClass(V(t.currentTarget),null,"ui-state-focus")},focusout:function(t){this._removeClass(V(t.currentTarget),null,"ui-state-focus")}})},_trigger:function(t,e,i){var s,n,o=this.options[t];if(i=i||{},(e=
V.Event(e)).type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),e.target=this.element[0],n=e.originalEvent)for(s in n)s in e||(e[s]=n[s]);return this.element.trigger(e,i),!("function"==typeof o&&!1===o.apply(this.element[0],[e].concat(i))||e.isDefaultPrevented())}},V.each({show:"fadeIn",hide:"fadeOut"},function(o,a){V.Widget.prototype["_"+o]=function(e,t,i){var s,n=(t="string"==typeof t?{effect:t}:t)?!0!==t&&"number"!=typeof t&&t.effect||a:o;"number"==typeof(t=t||{})?t={duration:t}:
!0===t&&(t={}),s=!V.isEmptyObject(t),t.complete=i,t.delay&&e.delay(t.delay),s&&V.effects&&V.effects.effect[n]?e[o](t):n!==o&&e[n]?e[n](t.duration,t.easing,i):e.queue(function(t){V(this)[o](),i&&i.call(e[0]),t()})}}),V.widget;function C(t,e,i){return[parseFloat(t[0])*(h.test(t[0])?e/100:1),parseFloat(t[1])*(h.test(t[1])?i/100:1)]}function D(t,e){return parseInt(V.css(t,e),10)||0}function I(t){return null!=t&&t===t.window}x=Math.max,k=Math.abs,o=/left|center|right/,a=/top|center|bottom/,r=/[\+\-]\d+(\.[\d]+)?%?/,
l=/^\w+/,h=/%$/,i=V.fn.position,V.position={scrollbarWidth:function(){var t,e,i;return void 0!==s?s:(i=(e=V("<div style='display:block;position:absolute;width:200px;height:200px;overflow:hidden;'><div style='height:300px;width:auto;'></div></div>")).children()[0],V("body").append(e),t=i.offsetWidth,e.css("overflow","scroll"),t===(i=i.offsetWidth)&&(i=e[0].clientWidth),e.remove(),s=t-i)},getScrollInfo:function(t){var e=t.isWindow||t.isDocument?"":t.element.css("overflow-x"),i=t.isWindow||t.isDocument?
"":t.element.css("overflow-y"),e="scroll"===e||"auto"===e&&t.width<t.element[0].scrollWidth;return{width:"scroll"===i||"auto"===i&&t.height<t.element[0].scrollHeight?V.position.scrollbarWidth():0,height:e?V.position.scrollbarWidth():0}},getWithinInfo:function(t){var e=V(t||window),i=I(e[0]),s=!!e[0]&&9===e[0].nodeType;return{element:e,isWindow:i,isDocument:s,offset:!i&&!s?V(t).offset():{left:0,top:0},scrollLeft:e.scrollLeft(),scrollTop:e.scrollTop(),width:e.outerWidth(),height:e.outerHeight()}}},
V.fn.position=function(u){var d,p,f,g,m,_,v,b,y,w,t,e;return u&&u.of?(_="string"==typeof(u=V.extend({},u)).of?V(document).find(u.of):V(u.of),v=V.position.getWithinInfo(u.within),b=V.position.getScrollInfo(v),y=(u.collision||"flip").split(" "),w={},e=9===(e=(t=_)[0]).nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:I(e)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:e.preventDefault?{width:0,height:0,offset:{top:e.pageY,left:e.pageX}}:{width:t.outerWidth(),
height:t.outerHeight(),offset:t.offset()},_[0].preventDefault&&(u.at="left top"),p=e.width,f=e.height,m=V.extend({},g=e.offset),V.each(["my","at"],function(){var t,e,i=(u[this]||"").split(" ");(i=1===i.length?o.test(i[0])?i.concat(["center"]):a.test(i[0])?["center"].concat(i):["center","center"]:i)[0]=o.test(i[0])?i[0]:"center",i[1]=a.test(i[1])?i[1]:"center",t=r.exec(i[0]),e=r.exec(i[1]),w[this]=[t?t[0]:0,e?e[0]:0],u[this]=[l.exec(i[0])[0],l.exec(i[1])[0]]}),1===y.length&&(y[1]=y[0]),"right"===u.at[0]?
m.left+=p:"center"===u.at[0]&&(m.left+=p/2),"bottom"===u.at[1]?m.top+=f:"center"===u.at[1]&&(m.top+=f/2),d=C(w.at,p,f),m.left+=d[0],m.top+=d[1],this.each(function(){var i,t,a=V(this),r=a.outerWidth(),l=a.outerHeight(),e=D(this,"marginLeft"),s=D(this,"marginTop"),n=r+e+D(this,"marginRight")+b.width,o=l+s+D(this,"marginBottom")+b.height,h=V.extend({},m),c=C(w.my,a.outerWidth(),a.outerHeight());"right"===u.my[0]?h.left-=r:"center"===u.my[0]&&(h.left-=r/2),"bottom"===u.my[1]?h.top-=l:"center"===u.my[1]&&
(h.top-=l/2),h.left+=c[0],h.top+=c[1],i={marginLeft:e,marginTop:s},V.each(["left","top"],function(t,e){V.ui.position[y[t]]&&V.ui.position[y[t]][e](h,{targetWidth:p,targetHeight:f,elemWidth:r,elemHeight:l,collisionPosition:i,collisionWidth:n,collisionHeight:o,offset:[d[0]+c[0],d[1]+c[1]],my:u.my,at:u.at,within:v,elem:a})}),u.using&&(t=function(t){var e=g.left-h.left,i=e+p-r,s=g.top-h.top,n=s+f-l,o={target:{element:_,left:g.left,top:g.top,width:p,height:f},element:{element:a,left:h.left,top:h.top,width:r,
height:l},horizontal:i<0?"left":0<e?"right":"center",vertical:n<0?"top":0<s?"bottom":"middle"};p<r&&k(e+i)<p&&(o.horizontal="center"),f<l&&k(s+n)<f&&(o.vertical="middle"),x(k(e),k(i))>x(k(s),k(n))?o.important="horizontal":o.important="vertical",u.using.call(this,t,o)}),a.offset(V.extend(h,{using:t}))})):i.apply(this,arguments)},V.ui.position={fit:{left:function(t,e){var i,s=e.within,n=s.isWindow?s.scrollLeft:s.offset.left,s=s.width,o=t.left-e.collisionPosition.marginLeft,a=n-o,r=o+e.collisionWidth-
s-n;e.collisionWidth>s?0<a&&r<=0?(i=t.left+a+e.collisionWidth-s-n,t.left+=a-i):t.left=!(0<r&&a<=0)&&r<a?n+s-e.collisionWidth:n:0<a?t.left+=a:0<r?t.left-=r:t.left=x(t.left-o,t.left)},top:function(t,e){var i,s=e.within,s=s.isWindow?s.scrollTop:s.offset.top,n=e.within.height,o=t.top-e.collisionPosition.marginTop,a=s-o,r=o+e.collisionHeight-n-s;e.collisionHeight>n?0<a&&r<=0?(i=t.top+a+e.collisionHeight-n-s,t.top+=a-i):t.top=!(0<r&&a<=0)&&r<a?s+n-e.collisionHeight:s:0<a?t.top+=a:0<r?t.top-=r:t.top=x(t.top-
o,t.top)}},flip:{left:function(t,e){var i=e.within,s=i.offset.left+i.scrollLeft,n=i.width,i=i.isWindow?i.scrollLeft:i.offset.left,o=t.left-e.collisionPosition.marginLeft,a=o-i,o=o+e.collisionWidth-n-i,r="left"===e.my[0]?-e.elemWidth:"right"===e.my[0]?e.elemWidth:0,l="left"===e.at[0]?e.targetWidth:"right"===e.at[0]?-e.targetWidth:0,h=-2*e.offset[0];a<0?((n=t.left+r+l+h+e.collisionWidth-n-s)<0||n<k(a))&&(t.left+=r+l+h):0<o&&(0<(s=t.left-e.collisionPosition.marginLeft+r+l+h-i)||k(s)<o)&&(t.left+=r+l+
h)},top:function(t,e){var i=e.within,s=i.offset.top+i.scrollTop,n=i.height,i=i.isWindow?i.scrollTop:i.offset.top,o=t.top-e.collisionPosition.marginTop,a=o-i,o=o+e.collisionHeight-n-i,r="top"===e.my[1]?-e.elemHeight:"bottom"===e.my[1]?e.elemHeight:0,l="top"===e.at[1]?e.targetHeight:"bottom"===e.at[1]?-e.targetHeight:0,h=-2*e.offset[1];a<0?((n=t.top+r+l+h+e.collisionHeight-n-s)<0||n<k(a))&&(t.top+=r+l+h):0<o&&(0<(s=t.top-e.collisionPosition.marginTop+r+l+h-i)||k(s)<o)&&(t.top+=r+l+h)}},flipfit:{left:function(){V.ui.position.flip.left.apply(this,
arguments),V.ui.position.fit.left.apply(this,arguments)},top:function(){V.ui.position.flip.top.apply(this,arguments),V.ui.position.fit.top.apply(this,arguments)}}};V.ui.position,V.extend(V.expr.pseudos,{data:V.expr.createPseudo?V.expr.createPseudo(function(e){return function(t){return!!V.data(t,e)}}):function(t,e,i){return!!V.data(t,i[3])}}),V.fn.extend({disableSelection:(W="onselectstart"in document.createElement("div")?"selectstart":"mousedown",function(){return this.on(W+".ui-disableSelection",
function(t){t.preventDefault()})}),enableSelection:function(){return this.off(".ui-disableSelection")}});var W,u=V,d={},F=d.toString,L=/^([\-+])=\s*(\d+\.?\d*)/,R=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[t[1],t[2],t[3],t[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)%\s*,\s*(\d+(?:\.\d+)?)%\s*,\s*(\d+(?:\.\d+)?)%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(t){return[2.55*t[1],2.55*t[2],2.55*t[3],t[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})?/,
parse:function(t){return[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),t[4]?(parseInt(t[4],16)/255).toFixed(2):1]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])([a-f0-9])?/,parse:function(t){return[parseInt(t[1]+t[1],16),parseInt(t[2]+t[2],16),parseInt(t[3]+t[3],16),t[4]?(parseInt(t[4]+t[4],16)/255).toFixed(2):1]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)%\s*,\s*(\d+(?:\.\d+)?)%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(t){return[t[1],t[2]/100,t[3]/100,t[4]]}}],p=u.Color=
function(t,e,i,s){return new u.Color.fn.parse(t,e,i,s)},f={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},Y={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},B=p.support={},t=u("<p>")[0],g=u.each;function m(t){return null==t?t+"":"object"==typeof t?d[F.call(t)]||"object":typeof t}function _(t,e,i){var s=Y[e.type]||{};return null==
t?i||!e.def?null:e.def:(t=s.floor?~~t:parseFloat(t),isNaN(t)?e.def:s.mod?(t+s.mod)%s.mod:Math.min(s.max,Math.max(0,t)))}function j(s){var n=p(),o=n._rgba=[];return s=s.toLowerCase(),g(R,function(t,e){var i=e.re.exec(s),i=i&&e.parse(i),e=e.space||"rgba";if(i)return i=n[e](i),n[f[e].cache]=i[f[e].cache],o=n._rgba=i._rgba,!1}),o.length?("0,0,0,0"===o.join()&&u.extend(o,y.transparent),n):y[s]}function v(t,e,i){return 6*(i=(i+1)%1)<1?t+(e-t)*i*6:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}t.style.cssText="background-color:rgba(1,1,1,.5)",
B.rgba=-1<t.style.backgroundColor.indexOf("rgba"),g(f,function(t,e){e.cache="_"+t,e.props.alpha={idx:3,type:"percent",def:1}}),u.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(t,e){d["[object "+e+"]"]=e.toLowerCase()}),(p.fn=u.extend(p.prototype,{parse:function(n,t,e,i){if(void 0===n)return this._rgba=[null,null,null,null],this;(n.jquery||n.nodeType)&&(n=u(n).css(t),t=void 0);var o=this,s=m(n),a=this._rgba=[];return void 0!==t&&(n=[n,t,e,i],s="array"),
"string"===s?this.parse(j(n)||y._default):"array"===s?(g(f.rgba.props,function(t,e){a[e.idx]=_(n[e.idx],e)}),this):"object"===s?(n instanceof p?g(f,function(t,e){n[e.cache]&&(o[e.cache]=n[e.cache].slice())}):g(f,function(t,i){var s=i.cache;g(i.props,function(t,e){if(!o[s]&&i.to){if("alpha"===t||null==n[t])return;o[s]=i.to(o._rgba)}o[s][e.idx]=_(n[t],e,!0)}),o[s]&&u.inArray(null,o[s].slice(0,3))<0&&(null==o[s][3]&&(o[s][3]=1),i.from)&&(o._rgba=i.from(o[s]))}),this):void 0},is:function(t){var n=p(t),
o=!0,a=this;return g(f,function(t,e){var i,s=n[e.cache];return s&&(i=a[e.cache]||e.to&&e.to(a._rgba)||[],g(e.props,function(t,e){if(null!=s[e.idx])return o=s[e.idx]===i[e.idx]})),o}),o},_space:function(){var i=[],s=this;return g(f,function(t,e){s[e.cache]&&i.push(t)}),i.pop()},transition:function(t,a){var t=(h=p(t))._space(),e=f[t],i=0===this.alpha()?p("transparent"):this,r=i[e.cache]||e.to(i._rgba),l=r.slice(),h=h[e.cache];return g(e.props,function(t,e){var i=e.idx,s=r[i],n=h[i],o=Y[e.type]||{};
null!==n&&(null===s?l[i]=n:(o.mod&&(n-s>o.mod/2?s+=o.mod:s-n>o.mod/2&&(s-=o.mod)),l[i]=_((n-s)*a+s,e)))}),this[t](l)},blend:function(t){var e,i,s;return 1===this._rgba[3]?this:(e=this._rgba.slice(),i=e.pop(),s=p(t)._rgba,p(u.map(e,function(t,e){return(1-i)*s[e]+i*t})))},toRgbaString:function(){var t="rgba(",e=u.map(this._rgba,function(t,e){return null!=t?t:2<e?1:0});return 1===e[3]&&(e.pop(),t="rgb("),t+e.join()+")"},toHslaString:function(){var t="hsla(",e=u.map(this.hsla(),function(t,e){return null==
t&&(t=2<e?1:0),t=e&&e<3?Math.round(100*t)+"%":t});return 1===e[3]&&(e.pop(),t="hsl("),t+e.join()+")"},toHexString:function(t){var e=this._rgba.slice(),i=e.pop();return t&&e.push(~~(255*i)),"#"+u.map(e,function(t){return 1===(t=(t||0).toString(16)).length?"0"+t:t}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}})).parse.prototype=p.fn,f.hsla.to=function(t){var e,i,s,n,o,a,r,l;return null==t[0]||null==t[1]||null==t[2]?[null,null,null,t[3]]:(e=t[0]/255,i=t[1]/
255,s=t[2]/255,t=t[3],n=(l=Math.max(e,i,s))-(r=Math.min(e,i,s)),a=.5*(o=l+r),r=r===l?0:e===l?60*(i-s)/n+360:i===l?60*(s-e)/n+120:60*(e-i)/n+240,l=0==n?0:a<=.5?n/o:n/(2-o),[Math.round(r)%360,l,a,null==t?1:t])},f.hsla.from=function(t){var e,i,s;return null==t[0]||null==t[1]||null==t[2]?[null,null,null,t[3]]:(e=t[0]/360,s=t[1],i=t[2],t=t[3],s=2*i-(i=i<=.5?i*(1+s):i+s-i*s),[Math.round(255*v(s,i,e+1/3)),Math.round(255*v(s,i,e)),Math.round(255*v(s,i,e-1/3)),t])},g(f,function(r,t){var e=t.props,o=t.cache,
a=t.to,l=t.from;p.fn[r]=function(t){var i,s,n;return a&&!this[o]&&(this[o]=a(this._rgba)),void 0===t?this[o].slice():(i=m(t),s="array"===i||"object"===i?t:arguments,n=this[o].slice(),g(e,function(t,e){t=s["object"===i?t:e.idx];null==t&&(t=n[e.idx]),n[e.idx]=_(t,e)}),l?((t=p(l(n)))[o]=n,t):p(n))},g(e,function(o,a){p.fn[o]||(p.fn[o]=function(t){var e=m(t),i="alpha"===o?this._hsla?"hsla":"rgba":r,s=this[i](),n=s[a.idx];return"undefined"===e?n:("function"===e&&(e=m(t=t.call(this,n))),null==t&&a.empty?
this:("string"===e&&(e=L.exec(t))&&(t=n+parseFloat(e[2])*("+"===e[1]?1:-1)),s[a.idx]=t,this[i](s)))})})}),(p.hook=function(t){t=t.split(" ");g(t,function(t,o){u.cssHooks[o]={set:function(t,e){var i,s,n="";if("transparent"!==e&&("string"!==m(e)||(i=j(e)))){if(e=p(i||e),!B.rgba&&1!==e._rgba[3]){for(s="backgroundColor"===o?t.parentNode:t;(""===n||"transparent"===n)&&s&&s.style;)try{n=u.css(s,"backgroundColor"),s=s.parentNode}catch(t){}e=e.blend(n&&"transparent"!==n?n:"_default")}e=e.toRgbaString()}try{t.style[o]=
e}catch(t){}}},u.fx.step[o]=function(t){t.colorInit||(t.start=p(t.elem,o),t.end=p(t.end),t.colorInit=!0),u.cssHooks[o].set(t.elem,t.start.transition(t.end,t.pos))}})})("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor"),u.cssHooks.borderColor={expand:function(i){var s={};return g(["Top","Right","Bottom","Left"],function(t,e){s["border"+e+"Color"]=i}),s}};var q,K,U,X,$,G,Q,J,Z,b,y=u.Color.names=
{aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"},w="ui-effects-",e="ui-effects-style",T="ui-effects-animated";function tt(t){var e,i,s=t.ownerDocument.defaultView?t.ownerDocument.defaultView.getComputedStyle(t,null):t.currentStyle,n={};if(s&&s.length&&
s[0]&&s[s[0]])for(i=s.length;i--;)"string"==typeof s[e=s[i]]&&(n[e.replace(/-([\da-z])/gi,function(t,e){return e.toUpperCase()})]=s[e]);else for(e in s)"string"==typeof s[e]&&(n[e]=s[e]);return n}function P(t,e,i,s){return t={effect:t=V.isPlainObject(t)?(e=t).effect:t},"function"==typeof(e=null==e?{}:e)&&(s=e,i=null,e={}),"number"!=typeof e&&!V.fx.speeds[e]||(s=i,i=e,e={}),"function"==typeof i&&(s=i,i=null),e&&V.extend(t,e),i=i||e.duration,t.duration=V.fx.off?0:"number"==typeof i?i:i in V.fx.speeds?
V.fx.speeds[i]:V.fx.speeds._default,t.complete=s||e.complete,t}function M(t){return!t||"number"==typeof t||V.fx.speeds[t]||"string"==typeof t&&!V.effects.effect[t]||"function"==typeof t||"object"==typeof t&&!t.effect}function et(t,e){var i=e.outerWidth(),e=e.outerHeight(),t=/^rect\((-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto),?\s*(-?\d*\.?\d*px|-?\d+%|auto)\)$/.exec(t)||["",0,i,e,0];return{top:parseFloat(t[1])||0,right:"auto"===t[2]?i:parseFloat(t[2]),
bottom:"auto"===t[3]?e:parseFloat(t[3]),left:parseFloat(t[4])||0}}V.effects={effect:{}},X=["add","remove","toggle"],$={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1},V.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(t,e){V.fx.step[e]=function(t){("none"!==t.end&&!t.setAttr||1===t.pos&&!t.setAttr)&&(u.style(t.elem,e,t.end),t.setAttr=!0)}}),V.fn.addBack||(V.fn.addBack=function(t){return this.add(null==
t?this.prevObject:this.prevObject.filter(t))}),V.effects.animateClass=function(n,t,e,i){var o=V.speed(t,e,i);return this.queue(function(){var i=V(this),t=i.attr("class")||"",e=(e=o.children?i.find("*").addBack():i).map(function(){return{el:V(this),start:tt(this)}}),s=function(){V.each(X,function(t,e){n[e]&&i[e+"Class"](n[e])})};s(),e=e.map(function(){return this.end=tt(this.el[0]),this.diff=function(t,e){var i,s,n={};for(i in e)s=e[i],t[i]===s||$[i]||!V.fx.step[i]&&isNaN(parseFloat(s))||(n[i]=s);
return n}(this.start,this.end),this}),i.attr("class",t),e=e.map(function(){var t=this,e=V.Deferred(),i=V.extend({},o,{queue:!1,complete:function(){e.resolve(t)}});return this.el.animate(this.diff,i),e.promise()}),V.when.apply(V,e.get()).done(function(){s(),V.each(arguments,function(){var e=this.el;V.each(this.diff,function(t){e.css(t,"")})}),o.complete.call(i[0])})})},V.fn.extend({addClass:(U=V.fn.addClass,function(t,e,i,s){return e?V.effects.animateClass.call(this,{add:t},e,i,s):U.apply(this,arguments)}),
removeClass:(K=V.fn.removeClass,function(t,e,i,s){return 1<arguments.length?V.effects.animateClass.call(this,{remove:t},e,i,s):K.apply(this,arguments)}),toggleClass:(q=V.fn.toggleClass,function(t,e,i,s,n){return"boolean"==typeof e||void 0===e?i?V.effects.animateClass.call(this,e?{add:t}:{remove:t},i,s,n):q.apply(this,arguments):V.effects.animateClass.call(this,{toggle:t},e,i,s)}),switchClass:function(t,e,i,s,n){return V.effects.animateClass.call(this,{add:e,remove:t},i,s,n)}}),V.expr&&V.expr.pseudos&&
V.expr.pseudos.animated&&(V.expr.pseudos.animated=(G=V.expr.pseudos.animated,function(t){return!!V(t).data(T)||G(t)})),!1!==V.uiBackCompat&&V.extend(V.effects,{save:function(t,e){for(var i=0,s=e.length;i<s;i++)null!==e[i]&&t.data(w+e[i],t[0].style[e[i]])},restore:function(t,e){for(var i,s=0,n=e.length;s<n;s++)null!==e[s]&&(i=t.data(w+e[s]),t.css(e[s],i))},setMode:function(t,e){return e="toggle"===e?t.is(":hidden")?"show":"hide":e},createWrapper:function(i){if(i.parent().is(".ui-effects-wrapper"))return i.parent();
var s={width:i.outerWidth(!0),height:i.outerHeight(!0),float:i.css("float")},t=V("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),e={width:i.width(),height:i.height()},n=document.activeElement;try{n.id}catch(t){n=document.body}return i.wrap(t),i[0]!==n&&!V.contains(i[0],n)||V(n).trigger("focus"),t=i.parent(),"static"===i.css("position")?(t.css({position:"relative"}),i.css({position:"relative"})):(V.extend(s,{position:i.css("position"),
zIndex:i.css("z-index")}),V.each(["top","left","bottom","right"],function(t,e){s[e]=i.css(e),isNaN(parseInt(s[e],10))&&(s[e]="auto")}),i.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),i.css(e),t.css(s).show()},removeWrapper:function(t){var e=document.activeElement;return t.parent().is(".ui-effects-wrapper")&&(t.parent().replaceWith(t),t[0]!==e&&!V.contains(t[0],e)||V(e).trigger("focus")),t}}),V.extend(V.effects,{version:"1.13.3",define:function(t,e,i){return i||(i=e,e="effect"),
V.effects.effect[t]=i,V.effects.effect[t].mode=e,i},scaledDimensions:function(t,e,i){var s;return 0===e?{height:0,width:0,outerHeight:0,outerWidth:0}:(s="horizontal"!==i?(e||100)/100:1,i="vertical"!==i?(e||100)/100:1,{height:t.height()*i,width:t.width()*s,outerHeight:t.outerHeight()*i,outerWidth:t.outerWidth()*s})},clipToBox:function(t){return{width:t.clip.right-t.clip.left,height:t.clip.bottom-t.clip.top,left:t.clip.left,top:t.clip.top}},unshift:function(t,e,i){var s=t.queue();1<e&&s.splice.apply(s,
[1,0].concat(s.splice(e,i))),t.dequeue()},saveStyle:function(t){t.data(e,t[0].style.cssText)},restoreStyle:function(t){t[0].style.cssText=t.data(e)||"",t.removeData(e)},mode:function(t,e){t=t.is(":hidden");return"toggle"===e&&(e=t?"show":"hide"),e=(t?"hide"===e:"show"===e)?"none":e},getBaseline:function(t,e){var i,s;switch(t[0]){case "top":i=0;break;case "middle":i=.5;break;case "bottom":i=1;break;default:i=t[0]/e.height}switch(t[1]){case "left":s=0;break;case "center":s=.5;break;case "right":s=1;
break;default:s=t[1]/e.width}return{x:s,y:i}},createPlaceholder:function(t){var e,i=t.css("position"),s=t.position();return t.css({marginTop:t.css("marginTop"),marginBottom:t.css("marginBottom"),marginLeft:t.css("marginLeft"),marginRight:t.css("marginRight")}).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()),/^(static|relative)/.test(i)&&(i="absolute",e=V("<"+t[0].nodeName+">").insertAfter(t).css({display:/^(inline|ruby)/.test(t.css("display"))?"inline-block":"block",visibility:"hidden",marginTop:t.css("marginTop"),
marginBottom:t.css("marginBottom"),marginLeft:t.css("marginLeft"),marginRight:t.css("marginRight"),float:t.css("float")}).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).addClass("ui-effects-placeholder"),t.data(w+"placeholder",e)),t.css({position:i,left:s.left,top:s.top}),e},removePlaceholder:function(t){var e=w+"placeholder",i=t.data(e);i&&(i.remove(),t.removeData(e))},cleanUp:function(t){V.effects.restoreStyle(t),V.effects.removePlaceholder(t)},setTransition:function(s,t,n,o){return o=
o||{},V.each(t,function(t,e){var i=s.cssUnit(e);0<i[0]&&(o[e]=i[0]*n+i[1])}),o}}),V.fn.extend({effect:function(){function t(t){var e=V(this),i=V.effects.mode(e,r)||o;e.data(T,!0),l.push(i),o&&("show"===i||i===o&&"hide"===i)&&e.show(),o&&"none"===i||V.effects.saveStyle(e),"function"==typeof t&&t()}var s=P.apply(this,arguments),n=V.effects.effect[s.effect],o=n.mode,e=s.queue,i=e||"fx",a=s.complete,r=s.mode,l=[];return V.fx.off||!n?r?this[r](s.duration,a):this.each(function(){a&&a.call(this)}):!1===
e?this.each(t).each(h):this.queue(i,t).queue(i,h);function h(t){var e=V(this);function i(){"function"==typeof a&&a.call(e[0]),"function"==typeof t&&t()}s.mode=l.shift(),!1===V.uiBackCompat||o?"none"===s.mode?(e[r](),i()):n.call(e[0],s,function(){e.removeData(T),V.effects.cleanUp(e),"hide"===s.mode&&e.hide(),i()}):(e.is(":hidden")?"hide"===r:"show"===r)?(e[r](),i()):n.call(e[0],s,i)}},show:(Z=V.fn.show,function(t){return M(t)?Z.apply(this,arguments):((t=P.apply(this,arguments)).mode="show",this.effect.call(this,
t))}),hide:(J=V.fn.hide,function(t){return M(t)?J.apply(this,arguments):((t=P.apply(this,arguments)).mode="hide",this.effect.call(this,t))}),toggle:(Q=V.fn.toggle,function(t){return M(t)||"boolean"==typeof t?Q.apply(this,arguments):((t=P.apply(this,arguments)).mode="toggle",this.effect.call(this,t))}),cssUnit:function(t){var i=this.css(t),s=[];return V.each(["em","px","%","pt"],function(t,e){0<i.indexOf(e)&&(s=[parseFloat(i),e])}),s},cssClip:function(t){return t?this.css("clip","rect("+t.top+"px "+
t.right+"px "+t.bottom+"px "+t.left+"px)"):et(this.css("clip"),this)},transfer:function(t,e){var i=V(this),s=V(t.to),n="fixed"===s.css("position"),o=V("body"),a=n?o.scrollTop():0,o=n?o.scrollLeft():0,r=s.offset(),r={top:r.top-a,left:r.left-o,height:s.innerHeight(),width:s.innerWidth()},s=i.offset(),l=V("<div class='ui-effects-transfer'></div>");l.appendTo("body").addClass(t.className).css({top:s.top-a,left:s.left-o,height:i.innerHeight(),width:i.innerWidth(),position:n?"fixed":"absolute"}).animate(r,
t.duration,t.easing,function(){l.remove(),"function"==typeof e&&e()})}}),V.fx.step.clip=function(t){t.clipInit||(t.start=V(t.elem).cssClip(),"string"==typeof t.end&&(t.end=et(t.end,t.elem)),t.clipInit=!0),V(t.elem).cssClip({top:t.pos*(t.end.top-t.start.top)+t.start.top,right:t.pos*(t.end.right-t.start.right)+t.start.right,bottom:t.pos*(t.end.bottom-t.start.bottom)+t.start.bottom,left:t.pos*(t.end.left-t.start.left)+t.start.left})},b={},V.each(["Quad","Cubic","Quart","Quint","Expo"],function(e,t){b[t]=
function(t){return Math.pow(t,e+2)}}),V.extend(b,{Sine:function(t){return 1-Math.cos(t*Math.PI/2)},Circ:function(t){return 1-Math.sqrt(1-t*t)},Elastic:function(t){return 0===t||1===t?t:-Math.pow(2,8*(t-1))*Math.sin((80*(t-1)-7.5)*Math.PI/15)},Back:function(t){return t*t*(3*t-2)},Bounce:function(t){for(var e,i=4;t<((e=Math.pow(2,--i))-1)/11;);return 1/Math.pow(4,3-i)-7.5625*Math.pow((3*e-2)/22-t,2)}}),V.each(b,function(t,e){V.easing["easeIn"+t]=e,V.easing["easeOut"+t]=function(t){return 1-e(1-t)},
V.easing["easeInOut"+t]=function(t){return t<.5?e(2*t)/2:1-e(-2*t+2)/2}});t=V.effects;V.effects.define("blind","hide",function(t,e){var i={up:["bottom","top"],vertical:["bottom","top"],down:["top","bottom"],left:["right","left"],horizontal:["right","left"],right:["left","right"]},s=V(this),n=t.direction||"up",o=s.cssClip(),a={clip:V.extend({},o)},r=V.effects.createPlaceholder(s);a.clip[i[n][0]]=a.clip[i[n][1]],"show"===t.mode&&(s.cssClip(a.clip),r&&r.css(V.effects.clipToBox(a)),a.clip=o),r&&r.animate(V.effects.clipToBox(a),
t.duration,t.easing),s.animate(a,{queue:!1,duration:t.duration,easing:t.easing,complete:e})}),V.effects.define("bounce",function(t,e){var i,s,n=V(this),o=t.mode,a="hide"===o,o="show"===o,r=t.direction||"up",l=t.distance,h=t.times||5,c=2*h+(o||a?1:0),u=t.duration/c,d=t.easing,p="up"===r||"down"===r?"top":"left",f="up"===r||"left"===r,g=0,t=n.queue().length;for(V.effects.createPlaceholder(n),r=n.css(p),l=l||n["top"==p?"outerHeight":"outerWidth"]()/3,o&&((s={opacity:1})[p]=r,n.css("opacity",0).css(p,
f?2*-l:2*l).animate(s,u,d)),a&&(l/=Math.pow(2,h-1)),(s={})[p]=r;g<h;g++)(i={})[p]=(f?"-=":"+=")+l,n.animate(i,u,d).animate(s,u,d),l=a?2*l:l/2;a&&((i={opacity:0})[p]=(f?"-=":"+=")+l,n.animate(i,u,d)),n.queue(e),V.effects.unshift(n,t,1+c)}),V.effects.define("clip","hide",function(t,e){var i={},s=V(this),n=t.direction||"vertical",o="both"===n,a=o||"horizontal"===n,o=o||"vertical"===n,n=s.cssClip();i.clip={top:o?(n.bottom-n.top)/2:n.top,right:a?(n.right-n.left)/2:n.right,bottom:o?(n.bottom-n.top)/2:n.bottom,
left:a?(n.right-n.left)/2:n.left},V.effects.createPlaceholder(s),"show"===t.mode&&(s.cssClip(i.clip),i.clip=n),s.animate(i,{queue:!1,duration:t.duration,easing:t.easing,complete:e})}),V.effects.define("drop","hide",function(t,e){var i,s=V(this),n="show"===t.mode,o=t.direction||"left",a="up"===o||"down"===o?"top":"left",o="up"===o||"left"===o?"-=":"+=",r="+="==o?"-=":"+=",l={opacity:0};V.effects.createPlaceholder(s),i=t.distance||s["top"==a?"outerHeight":"outerWidth"](!0)/2,l[a]=o+i,n&&(s.css(l),l[a]=
r+i,l.opacity=1),s.animate(l,{queue:!1,duration:t.duration,easing:t.easing,complete:e})}),V.effects.define("explode","hide",function(t,e){var i,s,n,o,a,r,l=t.pieces?Math.round(Math.sqrt(t.pieces)):3,h=l,c=V(this),u="show"===t.mode,d=c.show().css("visibility","hidden").offset(),p=Math.ceil(c.outerWidth()/h),f=Math.ceil(c.outerHeight()/l),g=[];function m(){g.push(this),g.length===l*h&&(c.css({visibility:"visible"}),V(g).remove(),e())}for(i=0;i<l;i++)for(o=d.top+i*f,r=i-(l-1)/2,s=0;s<h;s++)n=d.left+
s*p,a=s-(h-1)/2,c.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-s*p,top:-i*f}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:p,height:f,left:n+(u?a*p:0),top:o+(u?r*f:0),opacity:u?0:1}).animate({left:n+(u?0:a*p),top:o+(u?0:r*f),opacity:u?1:0},t.duration||500,t.easing,m)}),V.effects.define("fade","toggle",function(t,e){var i="show"===t.mode;V(this).css("opacity",i?0:1).animate({opacity:i?1:0},{queue:!1,duration:t.duration,
easing:t.easing,complete:e})}),V.effects.define("fold","hide",function(e,t){var i=V(this),s=e.mode,n="show"===s,s="hide"===s,o=e.size||15,a=/([0-9]+)%/.exec(o),r=!!e.horizFirst?["right","bottom"]:["bottom","right"],l=e.duration/2,h=V.effects.createPlaceholder(i),c=i.cssClip(),u={clip:V.extend({},c)},d={clip:V.extend({},c)},p=[c[r[0]],c[r[1]]],f=i.queue().length;a&&(o=parseInt(a[1],10)/100*p[s?0:1]),u.clip[r[0]]=o,d.clip[r[0]]=o,d.clip[r[1]]=0,n&&(i.cssClip(d.clip),h&&h.css(V.effects.clipToBox(d)),
d.clip=c),i.queue(function(t){h&&h.animate(V.effects.clipToBox(u),l,e.easing).animate(V.effects.clipToBox(d),l,e.easing),t()}).animate(u,l,e.easing).animate(d,l,e.easing).queue(t),V.effects.unshift(i,f,4)}),V.effects.define("highlight","show",function(t,e){var i=V(this),s={backgroundColor:i.css("backgroundColor")};"hide"===t.mode&&(s.opacity=0),V.effects.saveStyle(i),i.css({backgroundImage:"none",backgroundColor:t.color||"#ffff99"}).animate(s,{queue:!1,duration:t.duration,easing:t.easing,complete:e})}),
V.effects.define("size",function(s,e){var n,i=V(this),t=["fontSize"],o=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],a=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],r=s.mode,l="effect"!==r,h=s.scale||"both",c=s.origin||["middle","center"],u=i.css("position"),d=i.position(),p=V.effects.scaledDimensions(i),f=s.from||p,g=s.to||V.effects.scaledDimensions(i,0);V.effects.createPlaceholder(i),"show"===r&&(r=f,f=g,g=r),n={from:{y:f.height/p.height,x:f.width/p.width},
to:{y:g.height/p.height,x:g.width/p.width}},"box"!==h&&"both"!==h||(n.from.y!==n.to.y&&(f=V.effects.setTransition(i,o,n.from.y,f),g=V.effects.setTransition(i,o,n.to.y,g)),n.from.x!==n.to.x&&(f=V.effects.setTransition(i,a,n.from.x,f),g=V.effects.setTransition(i,a,n.to.x,g))),"content"!==h&&"both"!==h||n.from.y!==n.to.y&&(f=V.effects.setTransition(i,t,n.from.y,f),g=V.effects.setTransition(i,t,n.to.y,g)),c&&(r=V.effects.getBaseline(c,p),f.top=(p.outerHeight-f.outerHeight)*r.y+d.top,f.left=(p.outerWidth-
f.outerWidth)*r.x+d.left,g.top=(p.outerHeight-g.outerHeight)*r.y+d.top,g.left=(p.outerWidth-g.outerWidth)*r.x+d.left),delete f.outerHeight,delete f.outerWidth,i.css(f),"content"!==h&&"both"!==h||(o=o.concat(["marginTop","marginBottom"]).concat(t),a=a.concat(["marginLeft","marginRight"]),i.find("*[width]").each(function(){var t=V(this),e=V.effects.scaledDimensions(t),i={height:e.height*n.from.y,width:e.width*n.from.x,outerHeight:e.outerHeight*n.from.y,outerWidth:e.outerWidth*n.from.x},e={height:e.height*
n.to.y,width:e.width*n.to.x,outerHeight:e.height*n.to.y,outerWidth:e.width*n.to.x};n.from.y!==n.to.y&&(i=V.effects.setTransition(t,o,n.from.y,i),e=V.effects.setTransition(t,o,n.to.y,e)),n.from.x!==n.to.x&&(i=V.effects.setTransition(t,a,n.from.x,i),e=V.effects.setTransition(t,a,n.to.x,e)),l&&V.effects.saveStyle(t),t.css(i),t.animate(e,s.duration,s.easing,function(){l&&V.effects.restoreStyle(t)})})),i.animate(g,{queue:!1,duration:s.duration,easing:s.easing,complete:function(){var t=i.offset();0===g.opacity&&
i.css("opacity",f.opacity),l||(i.css("position","static"===u?"relative":u).offset(t),V.effects.saveStyle(i)),e()}})}),V.effects.define("scale",function(t,e){var i=V(this),s=t.mode,s=parseInt(t.percent,10)||(0===parseInt(t.percent,10)||"effect"!==s?0:100),i=V.extend(!0,{from:V.effects.scaledDimensions(i),to:V.effects.scaledDimensions(i,s,t.direction||"both"),origin:t.origin||["middle","center"]},t);t.fade&&(i.from.opacity=1,i.to.opacity=0),V.effects.effect.size.call(this,i,e)}),V.effects.define("puff",
"hide",function(t,e){t=V.extend(!0,{},t,{fade:!0,percent:parseInt(t.percent,10)||150});V.effects.effect.scale.call(this,t,e)}),V.effects.define("pulsate","show",function(t,e){var i=V(this),s=t.mode,n="show"===s,o=2*(t.times||5)+(n||"hide"===s?1:0),a=t.duration/o,r=0,l=1,s=i.queue().length;for(!n&&i.is(":visible")||(i.css("opacity",0).show(),r=1);l<o;l++)i.animate({opacity:r},a,t.easing),r=1-r;i.animate({opacity:r},a,t.easing),i.queue(e),V.effects.unshift(i,s,1+o)}),V.effects.define("shake",function(t,
e){var i=1,s=V(this),n=t.direction||"left",o=t.distance||20,a=t.times||3,r=2*a+1,l=Math.round(t.duration/r),h="up"===n||"down"===n?"top":"left",n="up"===n||"left"===n,c={},u={},d={},p=s.queue().length;for(V.effects.createPlaceholder(s),c[h]=(n?"-=":"+=")+o,u[h]=(n?"+=":"-=")+2*o,d[h]=(n?"-=":"+=")+2*o,s.animate(c,l,t.easing);i<a;i++)s.animate(u,l,t.easing).animate(d,l,t.easing);s.animate(u,l,t.easing).animate(c,l/2,t.easing).queue(e),V.effects.unshift(s,p,1+r)}),V.effects.define("slide","show",function(t,
e){var i,s,n=V(this),o={up:["bottom","top"],down:["top","bottom"],left:["right","left"],right:["left","right"]},a=t.mode,r=t.direction||"left",l="up"===r||"down"===r?"top":"left",h="up"===r||"left"===r,c=t.distance||n["top"==l?"outerHeight":"outerWidth"](!0),u={};V.effects.createPlaceholder(n),i=n.cssClip(),s=n.position()[l],u[l]=(h?-1:1)*c+s,u.clip=n.cssClip(),u.clip[o[r][1]]=u.clip[o[r][0]],"show"===a&&(n.cssClip(u.clip),n.css(l,u[l]),u.clip=i,u[l]=s),n.animate(u,{queue:!1,duration:t.duration,easing:t.easing,
complete:e})}),t=!1!==V.uiBackCompat?V.effects.define("transfer",function(t,e){V(this).transfer(t,e)}):t;V.ui.focusable=function(t,e){var i,s,n,o=t.nodeName.toLowerCase();return"area"===o?(n=(i=t.parentNode).name,!(!t.href||!n||"map"!==i.nodeName.toLowerCase())&&0<(i=V("img[usemap='#"+n+"']")).length&&i.is(":visible")):(/^(input|select|textarea|button|object)$/.test(o)?(s=!t.disabled)&&(n=V(t).closest("fieldset")[0])&&(s=!n.disabled):s="a"===o&&t.href||e,s&&V(t).is(":visible")&&function(t){var e=
t.css("visibility");for(;"inherit"===e;)t=t.parent(),e=t.css("visibility");return"visible"===e}(V(t)))},V.extend(V.expr.pseudos,{focusable:function(t){return V.ui.focusable(t,null!=V.attr(t,"tabindex"))}});V.ui.focusable,V.fn._form=function(){return"string"==typeof this[0].form?this.closest("form"):V(this[0].form)},V.ui.formResetMixin={_formResetHandler:function(){var e=V(this);setTimeout(function(){var t=e.data("ui-form-reset-instances");V.each(t,function(){this.refresh()})})},_bindFormResetHandler:function(){var t;
this.form=this.element._form(),this.form.length&&((t=this.form.data("ui-form-reset-instances")||[]).length||this.form.on("reset.ui-form-reset",this._formResetHandler),t.push(this),this.form.data("ui-form-reset-instances",t))},_unbindFormResetHandler:function(){var t;this.form.length&&((t=this.form.data("ui-form-reset-instances")).splice(V.inArray(this,t),1),t.length?this.form.data("ui-form-reset-instances",t):this.form.removeData("ui-form-reset-instances").off("reset.ui-form-reset"))}},V.expr.pseudos||
(V.expr.pseudos=V.expr[":"]),V.uniqueSort||(V.uniqueSort=V.unique),V.escapeSelector||(it=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\x80-\uFFFF\w-]/g,st=function(t,e){return e?"\x00"===t?"\ufffd":t.slice(0,-1)+"\\"+t.charCodeAt(t.length-1).toString(16)+" ":"\\"+t},V.escapeSelector=function(t){return(t+"").replace(it,st)}),V.fn.even&&V.fn.odd||V.fn.extend({even:function(){return this.filter(function(t){return t%2==0})},odd:function(){return this.filter(function(t){return t%2==1})}}),V.ui.keyCode={BACKSPACE:8,COMMA:188,
DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38},V.fn.labels=function(){var t,e,i;return this.length?this[0].labels&&this[0].labels.length?this.pushStack(this[0].labels):(e=this.eq(0).parents("label"),(t=this.attr("id"))&&(i=(i=this.eq(0).parents().last()).add((i.length?i:this).siblings()),t="label[for='"+V.escapeSelector(t)+"']",e=e.add(i.find(t).addBack(t))),this.pushStack(e)):this.pushStack([])},V.fn.scrollParent=function(t){var e=
this.css("position"),i="absolute"===e,s=t?/(auto|scroll|hidden)/:/(auto|scroll)/,t=this.parents().filter(function(){var t=V(this);return(!i||"static"!==t.css("position"))&&s.test(t.css("overflow")+t.css("overflow-y")+t.css("overflow-x"))}).eq(0);return"fixed"!==e&&t.length?t:V(this[0].ownerDocument||document)},V.extend(V.expr.pseudos,{tabbable:function(t){var e=V.attr(t,"tabindex"),i=null!=e;return(!i||0<=e)&&V.ui.focusable(t,i)}}),V.fn.extend({uniqueId:(nt=0,function(){return this.each(function(){this.id||
(this.id="ui-id-"+ ++nt)})}),removeUniqueId:function(){return this.each(function(){/^ui-id-\d+$/.test(this.id)&&V(this).removeAttr("id")})}}),V.widget("ui.accordion",{version:"1.13.3",options:{active:0,animate:{},classes:{"ui-accordion-header":"ui-corner-top","ui-accordion-header-collapsed":"ui-corner-all","ui-accordion-content":"ui-corner-bottom"},collapsible:!1,event:"click",header:function(t){return t.find("> li > :first-child").add(t.find("> :not(li)").even())},heightStyle:"auto",icons:{activeHeader:"ui-icon-triangle-1-s",
header:"ui-icon-triangle-1-e"},activate:null,beforeActivate:null},hideProps:{borderTopWidth:"hide",borderBottomWidth:"hide",paddingTop:"hide",paddingBottom:"hide",height:"hide"},showProps:{borderTopWidth:"show",borderBottomWidth:"show",paddingTop:"show",paddingBottom:"show",height:"show"},_create:function(){var t=this.options;this.prevShow=this.prevHide=V(),this._addClass("ui-accordion","ui-widget ui-helper-reset"),this.element.attr("role","tablist"),t.collapsible||!1!==t.active&&null!=t.active||
(t.active=0),this._processPanels(),t.active<0&&(t.active+=this.headers.length),this._refresh()},_getCreateEventData:function(){return{header:this.active,panel:this.active.length?this.active.next():V()}},_createIcons:function(){var t,e=this.options.icons;e&&(t=V("<span>"),this._addClass(t,"ui-accordion-header-icon","ui-icon "+e.header),t.prependTo(this.headers),t=this.active.children(".ui-accordion-header-icon"),this._removeClass(t,e.header)._addClass(t,null,e.activeHeader)._addClass(this.headers,
"ui-accordion-icons"))},_destroyIcons:function(){this._removeClass(this.headers,"ui-accordion-icons"),this.headers.children(".ui-accordion-header-icon").remove()},_destroy:function(){var t;this.element.removeAttr("role"),this.headers.removeAttr("role aria-expanded aria-selected aria-controls tabIndex").removeUniqueId(),this._destroyIcons(),t=this.headers.next().css("display","").removeAttr("role aria-hidden aria-labelledby").removeUniqueId(),"content"!==this.options.heightStyle&&t.css("height","")},
_setOption:function(t,e){"active"===t?this._activate(e):("event"===t&&(this.options.event&&this._off(this.headers,this.options.event),this._setupEvents(e)),this._super(t,e),"collapsible"!==t||e||!1!==this.options.active||this._activate(0),"icons"===t&&(this._destroyIcons(),e)&&this._createIcons())},_setOptionDisabled:function(t){this._super(t),this.element.attr("aria-disabled",t),this._toggleClass(null,"ui-state-disabled",!!t),this._toggleClass(this.headers.add(this.headers.next()),null,"ui-state-disabled",
!!t)},_keydown:function(t){if(!t.altKey&&!t.ctrlKey){var e=V.ui.keyCode,i=this.headers.length,s=this.headers.index(t.target),n=!1;switch(t.keyCode){case e.RIGHT:case e.DOWN:n=this.headers[(s+1)%i];break;case e.LEFT:case e.UP:n=this.headers[(s-1+i)%i];break;case e.SPACE:case e.ENTER:this._eventHandler(t);break;case e.HOME:n=this.headers[0];break;case e.END:n=this.headers[i-1]}n&&(V(t.target).attr("tabIndex",-1),V(n).attr("tabIndex",0),V(n).trigger("focus"),t.preventDefault())}},_panelKeyDown:function(t){t.keyCode===
V.ui.keyCode.UP&&t.ctrlKey&&V(t.currentTarget).prev().trigger("focus")},refresh:function(){var t=this.options;this._processPanels(),!1===t.active&&!0===t.collapsible||!this.headers.length?(t.active=!1,this.active=V()):!1===t.active?this._activate(0):this.active.length&&!V.contains(this.element[0],this.active[0])?this.headers.length===this.headers.find(".ui-state-disabled").length?(t.active=!1,this.active=V()):this._activate(Math.max(0,t.active-1)):t.active=this.headers.index(this.active),this._destroyIcons(),
this._refresh()},_processPanels:function(){var t=this.headers,e=this.panels;"function"==typeof this.options.header?this.headers=this.options.header(this.element):this.headers=this.element.find(this.options.header),this._addClass(this.headers,"ui-accordion-header ui-accordion-header-collapsed","ui-state-default"),this.panels=this.headers.next().filter(":not(.ui-accordion-content-active)").hide(),this._addClass(this.panels,"ui-accordion-content","ui-helper-reset ui-widget-content"),e&&(this._off(t.not(this.headers)),
this._off(e.not(this.panels)))},_refresh:function(){var i,t=this.options,e=t.heightStyle,s=this.element.parent();this.active=this._findActive(t.active),this._addClass(this.active,"ui-accordion-header-active","ui-state-active")._removeClass(this.active,"ui-accordion-header-collapsed"),this._addClass(this.active.next(),"ui-accordion-content-active"),this.active.next().show(),this.headers.attr("role","tab").each(function(){var t=V(this),e=t.uniqueId().attr("id"),i=t.next(),s=i.uniqueId().attr("id");
t.attr("aria-controls",s),i.attr("aria-labelledby",e)}).next().attr("role","tabpanel"),this.headers.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}).next().attr({"aria-hidden":"true"}).hide(),this.active.length?this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}).next().attr({"aria-hidden":"false"}):this.headers.eq(0).attr("tabIndex",0),this._createIcons(),this._setupEvents(t.event),"fill"===e?(i=s.height(),this.element.siblings(":visible").each(function(){var t=
V(this),e=t.css("position");"absolute"!==e&&"fixed"!==e&&(i-=t.outerHeight(!0))}),this.headers.each(function(){i-=V(this).outerHeight(!0)}),this.headers.next().each(function(){V(this).height(Math.max(0,i-V(this).innerHeight()+V(this).height()))}).css("overflow","auto")):"auto"===e&&(i=0,this.headers.next().each(function(){var t=V(this).is(":visible");t||V(this).show(),i=Math.max(i,V(this).css("height","").height()),t||V(this).hide()}).height(i))},_activate:function(t){t=this._findActive(t)[0];t!==
this.active[0]&&(t=t||this.active[0],this._eventHandler({target:t,currentTarget:t,preventDefault:V.noop}))},_findActive:function(t){return"number"==typeof t?this.headers.eq(t):V()},_setupEvents:function(t){var i={keydown:"_keydown"};t&&V.each(t.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.headers.add(this.headers.next())),this._on(this.headers,i),this._on(this.headers.next(),{keydown:"_panelKeyDown"}),this._hoverable(this.headers),this._focusable(this.headers)},_eventHandler:function(t){var e=
this.options,i=this.active,s=V(t.currentTarget),n=s[0]===i[0],o=n&&e.collapsible,a=o?V():s.next(),r=i.next(),r={oldHeader:i,oldPanel:r,newHeader:o?V():s,newPanel:a};t.preventDefault(),n&&!e.collapsible||!1===this._trigger("beforeActivate",t,r)||(e.active=!o&&this.headers.index(s),this.active=n?V():s,this._toggle(r),this._removeClass(i,"ui-accordion-header-active","ui-state-active"),e.icons&&(a=i.children(".ui-accordion-header-icon"),this._removeClass(a,null,e.icons.activeHeader)._addClass(a,null,
e.icons.header)),n)||(this._removeClass(s,"ui-accordion-header-collapsed")._addClass(s,"ui-accordion-header-active","ui-state-active"),e.icons&&(t=s.children(".ui-accordion-header-icon"),this._removeClass(t,null,e.icons.header)._addClass(t,null,e.icons.activeHeader)),this._addClass(s.next(),"ui-accordion-content-active"))},_toggle:function(t){var e=t.newPanel,i=this.prevShow.length?this.prevShow:t.oldPanel;this.prevShow.add(this.prevHide).stop(!0,!0),this.prevShow=e,this.prevHide=i,this.options.animate?
this._animate(e,i,t):(i.hide(),e.show(),this._toggleComplete(t)),i.attr({"aria-hidden":"true"}),i.prev().attr({"aria-selected":"false","aria-expanded":"false"}),e.length&&i.length?i.prev().attr({tabIndex:-1,"aria-expanded":"false"}):e.length&&this.headers.filter(function(){return 0===parseInt(V(this).attr("tabIndex"),10)}).attr("tabIndex",-1),e.attr("aria-hidden","false").prev().attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_animate:function(t,i,e){function s(){o._toggleComplete(e)}
var n,o=this,a=0,r=t.css("box-sizing"),l=t.length&&(!i.length||t.index()<i.index()),h=this.options.animate||{},l=l&&h.down||h,c=(c="string"==typeof l?l:c)||l.easing||h.easing,u=(u="number"==typeof l?l:u)||l.duration||h.duration;return i.length?t.length?(n=t.show().outerHeight(),i.animate(this.hideProps,{duration:u,easing:c,step:function(t,e){e.now=Math.round(t)}}),void t.hide().animate(this.showProps,{duration:u,easing:c,complete:s,step:function(t,e){e.now=Math.round(t),"height"!==e.prop?"content-box"===
r&&(a+=e.now):"content"!==o.options.heightStyle&&(e.now=Math.round(n-i.outerHeight()-a),a=0)}})):i.animate(this.hideProps,u,c,s):t.animate(this.showProps,u,c,s)},_toggleComplete:function(t){var e=t.oldPanel,i=e.prev();this._removeClass(e,"ui-accordion-content-active"),this._removeClass(i,"ui-accordion-header-active")._addClass(i,"ui-accordion-header-collapsed"),e.length&&(e.parent()[0].className=e.parent()[0].className),this._trigger("activate",null,t)}}),V.ui.safeActiveElement=function(e){var i;
try{i=e.activeElement}catch(t){i=e.body}return i=(i=i||e.body).nodeName?i:e.body},V.widget("ui.menu",{version:"1.13.3",defaultElement:"<ul>",delay:300,options:{icons:{submenu:"ui-icon-caret-1-e"},items:"> *",menus:"ul",position:{my:"left top",at:"right top"},role:"menu",blur:null,focus:null,select:null},_create:function(){this.activeMenu=this.element,this.mouseHandled=!1,this.lastMousePosition={x:null,y:null},this.element.uniqueId().attr({role:this.options.role,tabIndex:0}),this._addClass("ui-menu",
"ui-widget ui-widget-content"),this._on({"mousedown .ui-menu-item":function(t){t.preventDefault(),this._activateItem(t)},"click .ui-menu-item":function(t){var e=V(t.target),i=V(V.ui.safeActiveElement(this.document[0]));!this.mouseHandled&&e.not(".ui-state-disabled").length&&(this.select(t),t.isPropagationStopped()||(this.mouseHandled=!0),e.has(".ui-menu").length?this.expand(t):!this.element.is(":focus")&&i.closest(".ui-menu").length&&(this.element.trigger("focus",[!0]),this.active)&&1===this.active.parents(".ui-menu").length&&
clearTimeout(this.timer))},"mouseenter .ui-menu-item":"_activateItem","mousemove .ui-menu-item":"_activateItem",mouseleave:"collapseAll","mouseleave .ui-menu":"collapseAll",focus:function(t,e){var i=this.active||this._menuItems().first();e||this.focus(t,i)},blur:function(t){this._delay(function(){V.contains(this.element[0],V.ui.safeActiveElement(this.document[0]))||this.collapseAll(t)})},keydown:"_keydown"}),this.refresh(),this._on(this.document,{click:function(t){this._closeOnDocumentClick(t)&&this.collapseAll(t,
!0),this.mouseHandled=!1}})},_activateItem:function(t){var e,i;this.previousFilter||t.clientX===this.lastMousePosition.x&&t.clientY===this.lastMousePosition.y||(this.lastMousePosition={x:t.clientX,y:t.clientY},e=V(t.target).closest(".ui-menu-item"),i=V(t.currentTarget),e[0]!==i[0])||i.is(".ui-state-active")||(this._removeClass(i.siblings().children(".ui-state-active"),null,"ui-state-active"),this.focus(t,i))},_destroy:function(){var t=this.element.find(".ui-menu-item").removeAttr("role aria-disabled").children(".ui-menu-item-wrapper").removeUniqueId().removeAttr("tabIndex role aria-haspopup");
this.element.removeAttr("aria-activedescendant").find(".ui-menu").addBack().removeAttr("role aria-labelledby aria-expanded aria-hidden aria-disabled tabIndex").removeUniqueId().show(),t.children().each(function(){var t=V(this);t.data("ui-menu-submenu-caret")&&t.remove()})},_keydown:function(t){var e,i,s,n=!0;switch(t.keyCode){case V.ui.keyCode.PAGE_UP:this.previousPage(t);break;case V.ui.keyCode.PAGE_DOWN:this.nextPage(t);break;case V.ui.keyCode.HOME:this._move("first","first",t);break;case V.ui.keyCode.END:this._move("last",
"last",t);break;case V.ui.keyCode.UP:this.previous(t);break;case V.ui.keyCode.DOWN:this.next(t);break;case V.ui.keyCode.LEFT:this.collapse(t);break;case V.ui.keyCode.RIGHT:this.active&&!this.active.is(".ui-state-disabled")&&this.expand(t);break;case V.ui.keyCode.ENTER:case V.ui.keyCode.SPACE:this._activate(t);break;case V.ui.keyCode.ESCAPE:this.collapse(t);break;default:e=this.previousFilter||"",s=n=!1,i=96<=t.keyCode&&t.keyCode<=105?(t.keyCode-96).toString():String.fromCharCode(t.keyCode),clearTimeout(this.filterTimer),
i===e?s=!0:i=e+i,e=this._filterMenuItems(i),(e=s&&-1!==e.index(this.active.next())?this.active.nextAll(".ui-menu-item"):e).length||(i=String.fromCharCode(t.keyCode),e=this._filterMenuItems(i)),e.length?(this.focus(t,e),this.previousFilter=i,this.filterTimer=this._delay(function(){delete this.previousFilter},1E3)):delete this.previousFilter}n&&t.preventDefault()},_activate:function(t){this.active&&!this.active.is(".ui-state-disabled")&&(this.active.children("[aria-haspopup='true']").length?this.expand(t):
this.select(t))},refresh:function(){var t,e,s=this,n=this.options.icons.submenu,i=this.element.find(this.options.menus);this._toggleClass("ui-menu-icons",null,!!this.element.find(".ui-icon").length),t=i.filter(":not(.ui-menu)").hide().attr({role:this.options.role,"aria-hidden":"true","aria-expanded":"false"}).each(function(){var t=V(this),e=t.prev(),i=V("<span>").data("ui-menu-submenu-caret",!0);s._addClass(i,"ui-menu-icon","ui-icon "+n),e.attr("aria-haspopup","true").prepend(i),t.attr("aria-labelledby",
e.attr("id"))}),this._addClass(t,"ui-menu","ui-widget ui-widget-content ui-front"),(t=i.add(this.element).find(this.options.items)).not(".ui-menu-item").each(function(){var t=V(this);s._isDivider(t)&&s._addClass(t,"ui-menu-divider","ui-widget-content")}),e=(i=t.not(".ui-menu-item, .ui-menu-divider")).children().not(".ui-menu").uniqueId().attr({tabIndex:-1,role:this._itemRole()}),this._addClass(i,"ui-menu-item")._addClass(e,"ui-menu-item-wrapper"),t.filter(".ui-state-disabled").attr("aria-disabled",
"true"),this.active&&!V.contains(this.element[0],this.active[0])&&this.blur()},_itemRole:function(){return{menu:"menuitem",listbox:"option"}[this.options.role]},_setOption:function(t,e){var i;"icons"===t&&(i=this.element.find(".ui-menu-icon"),this._removeClass(i,null,this.options.icons.submenu)._addClass(i,null,e.submenu)),this._super(t,e)},_setOptionDisabled:function(t){this._super(t),this.element.attr("aria-disabled",String(t)),this._toggleClass(null,"ui-state-disabled",!!t)},focus:function(t,e){var i;
this.blur(t,t&&"focus"===t.type),this._scrollIntoView(e),this.active=e.first(),i=this.active.children(".ui-menu-item-wrapper"),this._addClass(i,null,"ui-state-active"),this.options.role&&this.element.attr("aria-activedescendant",i.attr("id")),i=this.active.parent().closest(".ui-menu-item").children(".ui-menu-item-wrapper"),this._addClass(i,null,"ui-state-active"),t&&"keydown"===t.type?this._close():this.timer=this._delay(function(){this._close()},this.delay),(i=e.children(".ui-menu")).length&&t&&
/^mouse/.test(t.type)&&this._startOpening(i),this.activeMenu=e.parent(),this._trigger("focus",t,{item:e})},_scrollIntoView:function(t){var e,i,s;this._hasScroll()&&(e=parseFloat(V.css(this.activeMenu[0],"borderTopWidth"))||0,i=parseFloat(V.css(this.activeMenu[0],"paddingTop"))||0,e=t.offset().top-this.activeMenu.offset().top-e-i,i=this.activeMenu.scrollTop(),s=this.activeMenu.height(),t=t.outerHeight(),e<0?this.activeMenu.scrollTop(i+e):s<e+t&&this.activeMenu.scrollTop(i+e-s+t))},blur:function(t,
e){e||clearTimeout(this.timer),this.active&&(this._removeClass(this.active.children(".ui-menu-item-wrapper"),null,"ui-state-active"),this._trigger("blur",t,{item:this.active}),this.active=null)},_startOpening:function(t){clearTimeout(this.timer),"true"===t.attr("aria-hidden")&&(this.timer=this._delay(function(){this._close(),this._open(t)},this.delay))},_open:function(t){var e=V.extend({of:this.active},this.options.position);clearTimeout(this.timer),this.element.find(".ui-menu").not(t.parents(".ui-menu")).hide().attr("aria-hidden",
"true"),t.show().removeAttr("aria-hidden").attr("aria-expanded","true").position(e)},collapseAll:function(e,i){clearTimeout(this.timer),this.timer=this._delay(function(){var t=i?this.element:V(e&&e.target).closest(this.element.find(".ui-menu"));t.length||(t=this.element),this._close(t),this.blur(e),this._removeClass(t.find(".ui-state-active"),null,"ui-state-active"),this.activeMenu=t},i?0:this.delay)},_close:function(t){(t=t||(this.active?this.active.parent():this.element)).find(".ui-menu").hide().attr("aria-hidden",
"true").attr("aria-expanded","false")},_closeOnDocumentClick:function(t){return!V(t.target).closest(".ui-menu").length},_isDivider:function(t){return!/[^\-\u2014\u2013\s]/.test(t.text())},collapse:function(t){var e=this.active&&this.active.parent().closest(".ui-menu-item",this.element);e&&e.length&&(this._close(),this.focus(t,e))},expand:function(t){var e=this.active&&this._menuItems(this.active.children(".ui-menu")).first();e&&e.length&&(this._open(e.parent()),this._delay(function(){this.focus(t,
e)}))},next:function(t){this._move("next","first",t)},previous:function(t){this._move("prev","last",t)},isFirstItem:function(){return this.active&&!this.active.prevAll(".ui-menu-item").length},isLastItem:function(){return this.active&&!this.active.nextAll(".ui-menu-item").length},_menuItems:function(t){return(t||this.element).find(this.options.items).filter(".ui-menu-item")},_move:function(t,e,i){var s;(s=this.active?"first"===t||"last"===t?this.active["first"===t?"prevAll":"nextAll"](".ui-menu-item").last():
this.active[t+"All"](".ui-menu-item").first():s)&&s.length&&this.active||(s=this._menuItems(this.activeMenu)[e]()),this.focus(i,s)},nextPage:function(t){var e,i,s;this.active?this.isLastItem()||(this._hasScroll()?(i=this.active.offset().top,s=this.element.innerHeight(),0===V.fn.jquery.indexOf("3.2.")&&(s+=this.element[0].offsetHeight-this.element.outerHeight()),this.active.nextAll(".ui-menu-item").each(function(){return(e=V(this)).offset().top-i-s<0}),this.focus(t,e)):this.focus(t,this._menuItems(this.activeMenu)[this.active?
"last":"first"]())):this.next(t)},previousPage:function(t){var e,i,s;this.active?this.isFirstItem()||(this._hasScroll()?(i=this.active.offset().top,s=this.element.innerHeight(),0===V.fn.jquery.indexOf("3.2.")&&(s+=this.element[0].offsetHeight-this.element.outerHeight()),this.active.prevAll(".ui-menu-item").each(function(){return 0<(e=V(this)).offset().top-i+s}),this.focus(t,e)):this.focus(t,this._menuItems(this.activeMenu).first())):this.next(t)},_hasScroll:function(){return this.element.outerHeight()<
this.element.prop("scrollHeight")},select:function(t){this.active=this.active||V(t.target).closest(".ui-menu-item");var e={item:this.active};this.active.has(".ui-menu").length||this.collapseAll(t,!0),this._trigger("select",t,e)},_filterMenuItems:function(t){var t=t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&"),e=new RegExp("^"+t,"i");return this.activeMenu.find(this.options.items).filter(".ui-menu-item").filter(function(){return e.test(String.prototype.trim.call(V(this).children(".ui-menu-item-wrapper").text()))})}}),
V.widget("ui.autocomplete",{version:"1.13.3",defaultElement:"<input>",options:{appendTo:null,autoFocus:!1,delay:300,minLength:1,position:{my:"left top",at:"left bottom",collision:"none"},source:null,change:null,close:null,focus:null,open:null,response:null,search:null,select:null},requestIndex:0,pending:0,liveRegionTimer:null,_create:function(){var i,s,n,t=this.element[0].nodeName.toLowerCase(),e="textarea"===t,t="input"===t;this.isMultiLine=e||!t&&this._isContentEditable(this.element),this.valueMethod=
this.element[e||t?"val":"text"],this.isNewMenu=!0,this._addClass("ui-autocomplete-input"),this.element.attr("autocomplete","off"),this._on(this.element,{keydown:function(t){if(this.element.prop("readOnly"))s=n=i=!0;else{s=n=i=!1;var e=V.ui.keyCode;switch(t.keyCode){case e.PAGE_UP:i=!0,this._move("previousPage",t);break;case e.PAGE_DOWN:i=!0,this._move("nextPage",t);break;case e.UP:i=!0,this._keyEvent("previous",t);break;case e.DOWN:i=!0,this._keyEvent("next",t);break;case e.ENTER:this.menu.active&&
(i=!0,t.preventDefault(),this.menu.select(t));break;case e.TAB:this.menu.active&&this.menu.select(t);break;case e.ESCAPE:this.menu.element.is(":visible")&&(this.isMultiLine||this._value(this.term),this.close(t),t.preventDefault());break;default:s=!0,this._searchTimeout(t)}}},keypress:function(t){if(i)i=!1,this.isMultiLine&&!this.menu.element.is(":visible")||t.preventDefault();else if(!s){var e=V.ui.keyCode;switch(t.keyCode){case e.PAGE_UP:this._move("previousPage",t);break;case e.PAGE_DOWN:this._move("nextPage",
t);break;case e.UP:this._keyEvent("previous",t);break;case e.DOWN:this._keyEvent("next",t)}}},input:function(t){n?(n=!1,t.preventDefault()):this._searchTimeout(t)},focus:function(){this.selectedItem=null,this.previous=this._value()},blur:function(t){clearTimeout(this.searching),this.close(t),this._change(t)}}),this._initSource(),this.menu=V("<ul>").appendTo(this._appendTo()).menu({role:null}).hide().attr({unselectable:"on"}).menu("instance"),this._addClass(this.menu.element,"ui-autocomplete","ui-front"),
this._on(this.menu.element,{mousedown:function(t){t.preventDefault()},menufocus:function(t,e){var i,s;this.isNewMenu&&(this.isNewMenu=!1,t.originalEvent)&&/^mouse/.test(t.originalEvent.type)?(this.menu.blur(),this.document.one("mousemove",function(){V(t.target).trigger(t.originalEvent)})):(s=e.item.data("ui-autocomplete-item"),!1!==this._trigger("focus",t,{item:s})&&t.originalEvent&&/^key/.test(t.originalEvent.type)&&this._value(s.value),(i=e.item.attr("aria-label")||s.value)&&String.prototype.trim.call(i).length&&
(clearTimeout(this.liveRegionTimer),this.liveRegionTimer=this._delay(function(){this.liveRegion.html(V("<div>").text(i))},100)))},menuselect:function(t,e){var i=e.item.data("ui-autocomplete-item"),s=this.previous;this.element[0]!==V.ui.safeActiveElement(this.document[0])&&(this.element.trigger("focus"),this.previous=s,this._delay(function(){this.previous=s,this.selectedItem=i})),!1!==this._trigger("select",t,{item:i})&&this._value(i.value),this.term=this._value(),this.close(t),this.selectedItem=i}}),
this.liveRegion=V("<div>",{role:"status","aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this._on(this.window,{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_destroy:function(){clearTimeout(this.searching),this.element.removeAttr("autocomplete"),this.menu.element.remove(),this.liveRegion.remove()},_setOption:function(t,e){this._super(t,e),"source"===t&&this._initSource(),
"appendTo"===t&&this.menu.element.appendTo(this._appendTo()),"disabled"===t&&e&&this.xhr&&this.xhr.abort()},_isEventTargetInWidget:function(t){var e=this.menu.element[0];return t.target===this.element[0]||t.target===e||V.contains(e,t.target)},_closeOnClickOutside:function(t){this._isEventTargetInWidget(t)||this.close()},_appendTo:function(){var t=this.options.appendTo;return t=(t=(t=t&&(t.jquery||t.nodeType?V(t):this.document.find(t).eq(0)))&&t[0]?t:this.element.closest(".ui-front, dialog")).length?
t:this.document[0].body},_initSource:function(){var i,s,n=this;Array.isArray(this.options.source)?(i=this.options.source,this.source=function(t,e){e(V.ui.autocomplete.filter(i,t.term))}):"string"==typeof this.options.source?(s=this.options.source,this.source=function(t,e){n.xhr&&n.xhr.abort(),n.xhr=V.ajax({url:s,data:t,dataType:"json",success:function(t){e(t)},error:function(){e([])}})}):this.source=this.options.source},_searchTimeout:function(s){clearTimeout(this.searching),this.searching=this._delay(function(){var t=
this.term===this._value(),e=this.menu.element.is(":visible"),i=s.altKey||s.ctrlKey||s.metaKey||s.shiftKey;t&&(e||i)||(this.selectedItem=null,this.search(null,s))},this.options.delay)},search:function(t,e){return t=null!=t?t:this._value(),this.term=this._value(),t.length<this.options.minLength?this.close(e):!1!==this._trigger("search",e)?this._search(t):void 0},_search:function(t){this.pending++,this._addClass("ui-autocomplete-loading"),this.cancelSearch=!1,this.source({term:t},this._response())},
_response:function(){var e=++this.requestIndex;return function(t){e===this.requestIndex&&this.__response(t),this.pending--,this.pending||this._removeClass("ui-autocomplete-loading")}.bind(this)},__response:function(t){t=t&&this._normalize(t),this._trigger("response",null,{content:t}),!this.options.disabled&&t&&t.length&&!this.cancelSearch?(this._suggest(t),this._trigger("open")):this._close()},close:function(t){this.cancelSearch=!0,this._close(t)},_close:function(t){this._off(this.document,"mousedown"),
this.menu.element.is(":visible")&&(this.menu.element.hide(),this.menu.blur(),this.isNewMenu=!0,this._trigger("close",t))},_change:function(t){this.previous!==this._value()&&this._trigger("change",t,{item:this.selectedItem})},_normalize:function(t){return t.length&&t[0].label&&t[0].value?t:V.map(t,function(t){return"string"==typeof t?{label:t,value:t}:V.extend({},t,{label:t.label||t.value,value:t.value||t.label})})},_suggest:function(t){var e=this.menu.element.empty();this._renderMenu(e,t),this.isNewMenu=
!0,this.menu.refresh(),e.show(),this._resizeMenu(),e.position(V.extend({of:this.element},this.options.position)),this.options.autoFocus&&this.menu.next(),this._on(this.document,{mousedown:"_closeOnClickOutside"})},_resizeMenu:function(){var t=this.menu.element;t.outerWidth(Math.max(t.width("").outerWidth()+1,this.element.outerWidth()))},_renderMenu:function(i,t){var s=this;V.each(t,function(t,e){s._renderItemData(i,e)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-autocomplete-item",
e)},_renderItem:function(t,e){return V("<li>").append(V("<div>").text(e.label)).appendTo(t)},_move:function(t,e){this.menu.element.is(":visible")?this.menu.isFirstItem()&&/^previous/.test(t)||this.menu.isLastItem()&&/^next/.test(t)?(this.isMultiLine||this._value(this.term),this.menu.blur()):this.menu[t](e):this.search(null,e)},widget:function(){return this.menu.element},_value:function(){return this.valueMethod.apply(this.element,arguments)},_keyEvent:function(t,e){this.isMultiLine&&!this.menu.element.is(":visible")||
(this._move(t,e),e.preventDefault())},_isContentEditable:function(t){var e;return!!t.length&&("inherit"===(e=t.prop("contentEditable"))?this._isContentEditable(t.parent()):"true"===e)}}),V.extend(V.ui.autocomplete,{escapeRegex:function(t){return t.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&")},filter:function(t,e){var i=new RegExp(V.ui.autocomplete.escapeRegex(e),"i");return V.grep(t,function(t){return i.test(t.label||t.value||t)})}}),V.widget("ui.autocomplete",V.ui.autocomplete,{options:{messages:{noResults:"No search results.",
results:function(t){return t+(1<t?" results are":" result is")+" available, use up and down arrow keys to navigate."}}},__response:function(t){var e;this._superApply(arguments),this.options.disabled||this.cancelSearch||(e=t&&t.length?this.options.messages.results(t.length):this.options.messages.noResults,clearTimeout(this.liveRegionTimer),this.liveRegionTimer=this._delay(function(){this.liveRegion.html(V("<div>").text(e))},100))}}),V.ui.autocomplete;var it,st,nt,ot,S,at=/ui-corner-([a-z]){2,6}/g;
V.widget("ui.controlgroup",{version:"1.13.3",defaultElement:"<div>",options:{direction:"horizontal",disabled:null,onlyVisible:!0,items:{button:"input[type=button], input[type=submit], input[type=reset], button, a",controlgroupLabel:".ui-controlgroup-label",checkboxradio:"input[type='checkbox'], input[type='radio']",selectmenu:"select",spinner:".ui-spinner-input"}},_create:function(){this._enhance()},_enhance:function(){this.element.attr("role","toolbar"),this.refresh()},_destroy:function(){this._callChildMethod("destroy"),
this.childWidgets.removeData("ui-controlgroup-data"),this.element.removeAttr("role"),this.options.items.controlgroupLabel&&this.element.find(this.options.items.controlgroupLabel).find(".ui-controlgroup-label-contents").contents().unwrap()},_initWidgets:function(){var o=this,a=[];V.each(this.options.items,function(s,t){var e,n={};t&&("controlgroupLabel"===s?((e=o.element.find(t)).each(function(){var t=V(this);t.children(".ui-controlgroup-label-contents").length||t.contents().wrapAll("<span class='ui-controlgroup-label-contents'></span>")}),
o._addClass(e,null,"ui-widget ui-widget-content ui-state-default"),a=a.concat(e.get())):V.fn[s]&&(n=o["_"+s+"Options"]?o["_"+s+"Options"]("middle"):{classes:{}},o.element.find(t).each(function(){var t=V(this),e=t[s]("instance"),i=V.widget.extend({},n);"button"===s&&t.parent(".ui-spinner").length||((e=e||t[s]()[s]("instance"))&&(i.classes=o._resolveClassesValues(i.classes,e)),t[s](i),i=t[s]("widget"),V.data(i[0],"ui-controlgroup-data",e||t[s]("instance")),a.push(i[0]))})))}),this.childWidgets=V(V.uniqueSort(a)),
this._addClass(this.childWidgets,"ui-controlgroup-item")},_callChildMethod:function(e){this.childWidgets.each(function(){var t=V(this).data("ui-controlgroup-data");t&&t[e]&&t[e]()})},_updateCornerClass:function(t,e){e=this._buildSimpleOptions(e,"label").classes.label;this._removeClass(t,null,"ui-corner-top ui-corner-bottom ui-corner-left ui-corner-right ui-corner-all"),this._addClass(t,null,e)},_buildSimpleOptions:function(t,e){var i="vertical"===this.options.direction,s={classes:{}};return s.classes[e]=
{middle:"",first:"ui-corner-"+(i?"top":"left"),last:"ui-corner-"+(i?"bottom":"right"),only:"ui-corner-all"}[t],s},_spinnerOptions:function(t){t=this._buildSimpleOptions(t,"ui-spinner");return t.classes["ui-spinner-up"]="",t.classes["ui-spinner-down"]="",t},_buttonOptions:function(t){return this._buildSimpleOptions(t,"ui-button")},_checkboxradioOptions:function(t){return this._buildSimpleOptions(t,"ui-checkboxradio-label")},_selectmenuOptions:function(t){var e="vertical"===this.options.direction;return{width:e&&
"auto",classes:{middle:{"ui-selectmenu-button-open":"","ui-selectmenu-button-closed":""},first:{"ui-selectmenu-button-open":"ui-corner-"+(e?"top":"tl"),"ui-selectmenu-button-closed":"ui-corner-"+(e?"top":"left")},last:{"ui-selectmenu-button-open":e?"":"ui-corner-tr","ui-selectmenu-button-closed":"ui-corner-"+(e?"bottom":"right")},only:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"}}[t]}},_resolveClassesValues:function(i,s){var n={};return V.each(i,function(t){var e=
s.options.classes[t]||"",e=String.prototype.trim.call(e.replace(at,""));n[t]=(e+" "+i[t]).replace(/\s+/g," ")}),n},_setOption:function(t,e){"direction"===t&&this._removeClass("ui-controlgroup-"+this.options.direction),this._super(t,e),"disabled"===t?this._callChildMethod(e?"disable":"enable"):this.refresh()},refresh:function(){var n,o=this;this._addClass("ui-controlgroup ui-controlgroup-"+this.options.direction),"horizontal"===this.options.direction&&this._addClass(null,"ui-helper-clearfix"),this._initWidgets(),
n=this.childWidgets,(n=this.options.onlyVisible?n.filter(":visible"):n).length&&(V.each(["first","last"],function(t,e){var i,s=n[e]().data("ui-controlgroup-data");s&&o["_"+s.widgetName+"Options"]?((i=o["_"+s.widgetName+"Options"](1===n.length?"only":e)).classes=o._resolveClassesValues(i.classes,s),s.element[s.widgetName](i)):o._updateCornerClass(n[e](),e)}),this._callChildMethod("refresh"))}}),V.widget("ui.checkboxradio",[V.ui.formResetMixin,{version:"1.13.3",options:{disabled:null,label:null,icon:!0,
classes:{"ui-checkboxradio-label":"ui-corner-all","ui-checkboxradio-icon":"ui-corner-all"}},_getCreateOptions:function(){var t,e=this._super()||{};return this._readType(),t=this.element.labels(),this.label=V(t[t.length-1]),this.label.length||V.error("No label found for checkboxradio widget"),this.originalLabel="",(t=this.label.contents().not(this.element[0])).length&&(this.originalLabel+=t.clone().wrapAll("<div></div>").parent().html()),this.originalLabel&&(e.label=this.originalLabel),null!=(t=this.element[0].disabled)&&
(e.disabled=t),e},_create:function(){var t=this.element[0].checked;this._bindFormResetHandler(),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled),this._setOption("disabled",this.options.disabled),this._addClass("ui-checkboxradio","ui-helper-hidden-accessible"),this._addClass(this.label,"ui-checkboxradio-label","ui-button ui-widget"),"radio"===this.type&&this._addClass(this.label,"ui-checkboxradio-radio-label"),this.options.label&&this.options.label!==this.originalLabel?
this._updateLabel():this.originalLabel&&(this.options.label=this.originalLabel),this._enhance(),t&&this._addClass(this.label,"ui-checkboxradio-checked","ui-state-active"),this._on({change:"_toggleClasses",focus:function(){this._addClass(this.label,null,"ui-state-focus ui-visual-focus")},blur:function(){this._removeClass(this.label,null,"ui-state-focus ui-visual-focus")}})},_readType:function(){var t=this.element[0].nodeName.toLowerCase();this.type=this.element[0].type,"input"===t&&/radio|checkbox/.test(this.type)||
V.error("Can't create checkboxradio on element.nodeName="+t+" and element.type="+this.type)},_enhance:function(){this._updateIcon(this.element[0].checked)},widget:function(){return this.label},_getRadioGroup:function(){var t=this.element[0].name,e="input[name='"+V.escapeSelector(t)+"']";return t?(this.form.length?V(this.form[0].elements).filter(e):V(e).filter(function(){return 0===V(this)._form().length})).not(this.element):V([])},_toggleClasses:function(){var t=this.element[0].checked;this._toggleClass(this.label,
"ui-checkboxradio-checked","ui-state-active",t),this.options.icon&&"checkbox"===this.type&&this._toggleClass(this.icon,null,"ui-icon-check ui-state-checked",t)._toggleClass(this.icon,null,"ui-icon-blank",!t),"radio"===this.type&&this._getRadioGroup().each(function(){var t=V(this).checkboxradio("instance");t&&t._removeClass(t.label,"ui-checkboxradio-checked","ui-state-active")})},_destroy:function(){this._unbindFormResetHandler(),this.icon&&(this.icon.remove(),this.iconSpace.remove())},_setOption:function(t,
e){"label"===t&&!e||(this._super(t,e),"disabled"===t?(this._toggleClass(this.label,null,"ui-state-disabled",e),this.element[0].disabled=e):this.refresh())},_updateIcon:function(t){var e="ui-icon ui-icon-background ";this.options.icon?(this.icon||(this.icon=V("<span>"),this.iconSpace=V("<span> </span>"),this._addClass(this.iconSpace,"ui-checkboxradio-icon-space")),"checkbox"===this.type?(e+=t?"ui-icon-check ui-state-checked":"ui-icon-blank",this._removeClass(this.icon,null,t?"ui-icon-blank":"ui-icon-check")):
e+="ui-icon-blank",this._addClass(this.icon,"ui-checkboxradio-icon",e),t||this._removeClass(this.icon,null,"ui-icon-check ui-state-checked"),this.icon.prependTo(this.label).after(this.iconSpace)):void 0!==this.icon&&(this.icon.remove(),this.iconSpace.remove(),delete this.icon)},_updateLabel:function(){var t=this.label.contents().not(this.element[0]);this.icon&&(t=t.not(this.icon[0])),(t=this.iconSpace?t.not(this.iconSpace[0]):t).remove(),this.label.append(this.options.label)},refresh:function(){var t=
this.element[0].checked,e=this.element[0].disabled;this._updateIcon(t),this._toggleClass(this.label,"ui-checkboxradio-checked","ui-state-active",t),null!==this.options.label&&this._updateLabel(),e!==this.options.disabled&&this._setOptions({disabled:e})}}]),V.ui.checkboxradio,V.widget("ui.button",{version:"1.13.3",defaultElement:"<button>",options:{classes:{"ui-button":"ui-corner-all"},disabled:null,icon:null,iconPosition:"beginning",label:null,showLabel:!0},_getCreateOptions:function(){var t,e=this._super()||
{};return this.isInput=this.element.is("input"),null!=(t=this.element[0].disabled)&&(e.disabled=t),this.originalLabel=this.isInput?this.element.val():this.element.html(),this.originalLabel&&(e.label=this.originalLabel),e},_create:function(){!this.option.showLabel&!this.options.icon&&(this.options.showLabel=!0),null==this.options.disabled&&(this.options.disabled=this.element[0].disabled||!1),this.hasTitle=!!this.element.attr("title"),this.options.label&&this.options.label!==this.originalLabel&&(this.isInput?
this.element.val(this.options.label):this.element.html(this.options.label)),this._addClass("ui-button","ui-widget"),this._setOption("disabled",this.options.disabled),this._enhance(),this.element.is("a")&&this._on({keyup:function(t){t.keyCode===V.ui.keyCode.SPACE&&(t.preventDefault(),this.element[0].click?this.element[0].click():this.element.trigger("click"))}})},_enhance:function(){this.element.is("button")||this.element.attr("role","button"),this.options.icon&&(this._updateIcon("icon",this.options.icon),
this._updateTooltip())},_updateTooltip:function(){this.title=this.element.attr("title"),this.options.showLabel||this.title||this.element.attr("title",this.options.label)},_updateIcon:function(t,e){var t="iconPosition"!==t,i=t?this.options.iconPosition:e,s="top"===i||"bottom"===i;this.icon?t&&this._removeClass(this.icon,null,this.options.icon):(this.icon=V("<span>"),this._addClass(this.icon,"ui-button-icon","ui-icon"),this.options.showLabel||this._addClass("ui-button-icon-only")),t&&this._addClass(this.icon,
null,e),this._attachIcon(i),s?(this._addClass(this.icon,null,"ui-widget-icon-block"),this.iconSpace&&this.iconSpace.remove()):(this.iconSpace||(this.iconSpace=V("<span> </span>"),this._addClass(this.iconSpace,"ui-button-icon-space")),this._removeClass(this.icon,null,"ui-wiget-icon-block"),this._attachIconSpace(i))},_destroy:function(){this.element.removeAttr("role"),this.icon&&this.icon.remove(),this.iconSpace&&this.iconSpace.remove(),this.hasTitle||this.element.removeAttr("title")},_attachIconSpace:function(t){this.icon[/^(?:end|bottom)/.test(t)?
"before":"after"](this.iconSpace)},_attachIcon:function(t){this.element[/^(?:end|bottom)/.test(t)?"append":"prepend"](this.icon)},_setOptions:function(t){var e=(void 0===t.showLabel?this.options:t).showLabel,i=(void 0===t.icon?this.options:t).icon;e||i||(t.showLabel=!0),this._super(t)},_setOption:function(t,e){"icon"===t&&(e?this._updateIcon(t,e):this.icon&&(this.icon.remove(),this.iconSpace)&&this.iconSpace.remove()),"iconPosition"===t&&this._updateIcon(t,e),"showLabel"===t&&(this._toggleClass("ui-button-icon-only",
null,!e),this._updateTooltip()),"label"===t&&(this.isInput?this.element.val(e):(this.element.html(e),this.icon&&(this._attachIcon(this.options.iconPosition),this._attachIconSpace(this.options.iconPosition)))),this._super(t,e),"disabled"===t&&(this._toggleClass(null,"ui-state-disabled",e),this.element[0].disabled=e)&&this.element.trigger("blur")},refresh:function(){var t=this.element.is("input, button")?this.element[0].disabled:this.element.hasClass("ui-button-disabled");t!==this.options.disabled&&
this._setOptions({disabled:t}),this._updateTooltip()}}),!1!==V.uiBackCompat&&(V.widget("ui.button",V.ui.button,{options:{text:!0,icons:{primary:null,secondary:null}},_create:function(){this.options.showLabel&&!this.options.text&&(this.options.showLabel=this.options.text),!this.options.showLabel&&this.options.text&&(this.options.text=this.options.showLabel),this.options.icon||!this.options.icons.primary&&!this.options.icons.secondary?this.options.icon&&(this.options.icons.primary=this.options.icon):
this.options.icons.primary?this.options.icon=this.options.icons.primary:(this.options.icon=this.options.icons.secondary,this.options.iconPosition="end"),this._super()},_setOption:function(t,e){"text"===t?this._super("showLabel",e):("showLabel"===t&&(this.options.text=e),"icon"===t&&(this.options.icons.primary=e),"icons"===t&&(e.primary?(this._super("icon",e.primary),this._super("iconPosition","beginning")):e.secondary&&(this._super("icon",e.secondary),this._super("iconPosition","end"))),this._superApply(arguments))}}),
V.fn.button=(ot=V.fn.button,function(i){var t="string"==typeof i,s=Array.prototype.slice.call(arguments,1),n=this;return t?this.length||"instance"!==i?this.each(function(){var t,e=V(this).attr("type"),e=V.data(this,"ui-"+("checkbox"!==e&&"radio"!==e?"button":"checkboxradio"));return"instance"===i?(n=e,!1):e?"function"!=typeof e[i]||"_"===i.charAt(0)?V.error("no such method '"+i+"' for button widget instance"):(t=e[i].apply(e,s))!==e&&void 0!==t?(n=t&&t.jquery?n.pushStack(t.get()):t,!1):void 0:V.error("cannot call methods on button prior to initialization; attempted to call method '"+
i+"'")}):n=void 0:(s.length&&(i=V.widget.extend.apply(null,[i].concat(s))),this.each(function(){var t=V(this).attr("type"),t="checkbox"!==t&&"radio"!==t?"button":"checkboxradio",e=V.data(this,"ui-"+t);e?(e.option(i||{}),e._init&&e._init()):"button"==t?ot.call(V(this),i):V(this).checkboxradio(V.extend({icon:!1},i))})),n}),V.fn.buttonset=function(){return V.ui.controlgroup||V.error("Controlgroup widget missing"),"option"===arguments[0]&&"items"===arguments[1]&&arguments[2]?this.controlgroup.apply(this,
[arguments[0],"items.button",arguments[2]]):"option"===arguments[0]&&"items"===arguments[1]?this.controlgroup.apply(this,[arguments[0],"items.button"]):("object"==typeof arguments[0]&&arguments[0].items&&(arguments[0].items={button:arguments[0].items}),this.controlgroup.apply(this,arguments))}),V.ui.button;function rt(){this._curInst=null,this._keyEvent=!1,this._disabledInputs=[],this._datepickerShowing=!1,this._inDialog=!1,this._mainDivId="ui-datepicker-div",this._inlineClass="ui-datepicker-inline",
this._appendClass="ui-datepicker-append",this._triggerClass="ui-datepicker-trigger",this._dialogClass="ui-datepicker-dialog",this._disableClass="ui-datepicker-disabled",this._unselectableClass="ui-datepicker-unselectable",this._currentClass="ui-datepicker-current-day",this._dayOverClass="ui-datepicker-days-cell-over",this.regional=[],this.regional[""]={closeText:"Done",prevText:"Prev",nextText:"Next",currentText:"Today",monthNames:["January","February","March","April","May","June","July","August",
"September","October","November","December"],monthNamesShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayNames:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayNamesShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dayNamesMin:["Su","Mo","Tu","We","Th","Fr","Sa"],weekHeader:"Wk",dateFormat:"mm/dd/yy",firstDay:0,isRTL:!1,showMonthAfterYear:!1,yearSuffix:"",selectMonthLabel:"Select month",selectYearLabel:"Select year"},this._defaults={showOn:"focus",
showAnim:"fadeIn",showOptions:{},defaultDate:null,appendText:"",buttonText:"...",buttonImage:"",buttonImageOnly:!1,hideIfNoPrevNext:!1,navigationAsDateFormat:!1,gotoCurrent:!1,changeMonth:!1,changeYear:!1,yearRange:"c-10:c+10",showOtherMonths:!1,selectOtherMonths:!1,showWeek:!1,calculateWeek:this.iso8601Week,shortYearCutoff:"+10",minDate:null,maxDate:null,duration:"fast",beforeShowDay:null,beforeShow:null,onSelect:null,onChangeMonthYear:null,onClose:null,onUpdateDatepicker:null,numberOfMonths:1,showCurrentAtPos:0,
stepMonths:1,stepBigMonths:12,altField:"",altFormat:"",constrainInput:!0,showButtonPanel:!1,autoSize:!1,disabled:!1},V.extend(this._defaults,this.regional[""]),this.regional.en=V.extend(!0,{},this.regional[""]),this.regional["en-US"]=V.extend(!0,{},this.regional.en),this.dpDiv=lt(V("<div id='"+this._mainDivId+"' class='ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>"))}function lt(t){var e="button, .ui-datepicker-prev, .ui-datepicker-next, .ui-datepicker-calendar td a";
return t.on("mouseout",e,function(){V(this).removeClass("ui-state-hover"),-1!==this.className.indexOf("ui-datepicker-prev")&&V(this).removeClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&V(this).removeClass("ui-datepicker-next-hover")}).on("mouseover",e,ht)}function ht(){V.datepicker._isDisabledDatepicker((S.inline?S.dpDiv.parent():S.input)[0])||(V(this).parents(".ui-datepicker-calendar").find("a").removeClass("ui-state-hover"),V(this).addClass("ui-state-hover"),
-1!==this.className.indexOf("ui-datepicker-prev")&&V(this).addClass("ui-datepicker-prev-hover"),-1!==this.className.indexOf("ui-datepicker-next")&&V(this).addClass("ui-datepicker-next-hover"))}function H(t,e){for(var i in V.extend(t,e),e)null==e[i]&&(t[i]=e[i])}V.extend(V.ui,{datepicker:{version:"1.13.3"}}),V.extend(rt.prototype,{markerClassName:"hasDatepicker",maxRows:4,_widgetDatepicker:function(){return this.dpDiv},setDefaults:function(t){return H(this._defaults,t||{}),this},_attachDatepicker:function(t,
e){var i,s=t.nodeName.toLowerCase(),n="div"===s||"span"===s;t.id||(this.uuid+=1,t.id="dp"+this.uuid),(i=this._newInst(V(t),n)).settings=V.extend({},e||{}),"input"===s?this._connectDatepicker(t,i):n&&this._inlineDatepicker(t,i)},_newInst:function(t,e){return{id:t[0].id.replace(/([^A-Za-z0-9_\-])/g,"\\\\$1"),input:t,selectedDay:0,selectedMonth:0,selectedYear:0,drawMonth:0,drawYear:0,inline:e,dpDiv:e?lt(V("<div class='"+this._inlineClass+" ui-datepicker ui-widget ui-widget-content ui-helper-clearfix ui-corner-all'></div>")):
this.dpDiv}},_connectDatepicker:function(t,e){var i=V(t);e.append=V([]),e.trigger=V([]),i.hasClass(this.markerClassName)||(this._attachments(i,e),i.addClass(this.markerClassName).on("keydown",this._doKeyDown).on("keypress",this._doKeyPress).on("keyup",this._doKeyUp),this._autoSize(e),V.data(t,"datepicker",e),e.settings.disabled&&this._disableDatepicker(t))},_attachments:function(t,e){var i,s=this._get(e,"appendText"),n=this._get(e,"isRTL");e.append&&e.append.remove(),s&&(e.append=V("<span>").addClass(this._appendClass).text(s),
t[n?"before":"after"](e.append)),t.off("focus",this._showDatepicker),e.trigger&&e.trigger.remove(),"focus"!==(s=this._get(e,"showOn"))&&"both"!==s||t.on("focus",this._showDatepicker),"button"!==s&&"both"!==s||(s=this._get(e,"buttonText"),i=this._get(e,"buttonImage"),this._get(e,"buttonImageOnly")?e.trigger=V("<img>").addClass(this._triggerClass).attr({src:i,alt:s,title:s}):(e.trigger=V("<button type='button'>").addClass(this._triggerClass),i?e.trigger.html(V("<img>").attr({src:i,alt:s,title:s})):
e.trigger.text(s)),t[n?"before":"after"](e.trigger),e.trigger.on("click",function(){return V.datepicker._datepickerShowing&&V.datepicker._lastInput===t[0]?V.datepicker._hideDatepicker():(V.datepicker._datepickerShowing&&V.datepicker._lastInput!==t[0]&&V.datepicker._hideDatepicker(),V.datepicker._showDatepicker(t[0])),!1}))},_autoSize:function(t){var e,i,s,n,o,a;this._get(t,"autoSize")&&!t.inline&&(o=new Date(2009,11,20),(a=this._get(t,"dateFormat")).match(/[DM]/)&&(o.setMonth((e=function(t){for(n=
s=i=0;n<t.length;n++)t[n].length>i&&(i=t[n].length,s=n);return s})(this._get(t,a.match(/MM/)?"monthNames":"monthNamesShort"))),o.setDate(e(this._get(t,a.match(/DD/)?"dayNames":"dayNamesShort"))+20-o.getDay())),t.input.attr("size",this._formatDate(t,o).length))},_inlineDatepicker:function(t,e){var i=V(t);i.hasClass(this.markerClassName)||(i.addClass(this.markerClassName).append(e.dpDiv),V.data(t,"datepicker",e),this._setDate(e,this._getDefaultDate(e),!0),this._updateDatepicker(e),this._updateAlternate(e),
e.settings.disabled&&this._disableDatepicker(t),e.dpDiv.css("display","block"))},_dialogDatepicker:function(t,e,i,s,n){var o,a=this._dialogInst;return a||(this.uuid+=1,o="dp"+this.uuid,this._dialogInput=V("<input type='text' id='"+o+"' style='position: absolute; top: -100px; width: 0px;'/>"),this._dialogInput.on("keydown",this._doKeyDown),V("body").append(this._dialogInput),(a=this._dialogInst=this._newInst(this._dialogInput,!1)).settings={},V.data(this._dialogInput[0],"datepicker",a)),H(a.settings,
s||{}),e=e&&e.constructor===Date?this._formatDate(a,e):e,this._dialogInput.val(e),this._pos=n?n.length?n:[n.pageX,n.pageY]:null,this._pos||(o=document.documentElement.clientWidth,s=document.documentElement.clientHeight,e=document.documentElement.scrollLeft||document.body.scrollLeft,n=document.documentElement.scrollTop||document.body.scrollTop,this._pos=[o/2-100+e,s/2-150+n]),this._dialogInput.css("left",this._pos[0]+20+"px").css("top",this._pos[1]+"px"),a.settings.onSelect=i,this._inDialog=!0,this.dpDiv.addClass(this._dialogClass),
this._showDatepicker(this._dialogInput[0]),V.blockUI&&V.blockUI(this.dpDiv),V.data(this._dialogInput[0],"datepicker",a),this},_destroyDatepicker:function(t){var e,i=V(t),s=V.data(t,"datepicker");i.hasClass(this.markerClassName)&&(e=t.nodeName.toLowerCase(),V.removeData(t,"datepicker"),"input"===e?(s.append.remove(),s.trigger.remove(),i.removeClass(this.markerClassName).off("focus",this._showDatepicker).off("keydown",this._doKeyDown).off("keypress",this._doKeyPress).off("keyup",this._doKeyUp)):"div"!==
e&&"span"!==e||i.removeClass(this.markerClassName).empty(),S===s)&&(S=null,this._curInst=null)},_enableDatepicker:function(e){var t,i=V(e),s=V.data(e,"datepicker");i.hasClass(this.markerClassName)&&("input"===(t=e.nodeName.toLowerCase())?(e.disabled=!1,s.trigger.filter("button").each(function(){this.disabled=!1}).end().filter("img").css({opacity:"1.0",cursor:""})):"div"!==t&&"span"!==t||((s=i.children("."+this._inlineClass)).children().removeClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",
!1)),this._disabledInputs=V.map(this._disabledInputs,function(t){return t===e?null:t}))},_disableDatepicker:function(e){var t,i=V(e),s=V.data(e,"datepicker");i.hasClass(this.markerClassName)&&("input"===(t=e.nodeName.toLowerCase())?(e.disabled=!0,s.trigger.filter("button").each(function(){this.disabled=!0}).end().filter("img").css({opacity:"0.5",cursor:"default"})):"div"!==t&&"span"!==t||((s=i.children("."+this._inlineClass)).children().addClass("ui-state-disabled"),s.find("select.ui-datepicker-month, select.ui-datepicker-year").prop("disabled",
!0)),this._disabledInputs=V.map(this._disabledInputs,function(t){return t===e?null:t}),this._disabledInputs[this._disabledInputs.length]=e)},_isDisabledDatepicker:function(t){if(t)for(var e=0;e<this._disabledInputs.length;e++)if(this._disabledInputs[e]===t)return!0;return!1},_getInst:function(t){try{return V.data(t,"datepicker")}catch(t){throw"Missing instance data for this datepicker";}},_optionDatepicker:function(t,e,i){var s,n,o=this._getInst(t);if(2===arguments.length&&"string"==typeof e)return"defaults"===
e?V.extend({},V.datepicker._defaults):o?"all"===e?V.extend({},o.settings):this._get(o,e):null;s=e||{},"string"==typeof e&&((s={})[e]=i),o&&(this._curInst===o&&this._hideDatepicker(),e=this._getDateDatepicker(t,!0),i=this._getMinMaxDate(o,"min"),n=this._getMinMaxDate(o,"max"),H(o.settings,s),null!==i&&void 0!==s.dateFormat&&void 0===s.minDate&&(o.settings.minDate=this._formatDate(o,i)),null!==n&&void 0!==s.dateFormat&&void 0===s.maxDate&&(o.settings.maxDate=this._formatDate(o,n)),"disabled"in s&&(s.disabled?
this._disableDatepicker(t):this._enableDatepicker(t)),this._attachments(V(t),o),this._autoSize(o),this._setDate(o,e),this._updateAlternate(o),this._updateDatepicker(o))},_changeDatepicker:function(t,e,i){this._optionDatepicker(t,e,i)},_refreshDatepicker:function(t){t=this._getInst(t);t&&this._updateDatepicker(t)},_setDateDatepicker:function(t,e){t=this._getInst(t);t&&(this._setDate(t,e),this._updateDatepicker(t),this._updateAlternate(t))},_getDateDatepicker:function(t,e){t=this._getInst(t);return t&&
!t.inline&&this._setDateFromField(t,e),t?this._getDate(t):null},_doKeyDown:function(t){var e,i,s=V.datepicker._getInst(t.target),n=!0,o=s.dpDiv.is(".ui-datepicker-rtl");if(s._keyEvent=!0,V.datepicker._datepickerShowing)switch(t.keyCode){case 9:V.datepicker._hideDatepicker(),n=!1;break;case 13:return(i=V("td."+V.datepicker._dayOverClass+":not(."+V.datepicker._currentClass+")",s.dpDiv))[0]&&V.datepicker._selectDay(t.target,s.selectedMonth,s.selectedYear,i[0]),(i=V.datepicker._get(s,"onSelect"))?(e=
V.datepicker._formatDate(s),i.apply(s.input?s.input[0]:null,[e,s])):V.datepicker._hideDatepicker(),!1;case 27:V.datepicker._hideDatepicker();break;case 33:V.datepicker._adjustDate(t.target,t.ctrlKey?-V.datepicker._get(s,"stepBigMonths"):-V.datepicker._get(s,"stepMonths"),"M");break;case 34:V.datepicker._adjustDate(t.target,t.ctrlKey?+V.datepicker._get(s,"stepBigMonths"):+V.datepicker._get(s,"stepMonths"),"M");break;case 35:(t.ctrlKey||t.metaKey)&&V.datepicker._clearDate(t.target),n=t.ctrlKey||t.metaKey;
break;case 36:(t.ctrlKey||t.metaKey)&&V.datepicker._gotoToday(t.target),n=t.ctrlKey||t.metaKey;break;case 37:(t.ctrlKey||t.metaKey)&&V.datepicker._adjustDate(t.target,o?1:-1,"D"),n=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&V.datepicker._adjustDate(t.target,t.ctrlKey?-V.datepicker._get(s,"stepBigMonths"):-V.datepicker._get(s,"stepMonths"),"M");break;case 38:(t.ctrlKey||t.metaKey)&&V.datepicker._adjustDate(t.target,-7,"D"),n=t.ctrlKey||t.metaKey;break;case 39:(t.ctrlKey||t.metaKey)&&V.datepicker._adjustDate(t.target,
o?-1:1,"D"),n=t.ctrlKey||t.metaKey,t.originalEvent.altKey&&V.datepicker._adjustDate(t.target,t.ctrlKey?+V.datepicker._get(s,"stepBigMonths"):+V.datepicker._get(s,"stepMonths"),"M");break;case 40:(t.ctrlKey||t.metaKey)&&V.datepicker._adjustDate(t.target,7,"D"),n=t.ctrlKey||t.metaKey;break;default:n=!1}else 36===t.keyCode&&t.ctrlKey?V.datepicker._showDatepicker(this):n=!1;n&&(t.preventDefault(),t.stopPropagation())},_doKeyPress:function(t){var e,i=V.datepicker._getInst(t.target);if(V.datepicker._get(i,
"constrainInput"))return i=V.datepicker._possibleChars(V.datepicker._get(i,"dateFormat")),e=String.fromCharCode(null==t.charCode?t.keyCode:t.charCode),t.ctrlKey||t.metaKey||e<" "||!i||-1<i.indexOf(e)},_doKeyUp:function(t){t=V.datepicker._getInst(t.target);if(t.input.val()!==t.lastVal)try{V.datepicker.parseDate(V.datepicker._get(t,"dateFormat"),t.input?t.input.val():null,V.datepicker._getFormatConfig(t))&&(V.datepicker._setDateFromField(t),V.datepicker._updateAlternate(t),V.datepicker._updateDatepicker(t))}catch(t){}return!0},
_showDatepicker:function(t){var e,i,s,n;"input"!==(t=t.target||t).nodeName.toLowerCase()&&(t=V("input",t.parentNode)[0]),V.datepicker._isDisabledDatepicker(t)||V.datepicker._lastInput===t||(n=V.datepicker._getInst(t),V.datepicker._curInst&&V.datepicker._curInst!==n&&(V.datepicker._curInst.dpDiv.stop(!0,!0),n)&&V.datepicker._datepickerShowing&&V.datepicker._hideDatepicker(V.datepicker._curInst.input[0]),!1===(i=(i=V.datepicker._get(n,"beforeShow"))?i.apply(t,[t,n]):{}))||(H(n.settings,i),n.lastVal=
null,V.datepicker._lastInput=t,V.datepicker._setDateFromField(n),V.datepicker._inDialog&&(t.value=""),V.datepicker._pos||(V.datepicker._pos=V.datepicker._findPos(t),V.datepicker._pos[1]+=t.offsetHeight),e=!1,V(t).parents().each(function(){return!(e|="fixed"===V(this).css("position"))}),i={left:V.datepicker._pos[0],top:V.datepicker._pos[1]},V.datepicker._pos=null,n.dpDiv.empty(),n.dpDiv.css({position:"absolute",display:"block",top:"-1000px"}),V.datepicker._updateDatepicker(n),i=V.datepicker._checkOffset(n,
i,e),n.dpDiv.css({position:V.datepicker._inDialog&&V.blockUI?"static":e?"fixed":"absolute",display:"none",left:i.left+"px",top:i.top+"px"}),n.inline)||(i=V.datepicker._get(n,"showAnim"),s=V.datepicker._get(n,"duration"),n.dpDiv.css("z-index",function(t){for(var e;t.length&&t[0]!==document;){if(("absolute"===(e=t.css("position"))||"relative"===e||"fixed"===e)&&(e=parseInt(t.css("zIndex"),10),!isNaN(e))&&0!==e)return e;t=t.parent()}return 0}(V(t))+1),V.datepicker._datepickerShowing=!0,V.effects&&V.effects.effect[i]?
n.dpDiv.show(i,V.datepicker._get(n,"showOptions"),s):n.dpDiv[i||"show"](i?s:null),V.datepicker._shouldFocusInput(n)&&n.input.trigger("focus"),V.datepicker._curInst=n)},_updateDatepicker:function(t){this.maxRows=4,(S=t).dpDiv.empty().append(this._generateHTML(t)),this._attachHandlers(t);var e,i=this._getNumberOfMonths(t),s=i[1],n=t.dpDiv.find("."+this._dayOverClass+" a"),o=V.datepicker._get(t,"onUpdateDatepicker");0<n.length&&ht.apply(n.get(0)),t.dpDiv.removeClass("ui-datepicker-multi-2 ui-datepicker-multi-3 ui-datepicker-multi-4").width(""),
1<s&&t.dpDiv.addClass("ui-datepicker-multi-"+s).css("width",17*s+"em"),t.dpDiv[(1!==i[0]||1!==i[1]?"add":"remove")+"Class"]("ui-datepicker-multi"),t.dpDiv[(this._get(t,"isRTL")?"add":"remove")+"Class"]("ui-datepicker-rtl"),t===V.datepicker._curInst&&V.datepicker._datepickerShowing&&V.datepicker._shouldFocusInput(t)&&t.input.trigger("focus"),t.yearshtml&&(e=t.yearshtml,setTimeout(function(){e===t.yearshtml&&t.yearshtml&&t.dpDiv.find("select.ui-datepicker-year").first().replaceWith(t.yearshtml),e=t.yearshtml=
null},0)),o&&o.apply(t.input?t.input[0]:null,[t])},_shouldFocusInput:function(t){return t.input&&t.input.is(":visible")&&!t.input.is(":disabled")&&!t.input.is(":focus")},_checkOffset:function(t,e,i){var s=t.dpDiv.outerWidth(),n=t.dpDiv.outerHeight(),o=t.input?t.input.outerWidth():0,a=t.input?t.input.outerHeight():0,r=document.documentElement.clientWidth+(i?0:V(document).scrollLeft()),l=document.documentElement.clientHeight+(i?0:V(document).scrollTop());return e.left-=this._get(t,"isRTL")?s-o:0,e.left-=
i&&e.left===t.input.offset().left?V(document).scrollLeft():0,e.top-=i&&e.top===t.input.offset().top+a?V(document).scrollTop():0,e.left-=Math.min(e.left,e.left+s>r&&s<r?Math.abs(e.left+s-r):0),e.top-=Math.min(e.top,e.top+n>l&&n<l?Math.abs(n+a):0),e},_findPos:function(t){for(var e=this._getInst(t),i=this._get(e,"isRTL");t&&("hidden"===t.type||1!==t.nodeType||V.expr.pseudos.hidden(t));)t=t[i?"previousSibling":"nextSibling"];return[(e=V(t).offset()).left,e.top]},_hideDatepicker:function(t){var e,i,s=
this._curInst;!s||t&&s!==V.data(t,"datepicker")||this._datepickerShowing&&(t=this._get(s,"showAnim"),i=this._get(s,"duration"),e=function(){V.datepicker._tidyDialog(s)},V.effects&&(V.effects.effect[t]||V.effects[t])?s.dpDiv.hide(t,V.datepicker._get(s,"showOptions"),i,e):s.dpDiv["slideDown"===t?"slideUp":"fadeIn"===t?"fadeOut":"hide"](t?i:null,e),t||e(),this._datepickerShowing=!1,(i=this._get(s,"onClose"))&&i.apply(s.input?s.input[0]:null,[s.input?s.input.val():"",s]),this._lastInput=null,this._inDialog&&
(this._dialogInput.css({position:"absolute",left:"0",top:"-100px"}),V.blockUI)&&(V.unblockUI(),V("body").append(this.dpDiv)),this._inDialog=!1)},_tidyDialog:function(t){t.dpDiv.removeClass(this._dialogClass).off(".ui-datepicker-calendar")},_checkExternalClick:function(t){var e;V.datepicker._curInst&&(t=V(t.target),e=V.datepicker._getInst(t[0]),!(t[0].id===V.datepicker._mainDivId||0!==t.parents("#"+V.datepicker._mainDivId).length||t.hasClass(V.datepicker.markerClassName)||t.closest("."+V.datepicker._triggerClass).length||
!V.datepicker._datepickerShowing||V.datepicker._inDialog&&V.blockUI)||t.hasClass(V.datepicker.markerClassName)&&V.datepicker._curInst!==e)&&V.datepicker._hideDatepicker()},_adjustDate:function(t,e,i){var t=V(t),s=this._getInst(t[0]);this._isDisabledDatepicker(t[0])||(this._adjustInstDate(s,e,i),this._updateDatepicker(s))},_gotoToday:function(t){var e,t=V(t),i=this._getInst(t[0]);this._get(i,"gotoCurrent")&&i.currentDay?(i.selectedDay=i.currentDay,i.drawMonth=i.selectedMonth=i.currentMonth,i.drawYear=
i.selectedYear=i.currentYear):(e=new Date,i.selectedDay=e.getDate(),i.drawMonth=i.selectedMonth=e.getMonth(),i.drawYear=i.selectedYear=e.getFullYear()),this._notifyChange(i),this._adjustDate(t)},_selectMonthYear:function(t,e,i){var t=V(t),s=this._getInst(t[0]);s["selected"+("M"===i?"Month":"Year")]=s["draw"+("M"===i?"Month":"Year")]=parseInt(e.options[e.selectedIndex].value,10),this._notifyChange(s),this._adjustDate(t)},_selectDay:function(t,e,i,s){var n=V(t);V(s).hasClass(this._unselectableClass)||
this._isDisabledDatepicker(n[0])||((n=this._getInst(n[0])).selectedDay=n.currentDay=parseInt(V("a",s).attr("data-date")),n.selectedMonth=n.currentMonth=e,n.selectedYear=n.currentYear=i,this._selectDate(t,this._formatDate(n,n.currentDay,n.currentMonth,n.currentYear)))},_clearDate:function(t){t=V(t);this._selectDate(t,"")},_selectDate:function(t,e){var i,t=V(t),t=this._getInst(t[0]);e=null!=e?e:this._formatDate(t),t.input&&t.input.val(e),this._updateAlternate(t),(i=this._get(t,"onSelect"))?i.apply(t.input?
t.input[0]:null,[e,t]):t.input&&t.input.trigger("change"),t.inline?this._updateDatepicker(t):(this._hideDatepicker(),this._lastInput=t.input[0],"object"!=typeof t.input[0]&&t.input.trigger("focus"),this._lastInput=null)},_updateAlternate:function(t){var e,i,s=this._get(t,"altField");s&&(i=this._get(t,"altFormat")||this._get(t,"dateFormat"),e=this._getDate(t),i=this.formatDate(i,e,this._getFormatConfig(t)),V(document).find(s).val(i))},noWeekends:function(t){t=t.getDay();return[0<t&&t<6,""]},iso8601Week:function(t){var e,
t=new Date(t.getTime());return t.setDate(t.getDate()+4-(t.getDay()||7)),e=t.getTime(),t.setMonth(0),t.setDate(1),Math.floor(Math.round((e-t)/864E5)/7)+1},parseDate:function(e,n,t){if(null==e||null==n)throw"Invalid arguments";if(""===(n="object"==typeof n?n.toString():n+""))return null;for(var i,s,o=0,a=(t?t.shortYearCutoff:null)||this._defaults.shortYearCutoff,a="string"!=typeof a?a:(new Date).getFullYear()%100+parseInt(a,10),r=(t?t.dayNamesShort:null)||this._defaults.dayNamesShort,l=(t?t.dayNames:
null)||this._defaults.dayNames,h=(t?t.monthNamesShort:null)||this._defaults.monthNamesShort,c=(t?t.monthNames:null)||this._defaults.monthNames,u=-1,d=-1,p=-1,f=-1,g=!1,m=function(t){t=y+1<e.length&&e.charAt(y+1)===t;return t&&y++,t},_=function(t){var e=m(t),e="@"===t?14:"!"===t?20:"y"===t&&e?4:"o"===t?3:2,t=new RegExp("^\\d{"+("y"===t?e:1)+","+e+"}"),e=n.substring(o).match(t);if(e)return o+=e[0].length,parseInt(e[0],10);throw"Missing number at position "+o;},v=function(t,e,i){var s=-1,t=V.map(m(t)?
i:e,function(t,e){return[[e,t]]}).sort(function(t,e){return-(t[1].length-e[1].length)});if(V.each(t,function(t,e){var i=e[1];if(n.substr(o,i.length).toLowerCase()===i.toLowerCase())return s=e[0],o+=i.length,!1}),-1!==s)return s+1;throw"Unknown name at position "+o;},b=function(){if(n.charAt(o)!==e.charAt(y))throw"Unexpected literal at position "+o;o++},y=0;y<e.length;y++)if(g)"'"!==e.charAt(y)||m("'")?b():g=!1;else switch(e.charAt(y)){case "d":p=_("d");break;case "D":v("D",r,l);break;case "o":f=_("o");
break;case "m":d=_("m");break;case "M":d=v("M",h,c);break;case "y":u=_("y");break;case "@":u=(s=new Date(_("@"))).getFullYear(),d=s.getMonth()+1,p=s.getDate();break;case "!":u=(s=new Date((_("!")-this._ticksTo1970)/1E4)).getFullYear(),d=s.getMonth()+1,p=s.getDate();break;case "'":m("'")?b():g=!0;break;default:b()}if(o<n.length&&(t=n.substr(o),!/^\s+/.test(t)))throw"Extra/unparsed characters found in date: "+t;if(-1===u?u=(new Date).getFullYear():u<100&&(u+=(new Date).getFullYear()-(new Date).getFullYear()%
100+(u<=a?0:-100)),-1<f)for(d=1,p=f;;){if(p<=(i=this._getDaysInMonth(u,d-1)))break;d++,p-=i}if((s=this._daylightSavingAdjust(new Date(u,d-1,p))).getFullYear()!==u||s.getMonth()+1!==d||s.getDate()!==p)throw"Invalid date";return s},ATOM:"yy-mm-dd",COOKIE:"D, dd M yy",ISO_8601:"yy-mm-dd",RFC_822:"D, d M y",RFC_850:"DD, dd-M-y",RFC_1036:"D, d M y",RFC_1123:"D, d M yy",RFC_2822:"D, d M yy",RSS:"D, d M y",TICKS:"!",TIMESTAMP:"@",W3C:"yy-mm-dd",_ticksTo1970:24*(718685+Math.floor(492.5)-Math.floor(19.7)+
Math.floor(4.925))*60*60*1E7,formatDate:function(e,t,i){if(!t)return"";function s(t,e,i){var s=""+e;if(c(t))for(;s.length<i;)s="0"+s;return s}function n(t,e,i,s){return(c(t)?s:i)[e]}var o,a=(i?i.dayNamesShort:null)||this._defaults.dayNamesShort,r=(i?i.dayNames:null)||this._defaults.dayNames,l=(i?i.monthNamesShort:null)||this._defaults.monthNamesShort,h=(i?i.monthNames:null)||this._defaults.monthNames,c=function(t){t=o+1<e.length&&e.charAt(o+1)===t;return t&&o++,t},u="",d=!1;if(t)for(o=0;o<e.length;o++)if(d)"'"!==
e.charAt(o)||c("'")?u+=e.charAt(o):d=!1;else switch(e.charAt(o)){case "d":u+=s("d",t.getDate(),2);break;case "D":u+=n("D",t.getDay(),a,r);break;case "o":u+=s("o",Math.round(((new Date(t.getFullYear(),t.getMonth(),t.getDate())).getTime()-(new Date(t.getFullYear(),0,0)).getTime())/864E5),3);break;case "m":u+=s("m",t.getMonth()+1,2);break;case "M":u+=n("M",t.getMonth(),l,h);break;case "y":u+=c("y")?t.getFullYear():(t.getFullYear()%100<10?"0":"")+t.getFullYear()%100;break;case "@":u+=t.getTime();break;
case "!":u+=1E4*t.getTime()+this._ticksTo1970;break;case "'":c("'")?u+="'":d=!0;break;default:u+=e.charAt(o)}return u},_possibleChars:function(e){for(var t="",i=!1,s=function(t){t=n+1<e.length&&e.charAt(n+1)===t;return t&&n++,t},n=0;n<e.length;n++)if(i)"'"!==e.charAt(n)||s("'")?t+=e.charAt(n):i=!1;else switch(e.charAt(n)){case "d":case "m":case "y":case "@":t+="0123456789";break;case "D":case "M":return null;case "'":s("'")?t+="'":i=!0;break;default:t+=e.charAt(n)}return t},_get:function(t,e){return(void 0!==
t.settings[e]?t.settings:this._defaults)[e]},_setDateFromField:function(t,e){if(t.input.val()!==t.lastVal){var i=this._get(t,"dateFormat"),s=t.lastVal=t.input?t.input.val():null,n=this._getDefaultDate(t),o=n,a=this._getFormatConfig(t);try{o=this.parseDate(i,s,a)||n}catch(t){s=e?"":s}t.selectedDay=o.getDate(),t.drawMonth=t.selectedMonth=o.getMonth(),t.drawYear=t.selectedYear=o.getFullYear(),t.currentDay=s?o.getDate():0,t.currentMonth=s?o.getMonth():0,t.currentYear=s?o.getFullYear():0,this._adjustInstDate(t)}},
_getDefaultDate:function(t){return this._restrictMinMax(t,this._determineDate(t,this._get(t,"defaultDate"),new Date))},_determineDate:function(r,t,e){var i,s=null==t||""===t?e:"string"==typeof t?function(t){try{return V.datepicker.parseDate(V.datepicker._get(r,"dateFormat"),t,V.datepicker._getFormatConfig(r))}catch(t){}for(var e=(t.toLowerCase().match(/^c/)?V.datepicker._getDate(r):null)||new Date,i=e.getFullYear(),s=e.getMonth(),n=e.getDate(),o=/([+\-]?[0-9]+)\s*(d|D|w|W|m|M|y|Y)?/g,a=o.exec(t);a;){switch(a[2]||
"d"){case "d":case "D":n+=parseInt(a[1],10);break;case "w":case "W":n+=7*parseInt(a[1],10);break;case "m":case "M":s+=parseInt(a[1],10),n=Math.min(n,V.datepicker._getDaysInMonth(i,s));break;case "y":case "Y":i+=parseInt(a[1],10),n=Math.min(n,V.datepicker._getDaysInMonth(i,s))}a=o.exec(t)}return new Date(i,s,n)}(t):"number"==typeof t?isNaN(t)?e:(s=t,(i=new Date).setDate(i.getDate()+s),i):new Date(t.getTime());return(s=s&&"Invalid Date"===s.toString()?e:s)&&(s.setHours(0),s.setMinutes(0),s.setSeconds(0),
s.setMilliseconds(0)),this._daylightSavingAdjust(s)},_daylightSavingAdjust:function(t){return t?(t.setHours(12<t.getHours()?t.getHours()+2:0),t):null},_setDate:function(t,e,i){var s=!e,n=t.selectedMonth,o=t.selectedYear,e=this._restrictMinMax(t,this._determineDate(t,e,new Date));t.selectedDay=t.currentDay=e.getDate(),t.drawMonth=t.selectedMonth=t.currentMonth=e.getMonth(),t.drawYear=t.selectedYear=t.currentYear=e.getFullYear(),n===t.selectedMonth&&o===t.selectedYear||i||this._notifyChange(t),this._adjustInstDate(t),
t.input&&t.input.val(s?"":this._formatDate(t))},_getDate:function(t){return!t.currentYear||t.input&&""===t.input.val()?null:this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay))},_attachHandlers:function(t){var e=this._get(t,"stepMonths"),i="#"+t.id.replace(/\\\\/g,"\\");t.dpDiv.find("[data-handler]").map(function(){var t={prev:function(){V.datepicker._adjustDate(i,-e,"M")},next:function(){V.datepicker._adjustDate(i,+e,"M")},hide:function(){V.datepicker._hideDatepicker()},
today:function(){V.datepicker._gotoToday(i)},selectDay:function(){return V.datepicker._selectDay(i,+this.getAttribute("data-month"),+this.getAttribute("data-year"),this),!1},selectMonth:function(){return V.datepicker._selectMonthYear(i,this,"M"),!1},selectYear:function(){return V.datepicker._selectMonthYear(i,this,"Y"),!1}};V(this).on(this.getAttribute("data-event"),t[this.getAttribute("data-handler")])})},_generateHTML:function(t){var e,i,s,n,o,E,W,F,L,a,r,R,l,h,c,u,d,p,f,g,m,_,Y,v,b,B,y,j,q,w,x,
k,C=new Date,K=this._daylightSavingAdjust(new Date(C.getFullYear(),C.getMonth(),C.getDate())),D=this._get(t,"isRTL"),C=this._get(t,"showButtonPanel"),I=this._get(t,"hideIfNoPrevNext"),T=this._get(t,"navigationAsDateFormat"),P=this._getNumberOfMonths(t),M=this._get(t,"showCurrentAtPos"),S=this._get(t,"stepMonths"),U=1!==P[0]||1!==P[1],H=this._daylightSavingAdjust(t.currentDay?new Date(t.currentYear,t.currentMonth,t.currentDay):new Date(9999,9,9)),z=this._getMinMaxDate(t,"min"),A=this._getMinMaxDate(t,
"max"),O=t.drawMonth-M,N=t.drawYear;if(O<0&&(O+=12,N--),A)for(e=this._daylightSavingAdjust(new Date(A.getFullYear(),A.getMonth()-P[0]*P[1]+1,A.getDate())),e=z&&e<z?z:e;this._daylightSavingAdjust(new Date(N,O,1))>e;)--O<0&&(O=11,N--);for(t.drawMonth=O,t.drawYear=N,M=this._get(t,"prevText"),M=T?this.formatDate(M,this._daylightSavingAdjust(new Date(N,O-S,1)),this._getFormatConfig(t)):M,i=this._canAdjustMonth(t,-1,N,O)?V("<a>").attr({class:"ui-datepicker-prev ui-corner-all","data-handler":"prev","data-event":"click",
title:M}).append(V("<span>").addClass("ui-icon ui-icon-circle-triangle-"+(D?"e":"w")).text(M))[0].outerHTML:I?"":V("<a>").attr({class:"ui-datepicker-prev ui-corner-all ui-state-disabled",title:M}).append(V("<span>").addClass("ui-icon ui-icon-circle-triangle-"+(D?"e":"w")).text(M))[0].outerHTML,M=this._get(t,"nextText"),M=T?this.formatDate(M,this._daylightSavingAdjust(new Date(N,O+S,1)),this._getFormatConfig(t)):M,s=this._canAdjustMonth(t,1,N,O)?V("<a>").attr({class:"ui-datepicker-next ui-corner-all",
"data-handler":"next","data-event":"click",title:M}).append(V("<span>").addClass("ui-icon ui-icon-circle-triangle-"+(D?"w":"e")).text(M))[0].outerHTML:I?"":V("<a>").attr({class:"ui-datepicker-next ui-corner-all ui-state-disabled",title:M}).append(V("<span>").attr("class","ui-icon ui-icon-circle-triangle-"+(D?"w":"e")).text(M))[0].outerHTML,S=this._get(t,"currentText"),I=this._get(t,"gotoCurrent")&&t.currentDay?H:K,S=T?this.formatDate(S,I,this._getFormatConfig(t)):S,M="",t.inline||(M=V("<button>").attr({type:"button",
class:"ui-datepicker-close ui-state-default ui-priority-primary ui-corner-all","data-handler":"hide","data-event":"click"}).text(this._get(t,"closeText"))[0].outerHTML),T="",C&&(T=V("<div class='ui-datepicker-buttonpane ui-widget-content'>").append(D?M:"").append(this._isInRange(t,I)?V("<button>").attr({type:"button",class:"ui-datepicker-current ui-state-default ui-priority-secondary ui-corner-all","data-handler":"today","data-event":"click"}).text(S):"").append(D?"":M)[0].outerHTML),n=parseInt(this._get(t,
"firstDay"),10),n=isNaN(n)?0:n,o=this._get(t,"showWeek"),E=this._get(t,"dayNames"),W=this._get(t,"dayNamesMin"),F=this._get(t,"monthNames"),L=this._get(t,"monthNamesShort"),a=this._get(t,"beforeShowDay"),r=this._get(t,"showOtherMonths"),R=this._get(t,"selectOtherMonths"),l=this._getDefaultDate(t),h="",u=0;u<P[0];u++){for(d="",this.maxRows=4,p=0;p<P[1];p++){if(f=this._daylightSavingAdjust(new Date(N,O,t.selectedDay)),g=" ui-corner-all",m="",U){if(m+="<div class='ui-datepicker-group",1<P[1])switch(p){case 0:m+=
" ui-datepicker-group-first",g=" ui-corner-"+(D?"right":"left");break;case P[1]-1:m+=" ui-datepicker-group-last",g=" ui-corner-"+(D?"left":"right");break;default:m+=" ui-datepicker-group-middle",g=""}m+="'>"}for(m+="<div class='ui-datepicker-header ui-widget-header ui-helper-clearfix"+g+"'>"+(/all|left/.test(g)&&0===u?D?s:i:"")+(/all|right/.test(g)&&0===u?D?i:s:"")+this._generateMonthYearHeader(t,O,N,z,A,0<u||0<p,F,L)+"</div><table class='ui-datepicker-calendar'><thead><tr>",_=o?"<th class='ui-datepicker-week-col'>"+
this._get(t,"weekHeader")+"</th>":"",c=0;c<7;c++)_+="<th scope='col'"+(5<=(c+n+6)%7?" class='ui-datepicker-week-end'":"")+"><span title='"+E[Y=(c+n)%7]+"'>"+W[Y]+"</span></th>";for(m+=_+"</tr></thead><tbody>",b=this._getDaysInMonth(N,O),N===t.selectedYear&&O===t.selectedMonth&&(t.selectedDay=Math.min(t.selectedDay,b)),v=(this._getFirstDayOfMonth(N,O)-n+7)%7,b=Math.ceil((v+b)/7),B=U&&this.maxRows>b?this.maxRows:b,this.maxRows=B,y=this._daylightSavingAdjust(new Date(N,O,1-v)),j=0;j<B;j++){for(m+="<tr>",
q=o?"<td class='ui-datepicker-week-col'>"+this._get(t,"calculateWeek")(y)+"</td>":"",c=0;c<7;c++)w=a?a.apply(t.input?t.input[0]:null,[y]):[!0,""],k=(x=y.getMonth()!==O)&&!R||!w[0]||z&&y<z||A&&A<y,q+="<td class='"+(5<=(c+n+6)%7?" ui-datepicker-week-end":"")+(x?" ui-datepicker-other-month":"")+(y.getTime()===f.getTime()&&O===t.selectedMonth&&t._keyEvent||l.getTime()===y.getTime()&&l.getTime()===f.getTime()?" "+this._dayOverClass:"")+(k?" "+this._unselectableClass+" ui-state-disabled":"")+(x&&!r?"":
" "+w[1]+(y.getTime()===H.getTime()?" "+this._currentClass:"")+(y.getTime()===K.getTime()?" ui-datepicker-today":""))+"'"+(x&&!r||!w[2]?"":" title='"+w[2].replace(/'/g,"&#39;")+"'")+(k?"":" data-handler='selectDay' data-event='click' data-month='"+y.getMonth()+"' data-year='"+y.getFullYear()+"'")+">"+(x&&!r?"&#xa0;":k?"<span class='ui-state-default'>"+y.getDate()+"</span>":"<a class='ui-state-default"+(y.getTime()===K.getTime()?" ui-state-highlight":"")+(y.getTime()===H.getTime()?" ui-state-active":
"")+(x?" ui-priority-secondary":"")+"' href='#' aria-current='"+(y.getTime()===H.getTime()?"true":"false")+"' data-date='"+y.getDate()+"'>"+y.getDate()+"</a>")+"</td>",y.setDate(y.getDate()+1),y=this._daylightSavingAdjust(y);m+=q+"</tr>"}11<++O&&(O=0,N++),d+=m+="</tbody></table>"+(U?"</div>"+(0<P[0]&&p===P[1]-1?"<div class='ui-datepicker-row-break'></div>":""):"")}h+=d}return h+=T,t._keyEvent=!1,h},_generateMonthYearHeader:function(t,e,i,s,n,o,a,r){var l,h,c,u,d,p,f=this._get(t,"changeMonth"),g=this._get(t,
"changeYear"),m=this._get(t,"showMonthAfterYear"),_=this._get(t,"selectMonthLabel"),v=this._get(t,"selectYearLabel"),b="<div class='ui-datepicker-title'>",y="";if(o||!f)y+="<span class='ui-datepicker-month'>"+a[e]+"</span>";else{for(l=s&&s.getFullYear()===i,h=n&&n.getFullYear()===i,y+="<select class='ui-datepicker-month' aria-label='"+_+"' data-handler='selectMonth' data-event='change'>",c=0;c<12;c++)(!l||c>=s.getMonth())&&(!h||c<=n.getMonth())&&(y+="<option value='"+c+"'"+(c===e?" selected='selected'":
"")+">"+r[c]+"</option>");y+="</select>"}if(m||(b+=y+(!o&&f&&g?"":"&#xa0;")),!t.yearshtml)if(t.yearshtml="",o||!g)b+="<span class='ui-datepicker-year'>"+i+"</span>";else{for(a=this._get(t,"yearRange").split(":"),u=(new Date).getFullYear(),d=(_=function(t){t=t.match(/c[+\-].*/)?i+parseInt(t.substring(1),10):t.match(/[+\-].*/)?u+parseInt(t,10):parseInt(t,10);return isNaN(t)?u:t})(a[0]),p=Math.max(d,_(a[1]||"")),d=s?Math.max(d,s.getFullYear()):d,p=n?Math.min(p,n.getFullYear()):p,t.yearshtml+="<select class='ui-datepicker-year' aria-label='"+
v+"' data-handler='selectYear' data-event='change'>";d<=p;d++)t.yearshtml+="<option value='"+d+"'"+(d===i?" selected='selected'":"")+">"+d+"</option>";t.yearshtml+="</select>",b+=t.yearshtml,t.yearshtml=null}return b+=this._get(t,"yearSuffix"),m&&(b+=(!o&&f&&g?"":"&#xa0;")+y),b+="</div>"},_adjustInstDate:function(t,e,i){var s=t.selectedYear+("Y"===i?e:0),n=t.selectedMonth+("M"===i?e:0),e=Math.min(t.selectedDay,this._getDaysInMonth(s,n))+("D"===i?e:0),s=this._restrictMinMax(t,this._daylightSavingAdjust(new Date(s,
n,e)));t.selectedDay=s.getDate(),t.drawMonth=t.selectedMonth=s.getMonth(),t.drawYear=t.selectedYear=s.getFullYear(),"M"!==i&&"Y"!==i||this._notifyChange(t)},_restrictMinMax:function(t,e){var i=this._getMinMaxDate(t,"min"),t=this._getMinMaxDate(t,"max"),i=i&&e<i?i:e;return t&&t<i?t:i},_notifyChange:function(t){var e=this._get(t,"onChangeMonthYear");e&&e.apply(t.input?t.input[0]:null,[t.selectedYear,t.selectedMonth+1,t])},_getNumberOfMonths:function(t){t=this._get(t,"numberOfMonths");return null==t?
[1,1]:"number"==typeof t?[1,t]:t},_getMinMaxDate:function(t,e){return this._determineDate(t,this._get(t,e+"Date"),null)},_getDaysInMonth:function(t,e){return 32-this._daylightSavingAdjust(new Date(t,e,32)).getDate()},_getFirstDayOfMonth:function(t,e){return(new Date(t,e,1)).getDay()},_canAdjustMonth:function(t,e,i,s){var n=this._getNumberOfMonths(t),i=this._daylightSavingAdjust(new Date(i,s+(e<0?e:n[0]*n[1]),1));return e<0&&i.setDate(this._getDaysInMonth(i.getFullYear(),i.getMonth())),this._isInRange(t,
i)},_isInRange:function(t,e){var i,s=this._getMinMaxDate(t,"min"),n=this._getMinMaxDate(t,"max"),o=null,a=null,t=this._get(t,"yearRange");return t&&(t=t.split(":"),i=(new Date).getFullYear(),o=parseInt(t[0],10),a=parseInt(t[1],10),t[0].match(/[+\-].*/)&&(o+=i),t[1].match(/[+\-].*/))&&(a+=i),(!s||e.getTime()>=s.getTime())&&(!n||e.getTime()<=n.getTime())&&(!o||e.getFullYear()>=o)&&(!a||e.getFullYear()<=a)},_getFormatConfig:function(t){var e=this._get(t,"shortYearCutoff");return{shortYearCutoff:"string"!=
typeof e?e:(new Date).getFullYear()%100+parseInt(e,10),dayNamesShort:this._get(t,"dayNamesShort"),dayNames:this._get(t,"dayNames"),monthNamesShort:this._get(t,"monthNamesShort"),monthNames:this._get(t,"monthNames")}},_formatDate:function(t,e,i,s){e||(t.currentDay=t.selectedDay,t.currentMonth=t.selectedMonth,t.currentYear=t.selectedYear);s=e?"object"==typeof e?e:this._daylightSavingAdjust(new Date(s,i,e)):this._daylightSavingAdjust(new Date(t.currentYear,t.currentMonth,t.currentDay));return this.formatDate(this._get(t,
"dateFormat"),s,this._getFormatConfig(t))}}),V.fn.datepicker=function(t){if(!this.length)return this;V.datepicker.initialized||(V(document).on("mousedown",V.datepicker._checkExternalClick),V.datepicker.initialized=!0),0===V("#"+V.datepicker._mainDivId).length&&V("body").append(V.datepicker.dpDiv);var e=Array.prototype.slice.call(arguments,1);return"string"==typeof t&&("isDisabled"===t||"getDate"===t||"widget"===t)||"option"===t&&2===arguments.length&&"string"==typeof arguments[1]?V.datepicker["_"+
t+"Datepicker"].apply(V.datepicker,[this[0]].concat(e)):this.each(function(){"string"==typeof t?V.datepicker["_"+t+"Datepicker"].apply(V.datepicker,[this].concat(e)):V.datepicker._attachDatepicker(this,t)})},V.datepicker=new rt,V.datepicker.initialized=!1,V.datepicker.uuid=(new Date).getTime(),V.datepicker.version="1.13.3";V.datepicker,V.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());var z=!1;V(document).on("mouseup",function(){z=!1}),V.widget("ui.mouse",{version:"1.13.3",options:{cancel:"input, textarea, button, select, option",
distance:1,delay:0},_mouseInit:function(){var e=this;this.element.on("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).on("click."+this.widgetName,function(t){if(!0===V.data(t.target,e.widgetName+".preventClickEvent"))return V.removeData(t.target,e.widgetName+".preventClickEvent"),t.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.off("."+this.widgetName),this._mouseMoveDelegate&&this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+
this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){var e,i,s;if(!z)return this._mouseMoved=!1,this._mouseStarted&&this._mouseUp(t),i=1===(this._mouseDownEvent=t).which,s=!("string"!=typeof(e=this).options.cancel||!t.target.nodeName)&&V(t.target).closest(this.options.cancel).length,i&&!s&&this._mouseCapture(t)&&(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){e.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&
(this._mouseStarted=!1!==this._mouseStart(t),!this._mouseStarted)?t.preventDefault():(!0===V.data(t.target,this.widgetName+".preventClickEvent")&&V.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return e._mouseMove(t)},this._mouseUpDelegate=function(t){return e._mouseUp(t)},this.document.on("mousemove."+this.widgetName,this._mouseMoveDelegate).on("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),z=!0)),!0},_mouseMove:function(t){if(this._mouseMoved){if(V.ui.ie&&
(!document.documentMode||document.documentMode<9)&&!t.button)return this._mouseUp(t);if(!t.which)if(t.originalEvent.altKey||t.originalEvent.ctrlKey||t.originalEvent.metaKey||t.originalEvent.shiftKey)this.ignoreMissingWhich=!0;else if(!this.ignoreMissingWhich)return this._mouseUp(t)}return(t.which||t.button)&&(this._mouseMoved=!0),this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,
t),this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){this.document.off("mousemove."+this.widgetName,this._mouseMoveDelegate).off("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&V.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),this._mouseDelayTimer&&(clearTimeout(this._mouseDelayTimer),delete this._mouseDelayTimer),this.ignoreMissingWhich=
!1,z=!1,t.preventDefault()},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}}),V.ui.plugin={add:function(t,e,i){var s,n=V.ui[t].prototype;for(s in i)n.plugins[s]=n.plugins[s]||[],n.plugins[s].push([e,i[s]])},call:function(t,e,i,
s){var n,o=t.plugins[e];if(o&&(s||t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType))for(n=0;n<o.length;n++)t.options[o[n][0]]&&o[n][1].apply(t.element,i)}},V.ui.safeBlur=function(t){t&&"body"!==t.nodeName.toLowerCase()&&V(t).trigger("blur")},V.widget("ui.draggable",V.ui.mouse,{version:"1.13.3",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,
refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"===this.options.helper&&this._setPositionRelative(),this.options.addClasses&&this._addClass("ui-draggable"),this._setHandleClassName(),this._mouseInit()},_setOption:function(t,e){this._super(t,e),"handle"===t&&(this._removeHandleClassName(),this._setHandleClassName())},
_destroy:function(){(this.helper||this.element).is(".ui-draggable-dragging")?this.destroyOnClear=!0:(this._removeHandleClassName(),this._mouseDestroy())},_mouseCapture:function(t){var e=this.options;return!(this.helper||e.disabled||0<V(t.target).closest(".ui-resizable-handle").length||(this.handle=this._getHandle(t),!this.handle)||(this._blurActiveElement(t),this._blockFrames(!0===e.iframeFix?"iframe":e.iframeFix),0))},_blockFrames:function(t){this.iframeBlocks=this.document.find(t).map(function(){var t=
V(this);return V("<div>").css("position","absolute").appendTo(t.parent()).outerWidth(t.outerWidth()).outerHeight(t.outerHeight()).offset(t.offset())[0]})},_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_blurActiveElement:function(t){var e=V.ui.safeActiveElement(this.document[0]);V(t.target).closest(e).length||V.ui.safeBlur(e)},_mouseStart:function(t){var e=this.options;return this.helper=this._createHelper(t),this._addClass(this.helper,"ui-draggable-dragging"),
this._cacheHelperProportions(),V.ui.ddmanager&&(V.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(!0),this.offsetParent=this.helper.offsetParent(),this.hasFixedAncestor=0<this.helper.parents().filter(function(){return"fixed"===V(this).css("position")}).length,this.positionAbs=this.element.offset(),this._refreshOffsets(t),this.originalPosition=this.position=this._generatePosition(t,!1),this.originalPageX=t.pageX,
this.originalPageY=t.pageY,e.cursorAt&&this._adjustOffsetFromHelper(e.cursorAt),this._setContainment(),!1===this._trigger("start",t)?(this._clear(),!1):(this._cacheHelperProportions(),V.ui.ddmanager&&!e.dropBehaviour&&V.ui.ddmanager.prepareOffsets(this,t),this._mouseDrag(t,!0),V.ui.ddmanager&&V.ui.ddmanager.dragStart(this,t),!0)},_refreshOffsets:function(t){this.offset={top:this.positionAbs.top-this.margins.top,left:this.positionAbs.left-this.margins.left,scroll:!1,parent:this._getParentOffset(),
relative:this._getRelativeOffset()},this.offset.click={left:t.pageX-this.offset.left,top:t.pageY-this.offset.top}},_mouseDrag:function(t,e){if(this.hasFixedAncestor&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(t,!0),this.positionAbs=this._convertPositionTo("absolute"),!e){e=this._uiHash();if(!1===this._trigger("drag",t,e))return this._mouseUp(new V.Event("mouseup",t)),!1;this.position=e.position}return this.helper[0].style.left=this.position.left+"px",this.helper[0].style.top=
this.position.top+"px",V.ui.ddmanager&&V.ui.ddmanager.drag(this,t),!1},_mouseStop:function(t){var e=this,i=!1;return V.ui.ddmanager&&!this.options.dropBehaviour&&(i=V.ui.ddmanager.drop(this,t)),this.dropped&&(i=this.dropped,this.dropped=!1),"invalid"===this.options.revert&&!i||"valid"===this.options.revert&&i||!0===this.options.revert||"function"==typeof this.options.revert&&this.options.revert.call(this.element,i)?V(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,
10),function(){!1!==e._trigger("stop",t)&&e._clear()}):!1!==this._trigger("stop",t)&&this._clear(),!1},_mouseUp:function(t){return this._unblockFrames(),V.ui.ddmanager&&V.ui.ddmanager.dragStop(this,t),this.handleElement.is(t.target)&&this.element.trigger("focus"),V.ui.mouse.prototype._mouseUp.call(this,t)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp(new V.Event("mouseup",{target:this.element[0]})):this._clear(),this},_getHandle:function(t){return!this.options.handle||
!!V(t.target).closest(this.element.find(this.options.handle)).length},_setHandleClassName:function(){this.handleElement=this.options.handle?this.element.find(this.options.handle):this.element,this._addClass(this.handleElement,"ui-draggable-handle")},_removeHandleClassName:function(){this._removeClass(this.handleElement,"ui-draggable-handle")},_createHelper:function(t){var e=this.options,i="function"==typeof e.helper,t=i?V(e.helper.apply(this.element[0],[t])):"clone"===e.helper?this.element.clone().removeAttr("id"):
this.element;return t.parents("body").length||t.appendTo("parent"===e.appendTo?this.element[0].parentNode:e.appendTo),i&&t[0]===this.element[0]&&this._setPositionRelative(),t[0]===this.element[0]||/(fixed|absolute)/.test(t.css("position"))||t.css("position","absolute"),t},_setPositionRelative:function(){/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative")},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),"left"in(t=Array.isArray(t)?{left:+t[0],
top:+t[1]||0}:t)&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_isRootNode:function(t){return/(html|body)/i.test(t.tagName)||t===this.document[0]},_getParentOffset:function(){var t=this.offsetParent.offset(),e=this.document[0];return"absolute"===this.cssPosition&&
this.scrollParent[0]!==e&&V.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),{top:(t=this._isRootNode(this.offsetParent[0])?{top:0,left:0}:t).top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){var t,e;return"relative"!==this.cssPosition?{top:0,left:0}:(t=this.element.position(),e=this._isRootNode(this.scrollParent[0]),
{top:t.top-(parseInt(this.helper.css("top"),10)||0)+(e?0:this.scrollParent.scrollTop()),left:t.left-(parseInt(this.helper.css("left"),10)||0)+(e?0:this.scrollParent.scrollLeft())})},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),
height:this.helper.outerHeight()}},_setContainment:function(){var t,e=this.options,i=this.document[0];this.relativeContainer=null,e.containment?"window"===e.containment?this.containment=[V(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,V(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,V(window).scrollLeft()+V(window).width()-this.helperProportions.width-this.margins.left,V(window).scrollTop()+(V(window).height()||i.body.parentNode.scrollHeight)-this.helperProportions.height-
this.margins.top]:"document"===e.containment?this.containment=[0,0,V(i).width()-this.helperProportions.width-this.margins.left,(V(i).height()||i.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]:e.containment.constructor===Array?this.containment=e.containment:("parent"===e.containment&&(e.containment=this.helper[0].parentNode),(e=(i=V(e.containment))[0])&&(t=/(scroll|auto)/.test(i.css("overflow")),this.containment=[(parseInt(i.css("borderLeftWidth"),10)||0)+(parseInt(i.css("paddingLeft"),
10)||0),(parseInt(i.css("borderTopWidth"),10)||0)+(parseInt(i.css("paddingTop"),10)||0),(t?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(i.css("borderRightWidth"),10)||0)-(parseInt(i.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(t?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(i.css("borderBottomWidth"),10)||0)-(parseInt(i.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],
this.relativeContainer=i)):this.containment=null},_convertPositionTo:function(t,e){e=e||this.position;var t="absolute"===t?1:-1,i=this._isRootNode(this.scrollParent[0]);return{top:e.top+this.offset.relative.top*t+this.offset.parent.top*t-("fixed"===this.cssPosition?-this.offset.scroll.top:i?0:this.offset.scroll.top)*t,left:e.left+this.offset.relative.left*t+this.offset.parent.left*t-("fixed"===this.cssPosition?-this.offset.scroll.left:i?0:this.offset.scroll.left)*t}},_generatePosition:function(t,
e){var i,s=this.options,n=this._isRootNode(this.scrollParent[0]),o=t.pageX,a=t.pageY;return n&&this.offset.scroll||(this.offset.scroll={top:this.scrollParent.scrollTop(),left:this.scrollParent.scrollLeft()}),{top:(a=e&&(this.containment&&(i=this.relativeContainer?(e=this.relativeContainer.offset(),[this.containment[0]+e.left,this.containment[1]+e.top,this.containment[2]+e.left,this.containment[3]+e.top]):this.containment,t.pageX-this.offset.click.left<i[0]&&(o=i[0]+this.offset.click.left),t.pageY-
this.offset.click.top<i[1]&&(a=i[1]+this.offset.click.top),t.pageX-this.offset.click.left>i[2]&&(o=i[2]+this.offset.click.left),t.pageY-this.offset.click.top>i[3])&&(a=i[3]+this.offset.click.top),s.grid&&(e=s.grid[1]?this.originalPageY+Math.round((a-this.originalPageY)/s.grid[1])*s.grid[1]:this.originalPageY,a=!i||e-this.offset.click.top>=i[1]||e-this.offset.click.top>i[3]?e:e-this.offset.click.top>=i[1]?e-s.grid[1]:e+s.grid[1],t=s.grid[0]?this.originalPageX+Math.round((o-this.originalPageX)/s.grid[0])*
s.grid[0]:this.originalPageX,o=!i||t-this.offset.click.left>=i[0]||t-this.offset.click.left>i[2]?t:t-this.offset.click.left>=i[0]?t-s.grid[0]:t+s.grid[0]),"y"===s.axis&&(o=this.originalPageX),"x"===s.axis)?this.originalPageY:a)-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.offset.scroll.top:n?0:this.offset.scroll.top),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.offset.scroll.left:
n?0:this.offset.scroll.left)}},_clear:function(){this._removeClass(this.helper,"ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1,this.destroyOnClear&&this.destroy()},_trigger:function(t,e,i){return i=i||this._uiHash(),V.ui.plugin.call(this,t,[e,i,this],!0),/^(drag|start|stop)/.test(t)&&(this.positionAbs=this._convertPositionTo("absolute"),i.offset=this.positionAbs),V.Widget.prototype._trigger.call(this,
t,e,i)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),V.ui.plugin.add("draggable","connectToSortable",{start:function(e,t,i){var s=V.extend({},t,{item:i.element});i.sortables=[],V(i.options.connectToSortable).each(function(){var t=V(this).sortable("instance");t&&!t.options.disabled&&(i.sortables.push(t),t.refreshPositions(),t._trigger("activate",e,s))})},stop:function(e,t,i){var s=V.extend({},t,{item:i.element});
i.cancelHelperRemoval=!1,V.each(i.sortables,function(){var t=this;t.isOver?(t.isOver=0,i.cancelHelperRemoval=!0,t.cancelHelperRemoval=!1,t._storedCSS={position:t.placeholder.css("position"),top:t.placeholder.css("top"),left:t.placeholder.css("left")},t._mouseStop(e),t.options.helper=t.options._helper):(t.cancelHelperRemoval=!0,t._trigger("deactivate",e,s))})},drag:function(i,s,n){V.each(n.sortables,function(){var t=!1,e=this;e.positionAbs=n.positionAbs,e.helperProportions=n.helperProportions,e.offset.click=
n.offset.click,e._intersectsWith(e.containerCache)&&(t=!0,V.each(n.sortables,function(){return this.positionAbs=n.positionAbs,this.helperProportions=n.helperProportions,this.offset.click=n.offset.click,t=this!==e&&this._intersectsWith(this.containerCache)&&V.contains(e.element[0],this.element[0])?!1:t})),t?(e.isOver||(e.isOver=1,n._parent=s.helper.parent(),e.currentItem=s.helper.appendTo(e.element).data("ui-sortable-item",!0),e.options._helper=e.options.helper,e.options.helper=function(){return s.helper[0]},
i.target=e.currentItem[0],e._mouseCapture(i,!0),e._mouseStart(i,!0,!0),e.offset.click.top=n.offset.click.top,e.offset.click.left=n.offset.click.left,e.offset.parent.left-=n.offset.parent.left-e.offset.parent.left,e.offset.parent.top-=n.offset.parent.top-e.offset.parent.top,n._trigger("toSortable",i),n.dropped=e.element,V.each(n.sortables,function(){this.refreshPositions()}),n.currentItem=n.element,e.fromOutside=n),e.currentItem&&(e._mouseDrag(i),s.position=e.position)):e.isOver&&(e.isOver=0,e.cancelHelperRemoval=
!0,e.options._revert=e.options.revert,e.options.revert=!1,e._trigger("out",i,e._uiHash(e)),e._mouseStop(i,!0),e.options.revert=e.options._revert,e.options.helper=e.options._helper,e.placeholder&&e.placeholder.remove(),s.helper.appendTo(n._parent),n._refreshOffsets(i),s.position=n._generatePosition(i,!0),n._trigger("fromSortable",i),n.dropped=!1,V.each(n.sortables,function(){this.refreshPositions()}))})}}),V.ui.plugin.add("draggable","cursor",{start:function(t,e,i){var s=V("body"),i=i.options;s.css("cursor")&&
(i._cursor=s.css("cursor")),s.css("cursor",i.cursor)},stop:function(t,e,i){i=i.options;i._cursor&&V("body").css("cursor",i._cursor)}}),V.ui.plugin.add("draggable","opacity",{start:function(t,e,i){e=V(e.helper),i=i.options;e.css("opacity")&&(i._opacity=e.css("opacity")),e.css("opacity",i.opacity)},stop:function(t,e,i){i=i.options;i._opacity&&V(e.helper).css("opacity",i._opacity)}}),V.ui.plugin.add("draggable","scroll",{start:function(t,e,i){i.scrollParentNotHidden||(i.scrollParentNotHidden=i.helper.scrollParent(!1)),
i.scrollParentNotHidden[0]!==i.document[0]&&"HTML"!==i.scrollParentNotHidden[0].tagName&&(i.overflowOffset=i.scrollParentNotHidden.offset())},drag:function(t,e,i){var s=i.options,n=!1,o=i.scrollParentNotHidden[0],a=i.document[0];o!==a&&"HTML"!==o.tagName?(s.axis&&"x"===s.axis||(i.overflowOffset.top+o.offsetHeight-t.pageY<s.scrollSensitivity?o.scrollTop=n=o.scrollTop+s.scrollSpeed:t.pageY-i.overflowOffset.top<s.scrollSensitivity&&(o.scrollTop=n=o.scrollTop-s.scrollSpeed)),s.axis&&"y"===s.axis||(i.overflowOffset.left+
o.offsetWidth-t.pageX<s.scrollSensitivity?o.scrollLeft=n=o.scrollLeft+s.scrollSpeed:t.pageX-i.overflowOffset.left<s.scrollSensitivity&&(o.scrollLeft=n=o.scrollLeft-s.scrollSpeed))):(s.axis&&"x"===s.axis||(t.pageY-V(a).scrollTop()<s.scrollSensitivity?n=V(a).scrollTop(V(a).scrollTop()-s.scrollSpeed):V(window).height()-(t.pageY-V(a).scrollTop())<s.scrollSensitivity&&(n=V(a).scrollTop(V(a).scrollTop()+s.scrollSpeed))),s.axis&&"y"===s.axis||(t.pageX-V(a).scrollLeft()<s.scrollSensitivity?n=V(a).scrollLeft(V(a).scrollLeft()-
s.scrollSpeed):V(window).width()-(t.pageX-V(a).scrollLeft())<s.scrollSensitivity&&(n=V(a).scrollLeft(V(a).scrollLeft()+s.scrollSpeed)))),!1!==n&&V.ui.ddmanager&&!s.dropBehaviour&&V.ui.ddmanager.prepareOffsets(i,t)}}),V.ui.plugin.add("draggable","snap",{start:function(t,e,i){var s=i.options;i.snapElements=[],V(s.snap.constructor!==String?s.snap.items||":data(ui-draggable)":s.snap).each(function(){var t=V(this),e=t.offset();this!==i.element[0]&&i.snapElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),
top:e.top,left:e.left})})},drag:function(t,e,i){for(var s,n,o,a,r,l,h,c,u,d=i.options,p=d.snapTolerance,f=e.offset.left,g=f+i.helperProportions.width,m=e.offset.top,_=m+i.helperProportions.height,v=i.snapElements.length-1;0<=v;v--)l=(r=i.snapElements[v].left-i.margins.left)+i.snapElements[v].width,c=(h=i.snapElements[v].top-i.margins.top)+i.snapElements[v].height,g<r-p||l+p<f||_<h-p||c+p<m||!V.contains(i.snapElements[v].item.ownerDocument,i.snapElements[v].item)?(i.snapElements[v].snapping&&i.options.snap.release&&
i.options.snap.release.call(i.element,t,V.extend(i._uiHash(),{snapItem:i.snapElements[v].item})),i.snapElements[v].snapping=!1):("inner"!==d.snapMode&&(s=Math.abs(h-_)<=p,n=Math.abs(c-m)<=p,o=Math.abs(r-g)<=p,a=Math.abs(l-f)<=p,s&&(e.position.top=i._convertPositionTo("relative",{top:h-i.helperProportions.height,left:0}).top),n&&(e.position.top=i._convertPositionTo("relative",{top:c,left:0}).top),o&&(e.position.left=i._convertPositionTo("relative",{top:0,left:r-i.helperProportions.width}).left),a)&&
(e.position.left=i._convertPositionTo("relative",{top:0,left:l}).left),u=s||n||o||a,"outer"!==d.snapMode&&(s=Math.abs(h-m)<=p,n=Math.abs(c-_)<=p,o=Math.abs(r-f)<=p,a=Math.abs(l-g)<=p,s&&(e.position.top=i._convertPositionTo("relative",{top:h,left:0}).top),n&&(e.position.top=i._convertPositionTo("relative",{top:c-i.helperProportions.height,left:0}).top),o&&(e.position.left=i._convertPositionTo("relative",{top:0,left:r}).left),a)&&(e.position.left=i._convertPositionTo("relative",{top:0,left:l-i.helperProportions.width}).left),
!i.snapElements[v].snapping&&(s||n||o||a||u)&&i.options.snap.snap&&i.options.snap.snap.call(i.element,t,V.extend(i._uiHash(),{snapItem:i.snapElements[v].item})),i.snapElements[v].snapping=s||n||o||a||u)}}),V.ui.plugin.add("draggable","stack",{start:function(t,e,i){var s,i=i.options,i=V.makeArray(V(i.stack)).sort(function(t,e){return(parseInt(V(t).css("zIndex"),10)||0)-(parseInt(V(e).css("zIndex"),10)||0)});i.length&&(s=parseInt(V(i[0]).css("zIndex"),10)||0,V(i).each(function(t){V(this).css("zIndex",
s+t)}),this.css("zIndex",s+i.length))}}),V.ui.plugin.add("draggable","zIndex",{start:function(t,e,i){e=V(e.helper),i=i.options;e.css("zIndex")&&(i._zIndex=e.css("zIndex")),e.css("zIndex",i.zIndex)},stop:function(t,e,i){i=i.options;i._zIndex&&V(e.helper).css("zIndex",i._zIndex)}}),V.ui.draggable,V.widget("ui.resizable",V.ui.mouse,{version:"1.13.3",widgetEventPrefix:"resize",options:{alsoResize:!1,animate:!1,animateDuration:"slow",animateEasing:"swing",aspectRatio:!1,autoHide:!1,classes:{"ui-resizable-se":"ui-icon ui-icon-gripsmall-diagonal-se"},
containment:!1,ghost:!1,grid:!1,handles:"e,s,se",helper:!1,maxHeight:null,maxWidth:null,minHeight:10,minWidth:10,zIndex:90,resize:null,start:null,stop:null},_num:function(t){return parseFloat(t)||0},_isNumber:function(t){return!isNaN(parseFloat(t))},_hasScroll:function(t,e){if("hidden"===V(t).css("overflow"))return!1;var e=e&&"left"===e?"scrollLeft":"scrollTop",i=!1;if(0<t[e])return!0;try{t[e]=1,i=0<t[e],t[e]=0}catch(t){}return i},_create:function(){var t,e=this.options,i=this;this._addClass("ui-resizable"),
V.extend(this,{_aspectRatio:!!e.aspectRatio,aspectRatio:e.aspectRatio,originalElement:this.element,_proportionallyResizeElements:[],_helper:e.helper||e.ghost||e.animate?e.helper||"ui-resizable-helper":null}),this.element[0].nodeName.match(/^(canvas|textarea|input|select|button|img)$/i)&&(this.element.wrap(V("<div class='ui-wrapper'></div>").css({overflow:"hidden",position:this.element.css("position"),width:this.element.outerWidth(),height:this.element.outerHeight(),top:this.element.css("top"),left:this.element.css("left")})),
this.element=this.element.parent().data("ui-resizable",this.element.resizable("instance")),this.elementIsWrapper=!0,t={marginTop:this.originalElement.css("marginTop"),marginRight:this.originalElement.css("marginRight"),marginBottom:this.originalElement.css("marginBottom"),marginLeft:this.originalElement.css("marginLeft")},this.element.css(t),this.originalElement.css("margin",0),this.originalResizeStyle=this.originalElement.css("resize"),this.originalElement.css("resize","none"),this._proportionallyResizeElements.push(this.originalElement.css({position:"static",
zoom:1,display:"block"})),this.originalElement.css(t),this._proportionallyResize()),this._setupHandles(),e.autoHide&&V(this.element).on("mouseenter",function(){e.disabled||(i._removeClass("ui-resizable-autohide"),i._handles.show())}).on("mouseleave",function(){e.disabled||i.resizing||(i._addClass("ui-resizable-autohide"),i._handles.hide())}),this._mouseInit()},_destroy:function(){this._mouseDestroy(),this._addedHandles.remove();function t(t){V(t).removeData("resizable").removeData("ui-resizable").off(".resizable")}
var e;return this.elementIsWrapper&&(t(this.element),e=this.element,this.originalElement.css({position:e.css("position"),width:e.outerWidth(),height:e.outerHeight(),top:e.css("top"),left:e.css("left")}).insertAfter(e),e.remove()),this.originalElement.css("resize",this.originalResizeStyle),t(this.originalElement),this},_setOption:function(t,e){switch(this._super(t,e),t){case "handles":this._removeHandles(),this._setupHandles();break;case "aspectRatio":this._aspectRatio=!!e}},_setupHandles:function(){var t,
e,i,s,n,o=this.options,a=this;if(this.handles=o.handles||(V(".ui-resizable-handle",this.element).length?{n:".ui-resizable-n",e:".ui-resizable-e",s:".ui-resizable-s",w:".ui-resizable-w",se:".ui-resizable-se",sw:".ui-resizable-sw",ne:".ui-resizable-ne",nw:".ui-resizable-nw"}:"e,s,se"),this._handles=V(),this._addedHandles=V(),this.handles.constructor===String)for("all"===this.handles&&(this.handles="n,e,s,w,se,sw,ne,nw"),i=this.handles.split(","),this.handles={},e=0;e<i.length;e++)s="ui-resizable-"+
(t=String.prototype.trim.call(i[e])),n=V("<div>"),this._addClass(n,"ui-resizable-handle "+s),n.css({zIndex:o.zIndex}),this.handles[t]=".ui-resizable-"+t,this.element.children(this.handles[t]).length||(this.element.append(n),this._addedHandles=this._addedHandles.add(n));this._renderAxis=function(t){var e,i,s;for(e in t=t||this.element,this.handles)this.handles[e].constructor===String?this.handles[e]=this.element.children(this.handles[e]).first().show():(this.handles[e].jquery||this.handles[e].nodeType)&&
(this.handles[e]=V(this.handles[e]),this._on(this.handles[e],{mousedown:a._mouseDown})),this.elementIsWrapper&&this.originalElement[0].nodeName.match(/^(textarea|input|select|button)$/i)&&(s=V(this.handles[e],this.element),s=/sw|ne|nw|se|n|s/.test(e)?s.outerHeight():s.outerWidth(),i=["padding",/ne|nw|n/.test(e)?"Top":/se|sw|s/.test(e)?"Bottom":/^e$/.test(e)?"Right":"Left"].join(""),t.css(i,s),this._proportionallyResize()),this._handles=this._handles.add(this.handles[e])},this._renderAxis(this.element),
this._handles=this._handles.add(this.element.find(".ui-resizable-handle")),this._handles.disableSelection(),this._handles.on("mouseover",function(){a.resizing||(this.className&&(n=this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i)),a.axis=n&&n[1]?n[1]:"se")}),o.autoHide&&(this._handles.hide(),this._addClass("ui-resizable-autohide"))},_removeHandles:function(){this._addedHandles.remove()},_mouseCapture:function(t){var e,i,s=!1;for(e in this.handles)(i=V(this.handles[e])[0])!==t.target&&!V.contains(i,
t.target)||(s=!0);return!this.options.disabled&&s},_mouseStart:function(t){var e,i,s=this.options,n=this.element;return this.resizing=!0,this._renderProxy(),e=this._num(this.helper.css("left")),i=this._num(this.helper.css("top")),s.containment&&(e+=V(s.containment).scrollLeft()||0,i+=V(s.containment).scrollTop()||0),this.offset=this.helper.offset(),this.position={left:e,top:i},this.size=this._helper?{width:this.helper.width(),height:this.helper.height()}:{width:n.width(),height:n.height()},this.originalSize=
this._helper?{width:n.outerWidth(),height:n.outerHeight()}:{width:n.width(),height:n.height()},this.sizeDiff={width:n.outerWidth()-n.width(),height:n.outerHeight()-n.height()},this.originalPosition={left:e,top:i},this.originalMousePosition={left:t.pageX,top:t.pageY},this.aspectRatio="number"==typeof s.aspectRatio?s.aspectRatio:this.originalSize.width/this.originalSize.height||1,n=V(".ui-resizable-"+this.axis).css("cursor"),V("body").css("cursor","auto"===n?this.axis+"-resize":n),this._addClass("ui-resizable-resizing"),
this._propagate("start",t),!0},_mouseDrag:function(t){var e=this.originalMousePosition,i=this.axis,s=t.pageX-e.left||0,e=t.pageY-e.top||0,i=this._change[i];return this._updatePrevProperties(),i&&(i=i.apply(this,[t,s,e]),this._updateVirtualBoundaries(t.shiftKey),(this._aspectRatio||t.shiftKey)&&(i=this._updateRatio(i,t)),i=this._respectSize(i,t),this._updateCache(i),this._propagate("resize",t),s=this._applyChanges(),!this._helper&&this._proportionallyResizeElements.length&&this._proportionallyResize(),
V.isEmptyObject(s)||(this._updatePrevProperties(),this._trigger("resize",t,this.ui()),this._applyChanges())),!1},_mouseStop:function(t){this.resizing=!1;var e,i,s,n=this.options,o=this;return this._helper&&(i=(e=(i=this._proportionallyResizeElements).length&&/textarea/i.test(i[0].nodeName))&&this._hasScroll(i[0],"left")?0:o.sizeDiff.height,e=e?0:o.sizeDiff.width,e={width:o.helper.width()-e,height:o.helper.height()-i},i=parseFloat(o.element.css("left"))+(o.position.left-o.originalPosition.left)||null,
s=parseFloat(o.element.css("top"))+(o.position.top-o.originalPosition.top)||null,n.animate||this.element.css(V.extend(e,{top:s,left:i})),o.helper.height(o.size.height),o.helper.width(o.size.width),this._helper)&&!n.animate&&this._proportionallyResize(),V("body").css("cursor","auto"),this._removeClass("ui-resizable-resizing"),this._propagate("stop",t),this._helper&&this.helper.remove(),!1},_updatePrevProperties:function(){this.prevPosition={top:this.position.top,left:this.position.left},this.prevSize=
{width:this.size.width,height:this.size.height}},_applyChanges:function(){var t={};return this.position.top!==this.prevPosition.top&&(t.top=this.position.top+"px"),this.position.left!==this.prevPosition.left&&(t.left=this.position.left+"px"),this.helper.css(t),this.size.width!==this.prevSize.width&&(t.width=this.size.width+"px",this.helper.width(t.width)),this.size.height!==this.prevSize.height&&(t.height=this.size.height+"px",this.helper.height(t.height)),t},_updateVirtualBoundaries:function(t){var e,
i,s,n=this.options,n={minWidth:this._isNumber(n.minWidth)?n.minWidth:0,maxWidth:this._isNumber(n.maxWidth)?n.maxWidth:1/0,minHeight:this._isNumber(n.minHeight)?n.minHeight:0,maxHeight:this._isNumber(n.maxHeight)?n.maxHeight:1/0};(this._aspectRatio||t)&&(t=n.minHeight*this.aspectRatio,i=n.minWidth/this.aspectRatio,e=n.maxHeight*this.aspectRatio,s=n.maxWidth/this.aspectRatio,n.minWidth<t&&(n.minWidth=t),n.minHeight<i&&(n.minHeight=i),e<n.maxWidth&&(n.maxWidth=e),s<n.maxHeight)&&(n.maxHeight=s),this._vBoundaries=
n},_updateCache:function(t){this.offset=this.helper.offset(),this._isNumber(t.left)&&(this.position.left=t.left),this._isNumber(t.top)&&(this.position.top=t.top),this._isNumber(t.height)&&(this.size.height=t.height),this._isNumber(t.width)&&(this.size.width=t.width)},_updateRatio:function(t){var e=this.position,i=this.size,s=this.axis;return this._isNumber(t.height)?t.width=t.height*this.aspectRatio:this._isNumber(t.width)&&(t.height=t.width/this.aspectRatio),"sw"===s&&(t.left=e.left+(i.width-t.width),
t.top=null),"nw"===s&&(t.top=e.top+(i.height-t.height),t.left=e.left+(i.width-t.width)),t},_respectSize:function(t){var e=this._vBoundaries,i=this.axis,s=this._isNumber(t.width)&&e.maxWidth&&e.maxWidth<t.width,n=this._isNumber(t.height)&&e.maxHeight&&e.maxHeight<t.height,o=this._isNumber(t.width)&&e.minWidth&&e.minWidth>t.width,a=this._isNumber(t.height)&&e.minHeight&&e.minHeight>t.height,r=this.originalPosition.left+this.originalSize.width,l=this.originalPosition.top+this.originalSize.height,h=/sw|nw|w/.test(i),
i=/nw|ne|n/.test(i);return o&&(t.width=e.minWidth),a&&(t.height=e.minHeight),s&&(t.width=e.maxWidth),n&&(t.height=e.maxHeight),o&&h&&(t.left=r-e.minWidth),s&&h&&(t.left=r-e.maxWidth),a&&i&&(t.top=l-e.minHeight),n&&i&&(t.top=l-e.maxHeight),t.width||t.height||t.left||!t.top?t.width||t.height||t.top||!t.left||(t.left=null):t.top=null,t},_getPaddingPlusBorderDimensions:function(t){for(var e=0,i=[],s=[t.css("borderTopWidth"),t.css("borderRightWidth"),t.css("borderBottomWidth"),t.css("borderLeftWidth")],
n=[t.css("paddingTop"),t.css("paddingRight"),t.css("paddingBottom"),t.css("paddingLeft")];e<4;e++)i[e]=parseFloat(s[e])||0,i[e]+=parseFloat(n[e])||0;return{height:i[0]+i[2],width:i[1]+i[3]}},_proportionallyResize:function(){if(this._proportionallyResizeElements.length)for(var t,e=0,i=this.helper||this.element;e<this._proportionallyResizeElements.length;e++)t=this._proportionallyResizeElements[e],this.outerDimensions||(this.outerDimensions=this._getPaddingPlusBorderDimensions(t)),t.css({height:i.height()-
this.outerDimensions.height||0,width:i.width()-this.outerDimensions.width||0})},_renderProxy:function(){var t=this.element,e=this.options;this.elementOffset=t.offset(),this._helper?(this.helper=this.helper||V("<div></div>").css({overflow:"hidden"}),this._addClass(this.helper,this._helper),this.helper.css({width:this.element.outerWidth(),height:this.element.outerHeight(),position:"absolute",left:this.elementOffset.left+"px",top:this.elementOffset.top+"px",zIndex:++e.zIndex}),this.helper.appendTo("body").disableSelection()):
this.helper=this.element},_change:{e:function(t,e){return{width:this.originalSize.width+e}},w:function(t,e){var i=this.originalSize;return{left:this.originalPosition.left+e,width:i.width-e}},n:function(t,e,i){var s=this.originalSize;return{top:this.originalPosition.top+i,height:s.height-i}},s:function(t,e,i){return{height:this.originalSize.height+i}},se:function(t,e,i){return V.extend(this._change.s.apply(this,arguments),this._change.e.apply(this,[t,e,i]))},sw:function(t,e,i){return V.extend(this._change.s.apply(this,
arguments),this._change.w.apply(this,[t,e,i]))},ne:function(t,e,i){return V.extend(this._change.n.apply(this,arguments),this._change.e.apply(this,[t,e,i]))},nw:function(t,e,i){return V.extend(this._change.n.apply(this,arguments),this._change.w.apply(this,[t,e,i]))}},_propagate:function(t,e){V.ui.plugin.call(this,t,[e,this.ui()]),"resize"!==t&&this._trigger(t,e,this.ui())},plugins:{},ui:function(){return{originalElement:this.originalElement,element:this.element,helper:this.helper,position:this.position,
size:this.size,originalSize:this.originalSize,originalPosition:this.originalPosition}}}),V.ui.plugin.add("resizable","animate",{stop:function(e){var i=V(this).resizable("instance"),t=i.options,s=i._proportionallyResizeElements,n=s.length&&/textarea/i.test(s[0].nodeName),o=n&&i._hasScroll(s[0],"left")?0:i.sizeDiff.height,n=n?0:i.sizeDiff.width,n={width:i.size.width-n,height:i.size.height-o},o=parseFloat(i.element.css("left"))+(i.position.left-i.originalPosition.left)||null,a=parseFloat(i.element.css("top"))+
(i.position.top-i.originalPosition.top)||null;i.element.animate(V.extend(n,a&&o?{top:a,left:o}:{}),{duration:t.animateDuration,easing:t.animateEasing,step:function(){var t={width:parseFloat(i.element.css("width")),height:parseFloat(i.element.css("height")),top:parseFloat(i.element.css("top")),left:parseFloat(i.element.css("left"))};s&&s.length&&V(s[0]).css({width:t.width,height:t.height}),i._updateCache(t),i._propagate("resize",e)}})}}),V.ui.plugin.add("resizable","containment",{start:function(){var i,
s,t,e,n=V(this).resizable("instance"),o=n.options,a=n.element,o=o.containment,a=o instanceof V?o.get(0):/parent/.test(o)?a.parent().get(0):o;a&&(n.containerElement=V(a),/document/.test(o)||o===document?(n.containerOffset={left:0,top:0},n.containerPosition={left:0,top:0},n.parentData={element:V(document),left:0,top:0,width:V(document).width(),height:V(document).height()||document.body.parentNode.scrollHeight}):(i=V(a),s=[],V(["Top","Right","Left","Bottom"]).each(function(t,e){s[t]=n._num(i.css("padding"+
e))}),n.containerOffset=i.offset(),n.containerPosition=i.position(),n.containerSize={height:i.innerHeight()-s[3],width:i.innerWidth()-s[1]},o=n.containerOffset,e=n.containerSize.height,t=n.containerSize.width,t=n._hasScroll(a,"left")?a.scrollWidth:t,e=n._hasScroll(a)?a.scrollHeight:e,n.parentData={element:a,left:o.left,top:o.top,width:t,height:e}))},resize:function(t){var e=V(this).resizable("instance"),i=e.options,s=e.containerOffset,n=e.position,t=e._aspectRatio||t.shiftKey,o={top:0,left:0},a=e.containerElement,
r=!0;a[0]!==document&&/static/.test(a.css("position"))&&(o=s),n.left<(e._helper?s.left:0)&&(e.size.width=e.size.width+(e._helper?e.position.left-s.left:e.position.left-o.left),t&&(e.size.height=e.size.width/e.aspectRatio,r=!1),e.position.left=i.helper?s.left:0),n.top<(e._helper?s.top:0)&&(e.size.height=e.size.height+(e._helper?e.position.top-s.top:e.position.top),t&&(e.size.width=e.size.height*e.aspectRatio,r=!1),e.position.top=e._helper?s.top:0),a=e.containerElement.get(0)===e.element.parent().get(0),
i=/relative|absolute/.test(e.containerElement.css("position")),a&&i?(e.offset.left=e.parentData.left+e.position.left,e.offset.top=e.parentData.top+e.position.top):(e.offset.left=e.element.offset().left,e.offset.top=e.element.offset().top),n=Math.abs(e.sizeDiff.width+(e._helper?e.offset.left-o.left:e.offset.left-s.left)),a=Math.abs(e.sizeDiff.height+(e._helper?e.offset.top-o.top:e.offset.top-s.top)),n+e.size.width>=e.parentData.width&&(e.size.width=e.parentData.width-n,t)&&(e.size.height=e.size.width/
e.aspectRatio,r=!1),a+e.size.height>=e.parentData.height&&(e.size.height=e.parentData.height-a,t)&&(e.size.width=e.size.height*e.aspectRatio,r=!1),r||(e.position.left=e.prevPosition.left,e.position.top=e.prevPosition.top,e.size.width=e.prevSize.width,e.size.height=e.prevSize.height)},stop:function(){var t=V(this).resizable("instance"),e=t.options,i=t.containerOffset,s=t.containerPosition,n=t.containerElement,o=V(t.helper),a=o.offset(),r=o.outerWidth()-t.sizeDiff.width,o=o.outerHeight()-t.sizeDiff.height;
t._helper&&!e.animate&&/relative/.test(n.css("position"))&&V(this).css({left:a.left-s.left-i.left,width:r,height:o}),t._helper&&!e.animate&&/static/.test(n.css("position"))&&V(this).css({left:a.left-s.left-i.left,width:r,height:o})}}),V.ui.plugin.add("resizable","alsoResize",{start:function(){var t=V(this).resizable("instance").options;V(t.alsoResize).each(function(){var t=V(this);t.data("ui-resizable-alsoresize",{width:parseFloat(t.css("width")),height:parseFloat(t.css("height")),left:parseFloat(t.css("left")),
top:parseFloat(t.css("top"))})})},resize:function(t,i){var e=V(this).resizable("instance"),s=e.options,n=e.originalSize,o=e.originalPosition,a={height:e.size.height-n.height||0,width:e.size.width-n.width||0,top:e.position.top-o.top||0,left:e.position.left-o.left||0};V(s.alsoResize).each(function(){var t=V(this),s=V(this).data("ui-resizable-alsoresize"),n={},e=t.parents(i.originalElement[0]).length?["width","height"]:["width","height","top","left"];V.each(e,function(t,e){var i=(s[e]||0)+(a[e]||0);
i&&0<=i&&(n[e]=i||null)}),t.css(n)})},stop:function(){V(this).removeData("ui-resizable-alsoresize")}}),V.ui.plugin.add("resizable","ghost",{start:function(){var t=V(this).resizable("instance"),e=t.size;t.ghost=t.originalElement.clone(),t.ghost.css({opacity:.25,display:"block",position:"relative",height:e.height,width:e.width,margin:0,left:0,top:0}),t._addClass(t.ghost,"ui-resizable-ghost"),!1!==V.uiBackCompat&&"string"==typeof t.options.ghost&&t.ghost.addClass(this.options.ghost),t.ghost.appendTo(t.helper)},
resize:function(){var t=V(this).resizable("instance");t.ghost&&t.ghost.css({position:"relative",height:t.size.height,width:t.size.width})},stop:function(){var t=V(this).resizable("instance");t.ghost&&t.helper&&t.helper.get(0).removeChild(t.ghost.get(0))}}),V.ui.plugin.add("resizable","grid",{resize:function(){var t,e=V(this).resizable("instance"),i=e.options,s=e.size,n=e.originalSize,o=e.originalPosition,a=e.axis,r="number"==typeof i.grid?[i.grid,i.grid]:i.grid,l=r[0]||1,h=r[1]||1,c=Math.round((s.width-
n.width)/l)*l,s=Math.round((s.height-n.height)/h)*h,u=n.width+c,d=n.height+s,p=i.maxWidth&&i.maxWidth<u,f=i.maxHeight&&i.maxHeight<d,g=i.minWidth&&i.minWidth>u,m=i.minHeight&&i.minHeight>d;i.grid=r,g&&(u+=l),m&&(d+=h),p&&(u-=l),f&&(d-=h),/^(se|s|e)$/.test(a)?(e.size.width=u,e.size.height=d):/^(ne)$/.test(a)?(e.size.width=u,e.size.height=d,e.position.top=o.top-s):/^(sw)$/.test(a)?(e.size.width=u,e.size.height=d,e.position.left=o.left-c):((d-h<=0||u-l<=0)&&(t=e._getPaddingPlusBorderDimensions(this)),
0<d-h?(e.size.height=d,e.position.top=o.top-s):(d=h-t.height,e.size.height=d,e.position.top=o.top+n.height-d),0<u-l?(e.size.width=u,e.position.left=o.left-c):(u=l-t.width,e.size.width=u,e.position.left=o.left+n.width-u))}}),V.ui.resizable,V.widget("ui.dialog",{version:"1.13.3",options:{appendTo:"body",autoOpen:!0,buttons:[],classes:{"ui-dialog":"ui-corner-all","ui-dialog-titlebar":"ui-corner-all"},closeOnEscape:!0,closeText:"Close",draggable:!0,hide:null,height:"auto",maxHeight:null,maxWidth:null,
minHeight:150,minWidth:150,modal:!1,position:{my:"center",at:"center",of:window,collision:"fit",using:function(t){var e=V(this).css(t).offset().top;e<0&&V(this).css("top",t.top-e)}},resizable:!0,show:null,title:null,width:300,beforeClose:null,close:null,drag:null,dragStart:null,dragStop:null,focus:null,open:null,resize:null,resizeStart:null,resizeStop:null},sizeRelatedOptions:{buttons:!0,height:!0,maxHeight:!0,maxWidth:!0,minHeight:!0,minWidth:!0,width:!0},resizableRelatedOptions:{maxHeight:!0,maxWidth:!0,
minHeight:!0,minWidth:!0},_create:function(){this.originalCss={display:this.element[0].style.display,width:this.element[0].style.width,minHeight:this.element[0].style.minHeight,maxHeight:this.element[0].style.maxHeight,height:this.element[0].style.height},this.originalPosition={parent:this.element.parent(),index:this.element.parent().children().index(this.element)},this.originalTitle=this.element.attr("title"),null==this.options.title&&null!=this.originalTitle&&(this.options.title=this.originalTitle),
this.options.disabled&&(this.options.disabled=!1),this._createWrapper(),this.element.show().removeAttr("title").appendTo(this.uiDialog),this._addClass("ui-dialog-content","ui-widget-content"),this._createTitlebar(),this._createButtonPane(),this.options.draggable&&V.fn.draggable&&this._makeDraggable(),this.options.resizable&&V.fn.resizable&&this._makeResizable(),this._isOpen=!1,this._trackFocus()},_init:function(){this.options.autoOpen&&this.open()},_appendTo:function(){var t=this.options.appendTo;
return t&&(t.jquery||t.nodeType)?V(t):this.document.find(t||"body").eq(0)},_destroy:function(){var t,e=this.originalPosition;this._untrackInstance(),this._destroyOverlay(),this.element.removeUniqueId().css(this.originalCss).detach(),this.uiDialog.remove(),this.originalTitle&&this.element.attr("title",this.originalTitle),(t=e.parent.children().eq(e.index)).length&&t[0]!==this.element[0]?t.before(this.element):e.parent.append(this.element)},widget:function(){return this.uiDialog},disable:V.noop,enable:V.noop,
close:function(t){var e=this;this._isOpen&&!1!==this._trigger("beforeClose",t)&&(this._isOpen=!1,this._focusedElement=null,this._destroyOverlay(),this._untrackInstance(),this.opener.filter(":focusable").trigger("focus").length||V.ui.safeBlur(V.ui.safeActiveElement(this.document[0])),this._hide(this.uiDialog,this.options.hide,function(){e._trigger("close",t)}))},isOpen:function(){return this._isOpen},moveToTop:function(){this._moveToTop()},_moveToTop:function(t,e){var i=!1,s=this.uiDialog.siblings(".ui-front:visible").map(function(){return+V(this).css("z-index")}).get(),
s=Math.max.apply(null,s);return s>=+this.uiDialog.css("z-index")&&(this.uiDialog.css("z-index",s+1),i=!0),i&&!e&&this._trigger("focus",t),i},open:function(){var t=this;this._isOpen?this._moveToTop()&&this._focusTabbable():(this._isOpen=!0,this.opener=V(V.ui.safeActiveElement(this.document[0])),this._size(),this._position(),this._createOverlay(),this._moveToTop(null,!0),this.overlay&&this.overlay.css("z-index",this.uiDialog.css("z-index")-1),this._show(this.uiDialog,this.options.show,function(){t._focusTabbable(),
t._trigger("focus")}),this._makeFocusTarget(),this._trigger("open"))},_focusTabbable:function(){var t=this._focusedElement;(t=(t=(t=(t=(t=t||this.element.find("[autofocus]")).length?t:this.element.find(":tabbable")).length?t:this.uiDialogButtonPane.find(":tabbable")).length?t:this.uiDialogTitlebarClose.filter(":tabbable")).length?t:this.uiDialog).eq(0).trigger("focus")},_restoreTabbableFocus:function(){var t=V.ui.safeActiveElement(this.document[0]);this.uiDialog[0]===t||V.contains(this.uiDialog[0],
t)||this._focusTabbable()},_keepFocus:function(t){t.preventDefault(),this._restoreTabbableFocus(),this._delay(this._restoreTabbableFocus)},_createWrapper:function(){this.uiDialog=V("<div>").hide().attr({tabIndex:-1,role:"dialog"}).appendTo(this._appendTo()),this._addClass(this.uiDialog,"ui-dialog","ui-widget ui-widget-content ui-front"),this._on(this.uiDialog,{keydown:function(t){var e,i,s;this.options.closeOnEscape&&!t.isDefaultPrevented()&&t.keyCode&&t.keyCode===V.ui.keyCode.ESCAPE?(t.preventDefault(),
this.close(t)):t.keyCode!==V.ui.keyCode.TAB||t.isDefaultPrevented()||(e=this.uiDialog.find(":tabbable"),i=e.first(),s=e.last(),t.target!==s[0]&&t.target!==this.uiDialog[0]||t.shiftKey?t.target!==i[0]&&t.target!==this.uiDialog[0]||!t.shiftKey||(this._delay(function(){s.trigger("focus")}),t.preventDefault()):(this._delay(function(){i.trigger("focus")}),t.preventDefault()))},mousedown:function(t){this._moveToTop(t)&&this._focusTabbable()}}),this.element.find("[aria-describedby]").length||this.uiDialog.attr({"aria-describedby":this.element.uniqueId().attr("id")})},
_createTitlebar:function(){var t;this.uiDialogTitlebar=V("<div>"),this._addClass(this.uiDialogTitlebar,"ui-dialog-titlebar","ui-widget-header ui-helper-clearfix"),this._on(this.uiDialogTitlebar,{mousedown:function(t){V(t.target).closest(".ui-dialog-titlebar-close")||this.uiDialog.trigger("focus")}}),this.uiDialogTitlebarClose=V("<button type='button'></button>").button({label:V("<a>").text(this.options.closeText).html(),icon:"ui-icon-closethick",showLabel:!1}).appendTo(this.uiDialogTitlebar),this._addClass(this.uiDialogTitlebarClose,
"ui-dialog-titlebar-close"),this._on(this.uiDialogTitlebarClose,{click:function(t){t.preventDefault(),this.close(t)}}),t=V("<span>").uniqueId().prependTo(this.uiDialogTitlebar),this._addClass(t,"ui-dialog-title"),this._title(t),this.uiDialogTitlebar.prependTo(this.uiDialog),this.uiDialog.attr({"aria-labelledby":t.attr("id")})},_title:function(t){this.options.title?t.text(this.options.title):t.html("&#160;")},_createButtonPane:function(){this.uiDialogButtonPane=V("<div>"),this._addClass(this.uiDialogButtonPane,
"ui-dialog-buttonpane","ui-widget-content ui-helper-clearfix"),this.uiButtonSet=V("<div>").appendTo(this.uiDialogButtonPane),this._addClass(this.uiButtonSet,"ui-dialog-buttonset"),this._createButtons()},_createButtons:function(){var s=this,t=this.options.buttons;this.uiDialogButtonPane.remove(),this.uiButtonSet.empty(),V.isEmptyObject(t)||Array.isArray(t)&&!t.length?this._removeClass(this.uiDialog,"ui-dialog-buttons"):(V.each(t,function(t,e){var i;e=V.extend({type:"button"},e="function"==typeof e?
{click:e,text:t}:e),i=e.click,t={icon:e.icon,iconPosition:e.iconPosition,showLabel:e.showLabel,icons:e.icons,text:e.text},delete e.click,delete e.icon,delete e.iconPosition,delete e.showLabel,delete e.icons,"boolean"==typeof e.text&&delete e.text,V("<button></button>",e).button(t).appendTo(s.uiButtonSet).on("click",function(){i.apply(s.element[0],arguments)})}),this._addClass(this.uiDialog,"ui-dialog-buttons"),this.uiDialogButtonPane.appendTo(this.uiDialog))},_makeDraggable:function(){var n=this,
o=this.options;function a(t){return{position:t.position,offset:t.offset}}this.uiDialog.draggable({cancel:".ui-dialog-content, .ui-dialog-titlebar-close",handle:".ui-dialog-titlebar",containment:"document",start:function(t,e){n._addClass(V(this),"ui-dialog-dragging"),n._blockFrames(),n._trigger("dragStart",t,a(e))},drag:function(t,e){n._trigger("drag",t,a(e))},stop:function(t,e){var i=e.offset.left-n.document.scrollLeft(),s=e.offset.top-n.document.scrollTop();o.position={my:"left top",at:"left"+(0<=
i?"+":"")+i+" top"+(0<=s?"+":"")+s,of:n.window},n._removeClass(V(this),"ui-dialog-dragging"),n._unblockFrames(),n._trigger("dragStop",t,a(e))}})},_makeResizable:function(){var n=this,o=this.options,t=o.resizable,e=this.uiDialog.css("position"),t="string"==typeof t?t:"n,e,s,w,se,sw,ne,nw";function a(t){return{originalPosition:t.originalPosition,originalSize:t.originalSize,position:t.position,size:t.size}}this.uiDialog.resizable({cancel:".ui-dialog-content",containment:"document",alsoResize:this.element,
maxWidth:o.maxWidth,maxHeight:o.maxHeight,minWidth:o.minWidth,minHeight:this._minHeight(),handles:t,start:function(t,e){n._addClass(V(this),"ui-dialog-resizing"),n._blockFrames(),n._trigger("resizeStart",t,a(e))},resize:function(t,e){n._trigger("resize",t,a(e))},stop:function(t,e){var i=n.uiDialog.offset(),s=i.left-n.document.scrollLeft(),i=i.top-n.document.scrollTop();o.height=n.uiDialog.height(),o.width=n.uiDialog.width(),o.position={my:"left top",at:"left"+(0<=s?"+":"")+s+" top"+(0<=i?"+":"")+
i,of:n.window},n._removeClass(V(this),"ui-dialog-resizing"),n._unblockFrames(),n._trigger("resizeStop",t,a(e))}}).css("position",e)},_trackFocus:function(){this._on(this.widget(),{focusin:function(t){this._makeFocusTarget(),this._focusedElement=V(t.target)}})},_makeFocusTarget:function(){this._untrackInstance(),this._trackingInstances().unshift(this)},_untrackInstance:function(){var t=this._trackingInstances(),e=V.inArray(this,t);-1!==e&&t.splice(e,1)},_trackingInstances:function(){var t=this.document.data("ui-dialog-instances");
return t||this.document.data("ui-dialog-instances",t=[]),t},_minHeight:function(){var t=this.options;return"auto"===t.height?t.minHeight:Math.min(t.minHeight,t.height)},_position:function(){var t=this.uiDialog.is(":visible");t||this.uiDialog.show(),this.uiDialog.position(this.options.position),t||this.uiDialog.hide()},_setOptions:function(t){var i=this,s=!1,n={};V.each(t,function(t,e){i._setOption(t,e),t in i.sizeRelatedOptions&&(s=!0),t in i.resizableRelatedOptions&&(n[t]=e)}),s&&(this._size(),this._position()),
this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option",n)},_setOption:function(t,e){var i,s=this.uiDialog;"disabled"!==t&&(this._super(t,e),"appendTo"===t&&this.uiDialog.appendTo(this._appendTo()),"buttons"===t&&this._createButtons(),"closeText"===t&&this.uiDialogTitlebarClose.button({label:V("<a>").text(""+this.options.closeText).html()}),"draggable"===t&&((i=s.is(":data(ui-draggable)"))&&!e&&s.draggable("destroy"),!i)&&e&&this._makeDraggable(),"position"===t&&this._position(),
"resizable"===t&&((i=s.is(":data(ui-resizable)"))&&!e&&s.resizable("destroy"),i&&"string"==typeof e&&s.resizable("option","handles",e),i||!1===e||this._makeResizable()),"title"===t)&&this._title(this.uiDialogTitlebar.find(".ui-dialog-title"))},_size:function(){var t,e,i,s=this.options;this.element.show().css({width:"auto",minHeight:0,maxHeight:"none",height:0}),s.minWidth>s.width&&(s.width=s.minWidth),t=this.uiDialog.css({height:"auto",width:s.width}).outerHeight(),e=Math.max(0,s.minHeight-t),i="number"==
typeof s.maxHeight?Math.max(0,s.maxHeight-t):"none","auto"===s.height?this.element.css({minHeight:e,maxHeight:i,height:"auto"}):this.element.height(Math.max(0,s.height-t)),this.uiDialog.is(":data(ui-resizable)")&&this.uiDialog.resizable("option","minHeight",this._minHeight())},_blockFrames:function(){this.iframeBlocks=this.document.find("iframe").map(function(){var t=V(this);return V("<div>").css({position:"absolute",width:t.outerWidth(),height:t.outerHeight()}).appendTo(t.parent()).offset(t.offset())[0]})},
_unblockFrames:function(){this.iframeBlocks&&(this.iframeBlocks.remove(),delete this.iframeBlocks)},_allowInteraction:function(t){return!!V(t.target).closest(".ui-dialog").length||!!V(t.target).closest(".ui-datepicker").length},_createOverlay:function(){var i,s;this.options.modal&&(i=V.fn.jquery.substring(0,4),s=!0,this._delay(function(){s=!1}),this.document.data("ui-dialog-overlays")||this.document.on("focusin.ui-dialog",function(t){var e;s||(e=this._trackingInstances()[0])._allowInteraction(t)||
(t.preventDefault(),e._focusTabbable(),"3.4."!==i&&"3.5."!==i&&"3.6."!==i)||e._delay(e._restoreTabbableFocus)}.bind(this)),this.overlay=V("<div>").appendTo(this._appendTo()),this._addClass(this.overlay,null,"ui-widget-overlay ui-front"),this._on(this.overlay,{mousedown:"_keepFocus"}),this.document.data("ui-dialog-overlays",(this.document.data("ui-dialog-overlays")||0)+1))},_destroyOverlay:function(){var t;this.options.modal&&this.overlay&&((t=this.document.data("ui-dialog-overlays")-1)?this.document.data("ui-dialog-overlays",
t):(this.document.off("focusin.ui-dialog"),this.document.removeData("ui-dialog-overlays")),this.overlay.remove(),this.overlay=null)}}),!1!==V.uiBackCompat&&V.widget("ui.dialog",V.ui.dialog,{options:{dialogClass:""},_createWrapper:function(){this._super(),this.uiDialog.addClass(this.options.dialogClass)},_setOption:function(t,e){"dialogClass"===t&&this.uiDialog.removeClass(this.options.dialogClass).addClass(e),this._superApply(arguments)}}),V.ui.dialog;function ct(t,e,i){return e<=t&&t<e+i}V.widget("ui.droppable",
{version:"1.13.3",widgetEventPrefix:"drop",options:{accept:"*",addClasses:!0,greedy:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var t,e=this.options,i=e.accept;this.isover=!1,this.isout=!0,this.accept="function"==typeof i?i:function(t){return t.is(i)},this.proportions=function(){if(!arguments.length)return t=t||{width:this.element[0].offsetWidth,height:this.element[0].offsetHeight};t=arguments[0]},this._addToManager(e.scope),
e.addClasses&&this._addClass("ui-droppable")},_addToManager:function(t){V.ui.ddmanager.droppables[t]=V.ui.ddmanager.droppables[t]||[],V.ui.ddmanager.droppables[t].push(this)},_splice:function(t){for(var e=0;e<t.length;e++)t[e]===this&&t.splice(e,1)},_destroy:function(){var t=V.ui.ddmanager.droppables[this.options.scope];this._splice(t)},_setOption:function(t,e){var i;"accept"===t?this.accept="function"==typeof e?e:function(t){return t.is(e)}:"scope"===t&&(i=V.ui.ddmanager.droppables[this.options.scope],
this._splice(i),this._addToManager(e)),this._super(t,e)},_activate:function(t){var e=V.ui.ddmanager.current;this._addActiveClass(),e&&this._trigger("activate",t,this.ui(e))},_deactivate:function(t){var e=V.ui.ddmanager.current;this._removeActiveClass(),e&&this._trigger("deactivate",t,this.ui(e))},_over:function(t){var e=V.ui.ddmanager.current;e&&(e.currentItem||e.element)[0]!==this.element[0]&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this._addHoverClass(),this._trigger("over",
t,this.ui(e)))},_out:function(t){var e=V.ui.ddmanager.current;e&&(e.currentItem||e.element)[0]!==this.element[0]&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this._removeHoverClass(),this._trigger("out",t,this.ui(e)))},_drop:function(e,t){var i=t||V.ui.ddmanager.current,s=!1;return!(!i||(i.currentItem||i.element)[0]===this.element[0]||(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var t=V(this).droppable("instance");if(t.options.greedy&&!t.options.disabled&&
t.options.scope===i.options.scope&&t.accept.call(t.element[0],i.currentItem||i.element)&&V.ui.intersect(i,V.extend(t,{offset:t.element.offset()}),t.options.tolerance,e))return!(s=!0)}),s)||!this.accept.call(this.element[0],i.currentItem||i.element))&&(this._removeActiveClass(),this._removeHoverClass(),this._trigger("drop",e,this.ui(i)),this.element)},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}},_addHoverClass:function(){this._addClass("ui-droppable-hover")},
_removeHoverClass:function(){this._removeClass("ui-droppable-hover")},_addActiveClass:function(){this._addClass("ui-droppable-active")},_removeActiveClass:function(){this._removeClass("ui-droppable-active")}}),V.ui.intersect=function(t,e,i,s){if(!e.offset)return!1;var n=(t.positionAbs||t.position.absolute).left+t.margins.left,o=(t.positionAbs||t.position.absolute).top+t.margins.top,a=n+t.helperProportions.width,r=o+t.helperProportions.height,l=e.offset.left,h=e.offset.top,c=l+e.proportions().width,
u=h+e.proportions().height;switch(i){case "fit":return l<=n&&a<=c&&h<=o&&r<=u;case "intersect":return l<n+t.helperProportions.width/2&&a-t.helperProportions.width/2<c&&h<o+t.helperProportions.height/2&&r-t.helperProportions.height/2<u;case "pointer":return ct(s.pageY,h,e.proportions().height)&&ct(s.pageX,l,e.proportions().width);case "touch":return(h<=o&&o<=u||h<=r&&r<=u||o<h&&u<r)&&(l<=n&&n<=c||l<=a&&a<=c||n<l&&c<a);default:return!1}},!(V.ui.ddmanager={current:null,droppables:{default:[]},prepareOffsets:function(t,
e){var i,s,n=V.ui.ddmanager.droppables[t.options.scope]||[],o=e?e.type:null,a=(t.currentItem||t.element).find(":data(ui-droppable)").addBack();t:for(i=0;i<n.length;i++)if(!(n[i].options.disabled||t&&!n[i].accept.call(n[i].element[0],t.currentItem||t.element))){for(s=0;s<a.length;s++)if(a[s]===n[i].element[0]){n[i].proportions().height=0;continue t}n[i].visible="none"!==n[i].element.css("display"),n[i].visible&&("mousedown"===o&&n[i]._activate.call(n[i],e),n[i].offset=n[i].element.offset(),n[i].proportions({width:n[i].element[0].offsetWidth,
height:n[i].element[0].offsetHeight}))}},drop:function(t,e){var i=!1;return V.each((V.ui.ddmanager.droppables[t.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&V.ui.intersect(t,this,this.options.tolerance,e)&&(i=this._drop.call(this,e)||i),!this.options.disabled)&&this.visible&&this.accept.call(this.element[0],t.currentItem||t.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,e))}),i},dragStart:function(t,e){t.element.parentsUntil("body").on("scroll.droppable",
function(){t.options.refreshPositions||V.ui.ddmanager.prepareOffsets(t,e)})},drag:function(n,o){n.options.refreshPositions&&V.ui.ddmanager.prepareOffsets(n,o),V.each(V.ui.ddmanager.droppables[n.options.scope]||[],function(){var t,e,i,s;this.options.disabled||this.greedyChild||!this.visible||(s=!(s=V.ui.intersect(n,this,this.options.tolerance,o))&&this.isover?"isout":s&&!this.isover?"isover":null)&&(this.options.greedy&&(e=this.options.scope,(i=this.element.parents(":data(ui-droppable)").filter(function(){return V(this).droppable("instance").options.scope===
e})).length)&&((t=V(i[0]).droppable("instance")).greedyChild="isover"===s),t&&"isover"===s&&(t.isover=!1,t.isout=!0,t._out.call(t,o)),this[s]=!0,this["isout"===s?"isover":"isout"]=!1,this["isover"===s?"_over":"_out"].call(this,o),t)&&"isout"===s&&(t.isout=!1,t.isover=!0,t._over.call(t,o))})},dragStop:function(t,e){t.element.parentsUntil("body").off("scroll.droppable"),t.options.refreshPositions||V.ui.ddmanager.prepareOffsets(t,e)}})!==V.uiBackCompat&&V.widget("ui.droppable",V.ui.droppable,{options:{hoverClass:!1,
activeClass:!1},_addActiveClass:function(){this._super(),this.options.activeClass&&this.element.addClass(this.options.activeClass)},_removeActiveClass:function(){this._super(),this.options.activeClass&&this.element.removeClass(this.options.activeClass)},_addHoverClass:function(){this._super(),this.options.hoverClass&&this.element.addClass(this.options.hoverClass)},_removeHoverClass:function(){this._super(),this.options.hoverClass&&this.element.removeClass(this.options.hoverClass)}});V.ui.droppable,
V.widget("ui.progressbar",{version:"1.13.3",options:{classes:{"ui-progressbar":"ui-corner-all","ui-progressbar-value":"ui-corner-left","ui-progressbar-complete":"ui-corner-right"},max:100,value:0,change:null,complete:null},min:0,_create:function(){this.oldValue=this.options.value=this._constrainedValue(),this.element.attr({role:"progressbar","aria-valuemin":this.min}),this._addClass("ui-progressbar","ui-widget ui-widget-content"),this.valueDiv=V("<div>").appendTo(this.element),this._addClass(this.valueDiv,
"ui-progressbar-value","ui-widget-header"),this._refreshValue()},_destroy:function(){this.element.removeAttr("role aria-valuemin aria-valuemax aria-valuenow"),this.valueDiv.remove()},value:function(t){if(void 0===t)return this.options.value;this.options.value=this._constrainedValue(t),this._refreshValue()},_constrainedValue:function(t){return void 0===t&&(t=this.options.value),this.indeterminate=!1===t,"number"!=typeof t&&(t=0),!this.indeterminate&&Math.min(this.options.max,Math.max(this.min,t))},
_setOptions:function(t){var e=t.value;delete t.value,this._super(t),this.options.value=this._constrainedValue(e),this._refreshValue()},_setOption:function(t,e){"max"===t&&(e=Math.max(this.min,e)),this._super(t,e)},_setOptionDisabled:function(t){this._super(t),this.element.attr("aria-disabled",t),this._toggleClass(null,"ui-state-disabled",!!t)},_percentage:function(){return this.indeterminate?100:100*(this.options.value-this.min)/(this.options.max-this.min)},_refreshValue:function(){var t=this.options.value,
e=this._percentage();this.valueDiv.toggle(this.indeterminate||t>this.min).width(e.toFixed(0)+"%"),this._toggleClass(this.valueDiv,"ui-progressbar-complete",null,t===this.options.max)._toggleClass("ui-progressbar-indeterminate",null,this.indeterminate),this.indeterminate?(this.element.removeAttr("aria-valuenow"),this.overlayDiv||(this.overlayDiv=V("<div>").appendTo(this.valueDiv),this._addClass(this.overlayDiv,"ui-progressbar-overlay"))):(this.element.attr({"aria-valuemax":this.options.max,"aria-valuenow":t}),
this.overlayDiv&&(this.overlayDiv.remove(),this.overlayDiv=null)),this.oldValue!==t&&(this.oldValue=t,this._trigger("change")),t===this.options.max&&this._trigger("complete")}}),V.widget("ui.selectable",V.ui.mouse,{version:"1.13.3",options:{appendTo:"body",autoRefresh:!0,distance:0,filter:"*",tolerance:"touch",selected:null,selecting:null,start:null,stop:null,unselected:null,unselecting:null},_create:function(){var i=this;this._addClass("ui-selectable"),this.dragged=!1,this.refresh=function(){i.elementPos=
V(i.element[0]).offset(),i.selectees=V(i.options.filter,i.element[0]),i._addClass(i.selectees,"ui-selectee"),i.selectees.each(function(){var t=V(this),e=t.offset(),e={left:e.left-i.elementPos.left,top:e.top-i.elementPos.top};V.data(this,"selectable-item",{element:this,$element:t,left:e.left,top:e.top,right:e.left+t.outerWidth(),bottom:e.top+t.outerHeight(),startselected:!1,selected:t.hasClass("ui-selected"),selecting:t.hasClass("ui-selecting"),unselecting:t.hasClass("ui-unselecting")})})},this.refresh(),
this._mouseInit(),this.helper=V("<div>"),this._addClass(this.helper,"ui-selectable-helper")},_destroy:function(){this.selectees.removeData("selectable-item"),this._mouseDestroy()},_mouseStart:function(i){var s=this,t=this.options;this.opos=[i.pageX,i.pageY],this.elementPos=V(this.element[0]).offset(),this.options.disabled||(this.selectees=V(t.filter,this.element[0]),this._trigger("start",i),V(t.appendTo).append(this.helper),this.helper.css({left:i.pageX,top:i.pageY,width:0,height:0}),t.autoRefresh&&
this.refresh(),this.selectees.filter(".ui-selected").each(function(){var t=V.data(this,"selectable-item");t.startselected=!0,i.metaKey||i.ctrlKey||(s._removeClass(t.$element,"ui-selected"),t.selected=!1,s._addClass(t.$element,"ui-unselecting"),t.unselecting=!0,s._trigger("unselecting",i,{unselecting:t.element}))}),V(i.target).parents().addBack().each(function(){var t,e=V.data(this,"selectable-item");if(e)return t=!i.metaKey&&!i.ctrlKey||!e.$element.hasClass("ui-selected"),s._removeClass(e.$element,
t?"ui-unselecting":"ui-selected")._addClass(e.$element,t?"ui-selecting":"ui-unselecting"),e.unselecting=!t,e.selecting=t,(e.selected=t)?s._trigger("selecting",i,{selecting:e.element}):s._trigger("unselecting",i,{unselecting:e.element}),!1}))},_mouseDrag:function(s){var t,n,o,a,r,l,h;if(this.dragged=!0,!this.options.disabled)return o=(n=this).options,a=this.opos[0],r=this.opos[1],l=s.pageX,h=s.pageY,l<a&&(t=l,l=a,a=t),h<r&&(t=h,h=r,r=t),this.helper.css({left:a,top:r,width:l-a,height:h-r}),this.selectees.each(function(){var t=
V.data(this,"selectable-item"),e=!1,i={};t&&t.element!==n.element[0]&&(i.left=t.left+n.elementPos.left,i.right=t.right+n.elementPos.left,i.top=t.top+n.elementPos.top,i.bottom=t.bottom+n.elementPos.top,"touch"===o.tolerance?e=!(l<i.left||i.right<a||h<i.top||i.bottom<r):"fit"===o.tolerance&&(e=a<i.left&&i.right<l&&r<i.top&&i.bottom<h),e?(t.selected&&(n._removeClass(t.$element,"ui-selected"),t.selected=!1),t.unselecting&&(n._removeClass(t.$element,"ui-unselecting"),t.unselecting=!1),t.selecting||(n._addClass(t.$element,
"ui-selecting"),t.selecting=!0,n._trigger("selecting",s,{selecting:t.element}))):(t.selecting&&((s.metaKey||s.ctrlKey)&&t.startselected?(n._removeClass(t.$element,"ui-selecting"),t.selecting=!1,n._addClass(t.$element,"ui-selected"),t.selected=!0):(n._removeClass(t.$element,"ui-selecting"),t.selecting=!1,t.startselected&&(n._addClass(t.$element,"ui-unselecting"),t.unselecting=!0),n._trigger("unselecting",s,{unselecting:t.element}))),!t.selected||s.metaKey||s.ctrlKey||t.startselected||(n._removeClass(t.$element,
"ui-selected"),t.selected=!1,n._addClass(t.$element,"ui-unselecting"),t.unselecting=!0,n._trigger("unselecting",s,{unselecting:t.element}))))}),!1},_mouseStop:function(e){var i=this;return this.dragged=!1,V(".ui-unselecting",this.element[0]).each(function(){var t=V.data(this,"selectable-item");i._removeClass(t.$element,"ui-unselecting"),t.unselecting=!1,t.startselected=!1,i._trigger("unselected",e,{unselected:t.element})}),V(".ui-selecting",this.element[0]).each(function(){var t=V.data(this,"selectable-item");
i._removeClass(t.$element,"ui-selecting")._addClass(t.$element,"ui-selected"),t.selecting=!1,t.selected=!0,t.startselected=!0,i._trigger("selected",e,{selected:t.element})}),this._trigger("stop",e),this.helper.remove(),!1}}),V.widget("ui.selectmenu",[V.ui.formResetMixin,{version:"1.13.3",defaultElement:"<select>",options:{appendTo:null,classes:{"ui-selectmenu-button-open":"ui-corner-top","ui-selectmenu-button-closed":"ui-corner-all"},disabled:null,icons:{button:"ui-icon-triangle-1-s"},position:{my:"left top",
at:"left bottom",collision:"none"},width:!1,change:null,close:null,focus:null,open:null,select:null},_create:function(){var t=this.element.uniqueId().attr("id");this.ids={element:t,button:t+"-button",menu:t+"-menu"},this._drawButton(),this._drawMenu(),this._bindFormResetHandler(),this._rendered=!1,this.menuItems=V()},_drawButton:function(){var t,e=this,i=this._parseOption(this.element.find("option:selected"),this.element[0].selectedIndex);this.labels=this.element.labels().attr("for",this.ids.button),
this._on(this.labels,{click:function(t){this.button.trigger("focus"),t.preventDefault()}}),this.element.hide(),this.button=V("<span>",{tabindex:this.options.disabled?-1:0,id:this.ids.button,role:"combobox","aria-expanded":"false","aria-autocomplete":"list","aria-owns":this.ids.menu,"aria-haspopup":"true",title:this.element.attr("title")}).insertAfter(this.element),this._addClass(this.button,"ui-selectmenu-button ui-selectmenu-button-closed","ui-button ui-widget"),t=V("<span>").appendTo(this.button),
this._addClass(t,"ui-selectmenu-icon","ui-icon "+this.options.icons.button),this.buttonItem=this._renderButtonItem(i).appendTo(this.button),!1!==this.options.width&&this._resizeButton(),this._on(this.button,this._buttonEvents),this.button.one("focusin",function(){e._rendered||e._refreshMenu()})},_drawMenu:function(){var i=this;this.menu=V("<ul>",{"aria-hidden":"true","aria-labelledby":this.ids.button,id:this.ids.menu}),this.menuWrap=V("<div>").append(this.menu),this._addClass(this.menuWrap,"ui-selectmenu-menu",
"ui-front"),this.menuWrap.appendTo(this._appendTo()),this.menuInstance=this.menu.menu({classes:{"ui-menu":"ui-corner-bottom"},role:"listbox",select:function(t,e){t.preventDefault(),i._setSelection(),i._select(e.item.data("ui-selectmenu-item"),t)},focus:function(t,e){e=e.item.data("ui-selectmenu-item");null!=i.focusIndex&&e.index!==i.focusIndex&&(i._trigger("focus",t,{item:e}),i.isOpen||i._select(e,t)),i.focusIndex=e.index,i.button.attr("aria-activedescendant",i.menuItems.eq(e.index).attr("id"))}}).menu("instance"),
this.menuInstance._off(this.menu,"mouseleave"),this.menuInstance._closeOnDocumentClick=function(){return!1},this.menuInstance._isDivider=function(){return!1}},refresh:function(){this._refreshMenu(),this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(this._getSelectedItem().data("ui-selectmenu-item")||{})),null===this.options.width&&this._resizeButton()},_refreshMenu:function(){var t=this.element.find("option");this.menu.empty(),this._parseOptions(t),this._renderMenu(this.menu,this.items),
this.menuInstance.refresh(),this.menuItems=this.menu.find("li").not(".ui-selectmenu-optgroup").find(".ui-menu-item-wrapper"),this._rendered=!0,t.length&&(t=this._getSelectedItem(),this.menuInstance.focus(null,t),this._setAria(t.data("ui-selectmenu-item")),this._setOption("disabled",this.element.prop("disabled")))},open:function(t){this.options.disabled||(this._rendered?(this._removeClass(this.menu.find(".ui-state-active"),null,"ui-state-active"),this.menuInstance.focus(null,this._getSelectedItem())):
this._refreshMenu(),this.menuItems.length&&(this.isOpen=!0,this._toggleAttr(),this._resizeMenu(),this._position(),this._on(this.document,this._documentClick),this._trigger("open",t)))},_position:function(){this.menuWrap.position(V.extend({of:this.button},this.options.position))},close:function(t){this.isOpen&&(this.isOpen=!1,this._toggleAttr(),this.range=null,this._off(this.document),this._trigger("close",t))},widget:function(){return this.button},menuWidget:function(){return this.menu},_renderButtonItem:function(t){var e=
V("<span>");return this._setText(e,t.label),this._addClass(e,"ui-selectmenu-text"),e},_renderMenu:function(s,t){var n=this,o="";V.each(t,function(t,e){var i;e.optgroup!==o&&(i=V("<li>",{text:e.optgroup}),n._addClass(i,"ui-selectmenu-optgroup","ui-menu-divider"+(e.element.parent("optgroup").prop("disabled")?" ui-state-disabled":"")),i.appendTo(s),o=e.optgroup),n._renderItemData(s,e)})},_renderItemData:function(t,e){return this._renderItem(t,e).data("ui-selectmenu-item",e)},_renderItem:function(t,e){var i=
V("<li>"),s=V("<div>",{title:e.element.attr("title")});return e.disabled&&this._addClass(i,null,"ui-state-disabled"),e.hidden?i.prop("hidden",!0):this._setText(s,e.label),i.append(s).appendTo(t)},_setText:function(t,e){e?t.text(e):t.html("&#160;")},_move:function(t,e){var i,s=".ui-menu-item";this.isOpen?i=this.menuItems.eq(this.focusIndex).parent("li"):(i=this.menuItems.eq(this.element[0].selectedIndex).parent("li"),s+=":not(.ui-state-disabled)"),(i="first"===t||"last"===t?i["first"===t?"prevAll":
"nextAll"](s).eq(-1):i[t+"All"](s).eq(0)).length&&this.menuInstance.focus(e,i)},_getSelectedItem:function(){return this.menuItems.eq(this.element[0].selectedIndex).parent("li")},_toggle:function(t){this[this.isOpen?"close":"open"](t)},_setSelection:function(){var t;this.range&&(window.getSelection?((t=window.getSelection()).removeAllRanges(),t.addRange(this.range)):this.range.select(),this.button.trigger("focus"))},_documentClick:{mousedown:function(t){!this.isOpen||V(t.target).closest(".ui-selectmenu-menu, #"+
V.escapeSelector(this.ids.button)).length||this.close(t)}},_buttonEvents:{mousedown:function(){var t;window.getSelection?(t=window.getSelection()).rangeCount&&(this.range=t.getRangeAt(0)):this.range=document.selection.createRange()},click:function(t){this._setSelection(),this._toggle(t)},keydown:function(t){var e=!0;switch(t.keyCode){case V.ui.keyCode.TAB:case V.ui.keyCode.ESCAPE:this.close(t),e=!1;break;case V.ui.keyCode.ENTER:this.isOpen&&this._selectFocusedItem(t);break;case V.ui.keyCode.UP:t.altKey?
this._toggle(t):this._move("prev",t);break;case V.ui.keyCode.DOWN:t.altKey?this._toggle(t):this._move("next",t);break;case V.ui.keyCode.SPACE:this.isOpen?this._selectFocusedItem(t):this._toggle(t);break;case V.ui.keyCode.LEFT:this._move("prev",t);break;case V.ui.keyCode.RIGHT:this._move("next",t);break;case V.ui.keyCode.HOME:case V.ui.keyCode.PAGE_UP:this._move("first",t);break;case V.ui.keyCode.END:case V.ui.keyCode.PAGE_DOWN:this._move("last",t);break;default:this.menu.trigger(t),e=!1}e&&t.preventDefault()}},
_selectFocusedItem:function(t){var e=this.menuItems.eq(this.focusIndex).parent("li");e.hasClass("ui-state-disabled")||this._select(e.data("ui-selectmenu-item"),t)},_select:function(t,e){var i=this.element[0].selectedIndex;this.element[0].selectedIndex=t.index,this.buttonItem.replaceWith(this.buttonItem=this._renderButtonItem(t)),this._setAria(t),this._trigger("select",e,{item:t}),t.index!==i&&this._trigger("change",e,{item:t}),this.close(e)},_setAria:function(t){t=this.menuItems.eq(t.index).attr("id");
this.button.attr({"aria-labelledby":t,"aria-activedescendant":t}),this.menu.attr("aria-activedescendant",t)},_setOption:function(t,e){var i;"icons"===t&&(i=this.button.find("span.ui-icon"),this._removeClass(i,null,this.options.icons.button)._addClass(i,null,e.button)),this._super(t,e),"appendTo"===t&&this.menuWrap.appendTo(this._appendTo()),"width"===t&&this._resizeButton()},_setOptionDisabled:function(t){this._super(t),this.menuInstance.option("disabled",t),this.button.attr("aria-disabled",t),this._toggleClass(this.button,
null,"ui-state-disabled",t),this.element.prop("disabled",t),t?(this.button.attr("tabindex",-1),this.close()):this.button.attr("tabindex",0)},_appendTo:function(){var t=this.options.appendTo;return t=(t=(t=t&&(t.jquery||t.nodeType?V(t):this.document.find(t).eq(0)))&&t[0]?t:this.element.closest(".ui-front, dialog")).length?t:this.document[0].body},_toggleAttr:function(){this.button.attr("aria-expanded",this.isOpen),this._removeClass(this.button,"ui-selectmenu-button-"+(this.isOpen?"closed":"open"))._addClass(this.button,
"ui-selectmenu-button-"+(this.isOpen?"open":"closed"))._toggleClass(this.menuWrap,"ui-selectmenu-open",null,this.isOpen),this.menu.attr("aria-hidden",!this.isOpen)},_resizeButton:function(){var t=this.options.width;!1===t?this.button.css("width",""):(null===t&&(t=this.element.show().outerWidth(),this.element.hide()),this.button.outerWidth(t))},_resizeMenu:function(){this.menu.outerWidth(Math.max(this.button.outerWidth(),this.menu.width("").outerWidth()+1))},_getCreateOptions:function(){var t=this._super();
return t.disabled=this.element.prop("disabled"),t},_parseOptions:function(t){var i=this,s=[];t.each(function(t,e){s.push(i._parseOption(V(e),t))}),this.items=s},_parseOption:function(t,e){var i=t.parent("optgroup");return{element:t,index:e,value:t.val(),label:t.text(),hidden:i.prop("hidden")||t.prop("hidden"),optgroup:i.attr("label")||"",disabled:i.prop("disabled")||t.prop("disabled")}},_destroy:function(){this._unbindFormResetHandler(),this.menuWrap.remove(),this.button.remove(),this.element.show(),
this.element.removeUniqueId(),this.labels.attr("for",this.ids.element)}}]),V.widget("ui.slider",V.ui.mouse,{version:"1.13.3",widgetEventPrefix:"slide",options:{animate:!1,classes:{"ui-slider":"ui-corner-all","ui-slider-handle":"ui-corner-all","ui-slider-range":"ui-corner-all ui-widget-header"},distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},numPages:5,_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=
!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this._calculateNewMax(),this._addClass("ui-slider ui-slider-"+this.orientation,"ui-widget ui-widget-content"),this._refresh(),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var t,e=this.options,i=this.element.find(".ui-slider-handle"),s=[],n=e.values&&e.values.length||1;for(i.length>n&&(i.slice(n).remove(),i=i.slice(0,n)),t=i.length;t<
n;t++)s.push("<span tabindex='0'></span>");this.handles=i.add(V(s.join("")).appendTo(this.element)),this._addClass(this.handles,"ui-slider-handle","ui-state-default"),this.handle=this.handles.eq(0),this.handles.each(function(t){V(this).data("ui-slider-handle-index",t).attr("tabIndex",0)})},_createRange:function(){var t=this.options;t.range?(!0===t.range&&(t.values?t.values.length&&2!==t.values.length?t.values=[t.values[0],t.values[0]]:Array.isArray(t.values)&&(t.values=t.values.slice(0)):t.values=
[this._valueMin(),this._valueMin()]),this.range&&this.range.length?(this._removeClass(this.range,"ui-slider-range-min ui-slider-range-max"),this.range.css({left:"",bottom:""})):(this.range=V("<div>").appendTo(this.element),this._addClass(this.range,"ui-slider-range")),"min"!==t.range&&"max"!==t.range||this._addClass(this.range,"ui-slider-range-"+t.range)):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){this._off(this.handles),this._on(this.handles,this._handleEvents),this._hoverable(this.handles),
this._focusable(this.handles)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this._mouseDestroy()},_mouseCapture:function(t){var i,s,n,o,e,a,r=this,l=this.options;return!l.disabled&&(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),e={x:t.pageX,y:t.pageY},i=this._normValueFromMouse(e),s=this._valueMax()-this._valueMin()+1,this.handles.each(function(t){var e=Math.abs(i-r.values(t));(e<s||s===e&&
(t===r._lastChangedValue||r.values(t)===l.min))&&(s=e,n=V(this),o=t)}),!1!==this._start(t,o))&&(this._mouseSliding=!0,this._handleIndex=o,this._addClass(n,null,"ui-state-active"),n.trigger("focus"),e=n.offset(),a=!V(t.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=a?{left:0,top:0}:{left:t.pageX-e.left-n.width()/2,top:t.pageY-e.top-n.height()/2-(parseInt(n.css("borderTopWidth"),10)||0)-(parseInt(n.css("borderBottomWidth"),10)||0)+(parseInt(n.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||
this._slide(t,o,i),this._animateOff=!0)},_mouseStart:function(){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},e=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,e),!1},_mouseStop:function(t){return this._removeClass(this.handles,null,"ui-state-active"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1},_detectOrientation:function(){this.orientation="vertical"===
this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(t){var e,t="horizontal"===this.orientation?(e=this.elementSize.width,t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),t=t/e;return(t=1<t?1:t)<0&&(t=0),"vertical"===this.orientation&&(t=1-t),e=this._valueMax()-this._valueMin(),t=this._valueMin()+t*e,this._trimAlignValue(t)},_uiHash:function(t,e,i){var s=
{handle:this.handles[t],handleIndex:t,value:void 0!==e?e:this.value()};return this._hasMultipleValues()&&(s.value=void 0!==e?e:this.values(t),s.values=i||this.values()),s},_hasMultipleValues:function(){return this.options.values&&this.options.values.length},_start:function(t,e){return this._trigger("start",t,this._uiHash(e))},_slide:function(t,e,i){var s,n=this.value(),o=this.values();this._hasMultipleValues()&&(s=this.values(e?0:1),n=this.values(e),2===this.options.values.length&&!0===this.options.range&&
(i=0===e?Math.min(s,i):Math.max(s,i)),o[e]=i),i!==n&&!1!==this._trigger("slide",t,this._uiHash(e,i,o))&&(this._hasMultipleValues()?this.values(e,i):this.value(i))},_stop:function(t,e){this._trigger("stop",t,this._uiHash(e))},_change:function(t,e){this._keySliding||this._mouseSliding||(this._lastChangedValue=e,this._trigger("change",t,this._uiHash(e)))},value:function(t){if(!arguments.length)return this._value();this.options.value=this._trimAlignValue(t),this._refreshValue(),this._change(null,0)},
values:function(t,e){var i,s,n;if(1<arguments.length)this.options.values[t]=this._trimAlignValue(e),this._refreshValue(),this._change(null,t);else{if(!arguments.length)return this._values();if(!Array.isArray(t))return this._hasMultipleValues()?this._values(t):this.value();for(i=this.options.values,s=t,n=0;n<i.length;n+=1)i[n]=this._trimAlignValue(s[n]),this._change(null,n);this._refreshValue()}},_setOption:function(t,e){var i,s=0;switch("range"===t&&!0===this.options.range&&("min"===e?(this.options.value=
this._values(0),this.options.values=null):"max"===e&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),Array.isArray(this.options.values)&&(s=this.options.values.length),this._super(t,e),t){case "orientation":this._detectOrientation(),this._removeClass("ui-slider-horizontal ui-slider-vertical")._addClass("ui-slider-"+this.orientation),this._refreshValue(),this.options.range&&this._refreshRange(e),this.handles.css("horizontal"===e?"bottom":"left","");break;case "value":this._animateOff=
!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case "values":for(this._animateOff=!0,this._refreshValue(),i=s-1;0<=i;i--)this._change(null,i);this._animateOff=!1;break;case "step":case "min":case "max":this._animateOff=!0,this._calculateNewMax(),this._refreshValue(),this._animateOff=!1;break;case "range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_setOptionDisabled:function(t){this._super(t),this._toggleClass(null,"ui-state-disabled",!!t)},_value:function(){var t=
this.options.value;return this._trimAlignValue(t)},_values:function(t){var e,i;if(arguments.length)return t=this.options.values[t],this._trimAlignValue(t);if(this._hasMultipleValues()){for(e=this.options.values.slice(),i=0;i<e.length;i+=1)e[i]=this._trimAlignValue(e[i]);return e}return[]},_trimAlignValue:function(t){var e,i;return t<=this._valueMin()?this._valueMin():t>=this._valueMax()?this._valueMax():(e=0<this.options.step?this.options.step:1,i=t-(t=(t-this._valueMin())%e),2*Math.abs(t)>=e&&(i+=
0<t?e:-e),parseFloat(i.toFixed(5)))},_calculateNewMax:function(){var t=this.options.max,e=this._valueMin(),i=this.options.step;(t=Math.round((t-e)/i)*i+e)>this.options.max&&(t-=i),this.max=parseFloat(t.toFixed(this._precision()))},_precision:function(){var t=this._precisionOf(this.options.step);return t=null!==this.options.min?Math.max(t,this._precisionOf(this.options.min)):t},_precisionOf:function(t){var t=t.toString(),e=t.indexOf(".");return-1===e?0:t.length-e-1},_valueMin:function(){return this.options.min},
_valueMax:function(){return this.max},_refreshRange:function(t){"vertical"===t&&this.range.css({width:"",left:""}),"horizontal"===t&&this.range.css({height:"",bottom:""})},_refreshValue:function(){var e,i,t,s,n,o=this.options.range,a=this.options,r=this,l=!this._animateOff&&a.animate,h={};this._hasMultipleValues()?this.handles.each(function(t){i=(r.values(t)-r._valueMin())/(r._valueMax()-r._valueMin())*100,h["horizontal"===r.orientation?"left":"bottom"]=i+"%",V(this).stop(1,1)[l?"animate":"css"](h,
a.animate),!0===r.options.range&&("horizontal"===r.orientation?(0===t&&r.range.stop(1,1)[l?"animate":"css"]({left:i+"%"},a.animate),1===t&&r.range[l?"animate":"css"]({width:i-e+"%"},{queue:!1,duration:a.animate})):(0===t&&r.range.stop(1,1)[l?"animate":"css"]({bottom:i+"%"},a.animate),1===t&&r.range[l?"animate":"css"]({height:i-e+"%"},{queue:!1,duration:a.animate}))),e=i}):(t=this.value(),s=this._valueMin(),n=this._valueMax(),i=n!==s?(t-s)/(n-s)*100:0,h["horizontal"===this.orientation?"left":"bottom"]=
i+"%",this.handle.stop(1,1)[l?"animate":"css"](h,a.animate),"min"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:i+"%"},a.animate),"max"===o&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:100-i+"%"},a.animate),"min"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:i+"%"},a.animate),"max"===o&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:100-i+"%"},a.animate))},
_handleEvents:{keydown:function(t){var e,i,s,n=V(t.target).data("ui-slider-handle-index");switch(t.keyCode){case V.ui.keyCode.HOME:case V.ui.keyCode.END:case V.ui.keyCode.PAGE_UP:case V.ui.keyCode.PAGE_DOWN:case V.ui.keyCode.UP:case V.ui.keyCode.RIGHT:case V.ui.keyCode.DOWN:case V.ui.keyCode.LEFT:if(t.preventDefault(),this._keySliding||(this._keySliding=!0,this._addClass(V(t.target),null,"ui-state-active"),!1!==this._start(t,n)))break;return}switch(s=this.options.step,e=i=this._hasMultipleValues()?
this.values(n):this.value(),t.keyCode){case V.ui.keyCode.HOME:i=this._valueMin();break;case V.ui.keyCode.END:i=this._valueMax();break;case V.ui.keyCode.PAGE_UP:i=this._trimAlignValue(e+(this._valueMax()-this._valueMin())/this.numPages);break;case V.ui.keyCode.PAGE_DOWN:i=this._trimAlignValue(e-(this._valueMax()-this._valueMin())/this.numPages);break;case V.ui.keyCode.UP:case V.ui.keyCode.RIGHT:if(e===this._valueMax())return;i=this._trimAlignValue(e+s);break;case V.ui.keyCode.DOWN:case V.ui.keyCode.LEFT:if(e===
this._valueMin())return;i=this._trimAlignValue(e-s)}this._slide(t,n,i)},keyup:function(t){var e=V(t.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(t,e),this._change(t,e),this._removeClass(V(t.target),null,"ui-state-active"))}}}),V.widget("ui.sortable",V.ui.mouse,{version:"1.13.3",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,
grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1E3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_isOverAxis:function(t,e,i){return e<=t&&t<e+i},_isFloating:function(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))},_create:function(){this.containerCache=
{},this._addClass("ui-sortable"),this.refresh(),this.offset=this.element.offset(),this._mouseInit(),this._setHandleClassName(),this.ready=!0},_setOption:function(t,e){this._super(t,e),"handle"===t&&this._setHandleClassName()},_setHandleClassName:function(){var t=this;this._removeClass(this.element.find(".ui-sortable-handle"),"ui-sortable-handle"),V.each(this.items,function(){t._addClass(this.instance.options.handle?this.item.find(this.instance.options.handle):this.item,"ui-sortable-handle")})},_destroy:function(){this._mouseDestroy();
for(var t=this.items.length-1;0<=t;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_mouseCapture:function(t,e){var i=null,s=!1,n=this;return!(this.reverting||this.options.disabled||"static"===this.options.type||(this._refreshItems(t),V(t.target).parents().each(function(){if(V.data(this,n.widgetName+"-item")===n)return i=V(this),!1}),!(i=V.data(t.target,n.widgetName+"-item")===n?V(t.target):i))||(this.options.handle&&!e&&(V(this.options.handle,i).find("*").addBack().each(function(){this===
t.target&&(s=!0)}),!s)||(this.currentItem=i,this._removeCurrentsFromItems(),0)))},_mouseStart:function(t,e,i){var s,n,o=this.options;if((this.currentContainer=this).refreshPositions(),this.appendTo=V("parent"!==o.appendTo?o.appendTo:this.currentItem.parent()),this.helper=this._createHelper(t),this._cacheHelperProportions(),this._cacheMargins(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},V.extend(this.offset,{click:{left:t.pageX-
this.offset.left,top:t.pageY-this.offset.top},relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),o.cursorAt&&this._adjustOffsetFromHelper(o.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),this.scrollParent=this.placeholder.scrollParent(),V.extend(this.offset,{parent:this._getParentOffset()}),o.containment&&
this._setContainment(),o.cursor&&"auto"!==o.cursor&&(n=this.document.find("body"),this.storedCursor=n.css("cursor"),n.css("cursor",o.cursor),this.storedStylesheet=V("<style>*{ cursor: "+o.cursor+" !important; }</style>").appendTo(n)),o.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",o.zIndex)),o.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",o.opacity)),this.scrollParent[0]!==
this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",t,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!i)for(s=this.containers.length-1;0<=s;s--)this.containers[s]._trigger("activate",t,this._uiHash(this));return V.ui.ddmanager&&(V.ui.ddmanager.current=this),V.ui.ddmanager&&!o.dropBehaviour&&V.ui.ddmanager.prepareOffsets(this,t),this.dragging=!0,this._addClass(this.helper,"ui-sortable-helper"),
this.helper.parent().is(this.appendTo)||(this.helper.detach().appendTo(this.appendTo),this.offset.parent=this._getParentOffset()),this.position=this.originalPosition=this._generatePosition(t),this.originalPageX=t.pageX,this.originalPageY=t.pageY,this.lastPositionAbs=this.positionAbs=this._convertPositionTo("absolute"),this._mouseDrag(t),!0},_scroll:function(t){var e=this.options,i=!1;return this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-
t.pageY<e.scrollSensitivity?this.scrollParent[0].scrollTop=i=this.scrollParent[0].scrollTop+e.scrollSpeed:t.pageY-this.overflowOffset.top<e.scrollSensitivity&&(this.scrollParent[0].scrollTop=i=this.scrollParent[0].scrollTop-e.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-t.pageX<e.scrollSensitivity?this.scrollParent[0].scrollLeft=i=this.scrollParent[0].scrollLeft+e.scrollSpeed:t.pageX-this.overflowOffset.left<e.scrollSensitivity&&(this.scrollParent[0].scrollLeft=i=this.scrollParent[0].scrollLeft-
e.scrollSpeed)):(t.pageY-this.document.scrollTop()<e.scrollSensitivity?i=this.document.scrollTop(this.document.scrollTop()-e.scrollSpeed):this.window.height()-(t.pageY-this.document.scrollTop())<e.scrollSensitivity&&(i=this.document.scrollTop(this.document.scrollTop()+e.scrollSpeed)),t.pageX-this.document.scrollLeft()<e.scrollSensitivity?i=this.document.scrollLeft(this.document.scrollLeft()-e.scrollSpeed):this.window.width()-(t.pageX-this.document.scrollLeft())<e.scrollSensitivity&&(i=this.document.scrollLeft(this.document.scrollLeft()+
e.scrollSpeed))),i},_mouseDrag:function(t){var e,i,s,n,o=this.options;for(this.position=this._generatePosition(t),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),o.scroll&&!1!==this._scroll(t)&&(this._refreshItemPositions(!0),V.ui.ddmanager)&&!o.dropBehaviour&&V.ui.ddmanager.prepareOffsets(this,t),this.dragDirection=
{vertical:this._getDragVerticalDirection(),horizontal:this._getDragHorizontalDirection()},e=this.items.length-1;0<=e;e--)if(s=(i=this.items[e]).item[0],(n=this._intersectsWithPointer(i))&&i.instance===this.currentContainer&&!(s===this.currentItem[0]||this.placeholder[1===n?"next":"prev"]()[0]===s||V.contains(this.placeholder[0],s)||"semi-dynamic"===this.options.type&&V.contains(this.element[0],s))){if(this.direction=1===n?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(i))break;
this._rearrange(t,i),this._trigger("change",t,this._uiHash());break}return this._contactContainers(t),V.ui.ddmanager&&V.ui.ddmanager.drag(this,t),this._trigger("sort",t,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(t,e){var i,s,n,o;if(t)return V.ui.ddmanager&&!this.options.dropBehaviour&&V.ui.ddmanager.drop(this,t),this.options.revert?(s=(i=this).placeholder.offset(),o={},(n=this.options.axis)&&"x"!==n||(o.left=s.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===
this.document[0].body?0:this.offsetParent[0].scrollLeft)),n&&"y"!==n||(o.top=s.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===this.document[0].body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,V(this.helper).animate(o,parseInt(this.options.revert,10)||500,function(){i._clear(t)})):this._clear(t,e),!1},cancel:function(){if(this.dragging){this._mouseUp(new V.Event("mouseup",{target:null})),"original"===this.options.helper?(this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,
"ui-sortable-helper")):this.currentItem.show();for(var t=this.containers.length-1;0<=t;t--)this.containers[t]._trigger("deactivate",null,this._uiHash(this)),this.containers[t].containerCache.over&&(this.containers[t]._trigger("out",null,this._uiHash(this)),this.containers[t].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),
V.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?V(this.domPosition.prev).after(this.currentItem):V(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var t=this._getItemsAsjQuery(e&&e.connected),i=[];return e=e||{},V(t).each(function(){var t=(V(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);t&&i.push((e.key||t[1]+"[]")+"="+(e.key&&e.expression?t[1]:t[2]))}),!i.length&&e.key&&i.push(e.key+"="),
i.join("&")},toArray:function(t){var e=this._getItemsAsjQuery(t&&t.connected),i=[];return t=t||{},e.each(function(){i.push(V(t.item||this).attr(t.attribute||"id")||"")}),i},_intersectsWith:function(t){var e=this.positionAbs.left,i=e+this.helperProportions.width,s=this.positionAbs.top,n=s+this.helperProportions.height,o=t.left,a=o+t.width,r=t.top,l=r+t.height,h=this.offset.click.top,c=this.offset.click.left,h="x"===this.options.axis||r<s+h&&s+h<l,c="y"===this.options.axis||o<e+c&&e+c<a;return"pointer"===
this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?h&&c:o<e+this.helperProportions.width/2&&i-this.helperProportions.width/2<a&&r<s+this.helperProportions.height/2&&n-this.helperProportions.height/2<l},_intersectsWithPointer:function(t){var e="x"===this.options.axis||this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top,t.height),t="y"===this.options.axis||
this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left,t.width);return!(!e||!t)&&(e=this.dragDirection.vertical,t=this.dragDirection.horizontal,this.floating?"right"===t||"down"===e?2:1:e&&("down"===e?2:1))},_intersectsWithSides:function(t){var e=this._isOverAxis(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),t=this._isOverAxis(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),i=this.dragDirection.vertical,s=this.dragDirection.horizontal;return this.floating&&
s?"right"===s&&t||"left"===s&&!t:i&&("down"===i&&e||"up"===i&&!e)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!=t&&(0<t?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!=t&&(0<t?"right":"left")},refresh:function(t){return this._refreshItems(t),this._setHandleClassName(),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?
[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(t){var e,i,s,n,o=[],a=[],r=this._connectWith();if(r&&t)for(e=r.length-1;0<=e;e--)for(i=(s=V(r[e],this.document[0])).length-1;0<=i;i--)(n=V.data(s[i],this.widgetFullName))&&n!==this&&!n.options.disabled&&a.push(["function"==typeof n.options.items?n.options.items.call(n.element):V(n.options.items,n.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),n]);function l(){o.push(this)}for(a.push(["function"==typeof this.options.items?
this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):V(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),e=a.length-1;0<=e;e--)a[e][0].each(l);return V(o)},_removeCurrentsFromItems:function(){var i=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=V.grep(this.items,function(t){for(var e=0;e<i.length;e++)if(i[e]===t.item[0])return!1;return!0})},_refreshItems:function(t){this.items=[],this.containers=
[this];var e,i,s,n,o,a,r,l,h=this.items,c=[["function"==typeof this.options.items?this.options.items.call(this.element[0],t,{item:this.currentItem}):V(this.options.items,this.element),this]],u=this._connectWith();if(u&&this.ready)for(e=u.length-1;0<=e;e--)for(i=(s=V(u[e],this.document[0])).length-1;0<=i;i--)(n=V.data(s[i],this.widgetFullName))&&n!==this&&!n.options.disabled&&(c.push(["function"==typeof n.options.items?n.options.items.call(n.element[0],t,{item:this.currentItem}):V(n.options.items,
n.element),n]),this.containers.push(n));for(e=c.length-1;0<=e;e--)for(o=c[e][1],l=(a=c[e][i=0]).length;i<l;i++)(r=V(a[i])).data(this.widgetName+"-item",o),h.push({item:r,instance:o,width:0,height:0,left:0,top:0})},_refreshItemPositions:function(t){for(var e,i,s=this.items.length-1;0<=s;s--)e=this.items[s],this.currentContainer&&e.instance!==this.currentContainer&&e.item[0]!==this.currentItem[0]||(i=this.options.toleranceElement?V(this.options.toleranceElement,e.item):e.item,t||(e.width=i.outerWidth(),
e.height=i.outerHeight()),i=i.offset(),e.left=i.left,e.top=i.top)},refreshPositions:function(t){var e,i;if(this.floating=!!this.items.length&&("x"===this.options.axis||this._isFloating(this.items[0].item)),this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset()),this._refreshItemPositions(t),this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(e=this.containers.length-1;0<=e;e--)i=this.containers[e].element.offset(),
this.containers[e].containerCache.left=i.left,this.containers[e].containerCache.top=i.top,this.containers[e].containerCache.width=this.containers[e].element.outerWidth(),this.containers[e].containerCache.height=this.containers[e].element.outerHeight();return this},_createPlaceholder:function(i){var s,n,o=(i=i||this).options;o.placeholder&&o.placeholder.constructor!==String||(s=o.placeholder,n=i.currentItem[0].nodeName.toLowerCase(),o.placeholder={element:function(){var t=V("<"+n+">",i.document[0]);
return i._addClass(t,"ui-sortable-placeholder",s||i.currentItem[0].className)._removeClass(t,"ui-sortable-helper"),"tbody"===n?i._createTrPlaceholder(i.currentItem.find("tr").eq(0),V("<tr>",i.document[0]).appendTo(t)):"tr"===n?i._createTrPlaceholder(i.currentItem,t):"img"===n&&t.attr("src",i.currentItem.attr("src")),s||t.css("visibility","hidden"),t},update:function(t,e){s&&!o.forcePlaceholderSize||(e.height()&&(!o.forcePlaceholderSize||"tbody"!==n&&"tr"!==n)||e.height(i.currentItem.innerHeight()-
parseInt(i.currentItem.css("paddingTop")||0,10)-parseInt(i.currentItem.css("paddingBottom")||0,10)),e.width())||e.width(i.currentItem.innerWidth()-parseInt(i.currentItem.css("paddingLeft")||0,10)-parseInt(i.currentItem.css("paddingRight")||0,10))}}),i.placeholder=V(o.placeholder.element.call(i.element,i.currentItem)),i.currentItem.after(i.placeholder),o.placeholder.update(i,i.placeholder)},_createTrPlaceholder:function(t,e){var i=this;t.children().each(function(){V("<td>&#160;</td>",i.document[0]).attr("colspan",
V(this).attr("colspan")||1).appendTo(e)})},_contactContainers:function(t){for(var e,i,s,n,o,a,r,l,h,c=null,u=null,d=this.containers.length-1;0<=d;d--)V.contains(this.currentItem[0],this.containers[d].element[0])||(this._intersectsWith(this.containers[d].containerCache)?c&&V.contains(this.containers[d].element[0],c.element[0])||(c=this.containers[d],u=d):this.containers[d].containerCache.over&&(this.containers[d]._trigger("out",t,this._uiHash(this)),this.containers[d].containerCache.over=0));if(c)if(1===
this.containers.length)this.containers[u].containerCache.over||(this.containers[u]._trigger("over",t,this._uiHash(this)),this.containers[u].containerCache.over=1);else{for(i=1E4,s=null,n=(l=c.floating||this._isFloating(this.currentItem))?"left":"top",o=l?"width":"height",h=l?"pageX":"pageY",e=this.items.length-1;0<=e;e--)V.contains(this.containers[u].element[0],this.items[e].item[0])&&this.items[e].item[0]!==this.currentItem[0]&&(a=this.items[e].item.offset()[n],r=!1,t[h]-a>this.items[e][o]/2&&(r=
!0),Math.abs(t[h]-a)<i)&&(i=Math.abs(t[h]-a),s=this.items[e],this.direction=r?"up":"down");(s||this.options.dropOnEmpty)&&(this.currentContainer===this.containers[u]?this.currentContainer.containerCache.over||(this.containers[u]._trigger("over",t,this._uiHash()),this.currentContainer.containerCache.over=1):(s?this._rearrange(t,s,null,!0):this._rearrange(t,null,this.containers[u].element,!0),this._trigger("change",t,this._uiHash()),this.containers[u]._trigger("change",t,this._uiHash(this)),this.currentContainer=
this.containers[u],this.options.placeholder.update(this.currentContainer,this.placeholder),this.scrollParent=this.placeholder.scrollParent(),this.scrollParent[0]!==this.document[0]&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this.containers[u]._trigger("over",t,this._uiHash(this)),this.containers[u].containerCache.over=1))}},_createHelper:function(t){var e=this.options,t="function"==typeof e.helper?V(e.helper.apply(this.element[0],[t,this.currentItem])):
"clone"===e.helper?this.currentItem.clone():this.currentItem;return t.parents("body").length||this.appendTo[0].appendChild(t[0]),t[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),t[0].style.width&&!e.forceHelperSize||t.width(this.currentItem.width()),t[0].style.height&&!e.forceHelperSize||t.height(this.currentItem.height()),
t},_adjustOffsetFromHelper:function(t){"string"==typeof t&&(t=t.split(" ")),"left"in(t=Array.isArray(t)?{left:+t[0],top:+t[1]||0}:t)&&(this.offset.click.left=t.left+this.margins.left),"right"in t&&(this.offset.click.left=this.helperProportions.width-t.right+this.margins.left),"top"in t&&(this.offset.click.top=t.top+this.margins.top),"bottom"in t&&(this.offset.click.top=this.helperProportions.height-t.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();
var t=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==this.document[0]&&V.contains(this.scrollParent[0],this.offsetParent[0])&&(t.left+=this.scrollParent.scrollLeft(),t.top+=this.scrollParent.scrollTop()),{top:(t=this.offsetParent[0]===this.document[0].body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&V.ui.ie?{top:0,left:0}:t).top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:t.left+(parseInt(this.offsetParent.css("borderLeftWidth"),
10)||0)}},_getRelativeOffset:function(){var t;return"relative"===this.cssPosition?{top:(t=this.currentItem.position()).top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}:{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions=
{width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var t,e,i=this.options;"parent"===i.containment&&(i.containment=this.helper[0].parentNode),"document"!==i.containment&&"window"!==i.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,"document"===i.containment?this.document.width():this.window.width()-this.helperProportions.width-this.margins.left,("document"===i.containment?
this.document.height()||document.body.parentNode.scrollHeight:this.window.height()||this.document[0].body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(i.containment)||(t=V(i.containment)[0],i=V(i.containment).offset(),e="hidden"!==V(t).css("overflow"),this.containment=[i.left+(parseInt(V(t).css("borderLeftWidth"),10)||0)+(parseInt(V(t).css("paddingLeft"),10)||0)-this.margins.left,i.top+(parseInt(V(t).css("borderTopWidth"),10)||0)+(parseInt(V(t).css("paddingTop"),
10)||0)-this.margins.top,i.left+(e?Math.max(t.scrollWidth,t.offsetWidth):t.offsetWidth)-(parseInt(V(t).css("borderLeftWidth"),10)||0)-(parseInt(V(t).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,i.top+(e?Math.max(t.scrollHeight,t.offsetHeight):t.offsetHeight)-(parseInt(V(t).css("borderTopWidth"),10)||0)-(parseInt(V(t).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(t,e){e=e||this.position;var t="absolute"===t?
1:-1,i="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&V.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,s=/(html|body)/i.test(i[0].tagName);return{top:e.top+this.offset.relative.top*t+this.offset.parent.top*t-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():s?0:i.scrollTop())*t,left:e.left+this.offset.relative.left*t+this.offset.parent.left*t-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():s?0:i.scrollLeft())*t}},
_generatePosition:function(t){var e=this.options,i=t.pageX,s=t.pageY,n="absolute"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&V.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(n[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==this.document[0]&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(t.pageX-this.offset.click.left<
this.containment[0]&&(i=this.containment[0]+this.offset.click.left),t.pageY-this.offset.click.top<this.containment[1]&&(s=this.containment[1]+this.offset.click.top),t.pageX-this.offset.click.left>this.containment[2]&&(i=this.containment[2]+this.offset.click.left),t.pageY-this.offset.click.top>this.containment[3])&&(s=this.containment[3]+this.offset.click.top),e.grid)&&(t=this.originalPageY+Math.round((s-this.originalPageY)/e.grid[1])*e.grid[1],s=!this.containment||t-this.offset.click.top>=this.containment[1]&&
t-this.offset.click.top<=this.containment[3]?t:t-this.offset.click.top>=this.containment[1]?t-e.grid[1]:t+e.grid[1],t=this.originalPageX+Math.round((i-this.originalPageX)/e.grid[0])*e.grid[0],i=!this.containment||t-this.offset.click.left>=this.containment[0]&&t-this.offset.click.left<=this.containment[2]?t:t-this.offset.click.left>=this.containment[0]?t-e.grid[0]:t+e.grid[0]),{top:s-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():
o?0:n.scrollTop()),left:i-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():o?0:n.scrollLeft())}},_rearrange:function(t,e,i,s){i?i[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var n=this.counter;this._delay(function(){n===this.counter&&this.refreshPositions(!s)})},_clear:function(t,
e){this.reverting=!1;var i,s=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(i in this._storedCSS)"auto"!==this._storedCSS[i]&&"static"!==this._storedCSS[i]||(this._storedCSS[i]="");this.currentItem.css(this._storedCSS),this._removeClass(this.currentItem,"ui-sortable-helper")}else this.currentItem.show();function n(e,i,s){return function(t){s._trigger(e,t,i._uiHash(i))}}for(this.fromOutside&&
!e&&s.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||s.push(function(t){this._trigger("update",t,this._uiHash())}),this===this.currentContainer||e||(s.push(function(t){this._trigger("remove",t,this._uiHash())}),s.push(function(e){return function(t){e._trigger("receive",t,this._uiHash(this))}}.call(this,this.currentContainer)),
s.push(function(e){return function(t){e._trigger("update",t,this._uiHash(this))}}.call(this,this.currentContainer))),i=this.containers.length-1;0<=i;i--)e||s.push(n("deactivate",this,this.containers[i])),this.containers[i].containerCache.over&&(s.push(n("out",this,this.containers[i])),this.containers[i].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),
this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.cancelHelperRemoval||(this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null),!e){for(i=0;i<s.length;i++)s[i].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!this.cancelHelperRemoval},_trigger:function(){!1===V.Widget.prototype._trigger.apply(this,
arguments)&&this.cancel()},_uiHash:function(t){var e=t||this;return{helper:e.helper,placeholder:e.placeholder||V([]),position:e.position,originalPosition:e.originalPosition,offset:e.positionAbs,item:e.currentItem,sender:t?t.element:null}}});function A(e){return function(){var t=this.element.val();e.apply(this,arguments),this._refresh(),t!==this.element.val()&&this._trigger("change")}}V.widget("ui.spinner",{version:"1.13.3",defaultElement:"<input>",widgetEventPrefix:"spin",options:{classes:{"ui-spinner":"ui-corner-all",
"ui-spinner-down":"ui-corner-br","ui-spinner-up":"ui-corner-tr"},culture:null,icons:{down:"ui-icon-triangle-1-s",up:"ui-icon-triangle-1-n"},incremental:!0,max:null,min:null,numberFormat:null,page:10,step:1,change:null,spin:null,start:null,stop:null},_create:function(){this._setOption("max",this.options.max),this._setOption("min",this.options.min),this._setOption("step",this.options.step),""!==this.value()&&this._value(this.element.val(),!0),this._draw(),this._on(this._events),this._refresh(),this._on(this.window,
{beforeunload:function(){this.element.removeAttr("autocomplete")}})},_getCreateOptions:function(){var s=this._super(),n=this.element;return V.each(["min","max","step"],function(t,e){var i=n.attr(e);null!=i&&i.length&&(s[e]=i)}),s},_events:{keydown:function(t){this._start(t)&&this._keydown(t)&&t.preventDefault()},keyup:"_stop",focus:function(){this.previous=this.element.val()},blur:function(t){this.cancelBlur?delete this.cancelBlur:(this._stop(),this._refresh(),this.previous!==this.element.val()&&
this._trigger("change",t))},mousewheel:function(t,e){var i=V.ui.safeActiveElement(this.document[0]);if(this.element[0]===i&&e){if(!this.spinning&&!this._start(t))return!1;this._spin((0<e?1:-1)*this.options.step,t),clearTimeout(this.mousewheelTimer),this.mousewheelTimer=this._delay(function(){this.spinning&&this._stop(t)},100),t.preventDefault()}},"mousedown .ui-spinner-button":function(t){var e;function i(){this.element[0]!==V.ui.safeActiveElement(this.document[0])&&(this.element.trigger("focus"),
this.previous=e,this._delay(function(){this.previous=e}))}e=this.element[0]===V.ui.safeActiveElement(this.document[0])?this.previous:this.element.val(),t.preventDefault(),i.call(this),this.cancelBlur=!0,this._delay(function(){delete this.cancelBlur,i.call(this)}),!1!==this._start(t)&&this._repeat(null,V(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseup .ui-spinner-button":"_stop","mouseenter .ui-spinner-button":function(t){if(V(t.currentTarget).hasClass("ui-state-active"))return!1!==this._start(t)&&
void this._repeat(null,V(t.currentTarget).hasClass("ui-spinner-up")?1:-1,t)},"mouseleave .ui-spinner-button":"_stop"},_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap("<span>").parent().append("<a></a><a></a>")},_draw:function(){this._enhance(),this._addClass(this.uiSpinner,"ui-spinner","ui-widget ui-widget-content"),this._addClass("ui-spinner-input"),this.element.attr("role","spinbutton"),this.buttons=this.uiSpinner.children("a").attr("tabIndex",-1).attr("aria-hidden",
!0).button({classes:{"ui-button":""}}),this._removeClass(this.buttons,"ui-corner-all"),this._addClass(this.buttons.first(),"ui-spinner-button ui-spinner-up"),this._addClass(this.buttons.last(),"ui-spinner-button ui-spinner-down"),this.buttons.first().button({icon:this.options.icons.up,showLabel:!1}),this.buttons.last().button({icon:this.options.icons.down,showLabel:!1}),this.buttons.height()>Math.ceil(.5*this.uiSpinner.height())&&0<this.uiSpinner.height()&&this.uiSpinner.height(this.uiSpinner.height())},
_keydown:function(t){var e=this.options,i=V.ui.keyCode;switch(t.keyCode){case i.UP:return this._repeat(null,1,t),!0;case i.DOWN:return this._repeat(null,-1,t),!0;case i.PAGE_UP:return this._repeat(null,e.page,t),!0;case i.PAGE_DOWN:return this._repeat(null,-e.page,t),!0}return!1},_start:function(t){return!(!this.spinning&&!1===this._trigger("start",t))&&(this.counter||(this.counter=1),this.spinning=!0)},_repeat:function(t,e,i){t=t||500,clearTimeout(this.timer),this.timer=this._delay(function(){this._repeat(40,
e,i)},t),this._spin(e*this.options.step,i)},_spin:function(t,e){var i=this.value()||0;this.counter||(this.counter=1),i=this._adjustValue(i+t*this._increment(this.counter)),this.spinning&&!1===this._trigger("spin",e,{value:i})||(this._value(i),this.counter++)},_increment:function(t){var e=this.options.incremental;return e?"function"==typeof e?e(t):Math.floor(t*t*t/5E4-t*t/500+17*t/200+1):1},_precision:function(){var t=this._precisionOf(this.options.step);return t=null!==this.options.min?Math.max(t,
this._precisionOf(this.options.min)):t},_precisionOf:function(t){var t=t.toString(),e=t.indexOf(".");return-1===e?0:t.length-e-1},_adjustValue:function(t){var e=this.options,i=null!==e.min?e.min:0,s=t-i;return t=i+Math.round(s/e.step)*e.step,t=parseFloat(t.toFixed(this._precision())),null!==e.max&&t>e.max?e.max:null!==e.min&&t<e.min?e.min:t},_stop:function(t){this.spinning&&(clearTimeout(this.timer),clearTimeout(this.mousewheelTimer),this.counter=0,this.spinning=!1,this._trigger("stop",t))},_setOption:function(t,
e){var i;"culture"===t||"numberFormat"===t?(i=this._parse(this.element.val()),this.options[t]=e,this.element.val(this._format(i))):("max"!==t&&"min"!==t&&"step"!==t||"string"==typeof e&&(e=this._parse(e)),"icons"===t&&(i=this.buttons.first().find(".ui-icon"),this._removeClass(i,null,this.options.icons.up),this._addClass(i,null,e.up),i=this.buttons.last().find(".ui-icon"),this._removeClass(i,null,this.options.icons.down),this._addClass(i,null,e.down)),this._super(t,e))},_setOptionDisabled:function(t){this._super(t),
this._toggleClass(this.uiSpinner,null,"ui-state-disabled",!!t),this.element.prop("disabled",!!t),this.buttons.button(t?"disable":"enable")},_setOptions:A(function(t){this._super(t)}),_parse:function(t){return""===(t="string"==typeof t&&""!==t?window.Globalize&&this.options.numberFormat?Globalize.parseFloat(t,10,this.options.culture):+t:t)||isNaN(t)?null:t},_format:function(t){return""===t?"":window.Globalize&&this.options.numberFormat?Globalize.format(t,this.options.numberFormat,this.options.culture):
t},_refresh:function(){this.element.attr({"aria-valuemin":this.options.min,"aria-valuemax":this.options.max,"aria-valuenow":this._parse(this.element.val())})},isValid:function(){var t=this.value();return null!==t&&t===this._adjustValue(t)},_value:function(t,e){var i;""!==t&&null!==(i=this._parse(t))&&(e||(i=this._adjustValue(i)),t=this._format(i)),this.element.val(t),this._refresh()},_destroy:function(){this.element.prop("disabled",!1).removeAttr("autocomplete role aria-valuemin aria-valuemax aria-valuenow"),
this.uiSpinner.replaceWith(this.element)},stepUp:A(function(t){this._stepUp(t)}),_stepUp:function(t){this._start()&&(this._spin((t||1)*this.options.step),this._stop())},stepDown:A(function(t){this._stepDown(t)}),_stepDown:function(t){this._start()&&(this._spin((t||1)*-this.options.step),this._stop())},pageUp:A(function(t){this._stepUp((t||1)*this.options.page)}),pageDown:A(function(t){this._stepDown((t||1)*this.options.page)}),value:function(t){if(!arguments.length)return this._parse(this.element.val());
A(this._value).call(this,t)},widget:function(){return this.uiSpinner}}),!1!==V.uiBackCompat&&V.widget("ui.spinner",V.ui.spinner,{_enhance:function(){this.uiSpinner=this.element.attr("autocomplete","off").wrap(this._uiSpinnerHtml()).parent().append(this._buttonHtml())},_uiSpinnerHtml:function(){return"<span>"},_buttonHtml:function(){return"<a></a><a></a>"}});var O;V.ui.spinner,V.widget("ui.tabs",{version:"1.13.3",delay:300,options:{active:null,classes:{"ui-tabs":"ui-corner-all","ui-tabs-nav":"ui-corner-all",
"ui-tabs-panel":"ui-corner-bottom","ui-tabs-tab":"ui-corner-top"},collapsible:!1,event:"click",heightStyle:"content",hide:null,show:null,activate:null,beforeActivate:null,beforeLoad:null,load:null},_isLocal:(O=/#.*$/,function(t){var e=t.href.replace(O,""),i=location.href.replace(O,"");try{e=decodeURIComponent(e)}catch(t){}try{i=decodeURIComponent(i)}catch(t){}return 1<t.hash.length&&e===i}),_create:function(){var e=this,t=this.options;this.running=!1,this._addClass("ui-tabs","ui-widget ui-widget-content"),
this._toggleClass("ui-tabs-collapsible",null,t.collapsible),this._processTabs(),t.active=this._initialActive(),Array.isArray(t.disabled)&&(t.disabled=V.uniqueSort(t.disabled.concat(V.map(this.tabs.filter(".ui-state-disabled"),function(t){return e.tabs.index(t)}))).sort()),!1!==this.options.active&&this.anchors.length?this.active=this._findActive(t.active):this.active=V(),this._refresh(),this.active.length&&this.load(t.active)},_initialActive:function(){var i=this.options.active,t=this.options.collapsible,
s=location.hash.substring(1);return null===i&&(s&&this.tabs.each(function(t,e){if(V(e).attr("aria-controls")===s)return i=t,!1}),null!==(i=null===i?this.tabs.index(this.tabs.filter(".ui-tabs-active")):i)&&-1!==i||(i=!!this.tabs.length&&0)),!1!==i&&-1===(i=this.tabs.index(this.tabs.eq(i)))&&(i=!t&&0),i=!t&&!1===i&&this.anchors.length?0:i},_getCreateEventData:function(){return{tab:this.active,panel:this.active.length?this._getPanelForTab(this.active):V()}},_tabKeydown:function(t){var e=V(V.ui.safeActiveElement(this.document[0])).closest("li"),
i=this.tabs.index(e),s=!0;if(!this._handlePageNav(t)){switch(t.keyCode){case V.ui.keyCode.RIGHT:case V.ui.keyCode.DOWN:i++;break;case V.ui.keyCode.UP:case V.ui.keyCode.LEFT:s=!1,i--;break;case V.ui.keyCode.END:i=this.anchors.length-1;break;case V.ui.keyCode.HOME:i=0;break;case V.ui.keyCode.SPACE:return t.preventDefault(),clearTimeout(this.activating),void this._activate(i);case V.ui.keyCode.ENTER:return t.preventDefault(),clearTimeout(this.activating),void this._activate(i!==this.options.active&&
i);default:return}t.preventDefault(),clearTimeout(this.activating),i=this._focusNextTab(i,s),t.ctrlKey||t.metaKey||(e.attr("aria-selected","false"),this.tabs.eq(i).attr("aria-selected","true"),this.activating=this._delay(function(){this.option("active",i)},this.delay))}},_panelKeydown:function(t){this._handlePageNav(t)||t.ctrlKey&&t.keyCode===V.ui.keyCode.UP&&(t.preventDefault(),this.active.trigger("focus"))},_handlePageNav:function(t){return t.altKey&&t.keyCode===V.ui.keyCode.PAGE_UP?(this._activate(this._focusNextTab(this.options.active-
1,!1)),!0):t.altKey&&t.keyCode===V.ui.keyCode.PAGE_DOWN?(this._activate(this._focusNextTab(this.options.active+1,!0)),!0):void 0},_findNextTab:function(t,e){var i=this.tabs.length-1;for(;-1!==V.inArray(t=(t=i<t?0:t)<0?i:t,this.options.disabled);)t=e?t+1:t-1;return t},_focusNextTab:function(t,e){return t=this._findNextTab(t,e),this.tabs.eq(t).trigger("focus"),t},_setOption:function(t,e){"active"===t?this._activate(e):(this._super(t,e),"collapsible"===t&&(this._toggleClass("ui-tabs-collapsible",null,
e),e||!1!==this.options.active||this._activate(0)),"event"===t&&this._setupEvents(e),"heightStyle"===t&&this._setupHeightStyle(e))},_sanitizeSelector:function(t){return t?t.replace(/[!"$%&'()*+,.\/:;<=>?@\[\]\^`{|}~]/g,"\\$&"):""},refresh:function(){var t=this.options,e=this.tablist.children(":has(a[href])");t.disabled=V.map(e.filter(".ui-state-disabled"),function(t){return e.index(t)}),this._processTabs(),!1!==t.active&&this.anchors.length?this.active.length&&!V.contains(this.tablist[0],this.active[0])?
this.tabs.length===t.disabled.length?(t.active=!1,this.active=V()):this._activate(this._findNextTab(Math.max(0,t.active-1),!1)):t.active=this.tabs.index(this.active):(t.active=!1,this.active=V()),this._refresh()},_refresh:function(){this._setOptionDisabled(this.options.disabled),this._setupEvents(this.options.event),this._setupHeightStyle(this.options.heightStyle),this.tabs.not(this.active).attr({"aria-selected":"false","aria-expanded":"false",tabIndex:-1}),this.panels.not(this._getPanelForTab(this.active)).hide().attr({"aria-hidden":"true"}),
this.active.length?(this.active.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0}),this._addClass(this.active,"ui-tabs-active","ui-state-active"),this._getPanelForTab(this.active).show().attr({"aria-hidden":"false"})):this.tabs.eq(0).attr("tabIndex",0)},_processTabs:function(){var l=this,t=this.tabs,e=this.anchors,i=this.panels;this.tablist=this._getList().attr("role","tablist"),this._addClass(this.tablist,"ui-tabs-nav","ui-helper-reset ui-helper-clearfix ui-widget-header"),this.tablist.on("mousedown"+
this.eventNamespace,"> li",function(t){V(this).is(".ui-state-disabled")&&t.preventDefault()}).on("focus"+this.eventNamespace,".ui-tabs-anchor",function(){V(this).closest("li").is(".ui-state-disabled")&&this.blur()}),this.tabs=this.tablist.find("> li:has(a[href])").attr({role:"tab",tabIndex:-1}),this._addClass(this.tabs,"ui-tabs-tab","ui-state-default"),this.anchors=this.tabs.map(function(){return V("a",this)[0]}).attr({tabIndex:-1}),this._addClass(this.anchors,"ui-tabs-anchor"),this.panels=V(),this.anchors.each(function(t,
e){var i,s,n,o=V(e).uniqueId().attr("id"),a=V(e).closest("li"),r=a.attr("aria-controls");l._isLocal(e)?(n=(i=e.hash).substring(1),s=l.element.find(l._sanitizeSelector(i))):(n=a.attr("aria-controls")||V({}).uniqueId()[0].id,(s=l.element.find(i="#"+n)).length||(s=l._createPanel(n)).insertAfter(l.panels[t-1]||l.tablist),s.attr("aria-live","polite")),s.length&&(l.panels=l.panels.add(s)),r&&a.data("ui-tabs-aria-controls",r),a.attr({"aria-controls":n,"aria-labelledby":o}),s.attr("aria-labelledby",o)}),
this.panels.attr("role","tabpanel"),this._addClass(this.panels,"ui-tabs-panel","ui-widget-content"),t&&(this._off(t.not(this.tabs)),this._off(e.not(this.anchors)),this._off(i.not(this.panels)))},_getList:function(){return this.tablist||this.element.find("ol, ul").eq(0)},_createPanel:function(t){return V("<div>").attr("id",t).data("ui-tabs-destroy",!0)},_setOptionDisabled:function(t){var e,i;for(Array.isArray(t)&&(t.length?t.length===this.anchors.length&&(t=!0):t=!1),i=0;e=this.tabs[i];i++)e=V(e),
!0===t||-1!==V.inArray(i,t)?(e.attr("aria-disabled","true"),this._addClass(e,null,"ui-state-disabled")):(e.removeAttr("aria-disabled"),this._removeClass(e,null,"ui-state-disabled"));this.options.disabled=t,this._toggleClass(this.widget(),this.widgetFullName+"-disabled",null,!0===t)},_setupEvents:function(t){var i={};t&&V.each(t.split(" "),function(t,e){i[e]="_eventHandler"}),this._off(this.anchors.add(this.tabs).add(this.panels)),this._on(!0,this.anchors,{click:function(t){t.preventDefault()}}),this._on(this.anchors,
i),this._on(this.tabs,{keydown:"_tabKeydown"}),this._on(this.panels,{keydown:"_panelKeydown"}),this._focusable(this.tabs),this._hoverable(this.tabs)},_setupHeightStyle:function(t){var i,e=this.element.parent();"fill"===t?(i=e.height(),i-=this.element.outerHeight()-this.element.height(),this.element.siblings(":visible").each(function(){var t=V(this),e=t.css("position");"absolute"!==e&&"fixed"!==e&&(i-=t.outerHeight(!0))}),this.element.children().not(this.panels).each(function(){i-=V(this).outerHeight(!0)}),
this.panels.each(function(){V(this).height(Math.max(0,i-V(this).innerHeight()+V(this).height()))}).css("overflow","auto")):"auto"===t&&(i=0,this.panels.each(function(){i=Math.max(i,V(this).height("").height())}).height(i))},_eventHandler:function(t){var e=this.options,i=this.active,s=V(t.currentTarget).closest("li"),n=s[0]===i[0],o=n&&e.collapsible,a=o?V():this._getPanelForTab(s),r=i.length?this._getPanelForTab(i):V(),i={oldTab:i,oldPanel:r,newTab:o?V():s,newPanel:a};t.preventDefault(),s.hasClass("ui-state-disabled")||
s.hasClass("ui-tabs-loading")||this.running||n&&!e.collapsible||!1===this._trigger("beforeActivate",t,i)||(e.active=!o&&this.tabs.index(s),this.active=n?V():s,this.xhr&&this.xhr.abort(),r.length||a.length||V.error("jQuery UI Tabs: Mismatching fragment identifier."),a.length&&this.load(this.tabs.index(s),t),this._toggle(t,i))},_toggle:function(t,e){var i=this,s=e.newPanel,n=e.oldPanel;function o(){i.running=!1,i._trigger("activate",t,e)}function a(){i._addClass(e.newTab.closest("li"),"ui-tabs-active",
"ui-state-active"),s.length&&i.options.show?i._show(s,i.options.show,o):(s.show(),o())}this.running=!0,n.length&&this.options.hide?this._hide(n,this.options.hide,function(){i._removeClass(e.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),a()}):(this._removeClass(e.oldTab.closest("li"),"ui-tabs-active","ui-state-active"),n.hide(),a()),n.attr("aria-hidden","true"),e.oldTab.attr({"aria-selected":"false","aria-expanded":"false"}),s.length&&n.length?e.oldTab.attr("tabIndex",-1):s.length&&this.tabs.filter(function(){return 0===
V(this).attr("tabIndex")}).attr("tabIndex",-1),s.attr("aria-hidden","false"),e.newTab.attr({"aria-selected":"true","aria-expanded":"true",tabIndex:0})},_activate:function(t){var t=this._findActive(t);t[0]!==this.active[0]&&(t=(t=t.length?t:this.active).find(".ui-tabs-anchor")[0],this._eventHandler({target:t,currentTarget:t,preventDefault:V.noop}))},_findActive:function(t){return!1===t?V():this.tabs.eq(t)},_getIndex:function(t){return t="string"==typeof t?this.anchors.index(this.anchors.filter("[href$='"+
V.escapeSelector(t)+"']")):t},_destroy:function(){this.xhr&&this.xhr.abort(),this.tablist.removeAttr("role").off(this.eventNamespace),this.anchors.removeAttr("role tabIndex").removeUniqueId(),this.tabs.add(this.panels).each(function(){V.data(this,"ui-tabs-destroy")?V(this).remove():V(this).removeAttr("role tabIndex aria-live aria-busy aria-selected aria-labelledby aria-hidden aria-expanded")}),this.tabs.each(function(){var t=V(this),e=t.data("ui-tabs-aria-controls");e?t.attr("aria-controls",e).removeData("ui-tabs-aria-controls"):
t.removeAttr("aria-controls")}),this.panels.show(),"content"!==this.options.heightStyle&&this.panels.css("height","")},enable:function(i){var t=this.options.disabled;!1!==t&&(t=void 0!==i&&(i=this._getIndex(i),Array.isArray(t)?V.map(t,function(t){return t!==i?t:null}):V.map(this.tabs,function(t,e){return e!==i?e:null})),this._setOptionDisabled(t))},disable:function(t){var e=this.options.disabled;if(!0!==e){if(void 0===t)e=!0;else{if(t=this._getIndex(t),-1!==V.inArray(t,e))return;e=Array.isArray(e)?
V.merge([t],e).sort():[t]}this._setOptionDisabled(e)}},load:function(t,s){t=this._getIndex(t);function n(t,e){"abort"===e&&o.panels.stop(!1,!0),o._removeClass(i,"ui-tabs-loading"),a.removeAttr("aria-busy"),t===o.xhr&&delete o.xhr}var o=this,i=this.tabs.eq(t),t=i.find(".ui-tabs-anchor"),a=this._getPanelForTab(i),r={tab:i,panel:a};this._isLocal(t[0])||(this.xhr=V.ajax(this._ajaxSettings(t,s,r)),this.xhr&&"canceled"!==this.xhr.statusText&&(this._addClass(i,"ui-tabs-loading"),a.attr("aria-busy","true"),
this.xhr.done(function(t,e,i){setTimeout(function(){a.html(t),o._trigger("load",s,r),n(i,e)},1)}).fail(function(t,e){setTimeout(function(){n(t,e)},1)})))},_ajaxSettings:function(t,i,s){var n=this;return{url:t.attr("href").replace(/#.*$/,""),beforeSend:function(t,e){return n._trigger("beforeLoad",i,V.extend({jqXHR:t,ajaxSettings:e},s))}}},_getPanelForTab:function(t){t=V(t).attr("aria-controls");return this.element.find(this._sanitizeSelector("#"+t))}}),!1!==V.uiBackCompat&&V.widget("ui.tabs",V.ui.tabs,
{_processTabs:function(){this._superApply(arguments),this._addClass(this.tabs,"ui-tab")}}),V.ui.tabs,V.widget("ui.tooltip",{version:"1.13.3",options:{classes:{"ui-tooltip":"ui-corner-all ui-widget-shadow"},content:function(){var t=V(this).attr("title");return V("<a>").text(t).html()},hide:!0,items:"[title]:not([disabled])",position:{my:"left top+15",at:"left bottom",collision:"flipfit flip"},show:!0,track:!1,close:null,open:null},_addDescribedBy:function(t,e){var i=(t.attr("aria-describedby")||"").split(/\s+/);
i.push(e),t.data("ui-tooltip-id",e).attr("aria-describedby",String.prototype.trim.call(i.join(" ")))},_removeDescribedBy:function(t){var e=t.data("ui-tooltip-id"),i=(t.attr("aria-describedby")||"").split(/\s+/),e=V.inArray(e,i);-1!==e&&i.splice(e,1),t.removeData("ui-tooltip-id"),(i=String.prototype.trim.call(i.join(" ")))?t.attr("aria-describedby",i):t.removeAttr("aria-describedby")},_create:function(){this._on({mouseover:"open",focusin:"open"}),this.tooltips={},this.parents={},this.liveRegion=V("<div>").attr({role:"log",
"aria-live":"assertive","aria-relevant":"additions"}).appendTo(this.document[0].body),this._addClass(this.liveRegion,null,"ui-helper-hidden-accessible"),this.disabledTitles=V([])},_setOption:function(t,e){var i=this;this._super(t,e),"content"===t&&V.each(this.tooltips,function(t,e){i._updateContent(e.element)})},_setOptionDisabled:function(t){this[t?"_disable":"_enable"]()},_disable:function(){var s=this;V.each(this.tooltips,function(t,e){var i=V.Event("blur");i.target=i.currentTarget=e.element[0],
s.close(i,!0)}),this.disabledTitles=this.disabledTitles.add(this.element.find(this.options.items).addBack().filter(function(){var t=V(this);if(t.is("[title]"))return t.data("ui-tooltip-title",t.attr("title")).removeAttr("title")}))},_enable:function(){this.disabledTitles.each(function(){var t=V(this);t.data("ui-tooltip-title")&&t.attr("title",t.data("ui-tooltip-title"))}),this.disabledTitles=V([])},open:function(t){var i=this,e=V(t?t.target:this.element).closest(this.options.items);e.length&&!e.data("ui-tooltip-id")&&
(e.attr("title")&&e.data("ui-tooltip-title",e.attr("title")),e.data("ui-tooltip-open",!0),t&&"mouseover"===t.type&&e.parents().each(function(){var t,e=V(this);e.data("ui-tooltip-open")&&((t=V.Event("blur")).target=t.currentTarget=this,i.close(t,!0)),e.attr("title")&&(e.uniqueId(),i.parents[this.id]={element:this,title:e.attr("title")},e.attr("title",""))}),this._registerCloseHandlers(t,e),this._updateContent(e,t))},_updateContent:function(e,i){var t=this.options.content,s=this,n=i?i.type:null;if("string"==
typeof t||t.nodeType||t.jquery)return this._open(i,e,t);(t=t.call(e[0],function(t){s._delay(function(){e.data("ui-tooltip-open")&&(i&&(i.type=n),this._open(i,e,t))})}))&&this._open(i,e,t)},_open:function(t,e,i){var s,n,o,a=V.extend({},this.options.position);function r(t){a.of=t,s.is(":hidden")||s.position(a)}i&&((o=this._find(e))?o.tooltip.find(".ui-tooltip-content").html(i):(e.is("[title]")&&(t&&"mouseover"===t.type?e.attr("title",""):e.removeAttr("title")),o=this._tooltip(e),s=o.tooltip,this._addDescribedBy(e,
s.attr("id")),s.find(".ui-tooltip-content").html(i),this.liveRegion.children().hide(),(o=V("<div>").html(s.find(".ui-tooltip-content").html())).removeAttr("name").find("[name]").removeAttr("name"),o.removeAttr("id").find("[id]").removeAttr("id"),o.appendTo(this.liveRegion),this.options.track&&t&&/^mouse/.test(t.type)?(this._on(this.document,{mousemove:r}),r(t)):s.position(V.extend({of:e},this.options.position)),s.hide(),this._show(s,this.options.show),this.options.track&&this.options.show&&this.options.show.delay&&
(n=this.delayedShow=setInterval(function(){s.is(":visible")&&(r(a.of),clearInterval(n))},13)),this._trigger("open",t,{tooltip:s})))},_registerCloseHandlers:function(t,e){var i={keyup:function(t){t.keyCode===V.ui.keyCode.ESCAPE&&((t=V.Event(t)).currentTarget=e[0],this.close(t,!0))}};e[0]!==this.element[0]&&(i.remove=function(){var t=this._find(e);t&&this._removeTooltip(t.tooltip)}),t&&"mouseover"!==t.type||(i.mouseleave="close"),t&&"focusin"!==t.type||(i.focusout="close"),this._on(!0,e,i)},close:function(t){var e,
i=this,s=V(t?t.currentTarget:this.element),n=this._find(s);n?(e=n.tooltip,n.closing||(clearInterval(this.delayedShow),s.data("ui-tooltip-title")&&!s.attr("title")&&s.attr("title",s.data("ui-tooltip-title")),this._removeDescribedBy(s),n.hiding=!0,e.stop(!0),this._hide(e,this.options.hide,function(){i._removeTooltip(V(this))}),s.removeData("ui-tooltip-open"),this._off(s,"mouseleave focusout keyup"),s[0]!==this.element[0]&&this._off(s,"remove"),this._off(this.document,"mousemove"),t&&"mouseleave"===
t.type&&V.each(this.parents,function(t,e){V(e.element).attr("title",e.title),delete i.parents[t]}),n.closing=!0,this._trigger("close",t,{tooltip:e}),n.hiding)||(n.closing=!1)):s.removeData("ui-tooltip-open")},_tooltip:function(t){var e=V("<div>").attr("role","tooltip"),i=V("<div>").appendTo(e),s=e.uniqueId().attr("id");return this._addClass(i,"ui-tooltip-content"),this._addClass(e,"ui-tooltip","ui-widget ui-widget-content"),e.appendTo(this._appendTo(t)),this.tooltips[s]={element:t,tooltip:e}},_find:function(t){t=
t.data("ui-tooltip-id");return t?this.tooltips[t]:null},_removeTooltip:function(t){clearInterval(this.delayedShow),t.remove(),delete this.tooltips[t.attr("id")]},_appendTo:function(t){t=t.closest(".ui-front, dialog");return t=t.length?t:this.document[0].body},_destroy:function(){var s=this;V.each(this.tooltips,function(t,e){var i=V.Event("blur"),e=e.element;i.target=i.currentTarget=e[0],s.close(i,!0),V("#"+t).remove(),e.data("ui-tooltip-title")&&(e.attr("title")||e.attr("title",e.data("ui-tooltip-title")),
e.removeData("ui-tooltip-title"))}),this.liveRegion.remove()}}),!1!==V.uiBackCompat&&V.widget("ui.tooltip",V.ui.tooltip,{options:{tooltipClass:null},_tooltip:function(){var t=this._superApply(arguments);return this.options.tooltipClass&&t.tooltip.addClass(this.options.tooltipClass),t}}),V.ui.tooltip});
(function(){function setup($){$.fn._fadeIn=$.fn.fadeIn;var noOp=$.noop||function(){};var msie=/MSIE/.test(navigator.userAgent);var ie6=/MSIE 6.0/.test(navigator.userAgent)&&!/MSIE 8.0/.test(navigator.userAgent);var mode=document.documentMode||0;var setExpr=$.isFunction(document.createElement("div").style.setExpression);$.blockUI=function(opts){install(window,opts)};$.unblockUI=function(opts){remove(window,opts)};$.growlUI=function(title,message,timeout,onClose){var $m=$('<div class="growlUI"></div>');
if(title)$m.append("<h1>"+title+"</h1>");if(message)$m.append("<h2>"+message+"</h2>");if(timeout===undefined)timeout=3E3;var callBlock=function(opts){opts=opts||{};$.blockUI({message:$m,fadeIn:typeof opts.fadeIn!=="undefined"?opts.fadeIn:700,fadeOut:typeof opts.fadeOut!=="undefined"?opts.fadeOut:1E3,timeout:typeof opts.timeout!=="undefined"?opts.timeout:timeout,centerY:false,showOverlay:false,onUnblock:onClose,css:$.blockUI.defaults.growlCSS})};callBlock();var nonmousedOpacity=$m.css("opacity");$m.mouseover(function(){callBlock({fadeIn:0,
timeout:3E4});var displayBlock=$(".blockMsg");displayBlock.stop();displayBlock.fadeTo(300,1)}).mouseout(function(){$(".blockMsg").fadeOut(1E3)})};$.fn.block=function(opts){if(this[0]===window){$.blockUI(opts);return this}var fullOpts=$.extend({},$.blockUI.defaults,opts||{});this.each(function(){var $el=$(this);if(fullOpts.ignoreIfBlocked&&$el.data("blockUI.isBlocked"))return;$el.unblock({fadeOut:0})});return this.each(function(){if($.css(this,"position")=="static"){this.style.position="relative";
$(this).data("blockUI.static",true)}this.style.zoom=1;install(this,opts)})};$.fn.unblock=function(opts){if(this[0]===window){$.unblockUI(opts);return this}return this.each(function(){remove(this,opts)})};$.blockUI.version=2.7;$.blockUI.defaults={message:"<h1>Please wait...</h1>",title:null,draggable:true,theme:false,css:{padding:0,margin:0,width:"30%",top:"40%",left:"35%",textAlign:"center",color:"#000",border:"3px solid #aaa",backgroundColor:"#fff",cursor:"wait"},themedCSS:{width:"30%",top:"40%",
left:"35%"},overlayCSS:{backgroundColor:"#000",opacity:.6,cursor:"wait"},cursorReset:"default",growlCSS:{width:"350px",top:"10px",left:"",right:"10px",border:"none",padding:"5px",opacity:.6,cursor:"default",color:"#fff",backgroundColor:"#000","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px"},iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank",forceIframe:false,baseZ:1E3,centerX:true,centerY:true,allowBodyStretch:true,bindEvents:true,
constrainTabKey:true,fadeIn:200,fadeOut:400,timeout:0,showOverlay:true,focusInput:true,focusableElements:":input:enabled:visible",onBlock:null,onUnblock:null,onOverlayClick:null,quirksmodeOffsetHack:4,blockMsgClass:"blockMsg",ignoreIfBlocked:false};var pageBlock=null;var pageBlockEls=[];function applyStyle(elem,style){for(var v in style)elem.style[v]=style[v]}function install(el,opts){var css,themedCSS;var full=el==window;var msg=opts&&opts.message!==undefined?opts.message:undefined;opts=$.extend({},
$.blockUI.defaults,opts||{});if(opts.ignoreIfBlocked&&$(el).data("blockUI.isBlocked"))return;opts.overlayCSS=$.extend({},$.blockUI.defaults.overlayCSS,opts.overlayCSS||{});css=$.extend({},$.blockUI.defaults.css,opts.css||{});if(opts.onOverlayClick)opts.overlayCSS.cursor="pointer";themedCSS=$.extend({},$.blockUI.defaults.themedCSS,opts.themedCSS||{});msg=msg===undefined?opts.message:msg;if(full&&pageBlock)remove(window,{fadeOut:0});if(msg&&typeof msg!="string"&&(msg.parentNode||msg.jquery)){var node=
msg.jquery?msg[0]:msg;var data={};$(el).data("blockUI.history",data);data.el=node;data.parent=node.parentNode;data.display=node.style.display;data.position=node.style.position;if(data.parent)data.parent.removeChild(node)}$(el).data("blockUI.onUnblock",opts.onUnblock);var z=opts.baseZ;var lyr1,lyr2,lyr3,s;if(msie||opts.forceIframe){lyr1=$('<iframe class="blockUI" src="'+opts.iframeSrc+'"></iframe>');applyStyle(lyr1[0],{"z-index":z++,"display":"none","border":"none","margin":0,"padding":0,"position":"absolute",
"width":"100%","height":"100%","top":0,"left":0})}else{lyr1=$('<div class="blockUI"></div>');applyStyle(lyr1[0],{"display":"none"})}if(opts.theme){lyr2=$('<div class="blockUI blockOverlay ui-widget-overlay"></div>');applyStyle(lyr2[0],{"z-index":z++,"display":"none"})}else{lyr2=$('<div class="blockUI blockOverlay" ></div>');applyStyle(lyr2[0],{"z-index":z++,"display":"none","border":"none","margin":0,"padding":0,"width":"100%","height":"100%","top":0,"left":0})}if(opts.theme&&full){s='<div class="blockUI '+
opts.blockMsgClass+' blockPage ui-dialog ui-widget ui-corner-all">';if(opts.title)s+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+(opts.title||"&nbsp;")+"</div>";s+='<div class="ui-widget-content ui-dialog-content"></div>';s+="</div>";s=$(s);applyStyle(s[0],{"z-index":z+10,"display":"none","position":"fixed"})}else if(opts.theme){s='<div class="blockUI '+opts.blockMsgClass+' blockElement ui-dialog ui-widget ui-corner-all">';if(opts.title)s+='<div class="ui-widget-header ui-dialog-titlebar ui-corner-all blockTitle">'+
(opts.title||"&nbsp;")+"</div>";s+='<div class="ui-widget-content ui-dialog-content"></div>';s+="</div>";s=$(s);applyStyle(s[0],{"z-index":z+10,"display":"none","position":"absolute"})}else if(full){s=$('<div class="blockUI '+opts.blockMsgClass+' blockPage"></div>');applyStyle(s[0],{"z-index":z+10,"display":"none","position":"fixed"})}else{s=$('<div class="blockUI '+opts.blockMsgClass+' blockElement"></div>');applyStyle(s[0],{"z-index":z+10,"display":"none","position":"absolute"})}lyr3=s;if(msg)if(opts.theme){lyr3.css(themedCSS);
lyr3.addClass("ui-widget-content")}else lyr3.css(css);if(!opts.theme)lyr2.css(opts.overlayCSS);lyr2.css("position",full?"fixed":"absolute");if(msie||opts.forceIframe)lyr1.css("opacity",0);var layers=[lyr1,lyr2,lyr3],$par=full?$("body"):$(el);$.each(layers,function(){this.appendTo($par)});if(opts.theme&&opts.draggable&&$.fn.draggable)lyr3.draggable({handle:".ui-dialog-titlebar",cancel:"li"});var expr=setExpr&&(!$.support.boxModel||$("object,embed",full?null:el).length>0);if(ie6||expr){if(full&&opts.allowBodyStretch&&
$.support.boxModel)$("html,body").css("height","100%");if((ie6||!$.support.boxModel)&&!full){var t=sz(el,"borderTopWidth"),l=sz(el,"borderLeftWidth");var fixT=t?"(0 - "+t+")":0;var fixL=l?"(0 - "+l+")":0}$.each(layers,function(i,o){var s=o[0].style;s.position="absolute";if(i<2){if(full)s.setExpression("height","Math.max(document.body.scrollHeight, document.body.offsetHeight) - (jQuery.support.boxModel?0:"+opts.quirksmodeOffsetHack+') + "px"');else s.setExpression("height",'this.parentNode.offsetHeight + "px"');
if(full)s.setExpression("width",'jQuery.support.boxModel && document.documentElement.clientWidth || document.body.clientWidth + "px"');else s.setExpression("width",'this.parentNode.offsetWidth + "px"');if(fixL)s.setExpression("left",fixL);if(fixT)s.setExpression("top",fixT)}else if(opts.centerY){if(full)s.setExpression("top",'(document.documentElement.clientHeight || document.body.clientHeight) / 2 - (this.offsetHeight / 2) + (blah = document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "px"');
s.marginTop=0}else if(!opts.centerY&&full){var top=opts.css&&opts.css.top?parseInt(opts.css.top,10):0;var expression="((document.documentElement.scrollTop ? document.documentElement.scrollTop : document.body.scrollTop) + "+top+') + "px"';s.setExpression("top",expression)}})}if(msg){if(opts.theme)lyr3.find(".ui-widget-content").append(msg);else lyr3.append(msg);if(msg.jquery||msg.nodeType)$(msg).show()}if((msie||opts.forceIframe)&&opts.showOverlay)lyr1.show();if(opts.fadeIn){var cb=opts.onBlock?opts.onBlock:
noOp;var cb1=opts.showOverlay&&!msg?cb:noOp;var cb2=msg?cb:noOp;if(opts.showOverlay)lyr2._fadeIn(opts.fadeIn,cb1);if(msg)lyr3._fadeIn(opts.fadeIn,cb2)}else{if(opts.showOverlay)lyr2.show();if(msg)lyr3.show();if(opts.onBlock)opts.onBlock.bind(lyr3)()}bind(1,el,opts);if(full){pageBlock=lyr3[0];pageBlockEls=$(opts.focusableElements,pageBlock);if(opts.focusInput)setTimeout(focus,20)}else{center(lyr3[0],opts.centerX,opts.centerY);$(window).on("resize",function(){center(lyr3[0],opts.centerX,opts.centerY)})}if(opts.timeout){var to=
setTimeout(function(){if(full)$.unblockUI(opts);else $(el).unblock(opts)},opts.timeout);$(el).data("blockUI.timeout",to)}}function remove(el,opts){var count;var full=el==window;var $el=$(el);var data=$el.data("blockUI.history");var to=$el.data("blockUI.timeout");if(to){clearTimeout(to);$el.removeData("blockUI.timeout")}opts=$.extend({},$.blockUI.defaults,opts||{});bind(0,el,opts);if(opts.onUnblock===null){opts.onUnblock=$el.data("blockUI.onUnblock");$el.removeData("blockUI.onUnblock")}var els;if(full)els=
$("body").children().filter(".blockUI").add("body > .blockUI");else els=$el.find(">.blockUI");if(opts.cursorReset){if(els.length>1)els[1].style.cursor=opts.cursorReset;if(els.length>2)els[2].style.cursor=opts.cursorReset}if(full)pageBlock=pageBlockEls=null;if(opts.fadeOut){count=els.length;els.stop().fadeOut(opts.fadeOut,function(){if(--count===0)reset(els,data,opts,el)})}else reset(els,data,opts,el)}function reset(els,data,opts,el){var $el=$(el);if($el.data("blockUI.isBlocked"))return;els.each(function(i,
o){if(this.parentNode)this.parentNode.removeChild(this)});if(data&&data.el){data.el.style.display=data.display;data.el.style.position=data.position;data.el.style.cursor="default";if(data.parent)data.parent.appendChild(data.el);$el.removeData("blockUI.history")}if($el.data("blockUI.static"))$el.css("position","static");if(typeof opts.onUnblock=="function")opts.onUnblock(el,opts);var body=$(document.body),w=body.width(),cssW=body[0].style.width;body.width(w-1).width(w);body[0].style.width=cssW}function bind(b,
el,opts){var full=el==window,$el=$(el);if(!b&&(full&&!pageBlock||!full&&!$el.data("blockUI.isBlocked")))return;$el.data("blockUI.isBlocked",b);if(!full||!opts.bindEvents||b&&!opts.showOverlay)return;var events="mousedown mouseup keydown keypress keyup touchstart touchend touchmove";if(b)$(document).bind(events,opts,handler);else $(document).unbind(events,handler)}function handler(e){if(e.type==="keydown"&&e.keyCode&&e.keyCode==9)if(pageBlock&&e.data.constrainTabKey){var els=pageBlockEls;var fwd=!e.shiftKey&&
e.target===els[els.length-1];var back=e.shiftKey&&e.target===els[0];if(fwd||back){setTimeout(function(){focus(back)},10);return false}}var opts=e.data;var target=$(e.target);if(target.hasClass("blockOverlay")&&opts.onOverlayClick)opts.onOverlayClick(e);if(target.parents("div."+opts.blockMsgClass).length>0)return true;return target.parents().children().filter("div.blockUI").length===0}function focus(back){if(!pageBlockEls)return;var e=pageBlockEls[back===true?pageBlockEls.length-1:0];if(e)e.focus()}
function center(el,x,y){var p=el.parentNode,s=el.style;if(p){var l=(p.offsetWidth-el.offsetWidth)/2-sz(p,"borderLeftWidth");var t=(p.offsetHeight-el.offsetHeight)/2-sz(p,"borderTopWidth");if(x)s.left=l>0?l+"px":"0";if(y)s.top=t>0?t+"px":"0"}}function sz(el,p){return parseInt($.css(el,p),10)||0}}if(typeof define==="function"&&define.amd&&define.amd.jQuery)define(["jquery"],setup);else setup(jQuery)})();
jQuery.ajaxq=function(queue,options){if(typeof document.ajaxq=="undefined")document.ajaxq={q:{},r:null};if(typeof document.ajaxq.q[queue]=="undefined")document.ajaxq.q[queue]=[];if(typeof options!="undefined"){var optionsCopy={};for(var o in options)optionsCopy[o]=options[o];options=optionsCopy;var originalCompleteCallback=options.complete;options.error=function(e){};options.complete=function(request,status){document.ajaxq.q[queue].shift();document.ajaxq.r=null;if(originalCompleteCallback)originalCompleteCallback(request,
status);if(document.ajaxq.q[queue].length>0)document.ajaxq.r=jQuery.ajax(document.ajaxq.q[queue][0])};document.ajaxq.q[queue].push(options);if(document.ajaxq.q[queue].length==1)document.ajaxq.r=jQuery.ajax(document.ajaxq.q[queue][0])}else{if(document.ajaxq.r){document.ajaxq.r.abort();document.ajaxq.r=null}document.ajaxq.q[queue]=[]}};"use strict";
jQuery.base64=function($){var _PADCHAR="=",_ALPHA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",_VERSION="1.0";function _getbyte64(s,i){var idx=_ALPHA.indexOf(s.charAt(i));if(idx===-1)throw"Cannot decode base64";return idx}function _decode(s){var pads=0,i,b10,imax=s.length,x=[];s=String(s);if(imax===0)return s;if(imax%4!==0)throw"Cannot decode base64";if(s.charAt(imax-1)===_PADCHAR){pads=1;if(s.charAt(imax-2)===_PADCHAR)pads=2;imax-=4}for(i=0;i<imax;i+=4){b10=_getbyte64(s,i)<<
18|_getbyte64(s,i+1)<<12|_getbyte64(s,i+2)<<6|_getbyte64(s,i+3);x.push(String.fromCharCode(b10>>16,b10>>8&255,b10&255))}switch(pads){case 1:b10=_getbyte64(s,i)<<18|_getbyte64(s,i+1)<<12|_getbyte64(s,i+2)<<6;x.push(String.fromCharCode(b10>>16,b10>>8&255));break;case 2:b10=_getbyte64(s,i)<<18|_getbyte64(s,i+1)<<12;x.push(String.fromCharCode(b10>>16));break}return x.join("")}function _getbyte(s,i){var x=s.charCodeAt(i);if(x>255)throw"INVALID_CHARACTER_ERR: DOM Exception 5";return x}function _encode(s){if(arguments.length!==
1)throw"SyntaxError: exactly one argument required";s=String(s);var i,b10,x=[],imax=s.length-s.length%3;if(s.length===0)return s;for(i=0;i<imax;i+=3){b10=_getbyte(s,i)<<16|_getbyte(s,i+1)<<8|_getbyte(s,i+2);x.push(_ALPHA.charAt(b10>>18));x.push(_ALPHA.charAt(b10>>12&63));x.push(_ALPHA.charAt(b10>>6&63));x.push(_ALPHA.charAt(b10&63))}switch(s.length-imax){case 1:b10=_getbyte(s,i)<<16;x.push(_ALPHA.charAt(b10>>18)+_ALPHA.charAt(b10>>12&63)+_PADCHAR+_PADCHAR);break;case 2:b10=_getbyte(s,i)<<16|_getbyte(s,
i+1)<<8;x.push(_ALPHA.charAt(b10>>18)+_ALPHA.charAt(b10>>12&63)+_ALPHA.charAt(b10>>6&63)+_PADCHAR);break}return x.join("")}return{decode:_decode,encode:_encode,VERSION:_VERSION}}(jQuery);
function AgentInfo(){var p={};var asyncCallbacks={};var apaSupported=false;var _self=this;var _surface={isTouchable:undefined,key:"__#thinfinity.touch.data__",callbacks:[]};function initialize(){p=getBrowserInfo();if(this.__proto__==null)if(Object.getPrototypeOf)this.__proto__=Object.getPrototypeOf(this);else this.__proto__=this.constructor.prototype;this.__proto__.getAgentKey=function(){var result;if(p["isIOS"])result="IOS_";else if(p["isAndroid"])result="ANDROID_";else if(p["isPlaybook"])result=
"PLAYBOOK_";else if(p["isHPTablet"])result="WEBOS_";else if(p["isChromeOS"])result="CHROMEOS_";else if(p["isMac"])result="MAC_";else if(p["isSymbian"])result="SYMBIAN_";else result="PC_";if(p["isFirefox"])result+="FIREFOX";else if(p["isOpera"])result+="OPERA";else if(p["isSafari"])result+="SAFARI";else if(p["isChrome"])result+="CHROME";else if(p["isMSIE"])result+="MSIE";else if(p["isTrident"])result+="TRIDENT";else if(p["isNokiaBrowser"])result+="NOKIA";else if(p["isChromium"])result+="CHROMIUM";
return result};this.__proto__.browserFromAgent=function(agentStr){var result;var params=getBrowserInfo(agentStr);if(params["isFirefox"])result="Mozilla Firefox";else if(params["isOpera"])result="Opera";else if(params["isSafari"])result="Safari";else if(params["isChrome"])result="Google Chrome";else if(params["isMSIE"])result="MS Internet Explorer";else if(params["isNokiaBrowser"])result="Nokia Browser";else if(params["isTrident"])result="Trident (MSIE >= 11, like Gecko)";else if(params["isChromium"])result=
"CHROMIUM";result+=" on ";if(params["isIOS"])result+="iOS"+(iosVersion==7)?" 7":"";else if(params["isAndroid"])result+="Android";else if(params["isPlaybook"])result+="BlackBerry Playbook";else if(params["isChromeOS"])result+="Chrome OS";else if(params["isHPTablet"])result+="Web OS";else if(params["isMac"])result+="Mac";else if(params["isSymbian"])result+="Symbian";else result+="PC";return result};getInitizationData();touchableDetection();try{window.dispatchEvent(new CustomEvent("addStatusAPIVariables",
{"detail":[{"name":"supportH264","title":"Support H264","get":function(){return p.h264},"index":100},{"name":"isMobile","title":"Mobile","get":function(){return p.isMobile},"index":110},{"name":"isTouch","title":"Touch","get":function(){return p.isTouch},"index":120},{"name":"browserInfo","title":"Browser","get":function(){var binfo=[];if(p.isWindows)binfo.push("Windows");else if(p.isMac)binfo.push("Mac");if(p.isChrome)binfo.push("Chrome: "+p.chromeVersion);else if(p.isOpera)binfo.push("Opera");else if(p.isSafari)binfo.push("Safari");
else if(p.isSafari)binfo.push("Safari");else if(p.isMSIE)binfo.push("IE "+p.msieVersion);else if(p.isFirefox)binfo.push("Firefox");binfo=binfo.join(", ");return binfo},"index":130}]}))}catch(error){}}(function autoplayAudioSupported(callback){if(isFirefox())callback(false);else{var audioFile="data:audio/mpeg;base64,/+MYxAAAAANIAAAAAExBTUUzLjk4LjIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA";var audioElem=document.createElement("audio");audioElem.muted=true;audioElem.preload="auto";
audioElem.src=audioFile;var startPlayPromise=audioElem.play();if(!!startPlayPromise)startPlayPromise.then(function(){audioElem=null;callback(true)}).catch(function(error){audioElem=null;callback(false)});else callback(false)}})(response=>{apaSupported=response});function touchableDetection(){if(window.sessionStorage){let tempData=sessionStorage.getItem(_surface.key);if(tempData)try{tempData=JSON.parse(tempData);if(tempData.hasOwnProperty("isTouchable"))_surface.isTouchable=tempData.isTouchable}catch(error){}if(_surface.isTouchable||
p.isTouch)p.isTouch=true;else if(!p.isMobile){var waitForTouchDevice=function(){return new Promise(resolve=>{var _touchDetection=function(e){if(e?.sourceCapabilities?.firesTouchEvents===true){p.isTouch=true;window.sessionStorage.setItem(_surface.key,JSON.stringify({isTouchable:true}));window.removeEventListener("touchstart",_touchDetection,{passive:false});resolve()}};window.addEventListener("touchstart",_touchDetection,{passive:false})})};waitForTouchDevice().then(r=>{_surface.callbacks.forEach(fn=>
{try{fn()}catch(error){console.log(`Cannot execute callback: ${error.message||error}`)}});_surface.callbacks=null})}}}function detectTouch(callback){if(_surface.isTouchable===true)callback();else _surface.callbacks.push(callback)}function isFirefox(){var m=window.navigator.userAgent.match(/firefox/gi);return m&&m.length!=-1}function detectFirefox(userAgent,params){params["isFirefox"]=userAgent.indexOf("firefox")!=-1;params["firefoxVersion"]=0;if(/firefox[\/\s](\d+\.\d+)/.test(userAgent))params["firefoxVersion"]=
new Number(RegExp.$1)}function getOSVersion(userAgent){var osReg=new RegExp(/Windows NT [0-9]+.[0-9]+;/gi);var numReg=new RegExp(/[0-9]+/gi);var fgroup=userAgent.match(osReg);if(fgroup)try{var osnum=fgroup[0].match(numReg);if(osnum){osnum=parseInt(osnum[0],10);if(osnum<10)return 7;else return 10}}catch(error){}return"unknown"}function getMSIEBrowserVersion(userAgent){try{var tempVersion=/edge\/(([0-9]+).)*/.exec(userAgent)||0;return parseFloat(tempVersion[0].replace("edge/","").replace(/ /g,"").replace(/;/g,
""))}catch(error){return 0}}function detectIE(userAgent,params){var reg=/(msie) ([\w.]+)/.exec(userAgent);params["msieVersion"]=0;params["msieOSVersion"]="";params["msieHTMLVersion"]=0;params["isWindowsPhone"]=false;var ieTest=/(msie) ([0-9\.]+)/i.exec(userAgent);params["isMSIE"]=!!(ieTest&&ieTest[1]=="msie");if(params["isMSIE"])params["msieVersion"]=parseFloat(ieTest[2]);else if(userAgent.indexOf("trident")!=-1){ieTest=/rv:([0-9\.]+)/i.exec(userAgent);if(ieTest){params["isMSIE"]=true;params["msieVersion"]=
parseFloat(ieTest[1])}}else if(/(windows nt 10.0)/i.exec(userAgent)&&/(edge)/i.exec(userAgent)){params["isMSIE"]=true;params["msieVersion"]=12}else if(/(windows phone 10.0)/i.exec(userAgent)&&/(edge)/i.exec(userAgent)){params["isMSIE"]=true;params["msieVersion"]=12;params["isWindowsPhone"]=true}if(params.isMSIE)params.msieHTMLVersion=getMSIEBrowserVersion(userAgent);params["msieOSVersion"]=getOSVersion(userAgent)}function checkPolyfillObjectURL(){window.URL=window.URL||window.webkitURL;return window.URL?
true:false}function checkTypedArrays(){var result=false;if(!window.Uint32Array&&!window.Uint16Array&&!window.Uint8Array)return result;var test=null;var testU8=null;var testU16=null;var testU32=null;var i;try{test=new ArrayBuffer(16);testU8=new Uint8ClampedArray(test,8,8);testU16=new Uint16Array(test,8,4);testU32=new Uint32Array(test,8,2);for(i=0;i<testU8.length;++i)testU8[i]=171;for(i=0;i<testU16.length;++i)testU16[i]=43947;for(i=0;i<testU32.length;++i)testU32[i]=2880154539;result=true}catch(err){result=
false}finally{testU8=null;testU16=null;testU32=null;test=null}return result}function checkTransferableObjects(){var result;var workerScript;var objectUrl;var trArr;var trWork;try{if(!window.URL)throw"";workerScript=new Blob(["onmessage = function (oEvent) {}"],{type:"text/javascript"});objectUrl=window.URL.createObjectURL(workerScript);trArr=new ArrayBuffer(1);trWork=new Worker(objectUrl);trWork.postMessage(trArr,[trArr]);result=trArr.byteLength?false:true}catch(err){result=false}finally{trWork=null;
trArr=null;window.URL.revokeObjectURL(objectUrl)}return result}function checkAsmJsWorkersSupportAsync(scriptUrl,params){var worker;try{if(!params["hasTypedArrays"]||!_self.hasTransferableObjects)throw"";worker=new Worker(scriptUrl);worker.onmessage=function(oEvent){params["supportsAsmJsWorkers"]=true;params["supportsRFXDecoder"]=true;worker=null;callAsyncDetectionCallback("OnAsmJsWorkersTested")};worker.onerror=function(oEvent){params["supportsAsmJsWorkers"]=false;params["supportsRFXDecoder"]=false;
worker=null;callAsyncDetectionCallback("OnAsmJsWorkersTested")};worker.postMessage("test")}catch(err){params["supportsAsmJsWorkers"]=false;params["supportsRFXDecoder"]=false;worker=null;callAsyncDetectionCallback("OnAsmJsWorkersTested")}}function getIphoneModel(){var retModel={"name":"","resolution":"","majorVersion":0};try{var dpr=window.devicePixelRatio||1;var h=window.screen.height*dpr;var w=window.screen.width*dpr;if(w==320&&h==480)retModel={"name":["1","2g","3","3g","3gs"],"resolution":"320x480",
"majorVersion":3};else if(w==640&&h==960)retModel={"name":["4","4s"],"resolution":"640x960","majorVersion":4};else if(w==640&&h==1136)retModel={"name":["5","5s","5c"],"resolution":"640x1136","majorVersion":5};else if(w==750&&h==1334)retModel={"name":["6"],"resolution":"750x1134","majorVersion":6};else if(w==1080&&h==1920)retModel={"name":["6plus"],"resolution":"1080x1920","majorVersion":6}}catch(error){}return retModel}function getBrowserInfo(userAgent){var params={};if(typeof userAgent!="string")userAgent=
navigator.userAgent;params["agentStr"]=userAgent=userAgent.toLowerCase();var isTrident=userAgent.indexOf("trident")!=-1;params["protocol"]=document.location.protocol=="https:"?"https":"http";params["majorVersion"]=parseInt(navigator.appVersion,10);params["isWindows"]=userAgent.indexOf("windows")!=-1;params["isMac"]=userAgent.indexOf("macintosh")!=-1;params["isLinux"]=userAgent.indexOf("linux")!=-1;params["isIOS"]=(userAgent.indexOf("iphone")!=-1||userAgent.indexOf("ipod")!=-1||userAgent.indexOf("ipad")!=
-1||navigator.platform==="MacIntel"&&navigator.maxTouchPoints>1)&&!isTrident;params["iosVersion"]=params["isIOS"]?/os (([0-9]+)_)*./.exec(userAgent)||0:0;if(params["iosVersion"]!=0)try{params["iosBuildVersion"]=params["iosVersion"][0].replace("os","").replace(/_/g,".").replace(/ /g,"");var tempIosVersion=params["iosVersion"][0].replace("os","").replace(/ /g,"");if(tempIosVersion.indexOf("_")!=-1)tempIosVersion=parseInt(tempIosVersion.substring(0,tempIosVersion.indexOf("_")),10);params["iosVersion"]=
tempIosVersion}catch(error){params["iosVersion"]=params["iosBuildVersion"]=params["iosVersion"][params["iosVersion"].length-1]}params["ipadModel"]=0;if(params["isIOS"])try{var ipadModel=1;if(window.ondevicemotion)window.ondevicemotion=function(e){if(event.acceleration)ipadModel+=window.devicePixelRatio;params["ipadModel"]=ipadModel;window.ondevicemotion=null};else params.ipadModel="pro"}catch(error){params["ipadModel"]=0}params["isIphone"]=(userAgent.indexOf("iphone")!=-1||userAgent.indexOf("ipod")!=
-1)&&!isTrident;if(params["isIphone"]==true)params["iphoneModel"]=getIphoneModel();params["isIpod"]=userAgent.indexOf("ipod")!=-1;params["isAndroid"]=userAgent.indexOf("android")!=-1&&!isTrident;params["isHPTablet"]=userAgent.indexOf("hp-tablet")!=-1;params["isPlaybook"]=userAgent.indexOf("playbook")!=-1;params["isChromeOS"]=userAgent.indexOf(" cros ")!=-1;if(params["isChromeOS"]==true)try{var tempChromeVersion=/android (([0-9]+).)*./.exec(userAgent)||0;params["chromeOSVersion"]=tempChromeVersion[0].replace("android",
"").replace(/ /g,"").replace(/;/g,"")}catch(error){params["chromeOSVersion"]="0"}else params["chromeOSVersion"]="0";params["isYandex"]=userAgent.indexOf("yabrowser")!=-1;detectIE(userAgent,params);params["isSymbian"]=userAgent.indexOf("symbian")!=-1;params["isWindowMobile"]=userAgent.indexOf("iemobile")!=-1||userAgent.indexOf("windows phone")!=-1;params["isOpera"]=userAgent.indexOf("opera")!=-1||userAgent.indexOf("opr/")!=-1;params["isChrome"]=!params["isOpera"]&&(userAgent.indexOf("chrome")!=-1||
userAgent.indexOf("crios")!=-1)&&params["isMSIE"]==false;params["isChromium"]=false;if(params["isChrome"])try{var getChromeVersion=function(){var tempChromeVersion=/chrome\/(([0-9]+).)*/.exec(userAgent)||0;return tempChromeVersion[0].replace("chrome/","").replace(/ /g,"").replace(/;/g,"")};var getCriosVersion=function(){var tempChromeVersion=/crios\/(([0-9]+).)*/.exec(userAgent)||0;return params["chromeVersion"]=tempChromeVersion[0].replace("crios/","").replace(/ /g,"").replace(/;/g,"")};var tempChromeVersion=
"";if(params["isIOS"]){tempChromeVersion=/crios\/(([0-9]+).)*/.exec(userAgent)||0;if(tempChromeVersion){params.isChrome=true;params.isSafari=false;params["chromeVersion"]=getCriosVersion()}else{params.isIOS=false;params.isSafari=false;params["chromeVersion"]=getChromeVersion()}}else{tempChromeVersion=/chrome\/(([0-9]+).)*/.exec(userAgent)||0;if(tempChromeVersion){params.isChrome=true;params.isSafari=false;params["chromeVersion"]=getChromeVersion()}else{params.isIOS=false;params.isSafari=false}}}catch(error){params["chromeVersion"]=
"0"}else params["chromeVersion"]="0";params["isDragon"]=userAgent.indexOf("dragon")!=-1&&params["isChrome"]==true;if(params["isDragon"])try{var tempDragonVersion=/dragon\/(([0-9]+).)*/.exec(userAgent)||0;params["dragonVersion"]=tempDragonVersion[0].replace("dragon/","").replace(/ /g,"").replace(/;/g,"")}catch(error){params["dragonVersion"]="0"}else params["dragonVersion"]="0";params["isNokiaBrowser"]=userAgent.indexOf("nokiabrowser")!=-1;detectFirefox(userAgent,params);params["isSafari"]=!(params["isNokiaBrowser"]||
params["isChrome"]||params["isOpera"]||params["isFirefox"]||params["isMSIE"])&&(userAgent.indexOf("safari")!=-1||params["isIOS"]);if(params["isSafari"]&&params["isAndroid"]){params["isSafari"]=false;params["isChromium"]=true}if(params.isMSIE&&params.msieVersion>=11&&params.isWindows){params.isIOS=false;params.isAndroid=false;params.isSafari=false;params.isChrome=false;params.isFirefox=false}params["isMobile"]=!params["isChromeOS"]&&(params["isIOS"]||params["isAndroid"]||params["isHPTablet"]||params["isPlaybook"]||
params["isSymbian"]||params["isWindowMobile"]);params["isTouch"]=!!("ontouchstart"in window)||navigator.pointerEnabled&&navigator.maxTouchPoints>0||navigator.msPointerEnabled&&navigator.msMaxTouchPoints>0||false;params["hasObjectURL"]=checkPolyfillObjectURL();params["hasArrayBuffers"]=!!window.ArrayBuffer;params["hasTypedArrays"]=params["hasArrayBuffers"]?checkTypedArrays():false;params["hasWorkers"]=!!window.Worker;params["hasTransferableObjects"]=null;window.requestAnimationFrame=window.requestAnimationFrame||
window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.msRequestAnimationFrame||function(callback){setTimeout(callback,0)};params["supportsAsmJsWorkers"]=false;params["supportsRFXDecoder"]=false;if(params["isWindowsPhone"]==true){params["isAndroid"]=false;params["isChromium"]=false;params["isChromeOS"]=false;params["chromeVersion"]="0"}params["isTabletMode"]=false;params["timeZone"]=-(new Date).getTimezoneOffset()/60;params["h264"]=!(params.isMSIE&&params.msieVersion<15);params["gfx"]=
!(params.isMSIE&&params.msieVersion<15)&&!params["isSafari"];return params}function supportsFullScreen(element){var response=false;if(element==null||element==undefined)element=document.documentElement;if(element){if(element.requestFullscreen)response=true;else if(element.mozRequestFullScreen)response=true;else if(element.webkitRequestFullscreen)response=true;else if(element.msRequestFullscreen)response=true;if(response&&!(p.isMac&&(p.isOpera||p.isChrome)||p.isChrome))response=window.top===(typeof element.defaultView!=
"undefined"?element.defaultView:typeof element.ownerDocument!="undefined"&&typeof element.ownerDocument.defaultView!="undefined"?element.ownerDocument.defaultView:window)}return response}function callAsyncDetectionCallback(event){if(asyncCallbacks.hasOwnProperty(event)){var callbacks=asyncCallbacks[event];for(var i=0;i<callbacks.length;++i)callbacks[i].callback.apply(callbacks[i].self)}}function addAsyncDetectionCallback(event,self,callback){if(!asyncCallbacks.hasOwnProperty(event))asyncCallbacks[event]=
[];asyncCallbacks[event].push({self:self,callback:callback})}function runAsyncDetections(){checkAsmJsWorkersSupportAsync("common/workers/test.js",p)}function supportHTML5(){try{var canvas=document.createElement("canvas");return typeof canvas.getContext!="undefined"?true:false}catch(error){return false}}function updateProperty(){if(arguments&&arguments.length>0)for(var key in arguments[0])if(p[key]!=undefined){console.log(`Forcing property value - ${key}:${arguments[0][key]}`);p[key]=arguments[0][key]}}
function getInitizationData(){if(window.Thinfinity&&window.Thinfinity.InitializationData){var data=window.Thinfinity.InitializationData.get("AGENTINFO");if(data)updateProperty(data)}}function setInitializationData(data){if(window.Thinfinity&&window.Thinfinity.InitializationData){window.Thinfinity.InitializationData.update("AGENTINFO",data);updateProperty(data)}}function getTransferableObjects(){if(p["hasTransferableObjects"]!=null)return p["hasTransferableObjects"];else{p["hasTransferableObjects"]=
p["hasWorkers"]?checkTransferableObjects():false;return p["hasTransferableObjects"]}}function compareVersions(versionA,versionB){var result=0;if(versionA!=versionB){var aVA=versionA.split(".");var aVB=versionB.split(".");var m=Math.min(aVA.length,aVB.length);var i=0;while(result==0&&i<m){result=parseInt(aVA[i],10)-parseInt(aVB[i],10);i++}if(result==0)if(m<aVB.length)result=-1;else if(m<aVA.length)result=1}return result}function isNewerThan(versionA,versionB){return compareVersions(versionA,versionB)>
0}function isOlderThan(versionA,versionB){return compareVersions(versionA,versionB)<0}function isSameVersion(versionA,versionB){return compareVersions(versionA,versionB)==0}function getBrowserName(){return p["isChrome"]?"chrome":p["isMSIE"]?"edge":p["isFirefox"]?"firefox":p["isOpera"]?"opera":p["isSafari"]?"safari":p["isDragon"]?"dragon":p["isSymbian"]?"symbian":p["isChromium"]?"android":"unknown"}function supportOggFormat(callback){let checkOgg=()=>{return new Promise(resolve=>{try{let audioCtx=
new AudioContext;let chunk=[79,103,103,83,0,2,0,0,0,0,0,0,0,0,26,50,0,0,0,0,0,0,253,79,48,95,1,19,79,112,117,115,72,101,97,100,1,2,56,1,68,172,0,0,0,0,0,79,103,103,83,0,0,0,0,0,0,0,0,0,0,26,50,0,0,1,0,0,0,101,92,227,247,1,51,79,112,117,115,84,97,103,115,35,0,0,0,108,105,98,111,112,117,115,32,117,110,107,110,111,119,110,44,32,108,105,98,111,112,117,115,101,110,99,32,117,110,107,110,111,119,110,0,0,0,0,79,103,103,83,0,4,245,37,0,0,0,0,0,0,26,50,0,0,2,0,0,0,167,37,66,36,14,255,144,241,237,233,235,241,
233,230,255,111,230,255,158,252,127,12,20,204,98,190,27,223,60,146,131,102,2,15,67,177,166,86,254,172,19,81,160,245,25,129,89,47,50,163,219,19,109,120,142,210,182,207,246,96,150,241,199,58,105,62,202,178,179,170,86,30,188,185,17,125,250,117,60,173,73,126,157,36,135,211,204,180,173,211,208,122,17,193,32,51,107,80,2,34,51,119,59,119,122,228,213,149,184,223,154,232,140,57,182,203,52,207,211,36,98,208,10,24,250,149,166,251,147,123,156,163,173,143,250,145,224,120,23,125,163,194,207,224,192,202,60,103,
42,44,254,187,54,251,212,135,145,105,136,31,138,157,19,34,160,226,180,201,223,78,96,54,7,249,255,203,49,105,182,182,227,80,120,30,161,20,0,0,0,1,244,148,122,129,74,111,98,98,85,129,123,61,74,124,255,58,194,191,58,194,183,89,45,128,75,96,0,2,208,1,30,72,209,111,46,227,119,148,51,34,19,209,3,214,235,0,191,149,3,214,235,55,120,147,57,153,131,41,216,133,47,110,252,30,102,202,17,96,192,212,74,97,193,185,149,214,165,55,204,141,161,39,104,96,131,64,197,153,0,109,233,199,117,124,93,47,177,243,68,148,182,
182,43,232,172,62,79,64,103,124,59,16,176,139,36,116,143,10,233,116,192,152,166,143,138,30,14,114,190,123,33,196,102,217,98,212,101,134,196,141,110,118,204,91,173,171,117,146,22,179,162,139,248,0,164,124,99,112,66,94,122,216,1,59,239,84,22,187,179,205,107,221,59,195,94,43,229,106,122,130,205,203,197,229,216,150,12,0,54,121,110,118,234,14,145,117,155,220,93,226,115,230,100,69,147,31,164,71,109,96,182,38,45,17,124,179,250,89,128,21,231,11,68,164,87,1,82,7,252,101,151,201,103,98,50,196,172,95,172,137,
244,140,185,12,251,106,121,57,240,172,205,112,121,55,113,123,117,114,14,246,44,246,80,110,187,121,212,147,237,241,69,46,235,178,140,192,114,121,219,97,150,55,23,151,4,19,37,221,162,241,61,214,150,232,163,86,135,190,154,29,191,84,40,136,48,81,232,230,206,213,92,99,105,182,199,80,230,91,49,85,148,56,51,176,67,233,100,20,152,213,3,194,183,146,123,49,23,37,51,223,66,43,116,115,57,11,16,159,43,198,68,239,150,143,76,54,72,36,151,188,185,201,243,25,74,132,117,71,202,195,63,131,194,48,50,155,61,136,31,247,
56,18,115,168,185,134,226,172,72,246,95,76,122,39,70,231,227,240,139,51,142,65,27,172,31,127,26,249,69,186,117,31,134,51,185,45,156,37,81,149,93,90,145,164,18,197,255,189,61,219,209,159,198,123,70,168,110,107,55,49,69,2,145,2,54,105,13,77,53,59,233,160,247,10,184,137,144,157,27,184,33,242,229,145,106,155,166,123,149,252,38,119,8,151,118,97,60,197,181,145,118,161,103,159,136,110,183,175,184,61,238,153,244,76,74,102,163,131,108,1,86,11,0,34,130,169,169,103,192,103,90,100,153,238,171,117,44,143,177,
252,6,14,193,55,13,24,140,103,2,252,205,240,15,204,12,174,97,179,126,240,140,76,251,90,229,42,205,20,183,121,43,250,243,148,162,226,230,127,110,202,103,62,84,198,232,113,45,3,185,90,52,180,220,120,20,123,231,143,102,132,221,227,46,11,221,92,73,71,207,133,131,128,108,39,45,205,14,68,70,83,178,18,26,232,179,88,43,29,39,175,76,153,80,31,221,61,228,239,130,217,80,157,95,149,43,230,177,106,69,153,0,54,129,100,65,23,60,6,5,156,187,33,183,107,89,142,117,165,31,198,138,24,134,177,177,79,130,139,181,20,106,
195,13,6,48,183,205,179,81,124,3,217,236,124,255,20,87,9,235,73,59,248,226,54,59,126,110,190,126,88,4,64,155,85,254,70,122,234,122,185,239,144,58,75,144,234,252,40,103,44,173,139,243,37,30,197,11,208,244,201,78,57,181,34,58,66,91,165,70,64,196,34,184,32,243,173,104,63,51,109,186,218,178,226,79,176,10,183,19,52,247,113,211,140,239,52,244,33,154,168,83,172,166,222,82,223,108,166,207,68,109,11,193,128,141,218,147,36,180,69,173,15,193,112,36,86,48,198,241,67,246,134,17,195,246,35,125,42,247,80,142,127,
67,146,2,204,117,227,203,160,208,164,141,226,73,131,203,89,215,80,206,22,64,116,155,137,197,119,87,161,46,235,231,82,13,34,234,228,38,36,87,38,128,236,101,183,25,108,53,79,248,133,242,140,107,88,86,134,80,66,142,109,53,219,109,14,186,81,42,117,47,82,243,50,54,15,170,90,56,21,199,82,16,161,241,123,72,63,62,163,209,12,31,212,150,210,215,178,241,71,151,143,179,155,102,109,228,230,244,8,18,22,3,155,197,62,212,148,68,154,244,10,193,22,55,170,207,168,185,21,247,110,197,218,207,242,149,240,249,252,37,177,
219,167,13,34,187,105,57,130,73,87,49,150,29,217,251,190,247,255,45,237,202,156,26,231,13,114,170,231,116,139,117,34,252,122,95,146,78,177,167,231,24,42,55,50,9,201,224,173,201,153,204,5,219,147,104,132,124,52,219,74,43,212,159,1,133,74,12,85,195,232,231,16,59,190,98,1,38,222,164,52,113,31,42,114,164,222,154,74,242,83,188,163,162,135,59,127,5,217,90,27,91,124,33,248,239,98,58,218,127,220,136,110,10,42,73,102,64,136,249,116,68,153,103,4,165,210,111,143,119,75,182,97,70,93,171,221,238,231,202,111,160,
111,35,126,254,88,190,125,160,69,85,223,230,225,180,189,57,32,75,148,91,58,163,14,73,51,254,2,14,203,168,109,141,29,225,52,108,13,52,54,155,172,191,153,125,225,190,93,114,36,205,35,48,60,144,215,202,204,57,18,118,14,147,161,143,250,45,143,65,224,84,216,197,96,210,10,160,52,230,209,109,39,45,143,132,126,114,74,7,31,45,60,252,46,164,87,128,38,225,187,169,63,243,221,220,205,167,103,27,124,115,184,21,55,115,9,104,162,39,189,176,22,175,89,189,148,187,215,107,84,90,202,96,131,199,111,39,240,230,122,137,
238,212,15,81,108,118,198,133,91,18,173,171,194,116,15,160,216,183,167,172,194,114,23,77,12,35,252,66,192,98,21,37,29,73,204,83,118,198,102,166,91,251,66,117,97,61,99,143,7,122,149,189,148,253,25,208,151,150,243,6,100,162,152,176,5,48,164,119,86,58,245,188,191,183,200,22,172,239,95,114,138,173,251,199,248,157,90,192,93,89,206,229,84,82,30,98,19,18,42,202,29,25,67,54,159,146,188,236,148,60,203,55,58,66,217,113,253,79,13,35,253,91,16,44,172,36,2,68,183,244,69,53,110,61,228,149,12,101,61,86,211,122,
152,68,69,145,7,208,57,93,91,31,14,142,163,8,156,22,154,142,187,80,192,100,221,184,249,185,221,133,74,153,67,105,189,186,185,71,82,216,226,52,69,238,44,106,34,236,199,68,141,131,252,47,9,213,11,17,31,234,115,186,222,147,77,196,1,20,144,89,226,207,65,128,12,138,213,175,85,7,180,28,136,198,216,55,103,59,153,110,195,193,202,20,207,134,44,128,190,3,83,166,125,130,68,218,106,38,193,95,81,156,99,85,107,98,64,2,211,235,176,1,12,218,141,40,150,220,170,57,94,8,152,53,103,130,141,102,224,130,59,206,3,235,14,
113,74,193,197,94,27,181,221,167,150,81,193,14,212,232,101,104,157,4,81,119,11,93,45,61,71,223,11,119,162,156,228,63,156,110,148,177,85,23,17,42,67,142,58,118,112,199,215,24,54,251,43,175,137,161,32,161,38,78,231,249,136,68,235,249,180,77,33,156,93,173,217,26,1,118,224,21,60,169,159,66,169,87,192,50,254,4,228,152,169,23,180,10,164,178,30,164,3,243,173,244,55,40,116,202,182,116,100,72,55,138,241,235,49,128,145,104,26,254,141,101,16,125,54,239,45,0,103,215,218,31,158,215,97,104,87,45,146,18,164,252,
46,0,101,234,211,183,62,130,57,238,51,209,85,67,128,33,10,167,149,176,189,237,244,99,28,6,121,119,183,32,108,88,245,165,153,181,153,51,71,142,71,9,254,24,204,95,196,3,34,188,225,84,206,7,157,159,242,174,188,170,39,240,133,52,129,88,151,44,11,187,239,245,192,18,57,182,161,133,110,12,178,128,144,89,47,206,243,222,2,181,137,29,228,181,133,20,98,135,210,56,218,162,123,139,111,230,228,247,76,252,228,136,149,129,131,122,162,43,132,165,118,77,140,168,89,122,250,225,65,90,60,4,213,71,237,205,210,26,28,95,
200,94,132,72,92,199,126,37,136,87,152,226,172,36,201,191,110,86,50,81,47,120,59,16,239,108,46,205,194,93,52,186,95,147,174,128,220,217,105,108,121,193,48,136,206,71,204,66,41,138,178,222,215,79,118,140,0,211,58,124,81,11,172,174,187,101,221,124,8,153,242,136,5,118,42,243,208,188,71,30,65,251,218,131,101,220,112,41,115,252,123,16,18,142,20,151,239,200,161,5,196,168,112,249,82,169,130,132,202,135,92,139,251,183,70,215,34,226,65,223,212,213,179,64,131,213,250,216,43,171,150,142,239,108,66,194,246,48,
69,195,166,24,197,224,63,195,5,132,131,214,218,65,5,146,98,195,112,121,192,145,72,229,193,182,53,210,7,12,139,143,19,184,151,117,4,234,212,36,199,100,106,187,168,212,115,48,201,239,33,29,26,162,94,117,137,84,143,238,144,66,142,98,58,93,26,107,90,79,113,171,146,158,1,153,111,48,232,126,120,114,61,159,191,106,154,157,96,31,42,60,238,188,203,88,125,154,239,97,228,120,220,241,123,235,22,13,220,205,19,30,15,6,28,22,183,3,162,191,200,195,184,187,45,32,173,180,77,168,212,79,102,50,219,27,163,123,144,24,
159,103,219,188,46,143,193,254,38,63,214,137,122,213,196,137,150,245,153,179,28,192,211,251,96,189,109,178,132,117,42,171,74,154,52,219,86,12,55,5,2,104,233,229,132,1,86,57,143,55,83,23,178,187,254,245,145,51,179,59,197,118,49,14,253,189,219,135,37,5,212,84,240,53,195,147,88,233,45,252,237,3,66,200,165,255,189,214,71,44,75,18,92,222,194,51,169,62,216,113,47,205,166,12,163,100,48,104,75,19,83,64,204,83,149,194,229,93,223,65,104,147,59,158,254,203,9,62,15,107,42,92,117,149,128,51,205,11,64,206,187,
145,23,126,41,65,25,52,165,152,139,26,81,72,107,223,223,242,122,115,111,52,220,27,84,55,141,92,36,146,136,97,237,196,168,69,217,252,1,18,158,161,218,100,186,252,112,152,148,116,30,118,133,8,19,138,136,50,109,180,225,221,171,138,140,219,194,53,216,152,237,58,114,57,229,39,122,170,168,222,46,144,55,199,30,234,6,104,86,64,18,42,111,80,207,57,64,129,234,56,237,117,138,130,110,141,39,137,4,247,52,96,244,134,213,135,140,218,54,183,195,243,179,113,29,191,92,164,183,88,197,60,35,214,3,250,149,205,165,204,
225,46,78,40,73,140,172,237,47,100,173,190,91,223,153,191,51,195,26,216,89,96,130,128,185,188,248,244,201,200,104,240,102,108,127,66,99,252,236,110,251,25,95,24,56,98,14,214,59,187,86,208,197,42,209,229,146,232,66,41,110,113,70,4,253,7,12,91,77,148,216,255,143,24,185,34,65,159,146,201,102,177,177,142,179,41,10,206,251,72,186,196,24,168,77,134,146,242,141,78,238,183,67,137,11,223,163,196,28,202,50,87,39,1,169,80,58,139,27,84,17,89,200,179,56,36,116,252,114,165,6,179,6,71,137,123,67,7,148,163,133,82,
23,107,43,58,198,65,72,174,130,245,38,3,254,68,169,70,116,99,149,186,84,114,147,213,100,103,222,56,189,156,225,96,58,156,0,17,86,213,8,134,46,136,30,11,11,247,97,229,80,0,12,226,247,49,102,152,8,183,31,4,151,11,188,3,11,27,5,19,184,6,190,213,104,188,0,0,7,65,195,30,60,0,0,223,109,64,130,237,214,14,160,176,40,27,216,147,27,9,68,165,25,73,146,192,72,249,89,190,220,55,61,146,249,212,81,61,64,162,97,161,102,79,186,150,13,37,121,24,189,69,247,56,202,2,217,206,0,99,86,203,165,149,53,174,201,202,97,113,
32,107,121,77,196,192,220,62,146,75,38,210,88,35,210,226,150,186,27,238,84,82,247,52,113,63,254,158,156,69,244,95,139,53,75,133,21,198,31,199,92,44,187,3,32,2,140,106,179,80,119,149,201,194,55,184,167,183,20,50,194,81,62,181,146,157,140,71,120,8,43,173,184,74,116,148,116,108,246,12,70,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,7,13,6,137,177,239,236,22,3,42,144,166,108,232,130,10,93,18,206,254,91,121,192,138,188,92,92,122,195,226,212,169,31,
80,106,16,4,149,101,83,203,7,200,64,216,252,84,87,224,52,63,5,67,56,252,142,223,73,194,52,119,31,134,214,12,196,135,1,136,3,131,169,176,171,247,16,0,0,0,0,0,0,0,5,42,130,161,75,5,183,162,118,19,150,78,89,249,239,152,208,143,151,199,114,90,242,137,175,148,247,102,96,66,224,163,67,83,165,204];let ab=new ArrayBuffer(chunk.length*Uint8Array.BYTES_PER_ELEMENT);let view=new Uint8Array(ab);chunk.forEach((elem,idx)=>{view[idx]=elem});view=null;audioCtx.decodeAudioData(ab,()=>{resolve(true)},()=>{resolve(false)})}catch(err){resolve(false)}})};
if(window.localStorage){let tempData=localStorage.getItem(_ogg.key);if(tempData)try{tempData=JSON.parse(tempData);if(tempData.hasOwnProperty("supportOgg"))_ogg.supportOgg=tempData.supportOgg;callback(_ogg.supportOgg)}catch(error){}else checkOgg().then(res=>{localStorage.setItem(_ogg.key,JSON.stringify({supportOgg:res}));callback(res)})}else checkOgg().then(res=>{callback(res)})}initialize();Object.defineProperty(this,"gfx",{enumerable:true,"configurable":false,"value":p["gfx"]});Object.defineProperty(this,
"h264",{enumerable:true,"configurable":false,"value":p["h264"]});Object.defineProperty(this,"agentStr",{enumerable:true,"configurable":false,"value":p["agentStr"]});Object.defineProperty(this,"protocol",{enumerable:true,"configurable":false,"get":function(){return p["protocol"]}});Object.defineProperty(this,"majorVersion",{enumerable:true,"configurable":false,"value":p["majorVersion"]});Object.defineProperty(this,"isWindows",{enumerable:true,"configurable":false,"value":p["isWindows"]});Object.defineProperty(this,
"isMac",{enumerable:true,"configurable":false,"value":p["isMac"]});Object.defineProperty(this,"isIOS",{enumerable:true,"configurable":false,"value":p["isIOS"]});Object.defineProperty(this,"iosVersion",{enumerable:true,"configurable":false,"value":p["iosVersion"]});Object.defineProperty(this,"ipadModel",{enumerable:true,"configurable":false,"get":function(){return p["ipadModel"]}});Object.defineProperty(this,"iosBuildVersion",{enumerable:true,"configurable":false,"value":p["iosBuildVersion"]});Object.defineProperty(this,
"isIphone",{enumerable:true,"configurable":false,"value":p["isIphone"]});if(p["isIphone"]==true)Object.defineProperty(this,"iphoneModel",{enumerable:true,"configurable":false,"value":p["iphoneModel"]});Object.defineProperty(this,"isIpod",{enumerable:true,"configurable":false,"value":p["isIpod"]});Object.defineProperty(this,"isAndroid",{enumerable:true,"configurable":false,"value":p["isAndroid"]});Object.defineProperty(this,"isHPTablet",{enumerable:true,"configurable":false,"value":p["isHPTablet"]});
Object.defineProperty(this,"isPlaybook",{enumerable:true,"configurable":false,"value":p["isPlaybook"]});Object.defineProperty(this,"isChromeOS",{enumerable:true,"configurable":false,"value":p["isChromeOS"]});Object.defineProperty(this,"chromeOSVersion",{enumerable:true,"configurable":false,"value":p["chromeOSVersion"]});Object.defineProperty(this,"isSymbian",{enumerable:true,"configurable":false,"value":p["isSymbian"]});Object.defineProperty(this,"isFirefox",{enumerable:true,"configurable":false,
"value":p["isFirefox"]});Object.defineProperty(this,"isOpera",{enumerable:true,"configurable":false,"value":p["isOpera"]});Object.defineProperty(this,"isChrome",{enumerable:true,"configurable":false,"value":p["isChrome"]});Object.defineProperty(this,"chromeVersion",{enumerable:true,"configurable":false,"value":p["chromeVersion"]});Object.defineProperty(this,"isNokiaBrowser",{enumerable:true,"configurable":false,"value":p["isNokiaBrowser"]});Object.defineProperty(this,"isSafari",{enumerable:true,"configurable":false,
"value":p["isSafari"]});Object.defineProperty(this,"isMSIE",{enumerable:true,"configurable":false,"value":p["isMSIE"]});Object.defineProperty(this,"isYandex",{enumerable:true,"configurable":false,"value":p["isYandex"]});Object.defineProperty(this,"isDragon",{enumerable:true,"configurable":false,"value":p["isDragon"]});Object.defineProperty(this,"dragonVersion",{enumerable:true,"configurable":false,"value":p["dragonVersion"]});Object.defineProperty(this,"isChromium",{enumerable:true,"configurable":false,
"value":p["isChromium"]});Object.defineProperty(this,"msieVersion",{enumerable:true,"configurable":false,"value":p["msieVersion"]});Object.defineProperty(this,"msieOSVersion",{enumerable:true,"configurable":false,"value":p["msieOSVersion"]});Object.defineProperty(this,"msieHTMLVersion",{enumerable:true,"configurable":false,"value":p["msieHTMLVersion"]});Object.defineProperty(this,"browserName",{enumerable:true,"configurable":false,"get":getBrowserName});Object.defineProperty(this,"firefoxVersion",
{enumerable:true,"configurable":false,"value":p["firefoxVersion"]});Object.defineProperty(this,"isWindowsPhone",{enumerable:true,"configurable":false,"value":p["isWindowsPhone"]});Object.defineProperty(this,"isMobile",{enumerable:true,"configurable":false,"get":function(){return p["isMobile"]}});Object.defineProperty(this,"isTouch",{enumerable:true,"configurable":false,"get":function(){return p["isTouch"]}});Object.defineProperty(this,"getAgentKey",{enumerable:true,"configurable":false,"value":getAgentKey});
Object.defineProperty(this,"browserFromAgent",{enumerable:true,"configurable":false,"value":browserFromAgent});Object.defineProperty(this,"hasObjectURL",{enumerable:true,"configurable":false,"value":p["hasObjectURL"]});Object.defineProperty(this,"hasArrayBuffers",{enumerable:true,"configurable":false,"value":p["hasArrayBuffers"]});Object.defineProperty(this,"hasTypedArrays",{enumerable:true,"configurable":false,"value":p["hasTypedArrays"]});Object.defineProperty(this,"hasWorkers",{enumerable:true,
"configurable":false,"value":p["hasWorkers"]});Object.defineProperty(this,"hasTransferableObjects",{enumerable:true,"configurable":false,"get":function(){return getTransferableObjects()}});Object.defineProperty(this,"supportsAsmJsWorkers",{enumerable:true,"configurable":false,"get":function(){return p["supportsAsmJsWorkers"]}});Object.defineProperty(this,"supportsRFXDecoder",{enumerable:true,"configurable":false,"get":function(){return p["supportsRFXDecoder"]}});Object.defineProperty(this,"supportsFullScreen",
{enumerable:true,"configurable":false,"value":supportsFullScreen});Object.defineProperty(this,"addAsyncDetectionCallback",{enumerable:true,"configurable":false,"value":addAsyncDetectionCallback});Object.defineProperty(this,"runAsyncDetections",{enumerable:true,"configurable":false,"value":runAsyncDetections});Object.defineProperty(this,"supportHTML5",{enumerable:true,"configurable":false,"get":function(){return supportHTML5()}});Object.defineProperty(this,"supportAudioAutoPlay",{enumerable:true,"configurable":false,
"get":function(){return apaSupported}});Object.defineProperty(this,"detectTouch",{enumerable:true,"configurable":false,writable:false,"value":detectTouch});Object.defineProperty(this,"isTabletMode",{enumerable:true,"configurable":false,"get":function(){return p["isTabletMode"]}});Object.defineProperty(this,"timeZone",{enumerable:true,"configurable":false,"get":function(){return p["timeZone"]}});Object.defineProperty(this,"compareVersions",{enumerable:true,"configurable":false,"value":compareVersions});
Object.defineProperty(this,"isOlderThan",{enumerable:true,"configurable":false,"value":isOlderThan});Object.defineProperty(this,"isNewerThan",{enumerable:true,"configurable":false,"value":isNewerThan});Object.defineProperty(this,"isSameVersion",{enumerable:true,"configurable":false,"value":isSameVersion});Object.defineProperty(this,"supportOggFormat",{enumerable:true,"configurable":false,"value":supportOggFormat});Object.defineProperty(this,"__setInitializationData__",{enumerable:true,"configurable":false,
"writable":false,"value":setInitializationData});return this}var agentInfo=null;try{agentInfo=new AgentInfo}catch(error){}if(typeof agentInfo=="undefined"||agentInfo==null){agentInfo=new Object;agentInfo["supportHTML5"]=false}
function Helper(){var GLOBAL_VAR={console:{logDebug:false,logWarning:true,logInfo:true,logError:true,logException:true,logFatal:true},"class":{"name":"help","privateREF#":null,"ref#":null}};var _plugins={};function initialize(assignElem){try{if(GLOBAL_VAR.console.logDebug)if(window.console!=undefined&&window.console.log!=undefined)window.console.log("Initializing "+GLOBAL_VAR["class"]["name"]+" class. - "+(new Date).toString());GLOBAL_VAR["class"]["privateREF#"]=assignElem;var ajax=new Ajax;var color=
new Color;var console=new Console;var dom=new Dom;var object=new ObjectExtend;var datetime=new Datetime;var dictionary=new Dictionary;var polyfills=new Polyfills;var printObject=new Printer;var size=new Size;var storage=new Storage;var string=new StringExtend;var style=new Style;var url=new URL;var utils=new Utils;new WebSocketObject(assignElem);Object.defineProperty(assignElem,"ajax",{"enumerable":true,"configurable":false,"get":function(){return ajax}});Object.defineProperty(assignElem,"color",
{"enumerable":true,"configurable":false,"get":function(){return color}});Object.defineProperty(assignElem,"console",{"enumerable":true,"configurable":false,"get":function(){return console}});Object.defineProperty(assignElem,"dom",{"enumerable":true,"configurable":false,"get":function(){return dom}});Object.defineProperty(assignElem,"object",{"enumerable":true,"configurable":false,"get":function(){return object}});Object.defineProperty(assignElem,"datetime",{"enumerable":true,"configurable":false,
"get":function(){return datetime}});Object.defineProperty(assignElem,"dictionary",{"enumerable":true,"configurable":false,"get":function(){return dictionary}});Object.defineProperty(assignElem,"printer",{"enumerable":true,"configurable":false,"get":function(){return printObject}});Object.defineProperty(assignElem,"url",{"enumerable":true,"configurable":false,"get":function(){return url}});Object.defineProperty(assignElem,"size",{"enumerable":true,"configurable":false,"get":function(){return size}});
Object.defineProperty(assignElem,"storage",{"enumerable":true,"configurable":false,"get":function(){return storage}});Object.defineProperty(assignElem,"string",{"enumerable":true,"configurable":false,"get":function(){return string}});Object.defineProperty(assignElem,"style",{"enumerable":true,"configurable":false,"get":function(){return style}});Object.defineProperty(assignElem,"utils",{"enumerable":true,"configurable":false,"get":function(){return utils}});Object.defineProperty(assignElem,"registerPlugin",
{"enumerable":true,"configurable":false,"writable":false,"value":registerPlugin});Object.defineProperty(assignElem,"unregisterPlugin",{"enumerable":true,"configurable":false,"writable":false,"value":unregisterPlugin});if(GLOBAL_VAR.console.logDebug)if(window.console!=undefined&&window.console.log!=undefined)window.console.log(GLOBAL_VAR["class"]["name"]+" class was Initialized. - "+(new Date).toString())}catch(error){genericLog(error,arguments)}}function getFunctionName(args){try{var fName="";if(args!=
null&&args!=undefined&&args.callee!=undefined){var calleeName=args.callee&&args.callee.name?args.callee.name:"[anonymous]";var callerName=args.callee&&args.callee.caller&&args.callee.caller.name?args.callee.caller.name:"[anonymous]";fName=calleeName+" from "+callerName}return fName}catch(error){return"[unknown]"}}function genericLog(error){if(typeof window["console"]!="undefined"){function convertMessageToString(message){try{var retMsg=GLOBAL_VAR["class"]["privateREF#"]["datetime"].getFormattedDatetime(new Date)+
" - ";if(message!=undefined&&message!=null){if(message.Message!=undefined)retMsg+=" Message: "+message.Message;else if(message.message!=undefined)retMsg+=" Message: "+message.message;if(message.Stack!=undefined)retMsg+=" Stack: "+message.Stack;else if(message.stack!=undefined)retMsg+=" Stack: "+message.stack;if(message.Description!=undefined)retMsg+=" Description: "+message.Description;else if(message.description!=undefined)retMsg+=" Description: "+message.description;else if(typeof message=="string")retMsg+=
" "+message}}catch(error){if(typeof window.agentInfo!="undefined"&&agentInfo.supportHTML5)return message&&typeof message.message!="undefined"?message.message:message.toString();else;}return retMsg}if(window["console"].hasOwnProperty("error"))window.console.error(convertMessageToString(error));else if(window["console"].hasOwnProperty("warn"))window.console.warn(convertMessageToString(error));else if(window["console"].hasOwnProperty("log"))window.console.log(convertMessageToString(error))}}function registerPlugin(name,
plugin){if(name&&name!=""&&_plugins[name]==undefined){for(var n in GLOBAL_VAR["class"]["privateREF#"])if(n.toLowerCase()==name.toLowerCase())return false;_plugins[name]=new plugin;Object.defineProperty(GLOBAL_VAR["class"]["privateREF#"],name,{"enumerable":true,"configurable":false,"get":function(){return _plugins[name]}});return true}else return false}function unregisterPlugin(name,plugin){if(name&&name!=""&&_plugins[name]!=undefined){delete _plugins[name];delete GLOBAL_VAR["class"]["privateREF#"][name];
return true}else return false}function Ajax(){var _className=getFunctionName(arguments);var _headers={};var _responseTypes=Object.freeze({"BLANK":"","TEXT":"text","ARRAYBUFFER":"arraybuffer","BLOB":"blob","DOCUMENT":"document","JSON":"json","MSSTREAM":"ms-stream"});var _HTTPStatusCodeDescription=Object.freeze({400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",
409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",419:"Page Expired",420:"Method Failure",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Reserved for WebDAV",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",430:"Request Header Fields Too Large",431:"Request Header Fields Too Large",
440:"Login Time-out",444:"No Response",449:"Retry With",450:"Blocked by Windows Parental Controls",451:"Unavailable For Legal Reasons",494:"Request header too large",495:"SSL Certificate Error",496:"SSL Certificate Required",497:"HTTP Request Sent to HTTPS Port",498:"Invalid Token",499:"Client Closed Request",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",
508:"Loop Detected",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required",520:"Web Server Returned an Unknown Error",521:"Web Server Is Down",522:"Connection Timed Out",523:"Origin Is Unreachable",524:"A Timeout Occurred",525:"SSL Handshake Failed",526:"Invalid SSL Certificate",527:"Railgun Error",561:"Unauthorized"});var _default={"async":true,"type":_responseTypes.BLANK,"timeout":3E4,"credentials":false};var _queues={};var states={"READY":0,"SETUP":1,"SENT":2,"PROCESS":3,
"COMPLETED":4};var _rePP=RegExp(/\?|&/);var _normalizeResponse=agentInfo.isMSIE&&agentInfo.msieVersion<12;function addHeaderValue(header,value){_headers[header]=value}function removeHeaderValue(header){delete _headers[header]}function shiftQueue(qname){if(qname&&_queues[qname]){_queues[qname].shift();setTimeout(execXMLHttpRequest,1,qname)}}function normalizeResponse(callback){if(callback)return function(response,status,xmlhttp){try{if(typeof response!=="object")callback(JSON.parse(response),status,
xmlhttp);else callback(response,status,xmlhttp)}catch(error){if(xmlhttp.error)xmlhttp.error(error.message,xmlhttp)}};else return undefined}function xmlHttpRequest(method,jData){var xmlhttp=new XMLHttpRequest;var responseType="";var async=typeof jData.async!="undefined"?jData.async:_default.async;if(async!==false)responseType=(jData.dataType||jData.type||jData.responseType||_default.type).toLowerCase();var qname=typeof jData.queueName!="undefined"?jData.queueName:null;xmlhttp.withCredentials=typeof jData.withCredentials!=
"undefined"?jData.withCredentials:_default.credentials;var url=jData.url;xmlhttp.success=_normalizeResponse&&responseType===_responseTypes.JSON?normalizeResponse(jData.success):jData.success;xmlhttp.error=jData.error;xmlhttp.abort=jData.abort;xmlhttp.readystatechange=jData.readystatechange;xmlhttp.onreadystatechange=function(e){var evt=e.target;if(evt.readyState===states.COMPLETED)if(evt.status===200){shiftQueue(evt.queuename);clearTimeout(xmlhttp.timeoutId);delete xmlhttp.timeoutId;if(!evt.aborted)if(xmlhttp.success)xmlhttp.success(evt.response,
evt.status,xmlhttp)}else{shiftQueue(evt.queuename);clearTimeout(xmlhttp.timeoutId);delete xmlhttp.timeoutId;var err={};try{err.message=evt.response?evt.response.error.message:evt.responseText}catch(error){}err.message=err.message||_HTTPStatusCodeDescription[evt.status]||"Unknown error";if(!evt.aborted&&xmlhttp.error)xmlhttp.error(err,evt.status,xmlhttp);else if(evt.aborted)if(xmlhttp.abort)xmlhttp.abort(err,evt.status,xmlhttp);else if(xmlhttp.error)xmlhttp.error(err,evt.status,xmlhttp)}if(xmlhttp.readystatechange)xmlhttp.readystatechange(evt.readyState,
evt.status,xmlhttp)};xmlhttp.params={"async":async,"method":method,"url":url,"contentType":jData.contentType,"data":jData.data,"timeout":typeof jData.timeout!="undefined"?jData.timeout:_default.timeout,"responseType":responseType,"noHeaders":jData.noHeaders,"beforeSend":jData.beforeSend};try{if(qname){if(!_queues[qname])_queues[qname]=[];xmlhttp.queuename=qname;_queues[qname].push({"xmlhttp":xmlhttp});execXMLHttpRequest(qname)}else executeXMLHttpRequest(xmlhttp)}catch(error){if(jData.error)jData.error(error,
-1,xmlhttp);return xmlhttp}return xmlhttp}function execXMLHttpRequest(qname){if(_queues[qname]&&_queues[qname].length>0){var xmlhttp=_queues[qname][0].xmlhttp;if(xmlhttp.readyState===states.READY)executeXMLHttpRequest(xmlhttp)}}function executeXMLHttpRequest(xmlhttp){var params=xmlhttp.params;xmlhttp.open(params.method,params.url,params.async);if(params.async){xmlhttp.responseType=params.responseType;if(params.timeout>0){xmlhttp.timeout=params.timeout;xmlhttp.timeoutId=setTimeout(function(){if(!xmlhttp.aborted){xmlhttp.aborted=
true;if(xmlhttp.abort)xmlhttp.abort()}},params.timeout);params.timeout=null}}var data=typeof params.data!="undefined"?params.data:null;if(params.method==="POST"){var contentType=null;if(params.contentType)contentType=params.contentType;else if(data!==null&&!(data instanceof FormData))if(GLOBAL_VAR["class"]["privateREF#"].object.getDataTypeOf(data)=="json")contentType="application/json";else contentType="application/x-www-form-urlencoded; charset=UTF-8";if(contentType!=null){xmlhttp.setRequestHeader("Content-Type",
contentType);if(contentType=="application/json"&&data!=null&&typeof data=="object")data=JSON.stringify(data)}}if(params.noHeaders!==true)for(var header in _headers)xmlhttp.setRequestHeader(header,_headers[header]);if(params.beforeSend&&params.beforeSend instanceof Function)params.beforeSend(xmlhttp);if(data!=null)xmlhttp.send(data);else xmlhttp.send()}function jsonP(jData){var script=document.createElement("script");script.async=true;script.defer=true;script.type="text/javascript";if(jData.charset)script.charset=
jData.charset;script.onload=function(e){if(jData.success)jData.success(e)};script.error=jData.error}function get(jData){return xmlHttpRequest("GET",jData)}function post(jData){return xmlHttpRequest("POST",jData)}function releaseQueue(queueName){if(_queues[queueName]&&_queues[queueName].length>0)_queues[queueName].forEach(function(elem){elem.xmlhttp.aborted=true;if(elem.xmlhttp.abort)elem.xmlhttp.abort()})}Object.defineProperty(this,"addHeaderValue",{"enumerable":true,"configurable":false,"writable":false,
"value":addHeaderValue});Object.defineProperty(this,"removeHeaderValue",{"enumerable":true,"configurable":false,"writable":false,"value":removeHeaderValue});Object.defineProperty(this,"jsonP",{"enumerable":true,"configurable":false,"writable":false,"value":jsonP});Object.defineProperty(this,"get",{"enumerable":true,"configurable":false,"writable":false,"value":get});Object.defineProperty(this,"post",{"enumerable":true,"configurable":false,"writable":false,"value":post});Object.defineProperty(this,
"releaseQueue",{"enumerable":true,"configurable":false,"writable":false,"value":releaseQueue});Object.defineProperty(this,"queueLength",{"enumerable":true,"configurable":false,"writable":false,"value":function(queueName){return _queues[queueName]?_queues[queueName].length:0}});Object.defineProperty(this,"responseType",{"enumerable":true,"configurable":false,"get":function(){return _responseTypes}});Object.defineProperty(this,"httpStatusCodeDescription",{"enumerable":true,"configurable":false,"get":function(){return _HTTPStatusCodeDescription}});
if(GLOBAL_VAR.console.logDebug)if(window.console!=undefined&&window.console.log!=undefined)window.console.log("Initializing "+_className+" class. - "+(new Date).toString());return this}function Color(){var _className=getFunctionName(arguments);var COLOR_LIGHT_BOTTOMLIMIT=144;function getRGBStruct(r,g,b,a){var aux=GLOBAL_VAR["class"]["privateREF#"]["string"].sprintf('{ "r": %s, "g": %s, "b": %s, "a": %s }',Math.round(r||0),Math.round(g||0),Math.round(b||0),a||1);return JSON.parse(aux)}function toRGB(color){if(typeof color==
"object"&&typeof color.r!="undefined"&&typeof color.g!="undefined"&&color.b!="undefined"){if(typeof color.a=="undefined")color.a=1;return color}var rgba=getRGBStruct();if(/^#[A-Fa-f0-9]{3}$/.test(color)){rgba.r=parseInt(color.substr(1,1),16);rgba.g=parseInt(color.substr(2,1),16);rgba.b=parseInt(color.substr(3,1),16)}else if(/^#[A-Fa-f0-9]{6}$/.test(color)){rgba.r=parseInt(color.substr(1,2),16);rgba.g=parseInt(color.substr(3,2),16);rgba.b=parseInt(color.substr(5,2),16)}else{var res=/rgba?\((\d+), ?(\d+), ?(\d+)(, ?(\.?\d+))?\)/.exec(color);
if(res!=null){rgba.r=parseInt(res[1],10);rgba.g=parseInt(res[2],10);rgba.b=parseInt(res[3],10);if(res.length==6)rgba.a=parseFloat(res[5])}}if(isNaN(rgba.a))rgba.a=1;return rgba}function averageColor(col1,col2){var RGB1=toRGB(col1);var RGB2=toRGB(col2);var rgba=getRGBStruct((RGB1.r+RGB2.r)/2,(RGB1.g+RGB2.g)/2,(RGB1.b+RGB2.b)/2,(RGB1.a+RGB2.a)/2);return toHexColor(rgba)}function toHexColor(){var toHex=function(n){return("0"+n.toString(16)).substr(-2)};if(arguments[0]instanceof Object){var c=arguments[0];
return"#"+toHex(c.r)+toHex(c.g)+toHex(c.b)}else if(arguments.length>2)return"#"+toHex(arguments[0])+toHex(arguments[1])+toHex(arguments[2]);else if(arguments.length===1){var c=toRGB(arguments[0]);return"#"+toHex(c.r)+toHex(c.g)+toHex(c.b)}return"#000"}function shift(color,shiftValue){var rgb=toRGB(color);if(shiftValue==1)return{"r":rgb.g,"g":rgb.b,"b":rgb.r};else return{"r":rgb.b,"g":rgb.r,"b":rgb.g}}function combine(mode,col1,col2){var RGB1=toRGB(col1);var RGB2=toRGB(col2);var rgba=getRGBStruct((RGB1.r+
RGB2.r)%256,(RGB1.g+RGB2.g)%256,(RGB1.b+RGB2.b)%256,(RGB1.a+RGB2.a)/2);return toHexColor(rgba)}function getTextColor(color){var rgb=toRGB(color);var avg=(rgb.r+rgb.g+rgb.b)/3;return avg>COLOR_LIGHT_BOTTOMLIMIT||Math.max(rgb.r,Math.max(rgb.g*1.8,rgb.b))>COLOR_LIGHT_BOTTOMLIMIT&&avg>COLOR_LIGHT_BOTTOMLIMIT?"#000000":"#fcfcfc"}function isLightColor(color){var rgb=toRGB(color);helper.console.log(JSON.stringify(rgb));return(rgb.r+rgb.g|+rgb.b)/3>COLOR_LIGHT_BOTTOMLIMIT}Object.defineProperty(this,"toRGB",
{"enumerable":true,"configurable":false,"writable":false,"value":toRGB});Object.defineProperty(this,"toHexColor",{"enumerable":true,"configurable":false,"writable":false,"value":toHexColor});Object.defineProperty(this,"averageColor",{"enumerable":true,"configurable":false,"writable":false,"value":averageColor});Object.defineProperty(this,"shift",{"enumerable":true,"configurable":false,"writable":false,"value":shift});Object.defineProperty(this,"combine",{"enumerable":true,"configurable":false,"writable":false,
"value":combine});Object.defineProperty(this,"getTextColor",{"enumerable":true,"configurable":false,"writable":false,"value":getTextColor});Object.defineProperty(this,"isLightColor",{"enumerable":true,"configurable":false,"writable":false,"value":isLightColor});if(GLOBAL_VAR.console.logDebug)if(window.console!=undefined&&window.console.log!=undefined)window.console.log("Initializing "+_className+" class. - "+(new Date).toString());return this}function Console(){var LOCAL_VAR={"class":{"name":"console"},
"console":{"log":null,"error":null,"info":null,"warn":null,"exception":null,"fatal":null},"msgLogAvailable":null,"msgLogger":null,"logConsole":null,"preserveLog":{"log":[],"available":false},"externalLog":false};try{function initialize(){try{if(GLOBAL_VAR.console.logDebug)if(window.console!=undefined&&window.console.log!=undefined)window.console.log("Initializing "+LOCAL_VAR["class"]["name"]+" class. - "+(new Date).toString());if(typeof Thinfinity!=="undefined"&&typeof Thinfinity.LogConsole!="undefined")LOCAL_VAR.logConsole=
Thinfinity.LogConsole;if(typeof MsgLogger!="undefined"){LOCAL_VAR.msgLogAvailable=true;LOCAL_VAR.msgLogger=new MsgLogger}else LOCAL_VAR.msgLogAvailable=false;for(var collection in LOCAL_VAR.console)LOCAL_VAR.console[collection]=window.console[collection]!==undefined?collection:LOCAL_VAR.console.log!=null?LOCAL_VAR.console.log:"alert";if(GLOBAL_VAR.console.logDebug)if(window.console!=undefined&&window.console.log!=undefined)window.console.log(LOCAL_VAR["class"]["name"]+" class was Initialized. - "+
(new Date).toString())}catch(error){genericLog(error,arguments)}}function getISOTime(){var now=new Date;if(typeof now.toISOString!="undefined"){var ret=now.toISOString();ret=ret.substr(ret.indexOf("T")+1,12);return ret}else return("0"+now.getUTCHours()).substr(-2)+":"+("0"+now.getUTCMinutes()).substr(-2)+":"+("0"+now.getUTCSeconds()).substr(-2)+"."+now.getUTCMilliseconds()}function remoteLog(value){LOCAL_VAR.externalLog=value}function log(message,args,collection,exceptionStack){try{var isLocal=arguments.length>=
5;var fnName=getFunctionName(args);if(fnName!="")fnName="Caller: "+fnName+" - ";var msg=getISOTime()+": ";if(message!=undefined&&message!=null){if(message.message!=undefined)msg+=" Message: "+message.message;else if(message.Message!=undefined)msg+=" Message: "+message.Message;if(message.stack!=undefined)msg+=" Stack: "+message.stack;else if(message.Stack!=undefined)msg+=" Stack: "+message.Stack;if(message.description!=undefined)msg+=" Description: "+message.description;else if(message.Description!=
undefined)msg+=" Description: "+message.Description;else if(typeof message=="string")msg+=" "+message}if(exceptionStack!=undefined&&exceptionStack!=null){if(exceptionStack.message!=undefined)msg+=" Message: "+exceptionStack.message;else if(exceptionStack.Message!=undefined)msg+=" Message: "+exceptionStack.Message;if(exceptionStack.stack!=undefined)msg+=" Stack: "+exceptionStack.stack;else if(exceptionStack.Stack!=undefined)msg+=" Stack: "+exceptionStack.Stack;if(exceptionStack.description!=undefined)msg+=
" Description: "+exceptionStack.description;else if(exceptionStack.Description!=undefined)msg+=" Description: "+exceptionStack.Description}if(LOCAL_VAR.console[collection]!="alert"){if(LOCAL_VAR["preserveLog"]["available"]==true)LOCAL_VAR["preserveLog"]["log"].push({"fName":fnName,"msg":msg,"collection":collection});window.console[LOCAL_VAR.console[collection]](fnName+msg)}else if(collection=="error"||collection=="exception"||collection=="fatal")alert(fnName+msg);if(LOCAL_VAR.logConsole)LOCAL_VAR.logConsole.send(collection,
fnName,msg,exceptionStack);if(!isLocal&&LOCAL_VAR.externalLog==true&&LOCAL_VAR.msgLogAvailable)switch(collection){case "error":case "exception":case "fatal":msgLogError(fnName+msg,collection);break;default:msgLogDebug(fnName+msg,collection);break}}catch(error){genericLog(error,arguments)}}function msgLogDebug(value,extraClass){try{var addISOTime=arguments.length>1&&arguments[1];if(addISOTime)value=getISOTime()+": "+value;if(LOCAL_VAR.msgLogAvailable)LOCAL_VAR.msgLogger.log(value,extraClass);else log(value,
null,"log",null,null)}catch(error){genericLog(error,arguments)}}function msgLogError(value,extraClass){try{var addISOTime=arguments.length>1&&arguments[1];if(addISOTime)value=getISOTime()+": "+value;if(LOCAL_VAR.msgLogAvailable)LOCAL_VAR.msgLogger.log("ERROR: "+value,extraClass);else{log(value,null,"error",null,null);return value}}catch(error){genericLog(error,arguments)}}function switchLogStatus(logsName,enabled){var response=true;try{logsName=logsName.toString().toLowerCase();if(logsName.indexOf("debug")!=
-1)GLOBAL_VAR["console"]["logDebug"]=enabled;if(logsName.indexOf("log")!=-1)GLOBAL_VAR["console"]["logDebug"]=enabled;if(logsName.indexOf("info")!=-1)GLOBAL_VAR["console"]["logInfo"]=enabled;if(logsName.indexOf("warning")!=-1)GLOBAL_VAR["console"]["logWarning"]=enabled;if(logsName.indexOf("warn")!=-1)GLOBAL_VAR["console"]["logWarning"]=enabled;if(logsName.indexOf("error")!=-1)GLOBAL_VAR["console"]["logError"]=enabled;if(logsName.indexOf("fatal")!=-1)GLOBAL_VAR["console"]["logFatal"]=enabled;if(logsName.indexOf("exception")!=
-1)GLOBAL_VAR["console"]["logException"]=enabled;if(logsName.indexOf("ex")!=-1)GLOBAL_VAR["console"]["logException"]=enabled}catch(error){response=false}return response}initialize();Object.defineProperty(this,"debug",{"enumerable":false,"configurable":false,"value":function(message,args){if(GLOBAL_VAR.console.logDebug)log(message,args,"log")}});Object.defineProperty(this,"log",{"enumerable":false,"configurable":false,"value":function(message,args){if(GLOBAL_VAR.console.logDebug)log(message,args,"log")}});
Object.defineProperty(this,"warning",{"enumerable":false,"configurable":false,"value":function(warn,args){if(GLOBAL_VAR.console.logWarning)log(warn,args,"warn")}});Object.defineProperty(this,"warn",{"enumerable":false,"configurable":false,"value":function(warn,args){if(GLOBAL_VAR.console.logWarning)log(warn,args,"warn")}});Object.defineProperty(this,"error",{"enumerable":false,"configurable":false,"value":function(message,exception,args){if(GLOBAL_VAR.console.logError)log(message,args,"error",exception)}});
Object.defineProperty(this,"fatal",{"enumerable":false,"configurable":false,"value":function(message,exception,args){if(GLOBAL_VAR.console.logFatal)log(message,args,"fatal",exception)}});Object.defineProperty(this,"exception",{"enumerable":false,"configurable":false,"value":function(message,exception,args){if(GLOBAL_VAR.console.logException)log(exception,args,"exception",exception)}});Object.defineProperty(this,"info",{"enumerable":false,"configurable":false,"value":function(info,args){if(GLOBAL_VAR.console.logInfo)log(info,
args,"info")}});Object.defineProperty(this,"msgDebug",{"enumerable":false,"configurable":false,"value":function(value){if(GLOBAL_VAR.console.logDebug)msgLogDebug(value)}});Object.defineProperty(this,"msgError",{"enumerable":false,"configurable":false,"value":function(value){if(GLOBAL_VAR.console.logError)msgLogDebug(value)}});genericLog=this.error;Object.defineProperty(this,"on",{"enumerable":false,"configurable":false,"value":function(logsName){switchLogStatus(logsName,true)}});Object.defineProperty(this,
"off",{"enumerable":false,"configurable":false,"value":function(logsName){switchLogStatus(logsName,false)}});Object.defineProperty(this,"remoteLog",{"enumerable":false,"configurable":false,"get":function(){return LOCAL_VAR.externalLog},"set":function(value){LOCAL_VAR.externalLog=value}});Object.defineProperty(this,"getLog",{"enumerable":true,"configurable":false,"value":function(){return LOCAL_VAR["preserveLog"]["log"]}});Object.defineProperty(this,"preserveLog",{"enumerable":true,"configurable":false,
"get":function(){return LOCAL_VAR["preserveLog"]["available"]},"set":function(value){return LOCAL_VAR["preserveLog"]["available"]=value}});return this}catch(error){genericLog(error,arguments)}}function Datetime(){var _className=getFunctionName(arguments);function getFormattedDatetime(datetime){return datetimeToString(datetime,"yyyy/mm/dd HH:MM:ss.f")}function getFormattedDate(datetime){return datetimeToString(datetime,"yyyy/mm/dd")}function getFormattedTime(datetime){return datetimeToString(datetime,
"HH:MM:ss")}function getDatetime(datetime,format){return datetimeToString(datetime,format)}function datetimeToString(datetime,format,utc){try{var dateFormat=function(){var token=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[FfoSZ]|"[^"]*"|'[^']*'/g,timezone=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,timezoneClip=/[^-+\dA-Z]/g,pad=function(val,len){val=String(val);len=len||2;while(val.length<len)val="0"+val;return val};
return function(date,mask,utc){var dF=dateFormat;if(arguments.length==1&&Object.prototype.toString.call(date)=="[object String]"&&!/\d/.test(date)){mask=date;date=undefined}if(!date instanceof Date)date=new Date;if(isNaN(date))throw SyntaxError("invalid date");mask=String(dF.masks[mask]||mask||dF.masks["default"]);if(mask.slice(0,4)=="UTC:"){mask=mask.slice(4);utc=true}var _=utc?"getUTC":"get",d=date[_+"Date"](),D=date[_+"Day"](),m=date[_+"Month"](),y=date[_+"FullYear"](),H=date[_+"Hours"](),M=date[_+
"Minutes"](),s=date[_+"Seconds"](),F=date[_+"Milliseconds"](),o=utc?0:date.getTimezoneOffset(),flags={d:d,dd:pad(d),ddd:dF.i18n.dayNames[D],dddd:dF.i18n.dayNames[D+7],m:m+1,mm:pad(m+1),mmm:dF.i18n.monthNames[m],mmmm:dF.i18n.monthNames[m+12],yy:String(y).slice(2),yyyy:y,h:H%12||12,hh:pad(H%12||12),H:H,HH:pad(H),M:M,MM:pad(M),s:s,ss:pad(s),f:pad(F,3),F:pad(F>99?Math.round(F/10):F),t:H<12?"a":"p",tt:H<12?"am":"pm",T:H<12?"A":"P",TT:H<12?"AM":"PM",Z:utc?"UTC":(String(date).match(timezone)||[""]).pop().replace(timezoneClip,
""),o:(o>0?"-":"+")+pad(Math.floor(Math.abs(o)/60)*100+Math.abs(o)%60,4),S:["th","st","nd","rd"][d%10>3?0:(d%100-d%10!=10)*d%10]};return mask.replace(token,function($0){return $0 in flags?flags[$0]:$0.slice(1,$0.length-1)})}}();dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",
isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"};dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]};return dateFormat(datetime,format,utc)}catch(Error){return Error}}function zeropad(n){return String("00"+n).slice(-2)}
function completeTimeToString(datetime){try{var d=new Date;d.setTime(datetime);s=zeropad(d.getMonth()+1)+"/"+zeropad(d.getDate())+" "+d.getHours()+":"+zeropad(d.getMinutes());return s}catch(error){return error}}Object.defineProperty(this,"getFormattedDatetime",{"enumerable":true,"configurable":false,"writable":false,"value":getFormattedDatetime});Object.defineProperty(this,"getFormattedDate",{"enumerable":true,"configurable":false,"writable":false,"value":getFormattedDate});Object.defineProperty(this,
"getFormattedTime",{"enumerable":true,"configurable":false,"writable":false,"value":getFormattedTime});Object.defineProperty(this,"getDatetime",{"enumerable":true,"configurable":false,"writable":false,"value":getDatetime});if(GLOBAL_VAR.console.logDebug)if(window.console!=undefined&&window.console.log!=undefined)window.console.log("Initializing "+_className+" class. - "+(new Date).toString());return this}function Dictionary(){var _className=getFunctionName(arguments);var _defaultDictionaries=null;
var _defaultDictionariesIgnoreCase=null;var _ignoreCase=false;function defaultDictionaries(dictionaries){_defaultDictionaries=[];_defaultDictionariesIgnoreCase=[];if(dictionaries)for(var i=0;i<dictionaries.length;i++){var _dic={};for(var key in dictionaries[i])_dic[key.toLowerCase()]=dictionaries[i][key];_defaultDictionaries.push(dictionaries[i]);_defaultDictionariesIgnoreCase.push(_dic)}}function getValue(key,dictionaries){if(key){if(dictionaries)for(var i=0;i<dictionaries.length;i++)if(dictionaries[i])if(dictionaries[i].hasOwnProperty(key))return dictionaries[i][key];
else if(_ignoreCase)for(var _key in dictionaries[i])if(_key.toLowerCase()==key.toLowerCase())return dictionaries[i][_key];if(_defaultDictionaries)for(var i=0;i<_defaultDictionaries.length;i++)if(_defaultDictionaries[i].hasOwnProperty(key))return _defaultDictionaries[i][key];else if(_ignoreCase&&_defaultDictionariesIgnoreCase[i].hasOwnProperty(key.toLowerCase()))return _defaultDictionariesIgnoreCase[i][key.toLowerCase()];return""}else return""}Object.defineProperty(this,"items",{"enumerable":true,
"configurable":false,"set":function(dictionaries){defaultDictionaries(dictionaries)}});Object.defineProperty(this,"ignoreCase",{"enumerable":true,"configurable":false,"set":function(value){_ignoreCase=value}});Object.defineProperty(this,"getValue",{"enumerable":true,"configurable":false,"writable":false,"value":getValue});if(GLOBAL_VAR.console.logDebug)if(window.console!=undefined&&window.console.log!=undefined)window.console.log("Initializing "+_className+" class. - "+(new Date).toString());return this}
function Dom(){var _className=getFunctionName(arguments);var _useOn=document.addEventListener==undefined;var _domStateEvents={"order":["loading","interactive","complete"],"lastState":-1,"handlers":{"loading":[],"interactive":[],"complete":[]}};var _shortcutTrim=null;function byId(id){return document.getElementById(id)}function setContent(elem,content){switch(elem.nodeName){case "DIV":case "SPAN":case "P":case "LABEL":case "LI":case "A":case "OPTION":case "BUTTON":elem.innerHTML=content;break;case "INPUT":case "CHECKBOX":case "RADIO":elem.value=
content;break;default:elem.nodeName=="OPTION"||typeof elem.value=="undefined"?elem.innerHTML=content:elem.value=content;break}}function createJsonElement(json){if(_shortcutTrim==null)_shortcutTrim=GLOBAL_VAR["class"]["privateREF#"].string.trim;var elem=document.createElement(json["type"]);if(json["attributes"])for(var attr in json["attributes"])if(["innerHTML","innerText"].indexOf(attr)==-1&&(attr=="class"||typeof elem[attr]!="undefined"||json.type==="label"&&attr==="for"))if(attr==="style"){var s=
json["attributes"][attr].replace(/ /g,"").split(";");s.forEach(function(item){var kvp=item.split(":");elem.style[kvp[0]]=kvp[1]})}else elem.setAttribute(attr,json["attributes"][attr]);else elem[attr]=json["attributes"][attr];var content=json["content"];if(typeof content!=="undefined"){var regExp=new RegExp("HTML{1}[a-zA-Z]*Element{1}");var type=GLOBAL_VAR["class"]["privateREF#"].object.getTypeOf(content);if(content instanceof HTMLElement||regExp.exec(type)!=null&&regExp.exec(type).length>0)elem.appendChild(content);
else setContent(elem,content)}var events=json["events"];for(var eventName in events){var _handler=typeof events[eventName]==="function"?events[eventName]:events[eventName]&&typeof events[eventName].handler==="function"?events[eventName].handler:null;var _evtAttr=typeof events[eventName]==="object"&&events[eventName]&&events[eventName].options?events[eventName].options:false;addEvent(elem,eventName,_handler,_evtAttr)}if(json["style"])GLOBAL_VAR["class"]["privateREF#"]["style"].add(elem,json["style"]);
return elem}function appendJsonElement(json){var elem=createJsonElement(json);if(json["parentElement"])json["parentElement"].appendChild(elem);return elem}function prependJsonElement(json){var elem=createJsonElement(json);if(json["parentElement"])json["parentElement"].insertBefore(elem,json["parentElement"].firstChild);return elem}function createElement(type,attributesCollection,content,events){if(GLOBAL_VAR["class"]["privateREF#"]["object"].getTypeOf(type)=="object")return createJsonElement(type);
else{var elem=document.createElement(type);if(attributesCollection)for(var a in attributesCollection)elem.setAttribute(a,attributesCollection[a]);if(content)if(GLOBAL_VAR["class"]["privateREF#"]["object"].getTypeOf(content)=="object")elem.appendChild(content);else elem.innerHTML=content;if(events)for(var eventName in events)addEvent(elem,eventName,events[eventName]);return elem}}function appendElement(parentElement,type,attributesCollection,content,events){if((typeof parentElement=="undefined"||typeof parentElement.nodeType==
"undefined")&&GLOBAL_VAR["class"]["privateREF#"]["object"].getTypeOf(parentElement)=="object")return appendJsonElement(parentElement);else{var elem=createElement(type,attributesCollection,content,events);parentElement.appendChild(elem);return elem}}function prependElement(parentElement,type,attributesCollection,content,events){if((typeof parentElement=="undefined"||typeof parentElement.nodeType=="undefined")&&GLOBAL_VAR["class"]["privateREF#"]["object"].getTypeOf(parentElement)=="object")return prependJsonElement(parentElement);
else{var elem=createElement(type,attributesCollection,content,events);parentElement.insertBefore(elem,parentElement.firstChild);return elem}}function addEvent(element,events,delegHandler,evtAttr){if(element){if(!(events instanceof Array))events=events.split(",");events=normalizeEventsName(events);var _addEvent=function(elem){if(typeof elem==="string")elem=document.getElementById(elem);if(elem)events.forEach(function(eventName){if(elem.addEventListener!=undefined)elem.addEventListener(eventName,delegHandler,
evtAttr||false);else elem.attachEvent(eventName,delegHandler,evtAttr||false)})};if(element instanceof Array||element instanceof NodeList)for(var i=0,t=element.length;i<t;i++)_addEvent(element[i]);else _addEvent(element)}}function removeEvent(element,events,delegHandler,evtAttr){if(element){if(!(events instanceof Array))events=[events];events=normalizeEventsName(events);var _removeEvent=function(elem){if(typeof elem==="string")elem=document.getElementById(elem);if(elem)events.forEach(function(eventName){if(elem.removeEventListener!=
undefined)elem.removeEventListener(eventName,delegHandler,evtAttr||false);else elem.detachEvent(eventName,delegHandler,evtAttr||false)})};if(element instanceof Array||element instanceof NodeList)for(var i=0,t=element.length;i<t;i++)_removeEvent(element[i]);else _removeEvent(element)}}function triggerEvent(element,event,args){var customEvent=null;event=normalizeEventName(event);if(window.CustomEvent)try{element.dispatchEvent(new window.CustomEvent(event,args))}catch(e){GLOBAL_VAR["class"]["privateREF#"]["console"].error(e.message,
e,arguments)}else{customEvent=document.createEventObject();customEvent.eventType=event;element.fireEvent(event,customEvent)}customEvent=null;return element}function normalizeEventsName(events){for(var i=0,t=events.length;i<t;i++)events[i]=normalizeEventName(events[i]);return events}function normalizeEventName(event){event=event.trim();var hasOn=event.substr(0,2)=="on";if(_useOn&&!hasOn)event="on"+event;else if(hasOn&&!_useOn)event=event.substring(2,event.length);hasOn=null;return event}window.document.onreadystatechange=
function(){var rn=document.readyState;var rs=convertStateToInt(rn);if(_domStateEvents.lastState<rs)for(var i=0;i<rs;i++)fireStateEvent(_domStateEvents.order[i]);_domStateEvents.lastState=rs;fireStateEvent(rn)};function convertStateToInt(rs){return _domStateEvents.order.indexOf(rs)}function documentLoading(callback){var en="loading";_domStateEvents.handlers[en].push(callback);checkDocumenEvent(en)}function documentInteractive(callback){var en="interactive";_domStateEvents.handlers[en].push(callback);
checkDocumenEvent(en)}function documentComplete(callback){var en="complete";_domStateEvents.handlers[en].push(callback);checkDocumenEvent(en)}function checkDocumenEvent(rs){if(convertStateToInt(rs)<=_domStateEvents.lastState)fireStateEvent(rs)}function fireStateEvent(name){if(_domStateEvents.handlers[name].length>0)while(_domStateEvents.handlers[name].length>0)try{_domStateEvents.handlers[name].shift()({"current":document.readyState,"eventName":name})}catch(error){if(GLOBAL_VAR.console.logError)console.log(error.message+
"\r\n"+error.stack)}}function loadScript(url,success,error){var script=document.createElement("script");script.type="text/javascript";script.onload=success;script.onerror=error;script.src=url;document.head.appendChild(script)}function loadFile(url){return new Promise(function(resolve,reject){var script=document.createElement("script");script.type="text/javascript";script.onload=resolve;script.onerror=reject;script.src=url;document.head.appendChild(script)})}function fillElements(elems){if(elems){var elem=
null,name=null;for(var kvp in elems){name=elems[kvp];if(!name||name==="")name=kvp;elem=document.getElementById(name);if(!elem){elem=document.getElementsByClassName(name);if(elem.length>0)elem=elem[0]}elems[kvp]=elem}}}function decodeText(value){var _auxTextArea=document.createElement("textarea");_auxTextArea.innerHTML=value;return _auxTextArea.value}Object.defineProperty(this,"byId",{"enumerable":false,"configurable":false,"writable":false,"value":byId});Object.defineProperty(this,"createElement",
{"enumerable":false,"configurable":false,"writable":false,"value":createElement});Object.defineProperty(this,"appendElement",{"enumerable":false,"configurable":false,"writable":false,"value":appendElement});Object.defineProperty(this,"prependElement",{"enumerable":false,"configurable":false,"writable":false,"value":prependElement});Object.defineProperty(this,"addEvent",{"enumerable":false,"configurable":false,"writable":false,"value":addEvent});Object.defineProperty(this,"removeEvent",{"enumerable":false,
"configurable":false,"writable":false,"value":removeEvent});Object.defineProperty(this,"triggerEvent",{"enumerable":false,"configurable":false,"writable":false,"value":triggerEvent});Object.defineProperty(this,"createJsonElement",{"enumerable":false,"configurable":false,"writable":false,"value":createJsonElement});Object.defineProperty(this,"appendJsonElement",{"enumerable":false,"configurable":false,"writable":false,"value":appendJsonElement});Object.defineProperty(this,"prependJsonElement",{"enumerable":false,
"configurable":false,"writable":false,"value":prependJsonElement});Object.defineProperty(this,"loading",{"enumerable":false,"configurable":false,"writable":false,"value":function(callback){return documentLoading(callback)}});Object.defineProperty(this,"interactive",{"enumerable":false,"configurable":false,"writable":false,"value":function(callback){return documentInteractive(callback)}});Object.defineProperty(this,"ready",{"enumerable":false,"configurable":false,"writable":false,"value":function(callback){return documentComplete(callback)}});
Object.defineProperty(this,"complete",{"enumerable":false,"configurable":false,"writable":false,"value":function(callback){return documentComplete(callback)}});Object.defineProperty(this,"loadScript",{"enumerable":false,"configurable":false,"writable":false,"value":function(url,success,error){return loadScript(url,success,error)}});Object.defineProperty(this,"loadFile",{"enumerable":false,"configurable":false,"writable":false,"value":function(url){return loadFile(url)}});Object.defineProperty(this,
"fillElements",{"enumerable":false,"configurable":false,"writable":false,"value":function(elems){return fillElements(elems)}});Object.defineProperty(this,"decodeText",{"enumerable":false,"configurable":false,"writable":false,"value":function(value){return decodeText(value)}});if(GLOBAL_VAR.console.logDebug)if(window.console!=undefined&&window.console.log!=undefined)window.console.log("Initializing "+_className+" class. - "+(new Date).toString());return this}function ObjectExtend(){var _className=
getFunctionName(arguments);var _REEvalFnRetrieve=/function/ig;function EnumeratorClass(){var _self=this;var _keys=[];var _ikeys={};var _values={};function initialize(values){if(typeof values[0]=="string")for(var v in values)addEnumValue(values[v],parseInt(v));else{var jsonDef=values[0];for(var key in jsonDef)addEnumValue(key,jsonDef[key]);jsonDef=null}}function addEnumValue(key,value){_keys.push(key);_ikeys[value]=key;if(_self[key]==undefined){_values[key]=value;Object.defineProperty(_self,key,{"enumerable":true,
"configurable":false,"get":function(){return _values[key]}})}}function hasValue(value){return Object.values(_self).indexOf(value)!=-1}function getKey(value){return _ikeys[value]}function toArray(){return _keys}if(arguments&&arguments.length>0)initialize(arguments[0]);else throw new Error("Cannot define new enum without arguments");Object.defineProperty(_self,"hasValue",{"enumerable":false,"configurable":false,"writable":false,"value":hasValue});Object.defineProperty(_self,"getKey",{"enumerable":false,
"configurable":false,"writable":false,"value":getKey});Object.defineProperty(_self,"toArray",{"enumerable":false,"configurable":false,"writable":false,"value":toArray});return Object.freeze?Object.freeze(_self):_self}function convertTo(value,type){try{type=type.toLowerCase();switch(type){case "number":case "float":value=parseFloat(value);break;case "integer":case "int":value=parseInt(value,10);break;case "datetime":case "date":case "time":value=new Date(value);break;case "json":value=JSON.parse(value);
break;case "string":value=value.toString();break;case "bool":case "boolean":if(typeof value=="string"&&["0","1"].indexOf(value)!=-1||typeof value=="number"&&value>=0&&value<=1)value=toBoolean(value);break;case "array":value=toArray(value);break;case "object":break;case "hexadecimal":value=toHexadecimal(value);break}}catch(error){helper.console.error(error.message,error,arguments)}return value}function isObject(elem){if(elem instanceof Object)if(elem instanceof Function||elem instanceof Array||elem instanceof
Date||elem instanceof String)return false;else return true;else return false}function isArray(array){try{if(array!=null&&array!=undefined&&array.hasOwnProperty("length")&&array instanceof Array)return true;else return Array.isArray(array)}catch(error){return false}}function isBoolean(value){if(value!=null)if(value==1||value==0)return true;else if(value.toString().toUpperCase()=="TRUE"||value.toString().toUpperCase()=="FALSE")return true;else if(typeof value=="boolean")return true;else return false;
else return false}function isNumber(n){if(n==undefined||n==null)return false;else return!isNaN(parseFloat(n))&&isFinite(n)&&n-parseFloat(n)+1>=0}var _HTMLElements=["HTMLDocument","HTMLBodyElement","HTMLAnchorElement","HTMLDivElement","HTMLIFrameElement","HTMLFrameElement","HTMLElement","HTMLImageElement","HTMLInputElement","HTMLFormElement","HTMLHeadElement","HTMLTableElement","HTMLCanvasElement","HTMLScriptElement","HTMLParagraphElement","HTMLSpanElement","HTMLStyleElement","HTMLHtmlElement","HTMLParamElement",
"HTMLPhraseElement","HTMLSelectElement","HTMLTableCaptionElement","HTMLTableCellElement","HTMLTableColElement","HTMLTableDataCellElement","HTMLTableHeaderCellElement","HTMLTableRowElement","HTMLTableSectionElement","HTMLTextAreaElement","HTMLAppletElement","HTMLAreaElement","HTMLAreasCollection","HTMLAudioElement","HTMLBaseElement","HTMLBaseFontElement","HTMLBGSoundElement","HTMLBlockElement","HTMLBRElement","HTMLButtonElement","HTMLCollection","HTMLDataListElement","HTMLDDElement","HTMLDirectoryElement",
"HTMLDListElement","HTMLDTElement","HTMLEmbedElement","HTMLFieldSetElement","HTMLFontElement","HTMLFrameSetElement","HTMLHeadingElement","HTMLHRElement","HTMLIsIndexElement","HTMLLabelElement","HTMLLegendElement","HTMLLIElement","HTMLLinkElement","HTMLMapElement","HTMLMarqueeElement","HTMLMediaElement","HTMLMenuElement","HTMLMetaElement","HTMLModElement","HTMLNextIdElement","HTMLObjectElement","HTMLOListElement","HTMLOptGroupElement","HTMLOptionElement","HTMLPreElement","HTMLProgressElement","HTMLQuoteElement",
"HTMLSourceElement","HTMLTitleElement","HTMLTrackElement","HTMLUListElement","HTMLUnknownElement","HTMLVideoElement"];var _nodeTypes={1:"ELEMENT_NODE",2:"ATTRIBUTE_NODE",3:"TEXT_NODE",4:"CDATA_SECTION_NODE",5:"ENTITY_REFERENCE_NODE",6:"ENTITY_NODE",7:"PROCESSING_INSTRUCTION_NODE",8:"COMMENT_NODE",9:"DOCUMENT_NODE",10:"DOCUMENT_TYPE_NODE",11:"DOCUMENT_FRAGMENT_NODE",12:"NOTATION_NODE"};function getTypeOfHTMLElement(elem){if(elem&&elem.nodeType&&elem.nodeName){var elemType=null;for(var i=0,t=_HTMLElements.length;i<
t;i++){elemType=_HTMLElements[i];if(window[elemType]&&elem instanceof window[elemType])return elemType}return getTypeOfNode(elem)||"HTMLElement"}else if(isWindowElem(elem))return"window";else return null}function getTypeOfNode(elem){if(elem&&elem.nodeType){for(var k in Node)if(elem.nodeType===Node[k])return _nodeTypes[elem.nodeType];return null}else return null}function isWindowElem(elem){if(elem){var cname=elem.constructor?elem.constructor.toString().toLowerCase():"";if(cname.indexOf("window")!=
-1)return true;else return elem.location&&elem.navigator&&elem.document&&getTypeOfHTMLElement(elem.document)==="HTMLDocument"}return false}function getTypeOf(elem){var t=null;try{if(elem!==null&&elem!==undefined)if(elem instanceof Function)return"function";else if(typeof elem=="object"){if(elem instanceof Date)return"date";else if(isArray(elem))return"array";else if(elem instanceof HTMLElement||elem.nodeType&&elem.nodeName)return"HTMLElement";else if(isWindowElem(elem))return"window";if(t!=null)return t;
else return elem.constructor&&elem.constructor.name?elem.constructor.name.toLowerCase():"object"}else if(typeof elem=="number"||isNumber(elem))return"number";else return(typeof elem).toString();else return elem===null?"null":"undefined"}catch(Error){return false}}function getDataTypeOf(value){var type=getTypeOf(value);function isJSON(value){try{if(value){if(typeof value=="string")JSON.parse(value);else if(typeof value=="object")JSON.stringify(value);return true}else return false}catch(error){return false}}
switch(type){case "function":case "array":case "datetime":break;case "number":type=value%1===0?"integer":"float";break;case "boolean":break;case "object":type=isJSON(value)==true?"json":type;break;case "string":function isHexadecimal(value){var pattern=/[A-Fa-f0-9]*/;var reg=new RegExp(pattern);var ret=reg.exec(value)[0].toString();if(ret.length==value.toString().length)return true;else return false}type=isHexadecimal(value)==true?"hexadecimal":type;if(type!="hexadecimal"){type=isBoolean(value)==
true?"boolean":type;if(type!="boolean")if(value.substr(0,1)=="{"&&value.substr(value.length-1,1)=="}")type=isJSON(value)==true?"json":type}break;case "HTMLCollection":case "HTMLElement":case "window":break;default:type=value==null?"null":typeof value;break}return type}function toBoolean(value){if(isNumber(value))if(value==1)return true;else return false;else if(typeof value=="boolean")return value;else if(typeof value=="string")if(value.toUpperCase().indexOf("TRUE")!=-1)return true;else return false;
else return false}function toArray(value){if(value==null||value=="")return[];else if(value instanceof Array)return value;else if(value instanceof String)if(value.indexOf(";")!=-1)return value.split(";");else return value.split(",");else return[value]}function toHexadecimal(value){if(value!=undefined&&value!=null){var hex="";for(var i=0;i<value.length;i++)hex+=""+value.charCodeAt(i).toString(16);return hex}else return null}function checkPath(obj,path){if(path.length==0&&obj!=null&&obj!=undefined)return true;
else if(obj!=null&&obj!=undefined&&obj[path[0]]!=null&&obj[path[0]]!=undefined){var remain=path.splice(0,1);return checkPath(obj[remain],path)}else return false}function existsPath(obj,path,separatorOpt){if(obj!=undefined&&path!=null&&path!=""){var finalPath=path.replace(/\[/g,".").replace(/\]/g,"");if(finalPath.substr(0,1)==".")finalPath=finalPath.substr(1,finalPath.length);if(finalPath.substr(finalPath.length-1,1)==".")finalPath=finalPath.substr(0,finalPath.length-1);var pathArray=finalPath.split(".");
return checkPath(obj,pathArray)}else return false}function getObjectValue(obj,path){try{if(path.length==0)return obj;else if(obj!=null&&obj!=undefined){var remain=path.splice(0,1);return getObjectValue(obj[remain],path)}else return null}catch(error){return null}}function generatePath(obj){var response=[];function _generatePath(obj,path){var fPath=path!=""?path+".":"";for(var attrib in obj)switch(getTypeOf(obj[attrib])){case "object":response.push(fPath+attrib);_generatePath(obj[attrib],fPath+attrib);
break;case "array":response.push(fPath+attrib);for(var i=0;i<obj[attrib].length;i++)switch(getTypeOf(obj[attrib][i])){case "object":case "array":_generatePath(obj[attrib][i],fPath+attrib+"["+i.toString()+"]");break;default:response.push(fPath+attrib+"["+i.toString()+"]");break}break;default:response.push(fPath+attrib);break}}_generatePath(obj,"");return response}function checkPathValue(obj,path,value,separatorOpt){if(obj!=undefined&&path!=null&&path!=""){var finalPath=path.replace(/\[/g,".").replace(/\]/g,
"");if(finalPath.substr(0,1)==".")finalPath=finalPath.substr(1,finalPath.length);if(finalPath.substr(finalPath.length-1,1)==".")finalPath=finalPath.substr(0,finalPath.length-1);var pathArray=finalPath.split(".");var validPaths=generatePath(obj);return validPaths.indexOf(path)!=-1&&getObjectValue(obj,pathArray)==value}else return false}function hasPath(obj,path){if(obj!=undefined&&path!=null&&path!=""){var validPaths=generatePath(obj);return validPaths.indexOf(path)!=-1}else return false}function validateTypeOf(value,
type,restricted){var isValid=false;restricted=restricted==undefined?false:restricted;type=type.toLowerCase();var foundType=getDataTypeOf(value);var rules={"float":{"types":["float","double","real"],"exceptions":[{"types":["integer"],"match":function(value){return!restricted?"float":""}}]},"hexadecimal":{"types":["hexadecimal","hexa","hex"]},"integer":{"types":["integer","int"]},"boolean":{"types":["boolean","bool"],"exceptions":[{"types":["integer","number"],"range":{"min":0,"max":1}},{"types":["string"],
"equalTo":["true","false"]}]},"function":{"types":["function","func","void","procedure"]},"string":{"types":["string","str"],"exceptions":[{"types":["*"],"match":function(value){return typeof value}}]},"datetime":{"types":["datetime","date","time"]},"array":{"types":["array"]},"object":{"types":["object","obj"]},"json":{"types":["json"]}};if(type=="string"&&foundType=="json"&&typeof value=="string")return true;var fnFindRule=function(r){if(r&&rules[r])return rules[r];else for(var n in rules)if(rules[n].types.indexOf(r)!=
-1)return rules[n];return null};var fnVerifyRule=function(r){r=fnFindRule(r);if(!r)return false;if(r.types.indexOf(foundType)!=-1)if(!restricted)return true;else return typeof value==type;else{if(r.exceptions)for(var i=0;i<r.exceptions.length;i++){var exc=r.exceptions[i];if(exc.types.length==1&&exc.types[0]=="*"||exc.types.indexOf(foundType)!=-1)if(exc.range&&exc.range.min<=value&&value<=exc.range.max&&(!restricted||typeof value==type))return true;else if(exc.equalTo&&exc.equalTo.indexOf(value)!=
-1&&(!restricted||typeof value==type))return true;else if(exc.match&&exc.match(value)==type&&(!restricted||typeof value==type))return true}return false}};return fnVerifyRule(type)}function isDOMNode(obj){if(obj==null)return false;return obj instanceof Object&&typeof obj.outerHTML!="undefined"||typeof obj==="object"&&obj.nodeType===1&&typeof obj.style==="object"&&typeof obj.ownerDocument==="object"}function parseByMatched(attributes,target){try{if(attributes!=null&&attributes!=undefined&&target!=null&&
target!=undefined){var ar=getArrayAttributesFromObject(attributes,[],"",1);for(var i=0;i<ar.length;i++)if(target.hasOwnProperty([ar[i]])){var origPath=ar[i];if(target[origPath]){if(target[origPath]!==attributes[origPath])if(target[origPath]instanceof Window||isDOMNode(target[origPath]))target[origPath]=attributes[origPath];else if(attributes[origPath]&&(attributes[origPath]instanceof Array||attributes[origPath].constructor&&attributes[origPath].constructor.name=="Array"))target[origPath]=attributes[origPath];
else if((!attributes[origPath].constructor||attributes[origPath].constructor.name==="Object")&&(target[origPath]instanceof Object||(target[origPath].constructor&&target[origPath].constructor.name=="Object"||GLOBAL_VAR["class"]["privateREF#"]["object"].getTypeOf(target[origPath])==="object")))parseByMatched(attributes[origPath],target[origPath]);else target[origPath]=attributes[origPath]}else target[origPath]=attributes[origPath]}}}catch(error){return error}return target}function getArrayAttributesFromObject(attributes,
array,base,deep){if(deep==undefined)deep=-1;return getArrayAttributesFromObjectInternal(attributes,array,base,deep,0)}function getArrayAttributesFromObjectInternal(attributes,array,base,deep,count){try{if(attributes)for(var attr in attributes){var type="string";if(attributes[attr]!=null){try{if(attributes[attr]&&attributes[attr].window&&attributes[attr].window===attributes[attr].frames)type="window";else if(attributes[attr].nodeType==undefined||attributes[attr].nodeType==null||typeof attributes[attr].nodeType!=
"number")type=typeof attributes[attr]}catch(error){type="unknown"}switch(type){case "object":if(attributes.length==undefined)array.push(base+attr);if(deep==-1||deep<=count)getArrayAttributesFromObjectInternal(attributes[attr],array,base+attr+".",deep,count);break;case "window":default:array.push(base+attr);break}}}}catch(error){return error}return array}function getAttribute(prop,source){try{var str="";if(prop&&source)for(var attr in source)if(attr.toUpperCase()==prop.toUpperCase())return str+="['"+
attr+"']";else{var type="string";if(source[attr]!=null&&(source[attr].nodeType==undefined||source[attr].nodeType==null||typeof source[attr].nodeType!="number"))type=typeof source[attr];switch(type){case "object":var name=getAttribute(prop,source[attr]);if(name!="")return str+="['"+attr+"']"+name;break;case "function":case "number":case "string":case "boolean":default:break}}}catch(error){return error}return str}function clone(obj){try{if(obj==null||typeof obj!="object")return obj;else if(typeof obj==
"object"&&obj.nodeType!=undefined&&obj.nodeType==1)return obj;else if(obj.scopeName&&obj.scopeName=="HTML"&&obj.document&&obj.document.mimeType&&obj.document.mimeType.indexOf("HTML")!=-1)return obj;else{var temp;if(obj instanceof Date)temp=obj;else{try{temp=new obj.constructor}catch(Error){temp={}}for(var key in obj)if(key.substring(0,1)=="#")temp[key]=obj[key];else temp[key]=clone(obj[key])}return temp}}catch(error){GLOBAL_VAR["class"]["privateREF#"]["console"].log("Cannot clone this object. ["+
JSON.stringify(obj)+"]");return obj}}function evaluate(obj,path,separator){if(obj!=undefined&&path!=null&&path!=""){if(separator==undefined||separator==""||separator==null)separator=".";var spl=path.toString().split(separator);var cValue=obj;for(var prop in spl){spl[prop]=spl[prop].replace(/\[|\]/g,"");if(typeof cValue!="string"&&cValue[spl[prop]]!=undefined){cValue=cValue[spl[prop]];if(spl[prop]==spl[spl.length-1])return cValue!=undefined&&cValue!=null?true:false}else return false}return false}else return false}
function evalExists(obj,path,separator){if(obj!=undefined&&path!=null&&path!=""){if(separator==undefined||separator==""||separator==null)separator=".";var spl=path.toString().split(separator);var cValue=obj;for(var prop in spl){spl[prop]=spl[prop].replace(/\[|\]/g,"");if(typeof cValue!="string"&&typeof cValue[spl[prop]]!="undefined"){cValue=cValue[spl[prop]];if(spl[prop]==spl[spl.length-1])return typeof cValue!="undefined"?true:false}else return false}return false}else return false}function getObjectKeyCaseInsensitive(obj,
key){const lc=key.toLowerCase();return Object.keys(obj).find(k=>k.toLowerCase()===lc)}function getValue(obj,path,defaultResponse,options){if(obj!=undefined&&path!=null&&path!=""){path=path.toString().replace(/\[/g,".").replace(/\[|\]/g,"");if(path[0]==".")path=path.substr(1,path.length);var spl=path.split(".");var cValue=obj;let ig=options&&options.ignoreCase;let len=spl.length;let last=spl[len-1];let prop=null;let oProp=null;for(let i=0,t=len;i<t;i++){prop=oProp=spl[i];if(ig===true)prop=getObjectKeyCaseInsensitive(cValue,
oProp);if(prop&&cValue[prop]!=undefined){cValue=cValue[prop];if(oProp==last)return cValue!=undefined?cValue:typeof defaultResponse!="undefined"?defaultResponse:undefined;let to=typeof cValue;if(["string","number","boolean","function"].indexOf(typeof cValue)!=-1)return typeof defaultResponse!="undefined"?defaultResponse:undefined}else return typeof defaultResponse!="undefined"?defaultResponse:undefined}}return typeof defaultResponse!="undefined"?defaultResponse:undefined}function setValue(obj,path,
value,options={switchTypes:false}){if(path){if(!obj)obj={};path=path.toString().replace(/\[/g,".").replace(/\[|\]/g,"");if(path[0]==".")path=path.substr(1,path.length);var spl=path.split(".");var cValue=obj;var tObj=null;var l=spl.length;let idx=0,c=true;let prop=null;while(idx<l&&c){prop=spl[idx];if(cValue[prop]==undefined)if(["string","number","boolean","function"].indexOf(typeof cValue)!==-1)if(options.switchTypes){tObj[spl[idx-1]]={};cValue[prop]={}}else c=false;else cValue[prop]={};tObj=cValue;
cValue=cValue[prop];idx++}if(c)tObj[prop]=value}return obj}function deleteValue(obj,path){if(path){if(!obj)obj={};path=path.toString().replace(/\[/g,".").replace(/\[|\]/g,"");if(path[0]==".")path=path.substr(1,path.length);var spl=path.split(".");var cValue=obj;var tObj=null;var l=spl.length-1;for(var prop in spl)if(cValue[spl[prop]]==undefined)return obj;else{tObj=cValue;cValue=cValue[spl[prop]]}try{delete tObj[spl[prop]]}catch(error){GLOBAL_VAR["class"]["privateREF#"]["console"].log("Cannot delete property ["+
ptath+"]. "+error.message)}}return obj}function validate(object){return typeof object!="undefined"&&object!=null}function extendObject(obj,attributes,extendArrays){try{if(validate(attributes)==true&&validate(obj)==false)obj={};obj=extendObjectAttributes(attributes,obj,typeof extendArrays!="boolean"?false:extendArrays);return obj}catch(error){return error.message}}function goOver(json,attributes){for(var prop in attributes)if(attributes[prop]instanceof Array&&json[prop]instanceof Array)for(var i=0;i<
attributes[prop].length;i++){if(typeof attributes[prop][i]=="object"||attributes[prop][i]instanceof Array)goOver(json[prop][i],attributes[prop][i])}else if(attributes[prop]instanceof Array&&typeof json[prop]=="undefined"){json[prop]={};json[prop]=clone(attributes[prop])}else if(typeof attributes[prop]=="object"){if(!json[prop])json[prop]={};goOver(json[prop],attributes[prop])}else if(typeof json[prop]!==typeof attributes[prop]){if(!evalExists(json,prop))json[prop]=clone(attributes[prop])}else if(typeof json[prop]==
"undefined")json[prop]=undefined}function jsonsBalance(json1,json2){try{if(validate(json1)&&validate(json2)){if(json1===json2)return;goOver(json1,json2);goOver(json2,json1);return}}catch(error){return error.message}}function compareJsonBranches(json1,json2){try{if(validate(json1)&&validate(json2)){if(json1===json2)return;var paths1=generatePath(json1);var paths2=generatePath(json2);if(paths1 instanceof Array&&paths2 instanceof Array&&paths1.length==paths2.length){paths1=paths1.sort();paths2=paths2.sort();
for(var i=0;i<paths1.length;i++)if(paths1[i]!=paths2[i])return false;return true}else return false}else return false}catch(error){console.log(error.message);return false}}function extendObjectAttributes(source,target,extendArrays){try{if(source==target)return target;if(target==null)target={};if(source instanceof Array&&!extendArrays)target=clone(source);else for(var prop in source)if(source[prop]instanceof Array)if(extendArrays&&target[prop]instanceof Array)for(var a=0;a<source[prop].length;a++){var idx=
target[prop].indexOf(source[prop][a]);if(idx==-1)try{target[prop].push(clone(source[prop][a]))}catch(e){console.warning(e.message+"  - Assigning target directly");target[prop]=source[prop]}else extendObjectAttributes(source[prop][idx],target[prop][a],extendArrays)}else target[prop]=source[prop];else if(source[prop]instanceof Window||isDOMNode(source[prop]))target[prop]=source[prop];else if(typeof source[prop]!="object")target[prop]=source[prop];else{if(target[prop]===undefined)target[prop]=null;target[prop]=
extendObjectAttributes(source[prop],target[prop],extendArrays)}return target}catch(error){return error.message}}function merge(source,target,override){try{if(source==target)return target;if(target==null){target=clone(source);return target}for(var prop in source)if(typeof source[prop]!="object"||source[prop]instanceof Array){if(target[prop]===undefined||override||override==undefined)target[prop]=source[prop]}else if(source[prop]instanceof Window||isDOMNode(source[prop]))target[prop]=source[prop];else{if(target[prop]===
undefined)target[prop]=null;target[prop]=merge(source[prop],target[prop],override)}return target}catch(error){return error.message}}function applyAttributes(source,attributes){try{if(source==attributes)return source;if(source==null)return source;for(var prop in source)if(typeof source[prop]!="object"||source[prop]instanceof Array){if(attributes[prop]!=undefined)source[prop]=attributes[prop]}else if(attributes[prop]instanceof Window||isDOMNode(attributes[prop]))source[prop]=attributes[prop];else if(attributes[prop]!=
undefined)source[prop]=applyAttributes(source[prop],attributes[prop]);return source}catch(error){return error.message}}function setAttribute(elem,keyValueAttributes,deep){deep=isNumber(deep)?deep:0;var recursive=function(elem,keyValueAttributes,count){if(elem){for(var attrib in keyValueAttributes)if(elem.nodeType==1&&elem.setAttribute)elem.setAttribute(attrib,keyValueAttributes[attrib]);if(count<deep&&elem.childNodes&&elem.childNodes.length>0){count++;for(var i=0;i<elem.childNodes.length;i++)recursive(elem.childNodes[i],
keyValueAttributes,count)}}};recursive(elem,keyValueAttributes,0)}function equals(a,b){if(arguments.length>2&&getDataTypeOf(arguments[2])=="json")return equalsWithOptions.apply(null,arguments);try{var p;var tap;var i;if(a==null&&b==null)return true;if(a==null&&b!=null||b==null)return false;if(a==undefined&&b==undefined)return true;if(a==undefined&&b!=undefined||b==undefined)return false;for(p in a)if(typeof b[p]=="undefined"&&typeof a[p]!="undefined")return false;else{tap=typeof a[p];switch(tap){case "object":if(tap!=
typeof b[p])return false;else if(a[p]instanceof HTMLElement){if(a[p]!==b[p])return false}else{tap=getTypeOf(a[p]);if(tap!=getTypeOf(b[p]))return false;else switch(tap){case "date":if(a[p].getTime()!=b[p].getTime())return false;break;case "array":if(a[p].length!=b[p].length)return false;else for(i=0;i<a[p].length;i++)if(!equals(a[p][i],b[p][i]))return false;break;default:if(!equals(a[p],b[p]))return false}}break;case "function":if(a[p].toString()!=b[p].toString())return false;break;default:if(a[p]!=
b[p])return false}}for(p in b)if(typeof a[p]=="undefined"&&typeof b[p]!="undefined")return false;return true}catch(e){GLOBAL_VAR["class"]["privateREF#"]["console"].log("Error comparing data objects: "+e.message);return false}finally{i=tap=p=null}}function equalsWithOptions(a,b,options){let d=false;let ds=[];let r=false;d=options?.differencies?true:false;try{var p;var tap;var i;if(a==null&&b==null)return true;if(a==null&&b!=null||b==null){if(!d)return r;ds.push("A is null")}if(a==undefined&&b==undefined)return true;
if(a==undefined&&b!=undefined||b==undefined){if(!d)return r;ds.push("A or B is undefined")}for(p in a)if(typeof b[p]=="undefined"&&typeof a[p]!="undefined"){if(!d)return r;ds.push(`B property is undefined prop: "${p}"`)}else{tap=typeof a[p];switch(tap){case "object":if(tap!=typeof b[p]){if(!d)return r;ds.push(`B prop: "${p}", is not a type of 'Object'`)}else if(a[p]instanceof HTMLElement){if(a[p]!==b[p]){if(!d)return r;ds.push(`B prop: "${p}", is not a type of 'HTMLElement'`)}}else{tap=getTypeOf(a[p]);
if(tap!=getTypeOf(b[p])){if(!d)return r;ds.push(`A prop: "${p}", type: "${tap}", is not the same that property B, type: "${getTypeOf(b[p])}"`)}else switch(tap){case "date":if(a[p].getTime()!=b[p].getTime()){if(!d)return r;ds.push(`Property value of A is different than B, prop: "${p}"`)}break;case "array":if(a[p].length!=b[p].length){if(!d)return r;ds.push(`Arrays have differents length, prop: "${p}",  A:${a[p].length}, B:"${b[p].length}"`)}else for(i=0;i<a[p].length;i++){let eq=equalsWithOptions(a[p][i],
b[p][i],options);if(eq!==true){if(!d)return r;ds=ds.concat(eq)}}break;default:let eq=equalsWithOptions(a[p],b[p],options);if(eq!==true){if(!d)return r;ds=ds.concat(eq)}}}break;case "function":if(a[p].toString()!=b[p].toString()){if(!d)return r;ds.push(`B Prop: "${p}" is not a "function"`)}break;default:if(a[p]!=b[p]){if(!d)return r;ds.push(`Prop: "${p}" is not equal`)}}}for(p in b)if(typeof a[p]=="undefined"&&typeof b[p]!="undefined"){if(!d)return r;ds.push(`Prop: "${p}" is undefined in A object, but exists in B object`)}if(!r)r=
d&&ds.length==0||!d?true:false}catch(e){let msg=`Error comparing data objects: ${e.message}`;GLOBAL_VAR["class"]["privateREF#"]["console"].log(msg);if(!d)return r;ds.push(msg);r=false}finally{i=tap=p=null}return r?r:d?ds:false}function toNumber(value,options){if(typeof options=="undefined")options={"type":"int","base":10,"defaultValue":null};else{options.type=typeof options.type!="undefined"?options.type.toLowerCase():"int";if(typeof options.base=="undefined")options.base=10;if(typeof options.defaultValue==
"undefined")options.defaultValue=null}if(isNumber(value))if(options.type=="int"||options.type=="integer")return parseInt(value,options.value);else return parseFloat(value);else if(typeof defaultValue!="undefined")return defaultValue;return value}function createEnum(){return new EnumeratorClass(arguments)}function evalObject(textScript,scope){if(getDataTypeOf(textScript)==="json")return JSON.parse(textScript);else if(!textScript.match(_REEvalFnRetrieve))return window[textScript];else{var script=document.createElement("script");
script.type="text/javascript";script.text=textScript;if(scope)scope.appendChild(script);else document.body.appendChild(script);window.setTimeout(function(){document.body.removeChild(script)},10)}}function createFunctionFromStr(params,strFn){if(params instanceof Array)params.push(strFn);return Function.apply(this,params)}function jsonToArray(json){var result=[];return Object.keys(json)}function jsonToString(jsonObj,firstParams,encode){var str="";var encFn=encode===true?encodeURIComponent:function(value){return value};
firstParams=firstParams===true?"?":firstParams===false?"&":typeof firstParams!="undefined"?firstParams:"&";for(var kvp in jsonObj){str+=firstParams+kvp+"="+encFn(jsonObj[kvp]);firstParams="&"}return str}function jsonMap(target,source,map,options={useBothKey:true,removeChildren:true}){if(!target)return null;if(source&&map)if(getDataTypeOf(map)=="json")for(let kvp in map){let values=map[kvp];if(!(values instanceof Array))values=[values];if(options.useBothKey)values=[kvp].concat(values);if(values){let propValue=
null;let idx=0,len=values.length;while(!propValue&&idx<len&&propValue==undefined){propValue=getValue(source,values[idx],undefined);if(propValue==undefined)propValue=source[values[idx]];idx++}if(propValue!=undefined)if(typeof target[kvp]==="object"&&typeof propValue==="object")merge(propValue,target[kvp],true);else setValue(target,kvp,propValue)}}else throw new Error(`Map object is not a JSON Object`);return target}Object.defineProperty(this,"getTypeOf",{"enumerable":false,"configurable":false,"writable":false,
"value":getTypeOf});Object.defineProperty(this,"getDataTypeOf",{"enumerable":false,"configurable":false,"writable":false,"value":getDataTypeOf});Object.defineProperty(this,"validateTypeOf",{"enumerable":false,"configurable":false,"writable":false,"value":validateTypeOf});Object.defineProperty(this,"getHTMLType",{"enumerable":false,"configurable":false,"writable":false,"value":getTypeOfHTMLElement});Object.defineProperty(this,"getTypeOfNode",{"enumerable":false,"configurable":false,"writable":false,
"value":getTypeOfNode});Object.defineProperty(this,"validate",{"enumerable":false,"configurable":false,"writable":false,"value":validate});Object.defineProperty(this,"convertTo",{"enumerable":false,"configurable":false,"writable":false,"value":convertTo});Object.defineProperty(this,"toNumber",{"enumerable":false,"configurable":false,"writable":false,"value":toNumber});Object.defineProperty(this,"isNumber",{"enumerable":false,"configurable":false,"writable":false,"value":isNumber});Object.defineProperty(this,
"existPath",{"enumerable":false,"configurable":false,"writable":false,"value":existsPath});Object.defineProperty(this,"existsPath",{"enumerable":false,"configurable":false,"writable":false,"value":existsPath});Object.defineProperty(this,"getValue",{"enumerable":false,"configurable":false,"writable":false,"value":getValue});Object.defineProperty(this,"setValue",{"enumerable":false,"configurable":false,"writable":false,"value":setValue});Object.defineProperty(this,"deleteValue",{"enumerable":false,
"configurable":false,"writable":false,"value":deleteValue});Object.defineProperty(this,"parseAttributes",{"enumerable":false,"configurable":false,"writable":false,"value":function(target,attributes){return parseByMatched(attributes,target)}});Object.defineProperty(this,"extend",{"enumerable":false,"configurable":false,"writable":false,"value":extendObject});Object.defineProperty(this,"jsonsBalance",{"enumerable":false,"configurable":false,"writable":false,"value":jsonsBalance});Object.defineProperty(this,
"jsonMap",{"enumerable":false,"configurable":false,"writable":false,"value":jsonMap});Object.defineProperty(this,"compareJsonBranches",{"enumerable":false,"configurable":false,"writable":false,"value":compareJsonBranches});Object.defineProperty(this,"merge",{"enumerable":false,"configurable":false,"writable":false,"value":merge});Object.defineProperty(this,"applyAttributes",{"enumerable":false,"configurable":false,"writable":false,"value":applyAttributes});Object.defineProperty(this,"clone",{"enumerable":false,
"configurable":false,"writable":false,"value":clone});Object.defineProperty(this,"evaluate",{"enumerable":false,"configurable":false,"writable":false,"value":evaluate});Object.defineProperty(this,"exist",{"enumerable":false,"configurable":false,"writable":false,"value":evalExists});Object.defineProperty(this,"exists",{"enumerable":false,"configurable":false,"writable":false,"value":evalExists});Object.defineProperty(this,"setAttribute",{"enumerable":false,"configurable":false,"writable":false,"value":setAttribute});
Object.defineProperty(this,"equals",{"enumerable":false,"configurable":false,"writable":false,"value":equals});Object.defineProperty(this,"checkPathValue",{"enumerable":false,"configurable":false,"writable":false,"value":checkPathValue});Object.defineProperty(this,"hasPath",{"enumerable":false,"configurable":false,"writable":false,"value":hasPath});Object.defineProperty(this,"createEnum",{"enumerable":false,"configurable":false,"writable":false,"value":createEnum});Object.defineProperty(this,"eval",
{"enumerable":false,"configurable":false,"writable":false,"value":evalObject});Object.defineProperty(this,"createFunction",{"enumerable":false,"configurable":false,"writable":false,"value":createFunctionFromStr});Object.defineProperty(this,"jsonToArray",{"enumerable":false,"configurable":false,"writable":false,"value":jsonToArray});Object.defineProperty(this,"jsonToString",{"enumerable":false,"configurable":false,"writable":false,"value":jsonToString});Object.defineProperty(this,"getFunctionName",
{"enumerable":false,"configurable":false,"writable":false,"value":getFunctionName});if(GLOBAL_VAR.console.logDebug)if(window.console!=undefined&&window.console.log!=undefined)window.console.log("Initializing "+_className+" class. - "+(new Date).toString());return this}function Polyfills(){var _className=getFunctionName(arguments);if(typeof window.btoa=="undefined"){var btoa=null;if(typeof window.Base64!="undefined"&&typeof window.Base64.encode!="undefined")btoa=Base64.encode;else if(typeof window.jQuery!=
"undefined"&&typeof window.jQuery.base64!="undefined"&&typeof window.jQuery.base64.encode!="undefined")btoa=jQuery.base64.encode;if(btoa!=null)Object.defineProperty(window,"btoa",{"enumerable":true,"writable":false,"configurable":false,"value":function(data){return btoa(data)}})}if(typeof window.crypto==="undefined")window.crypto=window.msCrypto;if(GLOBAL_VAR.console.logDebug)if(window.console!=undefined&&window.console.log!=undefined)window.console.log("Initializing "+_className+" class. - "+(new Date).toString())}
function Printer(){var _className=getFunctionName(arguments);function supportPrint(){var response=false;if(window.agentInfo)if(agentInfo.isWindows)switch(true){case agentInfo.isOpera:case agentInfo.isChrome:case agentInfo.isSafari:case agentInfo.isYandex:response=true;break;case agentInfo.isMSIE:case agentInfo.isFirefox:case agentInfo.isNokiaBrowser:default:response=false;break}else if(agentInfo.isMac)switch(true){case agentInfo.isOpera:case agentInfo.isChrome:case agentInfo.isSafari:case agentInfo.isYandex:response=
true;break;case agentInfo.isFirefox:case agentInfo.isNokiaBrowser:case agentInfo.isSymbian:default:response=false;break}else if(agentInfo.isIOS)switch(true){case agentInfo.isSafari:case agentInfo.isOpera:case agentInfo.isChrome:case agentInfo.isFirefox:case agentInfo.isNokiaBrowser:case agentInfo.isSymbian:default:response=false;break}else if(agentInfo.isChromeOS)response=false;else if(agentInfo.isPlaybook)response=false;else if(agentInfo.isHPTablet)response=false;else if(agentInfo.isAndroid)response=
false;else if(agentInfo.isIphone)response=false;else response=false;else{helper.console.warning("AgentInfo class is not defined",arguments);response=false}return response}function supportPrintMethods(){var response={"PREVIEW":false,"DIRECT":false};if(window.agentInfo)if(agentInfo.isWindows)switch(true){case agentInfo.isChrome:case agentInfo.isFirefox:case agentInfo.isSafari:case agentInfo.isOpera:case agentInfo.isYandex:response.PREVIEW=true;response.DIRECT=true;break;case agentInfo.isMSIE:response.PREVIEW=
true;response.DIRECT=false;break;case agentInfo.isNokiaBrowser:default:response.PREVIEW=false;response.DIRECT=false;break}else if(agentInfo.isMac)switch(true){case agentInfo.isOpera:case agentInfo.isChrome:case agentInfo.isSafari:case agentInfo.isYandex:response.PREVIEW=true;response.DIRECT=true;break;case agentInfo.isFirefox:case agentInfo.isNokiaBrowser:case agentInfo.isSymbian:default:response.PREVIEW=false;response.DIRECT=false;break}else if(agentInfo.isIOS)switch(true){case agentInfo.isSafari:if(agentInfo.ipadModel<=
2){response.PREVIEW=true;response.DIRECT=true}else if(agentInfo.ipadModel==3){response.PREVIEW=true;response.DIRECT=true}else{response.PREVIEW=true;response.DIRECT=false}break;case agentInfo.isChrome:response.PREVIEW=true;response.DIRECT=true;break;case agentInfo.isOpera:case agentInfo.isFirefox:case agentInfo.isNokiaBrowser:case agentInfo.isSymbian:default:response.PREVIEW=false;response.DIRECT=false;break}else if(agentInfo.isChromeOS){response.PREVIEW=false;response.DIRECT=false}else if(agentInfo.isPlaybook){response.PREVIEW=
false;response.DIRECT=false}else if(agentInfo.isHPTablet){response.PREVIEW=false;response.DIRECT=false}else if(agentInfo.isAndroid){response.PREVIEW=true;response.DIRECT=true}else if(agentInfo.isIphone){response.PREVIEW=false;response.DIRECT=false}else{response.PREVIEW=false;response.DIRECT=false}else{helper.console.warning("AgentInfo class is not defined",arguments);response.PREVIEW=false;response.DIRECT=false}return response}Object.defineProperty(this,"supportPrint",{"enumerable":true,"configurable":false,
"get":function(){return supportPrint()}});Object.defineProperty(this,"printMethods",{"enumerable":true,"configurable":false,"get":function(){return supportPrintMethods()}});if(GLOBAL_VAR.console.logDebug)if(window.console!=undefined&&window.console.log!=undefined)window.console.log("Initializing "+_className+" class. - "+(new Date).toString());return this}function Size(){var _className=getFunctionName(arguments);var _isMSIE=false;function round(value,decimals){var strValue;try{if(value!=null&&value!=
undefined&&(value!=""||value.toString()=="0")&&value.toString().toUpperCase()!="NAN"){strValue=parseFloat(value).toFixed(decimals);if(decimals==undefined||decimals==null||decimals==0)strValue=parseInt(strValue,10)}else strValue=""}catch(error){}return strValue}function isMSIE(){var userAgent=window.navigator.userAgent.toLowerCase();var isMSIE=false;var reg=/(msie) ([\w.]+)/.exec(userAgent);var ieTest=/(msie) ([0-9\.]+)/i.exec(userAgent);isMSIE=!!(ieTest&&ieTest[1]=="msie");if(!isMSIE&&userAgent.indexOf("trident")!=
-1&&/rv:([0-9\.]+)/i.exec(userAgent))isMSIE=true;return isMSIE}_isMSIE=isMSIE();function getCleanValue(value){var retValue=0;try{if(GLOBAL_VAR["class"]["privateREF#"]["object"]["isNumber"](value))retValue=parseFloat(value);else if(typeof(value=="string")){var exampleValue=round(1,2);var hasPoint=true;var re=new RegExp("[+-]?[0-9]*[.,][0-9]*|[+-]?[0-9]*");if(exampleValue.indexOf(",")!=-1)hasPoint=false;var regExpExec=re.exec(value);if(regExpExec!=null&&regExpExec[0]!=undefined&&regExpExec[0]!=""&&
regExpExec[0]!=null){var retValue=regExpExec[0];if(hasPoint)retValue=retValue.replace(",",".");else retValue=retValue.replace(".",",");retValue=parseFloat(retValue)}else retValue=value}else retValue=value}catch(error){retValue=value}return retValue}function getElementWidth(elem,includingMargin){var retValue=0;try{if(elem)if(elem.window&&elem.document&&elem.document.documentElement)retValue=elem.document.documentElement.clientWidth||elem.document.documentElement.offsetWidth;else if(window.getComputedStyle&&
elem.nodeType!=9&&window.getComputedStyle(elem,null)!=null){var tempWidth=window.getComputedStyle(elem,null).getPropertyValue("width");if(tempWidth.indexOf("px")>-1)retValue=getCleanValue(tempWidth);else if(tempWidth.indexOf("%")>-1)retValue=getElementWidth(elem.parentElement)*parseInt(getCleanValue(tempWidth),10)/100;else if(tempWidth.indexOf("auto")>-1)retValue=getElementWidth(elem.parentElement);else retValue=tempWidth}else if(elem.offsetWidth!=undefined&&elem.offsetWidth!=0)retValue=elem.offsetWidth;
else if(elem.clientWidth!=undefined&&elem.clientWidth!=0)retValue=elem.clientWidth;else if(_isMSIE==false&&elem.ownerDocument&&elem.ownerDocument.documentElement)retValue=elem.ownerDocument.documentElement.clientWidth||elem.ownerDocument.documentElement.offsetWidth;else if(elem.currentStyle)if(elem.currentStyle.width&&elem.currentStyle.width.indexOf("px")>-1)retValue=parseInt(elem.currentStyle.width.replace("px",""),10);else if(elem.currentStyle.width&&elem.currentStyle.width.indexOf("%")>-1)retValue=
getElementWidth(elem.parentElement)*parseInt(elem.currentStyle.width.replace("%",""),10)/100;else{if(elem.currentStyle.width&&elem.currentStyle.width.indexOf("auto")>-1)retValue=getElementWidth(elem.parentElement)}else if(elem.documentElement&&elem.documentElement.offsetWidth)retValue=elem.documentElement.offsetWidth;else if(elem.parentElement)retValue=getElementWidth(elem.parentElement);else retValue=0;else if(window.document.body.clientWidth!=undefined)retValue=window.document.body.clientWidth;
else if(window.document.body.offsetWidth!=undefined)retValue=window.document.body.offsetWidth;else retValue=MYREFERENCES.DefaultWidth;if(includingMargin===true){var css=window.getComputedStyle(elem,null);if(css){var ar=["marginLeft","marginRight","left","right"];for(var i=0;i<ar.length;i++){var rv=css[ar[i]];if(rv!="auto"&&rv!="")retValue+=parseFloat(getCleanValue(rv))}}}}catch(error){genericLog(error,arguments);retValue=0}return retValue}function getElementHeight(elem,includingMargin){var retValue=
0;try{if(elem)if(elem.window&&elem.document&&elem.document.documentElement)retValue=elem.document.documentElement.clientHeight||elem.document.documentElement.offsetHeight;else if(window.getComputedStyle&&elem.nodeType!=9&&window.getComputedStyle(elem,null)!=null){var tempHeight=window.getComputedStyle(elem,null).getPropertyValue("height");if(tempHeight.indexOf("px")>-1)retValue=getCleanValue(tempHeight);else if(tempHeight.indexOf("%")>-1)retValue=getElementHeight(elem.parentElement)*parseInt(getCleanValue(tempHeight),
10)/100;else if(tempHeight.indexOf("auto")>-1)retValue=getElementHeight(elem.parentElement);else retValue=tempHeight}else if(elem.offsetHeight!=undefined&&elem.offsetHeight!=0)retValue=elem.offsetHeight;else if(elem.clientHeight!=undefined&&elem.clientHeight!=0)retValue=elem.clientHeight;else if(_isMSIE==false&&elem.ownerDocument&&elem.ownerDocument.documentElement)retValue=elem.ownerDocument.documentElement.clientHeight||elem.ownerDocument.documentElement.offsetHeight;else if(elem.currentStyle)if(elem.currentStyle.height&&
elem.currentStyle.height.indexOf("px")>-1)retValue=parseInt(elem.currentStyle.height.replace("px",""),10);else if(elem.currentStyle.height&&elem.currentStyle.height.indexOf("%")>-1)retValue=getElementHeight(elem.parentElement)*parseInt(elem.currentStyle.height.replace("%",""),10)/100;else{if(elem.currentStyle.height&&elem.currentStyle.height.indexOf("auto")>-1)retValue=getElementHeight(elem.parentElement)}else if(elem.documentElement&&elem.documentElement.scrollHeight)retValue=elem.documentElement.scrollHeight;
else if(elem.parentElement)retValue=getElementHeight(elem.parentElement);else retValue=0;else if(window.document.body.clientHeight!=undefined)retValue=window.document.body.clientHeight;else if(window.document.body.offsetHeight!=undefined)retValue=window.document.body.offsetHeight;else retValue=MYREFERENCES.DefaultHeight;if(includingMargin===true){var css=window.getComputedStyle(elem,null);if(css){var ar=["marginTop","marginBottom","top","bottom"];for(var i=0;i<ar.length;i++){var rv=css[ar[i]];if(rv!=
"auto"&&rv!="")retValue+=parseFloat(getCleanValue(rv))}}}}catch(error){genericLog(error,arguments);retValue=0}return retValue}function getElementSize(elem,includingMargin){try{var _w;var _h;_w=getElementWidth(elem,includingMargin);_h=getElementHeight(elem,includingMargin);if(_w==undefined)_w=window.screen.width;if(_h==undefined)_h=window.screen.height;return{"width":_w,"height":_h}}catch(error){genericLog(error,arguments);return{"width":0,"height":0}}}Object.defineProperty(this,"getWidth",{"enumerable":true,
"configurable":false,"writable":false,"value":getElementWidth});Object.defineProperty(this,"getHeight",{"enumerable":true,"configurable":false,"writable":false,"value":getElementHeight});Object.defineProperty(this,"get",{"enumerable":true,"configurable":false,"writable":false,"value":getElementSize});Object.defineProperty(this,"cleanValue",{"enumerable":true,"configurable":false,"writable":false,"value":getCleanValue});if(GLOBAL_VAR.console.logDebug)if(window.console!=undefined&&window.console.log!=
undefined)window.console.log("Initializing "+_className+" class. - "+(new Date).toString());return this}function SessionStorage(){var _className=getFunctionName(arguments);var _supportSessionStorage=true;function initialize(){try{_supportSessionStorage=window.sessionStorage?true:false}catch(error){_supportSessionStorage=false}}function get(key){var tempData=null;if(_supportSessionStorage){tempData=sessionStorage.getItem(key);if(tempData)try{tempData=JSON.parse(tempData)}catch(error){GLOBAL_VAR["class"]["privateREF#"]["console"].error(error.message,
error,arguments);return error}}return tempData}function add(key,value){if(_supportSessionStorage&&key)try{sessionStorage.setItem(key,JSON.stringify(value))}catch(error){GLOBAL_VAR["class"]["privateREF#"]["console"].error(error.message,error,arguments)}}function remove(key){if(_supportSessionStorage&&key)sessionStorage.removeItem(key)}function clear(){if(_supportSessionStorage)sessionStorage.clear()}initialize();Object.defineProperty(this,"get",{"enumerable":true,"configurable":false,"writable":false,
"value":get});Object.defineProperty(this,"set",{"enumerable":true,"configurable":false,"writable":false,"value":add});Object.defineProperty(this,"add",{"enumerable":true,"configurable":false,"writable":false,"value":add});Object.defineProperty(this,"remove",{"enumerable":true,"configurable":false,"writable":false,"value":remove});Object.defineProperty(this,"clear",{"enumerable":true,"configurable":false,"writable":false,"value":clear});if(GLOBAL_VAR.console.logDebug)if(window.console!=undefined&&
window.console.log!=undefined)window.console.log("Initializing "+_className+" class. - "+(new Date).toString());return this}function Storage(){var _className=getFunctionName(arguments);var _noop=function(){};var _supportLocalStorage=true;var _eventName="storage";var _handlers={};_handlers[_eventName]={};var _listening=false;function initialize(){try{_supportLocalStorage=window.localStorage?true:false;if(!_supportLocalStorage)_off=_on=clear=remove=add=get=_noop}catch(error){_supportLocalStorage=false}}
function get(key){var tempData=null;tempData=localStorage.getItem(key);if(tempData)try{tempData=JSON.parse(tempData)}catch(error){GLOBAL_VAR["class"]["privateREF#"]["console"].error(error.message,error,arguments);return error}return tempData}function add(key,value){if(key)try{return localStorage.setItem(key,JSON.stringify(value))}catch(error){GLOBAL_VAR["class"]["privateREF#"]["console"].error(error.message,error,arguments)}}function remove(key){if(key)return localStorage.removeItem(key)}function clear(){return localStorage.clear()}
function on(key,handler){if(key&&handler)if(handler instanceof Function){if(!_listening)window.addEventListener(_eventName,localStorageChange,{passive:true});if(!_handlers[_eventName][key])_handlers[_eventName][key]=[];_handlers[_eventName][key].push(handler);_listening=true;return true}else return false;else return false}function off(key,handler){if(key&&handler)if(handler instanceof Function){if(_handlers[_eventName][key]){let idx=_handlers[_eventName][key].indexOf(handler);if(idx!=-1)_handlers[_eventName][key].splice(idx,
1)}else return false;return true}else return false;else return false}function localStorageChange(e){if(_handlers[_eventName][e.key])_handlers[_eventName][e.key].forEach(hnd=>{try{hnd(e)}catch(err){}})}initialize();Object.defineProperty(this,"get",{"enumerable":true,"configurable":false,"writable":false,"value":get});Object.defineProperty(this,"set",{"enumerable":true,"configurable":false,"writable":false,"value":add});Object.defineProperty(this,"add",{"enumerable":true,"configurable":false,"writable":false,
"value":add});Object.defineProperty(this,"remove",{"enumerable":true,"configurable":false,"writable":false,"value":remove});Object.defineProperty(this,"clear",{"enumerable":true,"configurable":false,"writable":false,"value":clear});var ss=new SessionStorage;Object.defineProperty(this,"session",{"enumerable":true,"configurable":false,"get":function(){return ss}});Object.defineProperty(this,"on",{enumerable:true,configurable:false,writeble:false,value:on});Object.defineProperty(this,"off",{enumerable:true,
configurable:false,writeble:false,value:off});if(GLOBAL_VAR.console.logDebug)if(window.console!=undefined&&window.console.log!=undefined)window.console.log("Initializing "+_className+" class. - "+(new Date).toString());return this}function StringExtend(){var _className=getFunctionName(arguments);if(!String.prototype.trimLeft)String.prototype.trimLeft=function(){return this.replace(/^\s+/,"")};if(!String.prototype.ltrim)String.prototype.ltrim=function(){return this.replace(/^\s+/,"")};if(!String.prototype.trimRight)String.prototype.trimRight=
function(){return this.replace(/\s+$/,"")};if(!String.prototype.rtrim)String.prototype.rtrim=function(){return this.replace(/\s+$/,"")};if(!String.prototype.trim)String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")};function trim(str){return typeof str=="string"?str.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""):str}function leftTrim(str){return typeof str=="string"?str.replace(/^\s+/,""):str}function rightTrim(str){return typeof str=="string"?str.replace(/\s+$/,
""):str}function formatStr(format,values){var args=Array.prototype.slice.call(arguments,1);return format.replace(/{(\d+)}/g,function(match,number){return typeof args[number]!="undefined"?args[number]:match})}function sprintf(format,values){var arg=arguments;var i=1;if(format!=null&&typeof format!="undefined")return format.replace(/%((%)|s)/g,function(m){return m[2]||arg[i++]});else return format}function hasWord(text,word){var i=text.indexOf(word);return i==-1?false:function(tl){return(i==0||text[i-
1]==" ")&&(text.length==tl||text[tl]==" ")}(i+word.length)}Object.defineProperty(this,"trim",{"enumerable":true,"configurable":false,"writable":false,"value":trim});Object.defineProperty(this,"ltrim",{"enumerable":true,"configurable":false,"writable":false,"value":leftTrim});Object.defineProperty(this,"rtrim",{"enumerable":true,"configurable":false,"writable":false,"value":rightTrim});Object.defineProperty(this,"format",{"enumerable":true,"configurable":false,"writable":false,"value":formatStr});
Object.defineProperty(this,"sprintf",{"enumerable":true,"configurable":false,"writable":false,"value":sprintf});Object.defineProperty(this,"hasWord",{"enumerable":true,"configurable":false,"writable":false,"value":hasWord});if(GLOBAL_VAR.console.logDebug)if(window.console!=undefined&&window.console.log!=undefined)window.console.log("Initializing "+_className+" class. - "+(new Date).toString());return this}function Style(){var _className=getFunctionName(arguments);var _dynamicStyleSheet=null;var _gref=
GLOBAL_VAR["class"]["privateREF#"];function parsingAttributes(attribute,value){var attrib={};if(!window.agentInfo)if(GLOBAL_VAR.class["privateREF#"].console)GLOBAL_VAR.class["privateREF#"].console.warning("AgentInfo class is not defined.",arguments);else window.console.log("AgentInfo class is not defined");else try{switch(attribute.toUpperCase()){case "OPACITY":case "FILTER":if(agentInfo.isMSIE){if(value>1)value/=100;attrib["name"]="opacity";attrib["value"]=value}else{attrib["name"]="filter";if(value<
1&&value%1!=0)value*=100;attrib["value"]="alpha(opacity="+value+")"}break;case "FLOAT":case "CSSFLOAT":case "STYLEFLOAT":if(agentInfo.isMSIE)attrib={"name":"styleFloat","value":value};else attrib={"name":"cssFloat","value":value};break;default:attrib={"name":attribute,"value":value};break}}catch(error){return error}return attrib}function add(elems,style){if(elems){var isElem=true;if(!(elems.forEach instanceof Function)){elems=[elems];isElem=false}elems.forEach(function(elem){try{if(GLOBAL_VAR["class"]["privateREF#"]["object"].validate(style)==
true&&GLOBAL_VAR["class"]["privateREF#"]["object"].validate(elem)==true)if(typeof style=="string"&&style.indexOf(":")==-1){var splStyle=GLOBAL_VAR["class"]["privateREF#"]["string"].trim(style).split(" ");var curClass=elem.className.split(" ");for(var i=0;i<splStyle.length;i++){var added=true;for(var k=0;k<curClass.length;k++)if(curClass[k]==splStyle[i]){added=false;break}if(added==true){elem.className=(elem.className+" "+splStyle[i]).replace(/ +/g," ").trim();added=false}}}else if(typeof style=="string"&&
style.indexOf(":")!=-1){var splStyle=GLOBAL_VAR["class"]["privateREF#"]["string"].trim(style).split(":");splStyle[1]=splStyle[1].replace(/[;|,]/g,"");if(GLOBAL_VAR["class"]["privateREF#"].object.evaluate(elem,"style."+splStyle[0])==true)elem.style[splStyle[0]]=splStyle[1]}else if(typeof style=="object")for(var attrib in style){var lAttrib=attrib.substring(0,1).toLowerCase()+attrib.substring(1,attrib.length);if(GLOBAL_VAR["class"]["privateREF#"].object.evaluate(elem,"style."+[lAttrib])==true){elem.style[lAttrib]=
style[attrib];if(elem.style[lAttrib]!=style[attrib]){var text=elem.style.cssText;var start=text.search(lAttrib);if(start==-1)if(text=="")text=attrib+":"+style[attrib];else text+=";"+attrib+":"+style[attrib];else{var end=text.substr(start).search(";");if(end==-1)text=text.replace(text.substr(start),attrib+":"+style[attrib]);else text=text.replace(text.substr(start,end),attrib+":"+style[attrib])}elem.style.cssText=text}}}}catch(error){return error}});return isElem?elems[0]:elems}}function remove(elems,
toRemove){if(elems){var isElem=true;if(!(elems.forEach instanceof Function)){elems=[elems];isElem=false}elems.forEach(function(elem){if(GLOBAL_VAR["class"]["privateREF#"]["object"].validate(toRemove)==true&&GLOBAL_VAR["class"]["privateREF#"]["object"].validate(elem)==true)if(typeof toRemove=="string"&&toRemove.indexOf(":")==-1){var rmvClasses=GLOBAL_VAR["class"]["privateREF#"]["string"].trim(toRemove).split(/ +/g);var curClasses=GLOBAL_VAR["class"]["privateREF#"]["string"].trim(elem.className).split(/ +/g);
var p;for(var i=0;i<rmvClasses.length;i++){p=curClasses.indexOf(rmvClasses[i]);if(p!=-1)curClasses.splice(p,1)}elem.className=curClasses.join(" ")}});return isElem?elems[0]:elems}}function addAll(elem,style){if(GLOBAL_VAR["class"]["privateREF#"]["object"].validate(style)==true&&GLOBAL_VAR["class"]["privateREF#"]["object"].validate(elem)==true){add(elem,style);for(var i=0;i<elem.childNodes.length;i++)addAll(elem.childNodes[i],style)}}function removeAll(elem,style){if(GLOBAL_VAR["class"]["privateREF#"]["object"].validate(style)==
true&&GLOBAL_VAR["class"]["privateREF#"]["object"].validate(elem)==true){remove(elem,style);for(var i=0;i<elem.childNodes.length;i++)removeAll(elem.childNodes[i],style)}}function replace(elems,oldStyle,newStyle){if(elems){var isElem=true;if(!(elems.forEach instanceof Function)){elems=[elems];isElem=false}elems.forEach(function(elem){remove(elem,oldStyle);add(elem,newStyle)});return isElem?elems[0]:elems}}function hasClass(elem,className){if(elem&&className&&elem instanceof HTMLElement&&typeof className==
"string"){var splClasses=GLOBAL_VAR["class"]["privateREF#"]["string"].trim(className).split(/ +/g);var count=0;for(var i=0;i<splClasses.length;i++)if(GLOBAL_VAR["class"]["privateREF#"]["string"].hasWord(elem.className,splClasses[i]))count++;return count==splClasses.length}return false}function hasAnyClass(elem,classes){if(elem&&classes&&elem instanceof HTMLElement&&typeof classes=="string"){var splClasses=GLOBAL_VAR["class"]["privateREF#"]["string"].trim(classes).split(/ +/g);for(var i=0;i<splClasses.length;i++)if(GLOBAL_VAR["class"]["privateREF#"]["string"].hasWord(elem.className,
splClasses[i]))return true;return false}return false}function hasAnyParentsClass(elem,classes){if(!elem)return false;else if(hasAnyClass(elem,classes))return true;else return hasAnyParentsClass(elem.parentElement,classes)}function getAttribute(elem,attribute){var value=undefined;var obj=GLOBAL_VAR["class"]["privateREF#"]["object"];try{if(obj.validate(elem)&&obj.validate(attribute)){if(obj.exists(elem,"currentStyle")==true){attribute=attribute.replace(/\-(\w)/g,function(strMatch,p1){return p1.toUpperCase()});
return elem.currentStyle[attribute]}if(obj.exists(document,"defaultView.getComputedStyle")){value=document.defaultView.getComputedStyle(elem,"");if(value!=null)return value.getPropertyValue(attribute)}if(obj.exists(elem,"style."+attribute)==true)return elem.style[attribute]}return value}catch(error){return error}}function getComputedStyleProperty(elem,prop){var value;if(elem.currentStyle)value=elem.currentStyle[styleProp];else if(window.getComputedStyle)value=document.defaultView.getComputedStyle(elem,
null).getPropertyValue(prop);return value}function getCSSRule(rulePath){var ruleName=rulePath.toLowerCase();var styleSheet;var i,ii;var cssRule,cssRuleInner=null;var cssRules,cssRulesInner;if(document.styleSheets)for(i=0;i<document.styleSheets.length;i++){styleSheet=document.styleSheets[i];try{styleSheet.cssRules||styleSheet.rules}catch(error){continue}if(styleSheet.cssRules)cssRules=styleSheet.cssRules;else cssRules=styleSheet.rules;if(cssRules)for(ii=0;ii<cssRules.length;ii++){cssRule=cssRules[ii];
if(cssRule)if(cssRule.selectorText){let selectors=cssRule.selectorText.split(",");if(selectors.find(r=>{return _gref.string.trim(r.toLowerCase())==ruleName}))return cssRule}else if(cssRule.styleSheet){if(cssRule.styleSheet.cssRules)cssRulesInner=cssRule.styleSheet.cssRules;else cssRulesInner=cssRule.styleSheet.rules;if(cssRulesInner)for(jj=0;jj<cssRulesInner.length;jj++){cssRuleInner=cssRulesInner[jj];if(cssRuleInner)if(cssRuleInner.selectorText)if(cssRuleInner.selectorText.toLowerCase()==ruleName)return cssRuleInner}}}}return null}
function addCSSRule(rulepath,style){if(!_dynamicStyleSheet){_dynamicStyleSheet=document.createElement("style");_dynamicStyleSheet.type="text/css";var idx=document.styleSheets.length;document.getElementsByTagName("head")[0].appendChild(_dynamicStyleSheet);_dynamicStyleSheet=document.styleSheets[idx]}var cssRules=null;if(_dynamicStyleSheet.cssRules)cssRules=_dynamicStyleSheet.cssRules;else cssRules=_dynamicStyleSheet.rules;_dynamicStyleSheet.insertRule(rulepath+"{"+style+"}",cssRules.length)}function removeCSSRule(rulepath){ruleName=
ruleName.toLowerCase();var styleSheet;var i,ii;var cssRule=null;var cssRules;if(document.styleSheets)for(i=0;i<document.styleSheets.length;i++){styleSheet=document.styleSheets[i];if(styleSheet.cssRules)cssRules=styleSheet.cssRules;else cssRules=styleSheet.rules;if(cssRules)for(var k=0;k<cssRules.length;k++){cssRule=cssRules[k];if(cssRule.selectorText)if(cssRule.selectorText.toLowerCase()==ruleName){cssRules.splice(k,1);return}}}}function changeCSSRule(rule,attribute,value){if(typeof rule=="string")rule=
getCSSRule(rule);if(rule)rule.style[attribute]=value;else GLOBAL_VAR["class"]["privateREF#"]["console"].log("rule '"+rule+"' not found",arguments)}function getCSSRuleAttributes(rule){if(typeof rule=="string")rule=getCSSRule(rule);if(rule==null)return null;else return rule.style}function getCSSRuleAttribute(rule,attrname){var attr=null;if(typeof rule=="string")rule=getCSSRule(rule);var styles=getCSSRuleAttributes(rule);if(styles!=null)attr=styles.getPropertyValue(attrname);return attr}function showElem(elems,
display){if(elems){if(!(elems instanceof Array))elems=[elems];var _show=function(elem){if(typeof elem=="string")elem=document.getElementById(elem);if(elem){if(getAttribute(elem,"display")=="none"&&display!==false){if(typeof display=="undefined")display="inherit";elem.style.display=display}if(elem.style.visibility!="visible")elem.style.visibility="visible"}};elems.forEach(_show)}}function hideElem(elems,display){if(elems){if(!(elems instanceof Array))elems=[elems];var _hide=function(elem){if(typeof elem==
"string")elem=document.getElementById(elem);if(elem){if(getAttribute(elem,"display")!="none"&&display!==false){if(typeof display=="undefined")display="none";elem.style.display=display}if(elem.style.visibility!="hidden")elem.style.visibility="hidden"}};elems.forEach(_hide)}}Object.defineProperty(this,"add",{"enumerable":true,"configurable":false,"writable":false,"value":add});Object.defineProperty(this,"addClass",{"enumerable":true,"configurable":false,"writable":false,"value":add});Object.defineProperty(this,
"remove",{"enumerable":true,"configurable":false,"writable":false,"value":remove});Object.defineProperty(this,"removeClass",{"enumerable":true,"configurable":false,"writable":false,"value":remove});Object.defineProperty(this,"replace",{"enumerable":true,"configurable":false,"writable":false,"value":replace});Object.defineProperty(this,"hasClass",{"enumerable":true,"configurable":false,"writable":false,"value":hasClass});Object.defineProperty(this,"hasAnyClass",{"enumerable":true,"configurable":false,
"writable":false,"value":hasAnyClass});Object.defineProperty(this,"hasAnyParentsClass",{"enumerable":true,"configurable":false,"writable":false,"value":hasAnyParentsClass});Object.defineProperty(this,"getAttribute",{"enumerable":true,"configurable":false,"writable":false,"value":getAttribute});Object.defineProperty(this,"getComputedStyle",{"enumerable":true,"configurable":false,"writable":false,"value":getComputedStyleProperty});Object.defineProperty(this,"getCSSRule",{"enumerable":true,"configurable":false,
"writable":false,"value":getCSSRule});Object.defineProperty(this,"addCSSRule",{"enumerable":true,"configurable":false,"writable":false,"value":addCSSRule});Object.defineProperty(this,"removeCSSRule",{"enumerable":true,"configurable":false,"writable":false,"value":removeCSSRule});Object.defineProperty(this,"changeCSSRule",{"enumerable":true,"configurable":false,"writable":false,"value":changeCSSRule});Object.defineProperty(this,"getCSSRuleAttributes",{"enumerable":true,"configurable":false,"writable":false,
"value":getCSSRuleAttributes});Object.defineProperty(this,"getCSSRuleAttribute",{"enumerable":true,"configurable":false,"writable":false,"value":getCSSRuleAttribute});Object.defineProperty(this,"show",{"enumerable":true,"configurable":false,"writable":false,"value":showElem});Object.defineProperty(this,"hide",{"enumerable":true,"configurable":false,"writable":false,"value":hideElem});if(GLOBAL_VAR.console.logDebug)if(window.console!=undefined&&window.console.log!=undefined)window.console.log("Initializing "+
_className+" class. - "+(new Date).toString());return this}function URL(){var _className=getFunctionName(arguments);var _gref=GLOBAL_VAR["class"]["privateREF#"];function gup(name,optionalWindow,defaultValue){var regex=new RegExp("[\\?&]"+name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]")+"=([^&#]*)","ig");var wnd="";try{wnd=typeof optionalWindow!="undefined"&&optionalWindow!=null&&optionalWindow.location&&optionalWindow.location.href?optionalWindow.location.href:window.location.href}catch(error){wnd=
window.location.href}var results=regex.exec(wnd);regex=null;return results==null?typeof defaultValue!="undefined"?defaultValue:"":results[1]}function getParam(parseUrl,name,params){if(params)params=params.replace(/ /g,"").replace(/\\/g,"-").split("-");if(parseUrl&&parseUrl.parameters&&name)for(var i=0;i<parseUrl.parameters.length;i++)if(parseUrl.parameters[i].name.toLowerCase()==name.toLowerCase()){var rParam=parseUrl.parameters[i];if(params){if(params.indexOf("lc")!=-1&&rParam)rParam=rParam.toLowerCase();
if(params.indexOf("uc")!=-1&&rParam)rParam=rParam.toUpperCase()}return rParam}return null}function toUrl(parseUrl,params){var fUrl="";if(parseUrl){if(typeof params==="undefined")params=[];else if(!(params instanceof Array))params=params.replace(/ /g,"").replace(/\\/g,"-").replace(/\//g,"-").split("-");if(params.indexOf("lp")!=-1)fUrl=parseUrl.lastPath;else if(params.indexOf("bp")!=-1)fUrl=parseUrl.brokerPath;else{if(parseUrl.protocol)fUrl+=parseUrl.protocol+"://";if(parseUrl.hostname)fUrl+=parseUrl.hostname;
if(parseUrl.port)fUrl+=":"+parseUrl.port;if(params.indexOf("vp")!=-1){if(fUrl.substr(fUrl.length-1,1)!="/")fUrl+="/"}else if(parseUrl.virtualPath){if(parseUrl.virtualPath.substr(0,1)!="/"&&fUrl.substr(fUrl.length-1,1)!="/")fUrl+="/";fUrl+=parseUrl.virtualPath}if(params.indexOf("r")===-1&&parseUrl.resource){if(fUrl.substr(fUrl.length-1,1)!="/")fUrl+="/";fUrl+=parseUrl.resource}if(params.indexOf("a")===-1)for(var i=0;i<parseUrl.parameters.length;i++)if(typeof parseUrl.parameters[i].value!="undefined")fUrl+=
(i==0?"?":"&")+parseUrl.parameters[i].name+"="+parseUrl.parameters[i].value;else fUrl+=(i==0?"?":"&")+parseUrl.parameters[i].name;if(params.indexOf("o")!=-1)fUrl=fUrl.replace(parseUrl.protocol+"://"+parseUrl.hostname+(parseUrl.port&&parseUrl.port!=""?":"+parseUrl.port:""),"");if(params.indexOf("p")!=-1)fUrl=fUrl.replace(parseUrl.protocol+"://","");if(params.indexOf("h")!=-1)fUrl=fUrl.split("#")[0]}}return fUrl}function parseUrl(url){var ret=null;var port=null;var prot=null;var host=null;var baseURL=
null;var parameters=[];var virtualPath=null;var lastPath=null;var brokerPath=null;var resource=null;var hash=null;var res;try{if(url){url=_gref.string.trim(url.toString());if(url.indexOf("://")!=-1){res=url.split("://");prot=res[0];url=res[1]}url=url.replace(/[/]+/g,"/");var colon=url.indexOf(":");if(colon!==-1&&colon<url.indexOf("/")){res=null;var re=new RegExp(":[0-9]*");res=re.exec(url);if(res!=null){port=res[0].replace(":","");host=url.substring(0,res.index);url=url.substring(res.index+res[0].length,
url.length)}}if(host===null){var slashIdx=url.indexOf("/");if(slashIdx!==-1){host=url.substr(0,slashIdx);url=url.substr(slashIdx)}else{host=url;url=""}}baseURL=url;if(baseURL&&baseURL.indexOf("#")!==-1){let hashes=baseURL.split("#");baseURL=hashes[0];hash=hashes[1]}if(baseURL&&baseURL.indexOf("?")!=-1){var params=baseURL.substr(baseURL.indexOf("?")+1,baseURL.length);virtualPath=baseURL.substr(0,baseURL.indexOf("?"));params=params.split("&");for(var i=0;i<params.length;i++){var param=params[i].split("=");
parameters.push({"name":param[0],"value":param[1]})}}else virtualPath=baseURL;if(virtualPath&&virtualPath.indexOf(".")!=-1){var lbs=virtualPath.lastIndexOf("/");var tempVirtualPath=virtualPath.substr(0,lbs+1);resource=virtualPath.substr(lbs+1,virtualPath.length-lbs);virtualPath=tempVirtualPath;tempVirtualPath=null}}if(host=="")host=null;if(baseURL=="")baseURL=null;if(virtualPath){var tvp=_gref.string.trim(virtualPath);var lvp=tvp.substr(0,tvp.lastIndexOf("/")).split("/");var i=lvp.length-1;lastPath=
lvp[i]!==""?lvp[i]+"/":i-1>0&&lvp[i-1]!==""?lvp[i-1]+"/":"";var bp=tvp;if(!bp.endsWith("/"))bp=tvp.substr(0,tvp.lastIndexOf("/"));bp=bp.split("/");if(bp.length>0){bp.pop();brokerPath=bp.join("/");if(!brokerPath.endsWith("/"))brokerPath+="/";if(brokerPath.endsWith(lastPath))brokerPath=brokerPath.substring(0,brokerPath.length-lastPath.length)}else brokerPath="/"}else{brokerPath="/";lastPath=""}var origin=(prot?`${prot}://`:"")+(host?host+(port?`:${port}`:""):"");ret={origin,port,"protocol":prot,"hostname":host,
"baseurl":baseURL,parameters,virtualPath,brokerPath,lastPath,resource,hash,"toUrl":function(params){return toUrl(this,params)},"getParam":function(name,params){return getParam(this,name,params)}}}catch(error){return error}return ret}function getTopWindow(wnd){if(wnd.parent&&wnd.parent!=wnd)try{var hasError=true;if(wnd.parent.location.href){hasError=false;return getTopWindow(wnd.parent)}}catch(error){hasError=true}finally{if(hasError)return wnd}else return wnd}Object.defineProperty(this,"gup",{"enumerable":true,
"configurable":false,"writable":false,"value":gup});Object.defineProperty(this,"getTopWindow",{"enumerable":true,"configurable":false,"writable":false,"value":getTopWindow});Object.defineProperty(this,"parseUrl",{"enumerable":true,"configurable":false,"writable":false,"value":parseUrl});Object.defineProperty(this,"toUrl",{"enumerable":true,"configurable":false,"writable":false,"value":toUrl});if(GLOBAL_VAR.console.logDebug)if(window.console!=undefined&&window.console.log!=undefined)window.console.log("Initializing "+
_className+" class. - "+(new Date).toString());return this}function Utils(){var _className=getFunctionName(arguments);function getCookie(name){var re=new RegExp(name+"=([^;]+)");var value=re.exec(document.cookie);return value!=null?unescape(value[1]):null}function removeCookie(name,path){var d=new Date(1);document.cookie=GLOBAL_VAR["class"]["privateREF#"].string.format("{0}=; expires={1}; path={2}",name,d.toString(),path||"/")}function uuidv4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,
function(c){var r=Math.random()*16|0,v=c=="x"?r:r&3|8;return v.toString(16)})}function getGUID(){return"{"+uuidv4().toUpperCase()+"}"}function getNewGWSID(){return generateGUID(32)}function generateGUID(len){var str="".padEnd(len,"x");return str.replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=="x"?r:r&3|8;return v.toString(16)}).toUpperCase()}function maskToGUID(mask){if(mask&&typeof mask==="string")return mask.replace(/[xy]/g,function(c){var r=Math.random()*16|0,v=c=="x"?r:r&3|8;return v.toString(16)});
else return null}Object.defineProperty(this,"getCookie",{"enumerable":true,"configurable":false,"writable":false,"value":getCookie});Object.defineProperty(this,"getGUID",{"enumerable":true,"configurable":false,"writable":false,"value":getGUID});Object.defineProperty(this,"getNewUUIDv4GUID",{"enumerable":true,"configurable":false,"writable":false,"value":uuidv4});Object.defineProperty(this,"getNewGWSID",{"enumerable":true,"configurable":false,"writable":false,"value":getNewGWSID});Object.defineProperty(this,
"generateGUID",{"enumerable":true,"configurable":false,"writable":false,"value":generateGUID});Object.defineProperty(this,"maskToGUID",{"enumerable":true,"configurable":false,"writable":false,"value":maskToGUID});Object.defineProperty(this,"removeCookie",{"enumerable":true,"configurable":false,"writable":false,"value":removeCookie});if(GLOBAL_VAR.console.logDebug)if(window.console!=undefined&&window.console.log!=undefined)window.console.log("Initializing "+_className+" class. - "+(new Date).toString());
return this}function WebSocketObject(owner){var _className=getFunctionName(arguments);var _webSocket=null;var _opening=false;var _wsObjects=[];function getWSConstructor(){return"WebSocket"in window?WebSocket:MozWebSocket}function checkPendings(){_opening=false;if(_wsObjects.length>0)resolveWebSocket.apply(null,_wsObjects.shift())}function resolveWebSocket(url,binaryType,resolve,reject){var _ws;var _eventHandler=function(e){if(_ws){_ws.removeEventListener("open",_eventHandler);_ws.removeEventListener("close",
_eventHandler);_ws.removeEventListener("error",_eventHandler);try{var str="";var values=["type"];var srcValues=["readyState","url","binaryType","protocol"];values.forEach(function(item){str+=item+": "+e[item]+"\n\r"});srcValues.forEach(function(item){str+=item+": "+e.srcElement[item]+"\n\r"});GLOBAL_VAR.class["privateREF#"].console.log("Type:["+e.type+"], message: "+str,arguments)}catch(err){}}checkPendings()};try{GLOBAL_VAR.class["privateREF#"].console.log("New WebSocket connection: "+url,arguments);
_ws=new _webSocket(url);if(binaryType&&typeof _ws.binaryType!="undefined")_ws.binaryType=binaryType;_ws.addEventListener("open",_eventHandler);_ws.addEventListener("close",_eventHandler);_ws.addEventListener("error",_eventHandler);resolve(_ws)}catch(e){reject(e)}}function getNewWebSocket(url,binaryType){return new Promise(function(resolve,reject){if(!_opening){_opening=true;resolveWebSocket(url,binaryType,resolve,reject)}else _wsObjects.push([url,binaryType,resolve,reject])})}_webSocket=getWSConstructor();
Object.defineProperty(owner,"webSocket",{"enumerable":true,"configurable":false,"writable":false,"value":getNewWebSocket});if(GLOBAL_VAR.console.logDebug)if(window.console!=undefined&&window.console.log!=undefined)window.console.log("Initializing "+_className+" class. - "+(new Date).toString())}function arrayExtract(a,fn){var result=[];var i=a.length-1;while(i>=0){if(fn(a[i]))result=result.concat(a.splice(i,1));i--}return result}function stringRepeat(s,count){if(s==null)throw new TypeError("can't convert "+
s+" to object");var str=""+s;count=+count;if(count!=count)count=0;if(count<0)throw new RangeError("repeat count must be non-negative");if(count==Infinity)throw new RangeError("repeat count must be less than infinity");count=Math.floor(count);if(str.length==0||count==0)return"";if(str.length*count>=1<<28)throw new RangeError("repeat count must not overflow maximum string size");var rpt="";for(;;){if((count&1)==1)rpt+=str;count>>>=1;if(count==0)break;str+=str}return rpt}if(window.agentInfo&&(window.agentInfo.isMSIE||
window.agentInfo.isSafari)){var _getBoundingClientRect=HTMLElement.prototype.getBoundingClientRect;HTMLElement.prototype._getBoundingClientRect=_getBoundingClientRect;HTMLElement.prototype.getBoundingClientRect=function(){var bcr=this._getBoundingClientRect();bcr.x=bcr.left;bcr.y=bcr.top;return bcr}}if(!Array.extract)Object.defineProperty(Array.prototype,"extract",{"enumerable":false,"configurable":false,"writable":false,"value":function(fn){return arrayExtract(this,fn)}});if(!String.repeat)Object.defineProperty(String.prototype,
"repeat",{"enumerable":false,"configurable":false,"writable":false,"value":function(count){return stringRepeat(this,count)}});GLOBAL_VAR["class"]["ref#"]=this;initialize(this);return this}if(typeof window.helper==="undefined")var helper=new Helper;
(function(){function Environment(){var _ref=this;if(typeof window["agentInfo"]=="undefined")return;var _isEmbedded=false;try{_isEmbedded=window.top!=window}catch(error){_isEmbedded=true}var _currentDevicePixelRatio=1;var _initialDevicePixelRatio=typeof window.agentInfo=="undefined"||!agentInfo.isMobile?1:window.devicePixelRatio||1;var _detectedWidth=window.screen.availWidth;var _availWidth=window.screen.availWidth;var _detectedHeight=window.screen.availHeight;var _availHeight=window.screen.availHeight;
var _screenWidth=window.screen.availWidth;var _screenHeight=window.screen.availHeight;var _screenRawWidth=_screenWidth;var _screenRawHeight=_screenHeight;var _getWidth=typeof window.helper!="undefined"?function(elem){return helper.size.getWidth(elem)}:function(elem){return $(elem).width()};var _getHeight=typeof window.helper!="undefined"?function(elem){return helper.size.getHeight(elem)}:function(elem){return $(elem).height()};var _winWidth=_getWidth(window);var _winHeight=_getHeight(window);var _viewportWidth=
_detectedWidth;var _viewportHeight=_detectedHeight;var _deviceWidth=window.screen.width;var _deviceHeight=window.screen.height;var _sizeCalculationHolderElem=null;var _sizeCalculationHolderElemId="sizeCalculationHolder";var _xzoom=100;var _xzoomfn=null;var _supportsFullScreenMode=agentInfo.supportHTML5&&!(agentInfo.isIOS&&agentInfo.ipadModel==="pro")&&agentInfo.supportsFullScreen(document.documentElement);var _fullScreenAvailable=false;var _isFullscreen=false;var _environmentReady=false;var _resolutionModes=
{"fittobrowser":0,"fittoscale":1,"fittoscreen":2,"fixed":3};var _resolutionMode=_resolutionModes.fittobrowser;var _watchDog={"intervalId":null,"intervalTime":50,"width":null,"height":null,"isChanging":false,"isRunning":false,"currentDate":null,"lastEvent":null,"waitTime":window.agentInfo&&agentInfo.isMobile?500:50,"updateTime":window.agentInfo&&agentInfo.isMobile?100:50,"count":0};var _commandHandlerList=[];var _isResizingRunning=false;var _holderElemReady=false;var _orientationMedia=null;var _margin=
{"left":0,"top":0,"right":0,"bottom":0,"infullscreen":false,"notinfullscreen":false,"original":{"left":0,"top":0,"right":0,"bottom":0}};var _savedValues={"currentDevicePixelRatio":null,"detectedWidth":null,"availWidth":null,"detectedHeight":null,"availHeight":null,"screenWidth":null,"screenHeight":null,"screenRawWidth":null,"screenRawHeight":null,"winWidth":null,"winHeight":null,"viewportWidth":null,"viewportHeight":null};var _crop={"width":0,"height":0,"infullscreen":false,"notinfullscreen":false,
"original":{"width":0,"height":0}};var _mobileLimits={"_320x320":320*320,"_640x480":640*480,"_960x600":960*600,"_2048x1024":2048*1024};var _isIEMobileMode=false;var _zoomValues=[25,33.5,50,67,75,80,90,100,110,125,150,175,200,250,300,400,500,600,700,800,900,1E3,2E3,3E3,4E3,1E4];var _initialOrientation=null;function initialize(){applyPixelRatioRule(undefined,function(){return _initialDevicePixelRatio},function(value){_initialDevicePixelRatio=value});_isIEMobileMode=agentInfo.isMSIE&&agentInfo.isWindowsPhone&&
typeof window.matchMedia!="undefined";appendSizeCalculationHolder();var bodyReady=function(){if(document.body){document.body.appendChild(_sizeCalculationHolderElem);_holderElemReady=true;if(!agentInfo.isMobile){_isFullscreen=isFullscreen();assignZoomFn();_orientationMedia="landscape";if(_detectedWidth==0&&_detectedHeight==0)startWatchDog()}attachEvents();updateSizeValues();_initialOrientation=getOrientation();_environmentReady=true}else setTimeout(bodyReady,25)};helper.dom.loading(bodyReady);try{window.dispatchEvent(new CustomEvent("addStatusAPIVariables",
{"detail":[{"name":"size","title":"Size","get":function(){return _detectedWidth+"x"+_detectedHeight},"index":55}]}));window.dispatchEvent(new CustomEvent("addStatusAPIVariables",{"detail":[{"name":"zoom","title":"Zoom","get":function(){return _xzoom},"index":56}]}));window.dispatchEvent(new CustomEvent("addStatusAPIVariables",{"detail":[{"name":"rsize","title":"RSize","get":function(){return window.screen.width+"x"+window.screen.height},"index":56}]}))}catch(error){}}function getMatchMedia(){return window.matchMedia("(orientation: portrait)").matches?
"portrait":"landscape"}function getWndOrientation(){return typeof window.orientation=="undefined"||Math.abs(window.orientation)==90?"landscape":"portrait"}function getOrientation(){if(agentInfo.isMobile)if(_holderElemReady)if(window.matchMedia&&(agentInfo.isIOS&&agentInfo.ipadModel>=2||agentInfo.isWindowsPhone))return getMatchMedia();else if(agentInfo.isAndroid&&agentInfo.chromeVersion>"50")return getWndOrientation();else{var h=_getHeight(_sizeCalculationHolderElem);var w=_getWidth(_sizeCalculationHolderElem);
if(agentInfo.isAndroid&&!agentInfo.isChrome&&!agentInfo.isFirefox&&agentInfo.agentStr.indexOf("android 4.2.2")!=-1){var sw=window.screen.width;var sh=window.screen.height;if(sw==w){w=2;h=1}else if(sh==w){w=1;h=2}else{var wDif=Math.abs(sw-w);var hDif=Math.abs(sh-h);if(wDif>300||hDif>300)if(wDif>hDif){w=2;h=1}else{w=1;h=2}}}return w>=h?"landscape":"portrait"}else if(window.matchMedia)return getMatchMedia();else return getWndOrientation();else return _orientationMedia}function applyPixelRatioRule(dpr,
getDpr,setDpr){if(typeof setDpr==="undefined"||!(setDpr instanceof Function))setDpr=function(value){_currentDevicePixelRatio=value};if(typeof dpr!="undefined")setDpr(dpr);else{var vdpr=null;var cdpr=getDpr();if(agentInfo.isMobile){var w=window.screen.availWidth;var h=window.screen.availHeight;if(w<=320&&h<=320)vdpr=2;else if(w<=320&&h>=640||w*h<_mobileLimits._320x320||w>=640&&h<=320)vdpr=1;else if(cdpr>1&&(w<=480&&h<=640||h<=480&&w<=640||w*h<_mobileLimits._640x480)){if(!(agentInfo.isIOS&&agentInfo.isIphone&&
agentInfo.iosVersion==4))vdpr=1}else if(w>2048||h>2048||w*h>_mobileLimits._2048x1024);else if((w>=600&&h>=960||w>=960&&h>=600||w*h>_mobileLimits._960x600)&&cdpr>1)vdpr=1;else if((w<=1024&&h<=768||w<=768&&h<=1024)&&cdpr>1)vdpr=1;else if(cdpr>2)vdpr=2;else vdpr=window.devicePixelRatio||1}else vdpr=1;if(vdpr)setDpr(vdpr)}}function appendSizeCalculationHolder(){_sizeCalculationHolderElem=document.createElement("div");_sizeCalculationHolderElem.id=_sizeCalculationHolderElemId;_sizeCalculationHolderElem.style.height=
"100%";_sizeCalculationHolderElem.style.width="100%";_sizeCalculationHolderElem.style.backgroundColor="transparent";_sizeCalculationHolderElem.style.opacity="0.5";_sizeCalculationHolderElem.style.position="fixed";_sizeCalculationHolderElem.style.margin="0px";_sizeCalculationHolderElem.style.padding="0px";_sizeCalculationHolderElem.style.top="0px";_sizeCalculationHolderElem.style.left="0px";_sizeCalculationHolderElem.style.right="0px";_sizeCalculationHolderElem.style.bottom="0px";_sizeCalculationHolderElem.style.zIndex=
-9999999}function attachEvents(){window.addEventListener("resize",onresize,false)}function assignZoomFn(){var zoom=null;if(_isEmbedded)_xzoomfn=function(){return 100};else if(agentInfo.isFirefox)_xzoomfn=function(){var mediaQueryBinarySearch=function(property,unit,a,b,maxIter,epsilon){var matchMedia;var head,style,div;if(window.matchMedia)matchMedia=window.matchMedia;else{head=document.getElementsByTagName("head")[0];style=document.createElement("style");head.appendChild(style);div=document.createElement("div");
div.className="mediaQueryBinarySearch";div.style.display="none";document.body.appendChild(div);matchMedia=function(query){style.sheet.insertRule("@media "+query+"{.mediaQueryBinarySearch "+"{text-decoration: underline} }",0);var matched=getComputedStyle(div,null).textDecoration=="underline";style.sheet.deleteRule(0);return{matches:matched}}}var ratio=binarySearch(a,b,maxIter);if(div){head.removeChild(style);document.body.removeChild(div)}return ratio;function binarySearch(a,b,maxIter){var mid=(a+
b)/2;if(maxIter<=0||b-a<epsilon)return mid;var query="("+property+":"+mid+unit+")";if(matchMedia(query).matches)return binarySearch(mid,b,maxIter-1);else return binarySearch(a,mid,maxIter-1)}};return mediaQueryBinarySearch("min--moz-device-pixel-ratio","",0,10,20,1E-4)*100};else if(agentInfo.isMSIE)_xzoomfn=function(){return screen.deviceXDPI/screen.logicalXDPI*100};else if(window===window.top)if(agentInfo.isSafari)_xzoomfn=function(){return window.outerWidth/window.innerWidth*100};else _xzoomfn=
function(){return window.outerWidth/window.innerWidth*100};else if(agentInfo.isChrome)_xzoomfn=function(){if(window.devicePixelRatio!=1&&Math.abs(_getWidth(window)-window.screen.availWidth)>window.screen.availWidth*.01)return window.devicePixelRatio*100;else return window.outerWidth===window.screen.availWidth?window.devicePixelRatio*100:100};else _xzoomfn=function(){return 100}}function updateRealDevicePixelRatio(){if(document.hidden)_currentDevicePixelRatio=1;else{var rawXzoom=_xzoomfn();var dif=
999;if(_zoomValues.indexOf(rawXzoom)==-1){var i=0;while(rawXzoom>_zoomValues[i])i++;if(i==0)rawXzoom=_zoomValues[i];else rawXzoom=Math.abs(_zoomValues[i-1]-rawXzoom)<Math.abs(_zoomValues[i]-rawXzoom)?_zoomValues[i-1]:_zoomValues[i]}_xzoom=rawXzoom;_currentDevicePixelRatio=Math.floor(_xzoom)/100}}function setResolutionMode(value){switch(value.toString().toLowerCase()){case "1":case "fittoscale":_resolutionMode=_resolutionModes.fittoscale;break;case "2":case "fittoscreen":_resolutionMode=_resolutionModes.fittoscreen;
break;case "3":case "fixed":_resolutionMode=_resolutionModes.fixed;break;case "0":case "fittobrowser":default:_resolutionMode=_resolutionModes.fittobrowser;break}}function updateSizeValues(){if(agentInfo.isMobile){var orin=getOrientation();var max=Math.max(window.screen.width,window.screen.height);var min=Math.min(window.screen.width,window.screen.height);if(agentInfo.isIOS&&agentInfo.ipadModel==="pro"&&_holderElemReady)if(orin==="portrait"){max=window.screen.height;min=window.screen.width}else if(orin===
"landscape"){max=window.screen.height;min=window.screen.width}_deviceWidth=orin==="portrait"?min:max;_deviceHeight=orin==="portrait"?max:min;_screenRawWidth=_deviceWidth-_crop.width;_screenRawHeight=_deviceHeight-_crop.height;_screenHeight=_screenRawHeight*_currentDevicePixelRatio;_screenWidth=_screenRawWidth*_currentDevicePixelRatio;if(_holderElemReady){_viewportWidth=_getWidth(_sizeCalculationHolderElem)-_crop.width;_viewportHeight=_getHeight(_sizeCalculationHolderElem)-_crop.height}if(_supportsFullScreenMode)if(agentInfo.isMSIE&&
_isIEMobileMode){if(agentInfo.msieVersion>=11)if(getOrientation()=="portrait"){_detectedWidth=(screen.width||1)-_crop.width;_availWidth=_detectedWidth*_currentDevicePixelRatio-(_margin.left+_margin.right);_detectedHeight=(screen.height||1)-_crop.height;_availHeight=_detectedHeight*_currentDevicePixelRatio-(_margin.top+_margin.bottom)}else{_detectedHeight=(screen.width||1)-_crop.height;_availHeight=_detectedHeight*_currentDevicePixelRatio-(_margin.left+_margin.right);_detectedWidth=(screen.height||
1)-_crop.width;_availWidth=_detectedWidth*_currentDevicePixelRatio-(_margin.top+_margin.bottom)}}else if(_holderElemReady){_detectedWidth=_getWidth(_sizeCalculationHolderElem)-_crop.width;_detectedHeight=_getHeight(_sizeCalculationHolderElem)-_crop.height}else{_detectedWidth=_screenRawWidth;_detectedHeight=_screenRawHeight}else{_detectedWidth=_getWidth(window)-_crop.width;_detectedHeight=_getHeight(window)-_crop.height}if(!_holderElemReady){_viewportWidth=_detectedWidth;_viewportHeight=_detectedHeight}_availWidth=
_detectedWidth*_currentDevicePixelRatio-(_margin.left+_margin.right);_availHeight=_detectedHeight*_currentDevicePixelRatio-(_margin.top+_margin.bottom)}else{updateRealDevicePixelRatio();_deviceWidth=window.screen.width;_deviceHeight=window.screen.height;if(_isFullscreen){_screenWidth=window.screen.width-_crop.width;_screenHeight=window.screen.height-_crop.height}else{_screenWidth=window.screen.availWidth-_crop.width;_screenHeight=window.screen.availHeight-_crop.height}_screenRawWidth=_screenWidth;
_screenRawHeight=_screenHeight;_detectedWidth=_getWidth(window)-_crop.width;_availWidth=_detectedWidth*_currentDevicePixelRatio-(_margin.left+_margin.right);_detectedHeight=_getHeight(window)-_crop.height;_availHeight=_detectedHeight*_currentDevicePixelRatio-(_margin.top+_margin.bottom);if(_holderElemReady&&!_isFullscreen){_viewportWidth=_getWidth(_sizeCalculationHolderElem)-_crop.width;_viewportHeight=_getHeight(_sizeCalculationHolderElem)-_crop.height}else{_viewportWidth=_detectedWidth;_viewportHeight=
_detectedHeight}}}function setElement(elem){if(typeof elem!="undefined"){_sizeCalculationHolderElem=elem;if(_sizeCalculationHolderElem.id==undefined||_sizeCalculationHolderElem=="")_sizeCalculationHolderElem.id=_sizeCalculationHolderElemId;else _sizeCalculationHolderElemId=_sizeCalculationHolderElemId.id}}function environmentReady(fCallback){if(_environmentReady&&_holderElemReady){updateSizeValues();fCallback()}else{var count=0;var tempInterval=setInterval(function(){if(count<25){if(_environmentReady&&
_holderElemReady){clearInterval(tempInterval);updateSizeValues();fCallback()}}else{clearInterval(tempInterval);var str="Cannot trigger environment ready event";var ex=new Error(str);helper.console.error(str,ex);_environmentReady=false;_holderElemReady=false;updateSizeValues();fCallback()}count++},25)}}function isFullscreen(){return _getWidth(window)==_deviceWidth&&_getHeight(window)==_deviceHeight}function addEvent(event,handler){if(event==undefined||event==null||event=="")return"Event is undefined or null.";
if(handler==undefined||handler==null||handler=="")return"Handler is undefined or null.";event=event.toLowerCase();var item={"event":event,"handler":handler};var isContained=false;if(_commandHandlerList[event]==undefined)_commandHandlerList[event]=[];else for(var i=0;i<_commandHandlerList[event].length;i++)if(_commandHandlerList[event][i].handler==item.handler){isContained=true;break}if(!isContained)_commandHandlerList[event].push(item);return true}function removeEvent(event,handler){var ret=false;
if(event==undefined||event==null||event=="")return"Event is undefined or null.";if(handler==undefined||handler==null||handler=="")return"Handler is undefined or null.";event=event.toLowerCase();var item={"event":event,"handler":handler};if(_commandHandlerList[event]==undefined)return"Cannot find event. Event is not in the command list.";else for(var i=0;i<_commandHandlerList[event].length;i++)if(_commandHandlerList[event][i].handler.toString()==item.handler.toString()){_commandHandlerList[event].splice(i,
1);ret=true}return ret}function setDevicePixelRatio(dpr){_initialDevicePixelRatio=dpr;_currentDevicePixelRatio=dpr;updateSizeValues()}function getCurrentWidth(){return(_holderElemReady?_getWidth(_sizeCalculationHolderElem):_screenRawWidth)-_crop.width}function getCurrentHeight(){return(_holderElemReady?_getHeight(_sizeCalculationHolderElem):_screenRawHeight)-_crop.height}function startWatchDog(e){_watchDog.currentDate=(new Date).getTime();_watchDog.lastEvent=e;watchDesktopSize()}function watchDesktopSize(){if(!_watchDog.isRunning&&
!_watchDog.isChanging){_watchDog.isRunning=true;_watchDog.count=0;triggerEvent(["resizestart"]);var elem=_holderElemReady?_sizeCalculationHolderElem:window;_watchDog.intervalId=setInterval(function(){if(_watchDog.height!=_getHeight(elem)||_watchDog.width!=_getWidth(elem)){_watchDog.height=_getHeight(elem);_watchDog.width=_getWidth(elem);stopWatchDog();changeScreenSize()}else{_watchDog.count++;if(_watchDog.count>10&&_watchDog.height==_getHeight(window)&&_watchDog.width==_getWidth(window)){stopWatchDog();
changeScreenSize()}}},_watchDog.intervalTime)}}function stopWatchDog(){clearInterval(_watchDog.intervalId);_watchDog.intervalId=null;_watchDog.isRunning=false}function changeScreenSize(){if(_watchDog.isChanging==false){_watchDog.isChanging=true;var cHeight=null;var originalHeight=cHeight;var maxWaitTime=1E3;function updateScreenSize(){_isFullscreen=!!document.fullscreenElement;if(_isFullscreen){if(_crop.notinfullscreen){_crop.width=_crop.original.width;_crop.height=_crop.original.height}if(_margin.notinfullscreen){_margin.left=
_margin.original.left;_margin.top=_margin.original.top;_margin.right=_margin.original.right;_margin.bottom=_margin.original.bottom}if(window.Thinfinity.InitializationData){var cropfs=helper.object.getValue(Thinfinity.InitializationData.get("ENVIRONMENT"),"crop.infullscreen",null);if(cropfs){_crop.infullscreen=true;_crop.width=cropfs.width;_crop.height=cropfs.height}var marginfs=helper.object.getValue(Thinfinity.InitializationData.get("ENVIRONMENT"),"margin.infullscreen",null);if(marginfs){_margin.infullscreen=
true;_margin.left=marginfs.left;_margin.top=marginfs.top;_margin.right=marginfs.right;_margin.bottom=marginfs.bottom}}}else{if(_crop.infullscreen){_crop.width=_crop.original.width;_crop.height=_crop.original.height}if(_margin.infullscreen){_margin.left=_margin.original.left;_margin.top=_margin.original.top;_margin.right=_margin.original.right;_margin.bottom=_margin.original.bottom}if(window.Thinfinity.InitializationData){var cropfs=helper.object.getValue(Thinfinity.InitializationData.get("ENVIRONMENT"),
"crop.notinfullscreen",null);if(cropfs){_crop.notinfullscreen=true;_crop.width=cropfs.width;_crop.height=cropfs.height}var marginfs=helper.object.getValue(Thinfinity.InitializationData.get("ENVIRONMENT"),"margin.notinfullscreen",null);if(marginfs){_margin.notinfullscreen=true;_margin.left=marginfs.left;_margin.top=marginfs.top;_margin.right=marginfs.right;_margin.bottom=marginfs.bottom}}}_watchDog.height=null;_watchDog.width=null;_watchDog.isChanging=false;updateSizeValues();triggerEvent(["resize",
"resizeComplete","resizeend"]);if(agentInfo.isMobile){var orin=getOrientation();if(_initialOrientation!=orin){_initialOrientation=orin;triggerEvent(["orientationChange"])}}triggerEvent(_isFullscreen?"enterfullscreen":"exitfullscreen")}function waitForSizeChanged(){var fHeight=_getHeight(window);if(fHeight!=_winHeight&&fHeight==cHeight)setTimeout(function(){updateScreenSize()},_watchDog.waitTime);else{cHeight=fHeight;if(maxWaitTime<(new Date).getTime()-_watchDog.currentDate)setTimeout(function(){updateScreenSize()},
_watchDog.waitTime);else setTimeout(function(){waitForSizeChanged()},_watchDog.updateTime)}}waitForSizeChanged()}}function updateDevicePixelRatio(){applyPixelRatioRule(undefined,function(value){_currentDevicePixelRatio=value});updateSizeValues()}function launchFullscreenMode(elem){try{_isFullscreen=true;if(!elem)elem=document.documentElement;if(elem.requestFullscreen)elem.requestFullscreen().then(()=>{_isFullscreen=!!document.fullscreenElement});else if(elem.mozRequestFullScreen)elem.mozRequestFullScreen();
else if(elem.webkitRequestFullscreen)elem.webkitRequestFullscreen(Element.ALLOW_KEYBOARD_INPUT);else if(elem.msRequestFullscreen)elem.msRequestFullscreen();else if(typeof window.ActiveXObject!="undefined"){var wscript=new ActiveXObject("WScript.Shell");if(wscript!=null)wscript.SendKeys("{F11}")}else{_isFullscreen=false;helper.console.log("Your browser do not support FullScreen Mode")}}catch(error){_isFullscreen=false}}function exitFullscreenMode(elem){_isFullscreen=false;try{if(document.fullscreenElement){if(!elem)elem=
document.documentElement;if(elem.exitFullscreen)elem.exitFullscreen();else if(document.exitFullscreen)document.exitFullscreen().then(()=>{_isFullscreen=!!document.fullscreenElement});else if(elem.cancelFullscreen)elem.cancelFullscreen();else if(document.cancelFullscreen)document.cancelFullscreen();else if(elem.mozCancelFullScreen)elem.mozCancelFullScreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(elem.webkitExitFullscreen)elem.webkitExitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();
else if(elem.webkitCancelFullscreen)elem.webkitCancelFullscreen();else if(document.webkitCancelFullscreen)document.webkitCancelFullscreen();else if(elem.msExitFullscreen)elem.msExitFullscreen();else if(document.msExitFullscreen)document.msExitFullscreen();else if(elem.msCancelFullscreen)elem.msCancelFullscreen();else if(document.msCancelFullscreen)document.msCancelFullscreen();else{_isFullscreen=true;logDebug("Your browser do not support FullScreen Mode")}}}catch(error){_isFullscreen=!!document.fullscreenElement}}
function onresize(e){_isFullscreen=isFullscreen();updateSizeValues(e);triggerEvent(["resize"]);startWatchDog(e)}function triggerEvent(eventNames){var atLeastOne=false;if(eventNames){if(typeof eventNames=="string")eventNames=[eventNames];for(var k=0;k<eventNames.length;k++)if(_commandHandlerList[eventNames[k].toLowerCase()]!=undefined)for(var i=0;i<_commandHandlerList[eventNames[k].toLowerCase()].length;i++){try{_commandHandlerList[eventNames[k].toLowerCase()][i]["handler"](_watchDog.lastEvent)}catch(error){}atLeastOne=
true}}return atLeastOne}function crop(sizes){if(!sizes)return _crop;else{helper.object.parseAttributes(_crop,sizes);_crop.original.width=_crop.width;_crop.original.height=_crop.height;updateSizeValues();startWatchDog()}}function getScaleAndLayout(){var dpr=parseInt(window.devicePixelRatio*100,10);var cdpr=parseInt(_currentDevicePixelRatio*100,10);if(dpr>cdpr){var fw=_screenRawWidth*100/_xzoom;var sal=fw*window.devicePixelRatio/(fw*_currentDevicePixelRatio)*100;return parseInt(sal/25,10)*25}else return 100}
function lookFor(wnd,key,onlyCurrentWindow){let getParent=function(wnd){try{if(wnd&&wnd.parent&&wnd.parent!=wnd&&wnd.parent.location.href)return wnd.parent}catch(error){return null}};var web7Info=null;try{if(wnd){web7Info=wnd[key];if(!onlyCurrentWindow)while(!web7Info&&wnd){wnd=getParent(wnd);if(wnd)web7Info=wnd[key]}}}catch(error){}return web7Info}function getEnvironmentInformation(){var wndp=null;var wb=true;var crossDomain,embeddedCross=false;try{if(!(parent&&parent.document))crossDomain=true}catch(error){crossDomain=
true}try{if(!window.top.document)embeddedCross=true}catch(error){embeddedCross=true}if(window.parent&&window!=window.parent)try{if(window.parent.location.href)wndp=window.parent;wb=wndp&&wndp.location.host==window.location.host&&wndp.location.protocol==window.location.protocol&&window.location.pathname.endsWith(wndp.location.pathname)}catch(error){wndp=window}else wndp=window;var mw=wndp!=window&&wndp==top?wndp:window;var inFullScreen=crossDomain||embeddedCross?false:isFullscreen();let wfe=window.frameElement==
null||window.frameElement.getAttribute("__webV7_frame__")!==null;let cReferrer=wfe?window.parent.document.referrer:document.referrer;var inw=wfe&&(mw.opener&&mw!=mw.opener||mw.document.referrer==mw.document.location.href||wndp==window&&window.document.referrer.indexOf("oturl")!=-1);let fIndex=undefined;let webV7=lookFor(window,"__webV7__",false);if(webV7)fIndex=inw=false;else{let twnd=helper.url.getTopWindow(window);if(twnd.opener==null&&(window.cookiePrefix==="VNC"||twnd.document.referrer===location.origin+
Thinfinity.global.variables.basePath)){inw=true;fIndex=false}}var referrer=inw?"":cReferrer;var sameOrigin=helper.url.parseUrl(referrer).toUrl("-vp-a-p")===helper.url.parseUrl(window.location).toUrl("-vp-a-p");var info={"withBroker":wb,"referrer":referrer,"fromIndex":inFullScreen||inw?false:typeof fIndex!="undefined"?fIndex:sameOrigin,"mainWindow":mw,"inFullScreen":inFullScreen,"inNewWindow":inw,"embedded":crossDomain||embeddedCross?false:mw!==window};Object.defineProperty(info,"webV7",{enumerable:true,
configurable:false,get:()=>{return lookFor(window,"__webV7__",true)}});return info}initialize();Object.defineProperty(_ref,"fixDevicePixelRatio",{"enumerable":true,"configurable":false,"writable":false,"value":function(){updateDevicePixelRatio()}});Object.defineProperty(_ref,"currentOrientation",{"enumerable":true,"configurable":false,"get":function(){return getOrientation()}});Object.defineProperty(_ref,"currentDevicePixelRatio",{"enumerable":true,"configurable":false,"get":function(){return _currentDevicePixelRatio},
"set":function(dpr){setDevicePixelRatio(dpr)}});Object.defineProperty(_ref,"initialDevicePixelRatio",{"enumerable":true,"configurable":false,"get":function(){return _initialDevicePixelRatio}});_ref.margin={};Object.defineProperty(_ref.margin,"left",{"enumerable":true,"configurable":false,"get":function(){return _margin.left},"set":function(value){_margin.left=_margin.original.left=value;updateSizeValues()}});Object.defineProperty(_ref.margin,"top",{"enumerable":true,"configurable":false,"get":function(){return _margin.top},
"set":function(value){_margin.top=_margin.original.top=value;updateSizeValues()}});Object.defineProperty(_ref.margin,"right",{"enumerable":true,"configurable":false,"get":function(){return _margin.right},"set":function(value){_margin.right=_margin.original.right=value;updateSizeValues()}});Object.defineProperty(_ref.margin,"bottom",{"enumerable":true,"configurable":false,"get":function(){return _margin.bottom},"set":function(value){_margin.bottom=_margin.original.bottom=value;updateSizeValues()}});
Object.defineProperty(_ref,"detectedWidth",{"enumerable":true,"configurable":false,"get":function(){return parseInt(_detectedWidth,10)}});Object.defineProperty(_ref,"detectedHeight",{"enumerable":true,"configurable":false,"get":function(){return parseInt(_detectedHeight,10)}});Object.defineProperty(_ref,"availWidth",{"enumerable":true,"configurable":false,"get":function(){return parseInt(_availWidth,10)}});Object.defineProperty(_ref,"availHeight",{"enumerable":true,"configurable":false,"get":function(){return parseInt(_availHeight,
10)}});Object.defineProperty(_ref,"rawWidth",{"enumerable":true,"configurable":false,"get":function(){return _screenRawWidth}});Object.defineProperty(_ref,"rawHeight",{"enumerable":true,"configurable":false,"get":function(){return _screenRawHeight}});Object.defineProperty(_ref,"width",{"enumerable":true,"configurable":false,"get":function(){return parseInt(_screenWidth,10)}});Object.defineProperty(_ref,"height",{"enumerable":true,"configurable":false,"get":function(){return parseInt(_screenHeight,
10)}});Object.defineProperty(_ref,"currentWidth",{"enumerable":true,"configurable":false,"get":function(){return getCurrentWidth()}});Object.defineProperty(_ref,"currentHeight",{"enumerable":true,"configurable":false,"get":function(){return getCurrentHeight()}});Object.defineProperty(_ref,"viewportWidth",{"enumerable":true,"configurable":false,"get":function(){return _viewportWidth}});Object.defineProperty(_ref,"viewportHeight",{"enumerable":true,"configurable":false,"get":function(){return _viewportHeight}});
if(typeof _ref["devicePixelRatio"]==undefined)Object.defineProperty(_ref,"devicePixelRatio",{"enumerable":true,"configurable":false,"get":function(){return _currentDevicePixelRatio}});Object.defineProperty(_ref,"scaleAndLayout",{"enumerable":true,"configurable":false,"get":function(){return getScaleAndLayout()}});Object.defineProperty(_ref,"resolutionMode",{"enumerable":true,"configurable":false,"get":function(){return _resolutionMode},"set":function(value){setResolutionMode(value)}});Object.defineProperty(_ref,
"setElement",{"enumerable":true,"configurable":false,"value":function(elem){setElement(elem)}});Object.defineProperty(_ref,"ready",{"enumerable":true,"configurable":false,"writable":false,"value":environmentReady});Object.defineProperty(_ref,"isFullscreen",{"enumerable":true,"configurable":false,"get":function(){return _isFullscreen}});Object.defineProperty(_ref,"supportsFullScreen",{"enumerable":true,"configurable":false,"get":function(){return _supportsFullScreenMode}});Object.defineProperty(_ref,
"fullScreenAvailable",{"enumerable":true,"configurable":false,"get":function(){return _fullScreenAvailable},"set":function(value){_fullScreenAvailable=value}});Object.defineProperty(_ref,"requestFullscreen",{"enumerable":true,"configurable":false,"writable":false,"value":launchFullscreenMode});Object.defineProperty(_ref,"exitFullscreen",{"enumerable":true,"configurable":false,"writable":false,"value":exitFullscreenMode});Object.defineProperty(_ref,"on",{"enumerable":true,"configurable":false,"writable":false,
"value":addEvent});Object.defineProperty(_ref,"off",{"enumerable":true,"configurable":false,"writable":false,"value":removeEvent});Object.defineProperty(_ref,"webapp",{"enumerable":true,"configurable":false,"get":function(){return typeof window.navigator.standalone!="undefined"?window.navigator.standalone:false}});Object.defineProperty(_ref,"trigger",{"enumerable":true,"configurable":false,"writable":false,"value":function(eventNames){return triggerEvent(eventNames)}});Object.defineProperty(_ref,
"update",{"enumerable":true,"configurable":false,"writable":false,"value":function(){return updateSizeValues()}});Object.defineProperty(_ref,"crop",{"enumerable":true,"configurable":false,"get":function(){return{"width":_crop.width,"height":_crop.height}},"set":function(sizes){return crop(sizes)}});Object.defineProperty(_ref,"xZoom",{"enumerable":true,"configurable":false,"get":function(){return _xzoom}});Object.defineProperty(_ref,"getEnvironmentInformation",{"enumerable":true,"configurable":false,
"writable":false,"value":getEnvironmentInformation});return _ref}try{Thinfinity!=undefined}catch(e){Thinfinity={}}Thinfinity.Environment=Environment})();window.environment=new Thinfinity.Environment;
(function(){const _swstate={"installing":0,"installed":1,"activating":2,"activated":3,"redundant":4};if(Object.freeze)Object.freeze(_swstate);function ServiceWorkerRegistrator(){var _ref=this;var _isAvailable=false;var _notSupportedMsg="Service Workers are not supported by your browser.";var _notSupportedHandler=function(){return _notSupportedMsg};var _notSupportedPromise=function(){return new Promise((resolve,reject)=>{reject(_notSupportedMsg)})};let _controller=null;function initialize(){if("serviceWorker"in
window.navigator)_isAvailable=true;else console.warn(`Service Worker is not available in your browser. "serviceWorker" is not in window.navigator object.`)}function initializeNewService(workerUrl,options){return new Promise(function(resolve,reject){if(options===undefined)options={};window.navigator.serviceWorker.register(workerUrl,options).then(()=>{getInstalledService(options.scope).then(resolve).catch(reject)}).catch(function(error){console.warn("Service worker registration failed:",error);_notSupportedMsg=
error;reject(error)})})}function unregisterService(clientURL,matchCase){return new Promise((resolve,reject)=>{clientURL=normalizeScope(clientURL);getInstalledService(clientURL).then(result=>{if(result&&result.unregister)result.unregister().then(resolve).catch(reject);else if(matchCase===false)unregisterServiceUnMatchCase(clientURL).then(resolve).catch(reject)}).catch(reject)})}function unregisterServiceUnMatchCase(clientURL){return new Promise((resolve,reject)=>{navigator.serviceWorker.getRegistrations().then(registrations=>
{if(registrations){clientURL=clientURL.toLowerCase();let proms=[];registrations.forEach(reg=>{let scope=reg.scope.replace(location.origin,"");if(scope.toLowerCase()===clientURL)proms.push(reg.unregister())});Promise.all(proms).then(resolve).catch(reject)}})})}function normalizeScope(scope){if(scope){if(scope==="/")return scope;let scopes=scope.split("/").filter(s=>s!=="");if(scopes.length==1)return`/${scopes[0]}/`;else return null}else return null}function getInstalledService(clientURL){return new Promise(function(resolve,
reject){if(clientURL!=="")navigator.serviceWorker.getRegistration(clientURL).then(resolve).catch(reject);else reject("Invalid clientURL")})}function getController(){return new Promise((resolve,reject)=>{if(navigator.serviceWorker.controller)resolve(navigator.serviceWorker.controller);else{console.warn(`Controller is not running, please wait...`);let timeoutId=null;timeoutId=setTimeout(()=>{reject(`ServiceWorker is not controlling the page..., trying to reload...`)},45E3);navigator.serviceWorker.ready.then(e=>
{clearTimeout(timeoutId);resolve(navigator.serviceWorker.controller)}).catch(err=>{clearTimeout(timeoutId);reject(null)})}})}function sendMessage(msg,port){return new Promise((resolve,reject)=>{let sendMsg=(msg,port)=>{_controller.postMessage(msg,port)};if(!_controller)getController().then(controller=>{_controller=controller;sendMsg(msg,port);resolve(true)}).catch(err=>{console.warn(`Cannot send message, controller is not ready yet, ${err.message||err}`);reject(err)});else{sendMsg(msg,port);resolve(true)}})}
initialize();Object.defineProperty(_ref,"isSupported",{"enumerable":true,"configurable":false,"get":_isAvailable?()=>{return true}:_notSupportedHandler});Object.defineProperty(_ref,"initializeNewService",{"enumerable":true,"configurable":false,"writable":false,"value":_isAvailable?initializeNewService:_notSupportedPromise});Object.defineProperty(_ref,"unregisterService",{"enumerable":true,"configurable":false,"writable":false,"value":_isAvailable?unregisterService:_notSupportedPromise});Object.defineProperty(_ref,
"getInstalledService",{"enumerable":true,"configurable":false,"writable":false,"value":_isAvailable?getInstalledService:_notSupportedPromise});Object.defineProperty(_ref,"sendMessage",{"enumerable":true,"configurable":false,"writable":false,"value":_isAvailable?sendMessage:_notSupportedPromise});return _ref}try{Thinfinity!==undefined}catch(e){Thinfinity={}}if(Thinfinity.Service===undefined)Thinfinity.Service={};Thinfinity.Service.Worker=new ServiceWorkerRegistrator;Object.defineProperty(Thinfinity.Service.Worker,
"state",{"enumerable":true,"configurable":false,"get":function(){return _swstate}})})();
(function(){var _ref=this;function initialize(){try{let basepath="<%=@BASEURL%>";if(window?.Thinfinity?.Service?.Worker?.unregisterService){let proms=[];let vRoot="/";let pathnames=window.location.pathname.split("/").filter(f=>{return f!==""});let vp=null;if(pathnames.length>0){if(basepath!=="/"){basepath=basepath.split("/").filter(f=>{return f!==""});basepath=basepath.pop();let idx=pathnames.findIndex(p=>{return p.toLowerCase()==basepath.toLowerCase()});if(idx!==null)pathnames=pathnames.splice(idx+
1)}vp=pathnames.length>0?`/${pathnames.pop()}/`:null;if(pathnames.length>0)vRoot=`/${pathnames.join("/")}/`}proms.push(Thinfinity.Service.Worker.unregisterService(vRoot,false));if(vp)proms.push(Thinfinity.Service.Worker.unregisterService(vp,false));Promise.all(proms).then(result=>{if(result[0]==true){if(window?.indexedDB)window.indexedDB.deleteDatabase("thinfinity.indexeddb.wvpn");console.log(`Service worker was successful uninstall for ${vRoot} scope, and IndexedDB was removed also.`)}if(result[1]==
true){console.log(`Service worker was successful uninstall for ${vp} scope.`);if(Thinfinity?.WAG?.Rules?.remove)Thinfinity.WAG.Rules.remove()}}).catch(err=>{console.log(`Cannot unregister Service Worker: ${err.message||err}`)})}}catch(error){console.log(`Cannot unregister service worker. ${error.message||error}`)}}initialize()})();
(function(){function Events(args){var _ref=this;var _events=[];var _args={fireEventArgs:{async:1}};var _noop=function(){};function initialize(){helper.object.parseAttributes(_args,args);if(!args.owner)args.owner=_ref;if(args.events)for(var name in args.events)on(name,args.events[name])}function on(events,handler){if(events==undefined||events==null||events=="")return"Event is undefined or null.";if(!(events instanceof Array))events=events.split(",");if(handler==undefined||handler==null||handler=="")return"Handler is undefined or null.";
events.forEach(function(eventName){if(_events[eventName]==undefined)_events[eventName]=[];_events[eventName].push(handler)});return args.owner}function off(events,handler){if(events==undefined||events==null||events=="")return"Event is undefined or null.";if(!(events instanceof Array))events=events.split(",");if(handler==undefined||handler==null||handler=="")return"Handler is undefined or null.";events.forEach(function(eventName){if(_events[eventName])for(var i=_events[eventName].length-1;i>=0;i--)if(_events[eventName][i]===
handler)_events[eventName].splice(i,1)});return args.owner}function fireEvent(){var name=null;var data=null;var jArgs=null;name=arguments[0];var response=[];if(_events[name]&&_events[name].length>0){if(arguments.length<=3){data=[arguments[1]];jArgs=arguments[2]}else{var len=arguments.length;jArgs=arguments[len-1];data=[];for(let i=1,t=len-1;i<t;i++)data.push(arguments[i])}if(!jArgs)jArgs=_args.fireEventArgs;for(var i=0;i<_events[name].length;i++)try{if(jArgs.async===false||jArgs.async===0)response[i]=
_events[name][i].apply(null,data);else{var time=parseInt(jArgs.async,10);if(time.toString()==="NaN")time=1;setTimeout(function(args){if(_events[name]&&_events[name][args[0]])response[i]=_events[name][args[0]].apply(null,data);if(i==_events[name].length-1)if(jArgs.callback)jArgs.callback(getResponse(response))},time,[i])}}catch(error){console.warn("Uncaught error: "+error.message,arguments);response[i]=error.message}}return getResponse(response)}function getResponse(a){Object.defineProperty(a,"preventExecution",
{"enumerable":true,"configurable":false,"get":function(){return a.find(function(elem){return elem===true})}});return a}function hasHandler(event){return _events[event]&&_events[event].length>0}function dispose(){_events=[];delete args.owner.on;delete args.owner.off;delete _ref["fireEvent"];on=off=fireEvent=_noop}initialize();let override=args.owner===_ref;Object.defineProperty(args.owner,"on",{"enumerable":true,"configurable":override,"value":on});Object.defineProperty(args.owner,"off",{"enumerable":true,
"configurable":override,"value":off});Object.defineProperty(_ref,"hasHandler",{"enumerable":true,"configurable":override,"value":hasHandler});Object.defineProperty(_ref,"dispose",{"enumerable":true,"configurable":override,"writable":override,"value":dispose});Object.defineProperty(_ref,"fireEvent",{"enumerable":true,"configurable":override,"value":fireEvent});return _ref}try{Thinfinity!=undefined}catch(e){Thinfinity={}}Thinfinity.Events=Events})();
(function(){function TabFocusHook(args){var _ref=this;var _tabFocusHook=this;var _focusAttached=false;var _visibilityChange=null;var _hasFocus=null;var fireEvent=null;var _states=helper.object.createEnum({"BLUR":"blur","FOCUS":"focus"});var _lastState={"focus":null,"visible":null,"visibility":null,name:null,evt:null};var _vstates=helper.object.createEnum({"VISIBLE":"visible","HIDDEN":"hidden"});var _evisibility=helper.object.createEnum({"VISIBLE":"visible","HIDDEN":"hidden","OCCLUDED":"occluded",
"UNKNOWN":"unknown"});var _lastDocumentVisibility=null;var te=null;function initialize(){te=new Thinfinity.Events({"owner":_ref});fireEvent=te.fireEvent;_lastState.focus=!isHidden()?_states.FOCUS:_states.BLUR;_lastState.visible=document.visibilityState;_lastState.visibility=getVisibilityName(_lastState.visible,_lastState.focus);observeDocumentVisibility()}function getVisibilityName(visibility,focus){if(visibility===_vstates.VISIBLE)return focus===_states.FOCUS?_evisibility.VISIBLE:_evisibility.OCCLUDED;
else if(visibility===_vstates.HIDDEN)return isMinimized()?_evisibility.HIDDEN:_evisibility.OCCLUDED;else return _evisibility.UNKNOWN}function isMinimized(){return window.screenX<-window.screen.availWidth&&window.screenY<-window.screen.availHeight}function visibilityChange(e,callback){e=e||window.event;e.stopPropagation();e.preventDefault();var v=true;var h=false;var map={"pageshow":v,"focus":v,"focusin":v,"blur":h,"focusout":h,"pagehide":h,"visibilitychange":v};if(e.type in map){if(document.visibilityState!==
_lastDocumentVisibility){if(document.visibilityState===_vstates.VISIBLE)notify("visible",_vstates.VISIBLE,e);else notify("visible",_vstates.HIDDEN,e);_lastDocumentVisibility=document.visibilityState}_hasFocus=map[e.type]&&!isHidden()&&document.hasFocus();if(_hasFocus)notify("focus",_states.FOCUS,e);else notify("focus",_states.BLUR,e);notify("visibility","visibility",e,getVisibilityName(_lastState.visible,_lastState.focus));if(callback)callback()}map=h=v=null;return false}function isHidden(){return document.hidden}
function notify(propName,evtName,e,value){var lv=value||evtName;if(_lastState[propName]!=lv){e.visibilityState=value||evtName;_lastState.evt=e;_lastState.name=evtName;fireEvent(evtName,e,{"async":false})}_lastState[propName]=lv}function observeDocumentVisibility(callback){if(!_focusAttached){_focusAttached=true;_visibilityChange=function(e){visibilityChange(e,callback)};var hidden="hidden";if(hidden in document)document.addEventListener("visibilitychange",_visibilityChange,false);else if(hidden==
"mozHidden")document.addEventListener("mozvisibilitychnage",_visibilityChange,false);else if(hidden=="webkitHidden")document.addEventListener("webkitvisibilitychange",_visibilityChange,false);else if(hidden=="msHidden")document.addEventListener("msvisibilitychange",_visibilityChange,false);else if("onfocusin"in document)document.onfocusin=document.onfocusout=_visibilityChange;window.onpageshow=window.onpagehide=window.onfocus=window.onblur=_visibilityChange;if(document[hidden]!==undefined)_visibilityChange({"type":document[hidden]?
"blur":"focus","stopPropagation":function(){return},"preventDefault":function(){return}})}else if(_lastState.name)fireEvent(_lastState.name,_lastState.evt,{"async":false});else{let evtName=document.hasFocus()?"focus":"blur";fireEvent(evtName,window.event||{},{"async":false})}if(callback)callback()}function unobserveDocumentVisibility(){var hidden="hidden";if(hidden in document)document.removeEventListener("visibilitychange",_visibilityChange,false);else if(hidden=="mozHidden")document.removeEventListener("mozvisibilitychnage",
_visibilityChange,false);else if(hidden=="webkitHidden")document.removeEventListener("webkitvisibilitychange",_visibilityChange,false);else if(hidden=="msHidden")document.removeEventListener("msvisibilitychange",_visibilityChange,false);else if("onfocusin"in document){_visibilityChange=function(){};document.onfocusin=document.onfocusout=null}_visibilityChange=function(){};window.onpageshow=window.onpagehide=window.onfocus=window.onblur=null;_focusAttached=false;te.dispose()}initialize();Object.defineProperty(_tabFocusHook,
"start",{"enumerable":true,"configurable":false,"writable":false,"value":observeDocumentVisibility});Object.defineProperty(_tabFocusHook,"stop",{"enumerable":true,"configurable":false,"writable":false,"value":unobserveDocumentVisibility});Object.defineProperty(_tabFocusHook,"isHidden",{"enumerable":true,"configurable":false,"get":isHidden});return _ref}try{Thinfinity!=undefined}catch(e){Thinfinity={}}Thinfinity.TabFocusHook=new TabFocusHook})();
(function(){function InitializationData(args){var _ref=this;var _storage={"dataKey":"__#thinfinity.initialization.data__"};function initialize(args){if(typeof window.localStorage=="undefined")throw new Error("Your browser doesn't support localStorage, please contact with your web admin");}function add(name,data){if(name){var jdata=localStorage.getItem(_storage.dataKey);if(jdata)try{jdata=JSON.parse(jdata);jdata[name]=data}catch(error){}else{jdata={};jdata[name]=data}localStorage.setItem(_storage.dataKey,
JSON.stringify(jdata));return true}else return false}function update(name,data){if(name){var jdata=localStorage.getItem(_storage.dataKey);if(jdata)try{jdata=JSON.parse(jdata);if(jdata[name])if(data!=null&&data!=undefined)helper.object.parseAttributes(jdata[name],data,"MATCH");else jdata[name]=null;else jdata[name]=data}catch(error){}else{jdata={};jdata[name]=data}localStorage.setItem(_storage.dataKey,JSON.stringify(jdata));return true}else return false}function get(name){if(name){var jdata=localStorage.getItem(_storage.dataKey);
if(jdata)try{jdata=JSON.parse(jdata);if(jdata[name])return jdata[name]}catch(error){}}return null}function remove(name){if(name){var jdata=localStorage.getItem(_storage.dataKey);if(jdata)try{jdata=JSON.parse(jdata);if(jdata[name])delete jdata[name];localStorage.setItem(_storage.dataKey,JSON.stringify(jdata))}catch(error){}}return true}function clear(){localStorage.removeItem(_storage.dataKey)}initialize(args);Object.defineProperty(_ref,"add",{"enumerable":true,"configurable":false,"writable":false,
"value":add});Object.defineProperty(_ref,"update",{"enumerable":true,"configurable":false,"writable":false,"value":update});Object.defineProperty(_ref,"remove",{"enumerable":true,"configurable":false,"writable":false,"value":remove});Object.defineProperty(_ref,"get",{"enumerable":true,"configurable":false,"writable":false,"value":get});Object.defineProperty(_ref,"clear",{"enumerable":true,"configurable":false,"writable":false,"value":clear});return this}try{Thinfinity!=undefined}catch(e){Thinfinity=
{}}Thinfinity.InitializationData=new InitializationData})();
(function(){function Events(args){var _ref=this;var _events=[];var _args={fireEventArgs:{async:1}};var _noop=function(){};function initialize(){helper.object.parseAttributes(_args,args);if(!args.owner)args.owner=_ref;if(args.events)for(var name in args.events)on(name,args.events[name])}function on(events,handler){if(events==undefined||events==null||events=="")return"Event is undefined or null.";if(!(events instanceof Array))events=events.split(",");if(handler==undefined||handler==null||handler=="")return"Handler is undefined or null.";
events.forEach(function(eventName){if(_events[eventName]==undefined)_events[eventName]=[];_events[eventName].push(handler)});return args.owner}function off(events,handler){if(events==undefined||events==null||events=="")return"Event is undefined or null.";if(!(events instanceof Array))events=events.split(",");if(handler==undefined||handler==null||handler=="")return"Handler is undefined or null.";events.forEach(function(eventName){if(_events[eventName])for(var i=_events[eventName].length-1;i>=0;i--)if(_events[eventName][i]===
handler)_events[eventName].splice(i,1)});return args.owner}function fireEvent(){var name=null;var data=null;var jArgs=null;name=arguments[0];var response=[];if(_events[name]&&_events[name].length>0){if(arguments.length<=3){data=[arguments[1]];jArgs=arguments[2]}else{var len=arguments.length;jArgs=arguments[len-1];data=[];for(let i=1,t=len-1;i<t;i++)data.push(arguments[i])}if(!jArgs)jArgs=_args.fireEventArgs;for(var i=0;i<_events[name].length;i++)try{if(jArgs.async===false||jArgs.async===0)response[i]=
_events[name][i].apply(null,data);else{var time=parseInt(jArgs.async,10);if(time.toString()==="NaN")time=1;setTimeout(function(args){if(_events[name]&&_events[name][args[0]])response[i]=_events[name][args[0]].apply(null,data);if(i==_events[name].length-1)if(jArgs.callback)jArgs.callback(getResponse(response))},time,[i])}}catch(error){console.warn("Uncaught error: "+error.message,arguments);response[i]=error.message}}return getResponse(response)}function getResponse(a){Object.defineProperty(a,"preventExecution",
{"enumerable":true,"configurable":false,"get":function(){return a.find(function(elem){return elem===true})}});return a}function hasHandler(event){return _events[event]&&_events[event].length>0}function dispose(){_events=[];delete args.owner.on;delete args.owner.off;delete _ref["fireEvent"];on=off=fireEvent=_noop}initialize();let override=args.owner===_ref;Object.defineProperty(args.owner,"on",{"enumerable":true,"configurable":override,"value":on});Object.defineProperty(args.owner,"off",{"enumerable":true,
"configurable":override,"value":off});Object.defineProperty(_ref,"hasHandler",{"enumerable":true,"configurable":override,"value":hasHandler});Object.defineProperty(_ref,"dispose",{"enumerable":true,"configurable":override,"writable":override,"value":dispose});Object.defineProperty(_ref,"fireEvent",{"enumerable":true,"configurable":override,"value":fireEvent});return _ref}try{Thinfinity!=undefined}catch(e){Thinfinity={}}Thinfinity.Events=Events})();
function JSLogAPI(Server){var _TVNC=Server;this._log=function(msgType,msgText,msgDest){if(typeof msgDest=="undefined"||msgDest=="")msgDest="*";var cmd="cmd=jslogapi"+"&dest="+escape(msgDest)+"&type="+escape(msgType)+"&text="+escape(msgText);_TVNC.sendCmd(cmd)};this.logDebug=function(text,dest){this._log("debug",text,dest)};this.logInfo=function(text,dest){this._log("info",text,dest)};this.logError=function(text,dest){this._log("error",text,dest)};this.logWarning=function(text,dest){this._log("warning",
text,dest)};this.errorReport=function(reportData){this._log("report",reportData)}}function getISOTime(){var now=new Date;if(typeof now.toISOString!="undefined"){var ret=now.toISOString();ret=ret.substr(ret.indexOf("T")+1,12);return ret}else return("0"+now.getUTCHours()).substr(-2)+":"+("0"+now.getUTCMinutes()).substr(-2)+":"+("0"+now.getUTCSeconds()).substr(-2)+"."+now.getUTCMilliseconds()}
function logDebug(value){value=getISOTime()+": "+value;if(typeof MsgLogger=="undefined"){if(window.console&&window.console.log)window.console.log(value)}else logDebugW(value)}function logError(value){value=getISOTime()+": "+value;if(typeof MsgLogger=="undefined"){if(window.console&&window.console.error){window.console.error(value);return value}}else logErrorW(value)}var oMsgLogger=null;function logDebugW(value){if(!oMsgLogger)oMsgLogger=new MsgLogger;oMsgLogger.log(value)}
function logErrorW(value){logDebugW("ERROR: "+value)}
(function(){function ObserveObject(){var _observePollingTime=100;var _observeTimeoutId=null;var _objectCollection=[];var _handlerList={};var _handlerListName={};var _handlerCount=0;function isContained(elem){for(var i=0;i<_objectCollection.length;i++)if(_objectCollection[i]["object"]==elem)return true;return false}function compareObject(){var hasChanged=false;var list={};for(var i=0;i<_objectCollection.length;i++){var currentObject=_objectCollection[i];for(var key in currentObject["object"])if(key!=
undefined)if(typeof currentObject["copy"][key]=="undefined"){currentObject["copy"][key]=currentObject["object"][key];_handlerList[getHandlerName(currentObject["handler"])]["list"].push({"name":key,"object":currentObject["object"],"type":"add"})}else if(currentObject["copy"][key]!=currentObject["object"][key]&&!(Number.isNaN(currentObject["object"][key])&&Number.isNaN(currentObject["copy"][key]))){var oldValue=currentObject["copy"][key];currentObject["copy"][key]=currentObject["object"][key];_handlerList[getHandlerName(currentObject["handler"])]["list"].push({"name":key,
"object":currentObject["object"],"type":"update","oldValue":oldValue})}for(var key in currentObject["copy"])if(key!=undefined)if(typeof currentObject["object"][key]=="undefined"){var oldValue=currentObject["copy"][key];delete currentObject["copy"][key];_handlerList[getHandlerName(currentObject["handler"])]["list"].push({"name":key,"object":currentObject["object"],"type":"delete","oldValue":oldValue})}}for(var handlerName in _handlerList)try{if(_handlerList[handlerName]["list"].length>0){_handlerList[handlerName].handler(_handlerList[handlerName]["list"]);
_handlerList[handlerName]["list"]=[]}}catch(error){}clearTimeout(_observeTimeoutId);_observeTimeoutId=null;if(_objectCollection.length>0)_observeTimeoutId=setTimeout(compareObject,_observePollingTime)}function copyObject(elem){var copy={};for(var key in elem)copy[key]=elem[key];return copy}function getHandlerName(handler){for(var key in _handlerListName)if(_handlerListName[key]==handler)return key;key=(new Date).getTime()+"_"+_handlerCount.toString();_handlerCount++;if(_handlerCount>9999)_handlerCount=
0;_handlerListName[key]=handler;return key}function observe(elem,handler){if(isContained(elem)==false){var copy=copyObject(elem);var handlerName=getHandlerName(handler);if(_handlerList[handlerName]==undefined)_handlerList[handlerName]={"handler":handler,"list":[],"count":1};else _handlerList[handlerName]["count"]++;_objectCollection.push({"object":elem,"handler":handler,"copy":copy});if(_observeTimeoutId==null)_observeTimeoutId=setTimeout(compareObject,_observePollingTime)}}function unobserve(elem,
handler){for(var i=0;i<_objectCollection.length;i++)if(_objectCollection[i]["object"]==elem&&_objectCollection[i]["handler"]==handler){_objectCollection.splice(i,1);break}}function startObserve(){clearTimeout(_observeTimeoutId);_observeTimeoutId=setTimeout(compareObject,_observePollingTime)}function stopObserve(){clearTimeout(_observeTimeoutId)}clearTimeout(_observeTimeoutId);_observeTimeoutId=setTimeout(compareObject,_observePollingTime);Object.defineProperty(this,"observe",{"enumerable":true,"configurable":false,
"value":observe});Object.defineProperty(this,"unobserve",{"enumerable":true,"configurable":false,"value":unobserve});Object.defineProperty(Object,"startObserve",{"enumerable":true,"configurable":false,"value":startObserve});Object.defineProperty(Object,"stopObserve",{"enumerable":true,"configurable":false,"value":stopObserve})}if(Object["observe"]==undefined){var obs=new ObserveObject;Object.defineProperty(Object,"observe",{"enumerable":true,"configurable":false,"value":obs.observe});Object.defineProperty(Object,
"unobserve",{"enumerable":true,"configurable":false,"value":obs.unobserve})}})();
(function(){function JsViewConfig(args){var _ref=this;var _args={};var _config={};function initialize(args){helper.object.merge(args,_args);if(_args!=undefined)if(typeof _args.config!="undefined"){var type=helper.object.getDataTypeOf(_args.config);switch(type.toUpperCase()){case "ARRAY":for(var i=0;i<_args.config.length;i++){var property=_args.config[i];registerProperty(property[0],property[1],property[2],typeof property[3]!="undefined"?property[3]:undefined,typeof property[4]!="undefined"?property[4]:
undefined,typeof property[5]!="undefined"?property[5]:undefined,typeof property[6]!="undefined"?property[6]:true)}break;case "JSON":for(var property in _args.config)registerProperty(property["name"],property["reference"],property["accessName"],typeof property["readonly"]!="undefined"?property["readonly"]:undefined,typeof property["nodeType"]!="undefined"?property["nodeType"]:undefined,typeof property["type"]!="undefined"?property["type"]:undefined,typeof property["populate"]!="undefined"?property["populate"]:
true);break}}}function registerProperty(name,reference,accessName,optionalReadonly,optionalNodeType,optionalType,optionalPopulate){try{if(_config[name]==undefined){if(typeof name=="undefined"||name==null)throw"Name is undefined or null";if(typeof reference=="undefined"||reference==null)throw"Reference is undefined or null";if(typeof optionalReadonly=="undefined"||optionalReadonly==null)optionalReadonly=true;if(typeof optionalNodeType=="undefined"||optionalNodeType==null)optionalNodeType="property";
if(typeof optionalType=="undefined"||optionalType==null)optionalType=helper.object.getTypeOf(reference[name])||"property";if((typeof accessName=="undefined"||accessName==null)&&(optionalNodeType!="method"&&optionalNodeType!="function"&&optionalNodeType!="local"))throw"Access Name is undefined or null";if(optionalPopulate===undefined)optionalPopulate=true;_config[name]={"name":name,"nodeType":optionalNodeType,"accessName":accessName,"reference":reference,"type":optionalType,"readonly":optionalReadonly,
"populate":optionalPopulate}}else throw"Already exists";}catch(error){helper.console.warning('Cannot register this property ["'+(accessName||name)+'"]',error)}}function getConfig(){return _config}initialize(args);Object.defineProperty(_ref,"registerProperty",{"enumerable":true,"configurable":false,"writable":false,"value":registerProperty});Object.defineProperty(_ref,"getConfig",{"enumerable":true,"configurable":false,"writable":false,"value":getConfig});return _ref}try{Thinfinity!=undefined}catch(e){Thinfinity=
{}}Thinfinity.JsViewConfig=JsViewConfig})();
(function(){function ObserveObject(args){var _args={"id":null,"input":null,"output":null};var _path="";var _objectView=null;var _dataModel={};var _isReady=false;var _serverFiredList={};var _eventsList={};var _customEventsList={};var _commandHandlerList={};var _cbIdList={};var _modelName="model";var _readOnlyPath=null;var _ref=this;function initialize(args){if(args!=null&&args!=undefined)for(var arg in _args)if(args[arg]!=undefined)_args[arg]=args[arg];if(_args["input"]==undefined||_args["input"]==
null||helper.object.getTypeOf(_args["input"])!="function")_args["input"]=function(){};if(_args["output"]==undefined||_args["output"]==null||helper.object.getTypeOf(_args["output"])!="function")_args["output"]=function(){};_objectView={}}function getPath(model,change){var path="";if(model!=undefined&&model!=null)if(model==change.object)path=change.name;else{var tempRef=null;for(var attrib in model){tempRef=model[attrib];var type=helper.object.getTypeOf(model[attrib]);switch(type){case "object":path+=
getPath(tempRef)+".";break;case "array":for(var i=0;i<tempRef.length;i++)if(helper.object.getTypeOf(tempRef[i])=="object")path+=getPath(tempRef)+".";break}}}return path}function getNode(model,path){var idx=path.indexOf(".")!=-1?path.indexOf("."):path.length;var tempPath=path.substring(0,idx);path=path.substring(idx+1,path.length);if(tempPath!="")return getNode(model[tempPath],path);else return model}function setValue(model,path,value){var idx=path.indexOf(".")!=-1?path.indexOf("."):path.length;var tempPath=
path.substring(0,idx);path=path.substring(idx+1,path.length);if(tempPath!=""&&path!="")return setValue(model[tempPath],path,value);else return model[tempPath]=value}function observeModel(model){if(model!=null&&model!=undefined){for(var attrib in model){var type=helper.object.getTypeOf(model[attrib]);switch(type){case "object":case "array":observeModel(model[attrib]);break;case "function":case "number":case "datetime":case "string":default:break}}Object.observe(model,observeChanges)}}function unobserveModel(model){if(model!=
null&&model!=undefined){for(var attrib in model){var type=helper.object.getTypeOf(model[attrib]);switch(type){case "object":case "array":unobserveModel(model[attrib]);break;case "function":case "number":case "datetime":case "string":default:break}}Object.unobserve(model,observeChanges)}}function setDataModel(model){_isReady=false;var _noErrors=true;if(model["data"]!=undefined){if(model["data"]!=undefined&&model["type"]){switch(model["type"].toUpperCase()){case "OM":unobserveModel(model.data);observeModel(model.data);
_objectView["data"]={};_objectView["data"]=model.data;break;case "ADD":addAttribute(model.data);break;case "UPDATE":updateAttribute(model.data);break;case "DELETE":deleteAttribute(model.data);break;default:helper.console.log("unknown type: "+model["type"]+", Id:"+_args["id"]);break}_noErrors=true}else{helper.console.log("Cannot update this property."+", Id:"+_args["id"]);_noErrors=false}_noErrors=true}else{helper.console.log("Cannot observe these kind of data.");_noErrors=false}setTimeout(function(){_isReady=
true},50);return _noErrors}function addAttribute(data){try{setValue(_objectView.data,data.path,data.value);observeModel(getNode(_objectView.data,data.path))}catch(error){helper.console.warning("Cannot add this attribute: "+data.path+" ,value: "+data.value,error)}}function updateAttribute(data){try{setValue(_objectView.data,data.path,data.value)}catch(error){helper.console.warning("Cannot update this attribute: "+data.path+" ,value: "+data.value,error)}}function deleteAttribute(data){try{unobserveModel(getNode(_objectView.data,
data.path));delete data.object[data.name]}catch(error){helper.console.warning("Cannot delete this attribute: "+data.path+" ,value: "+data.value,error)}}function on(object,event,handler){var canonicalPath=getCanonicalPath(object);if(canonicalPath.indexOf(":")!=-1&&canonicalPath.substring(0,_modelName.length)==_modelName){canonicalPath=canonicalPath.substring(_modelName.length+1,canonicalPath.length);switch(event.toLowerCase()){case "created":case "updated":case "deleted":case "fired":case "error":case "changed":return addCommandHandler(canonicalPath,
event,handler);break;default:return addEventHandler(canonicalPath,event,handler,_customEventsList);break}}else return addEventHandler(canonicalPath,event,handler,_eventsList)}function off(object,event,handler){var canonicalPath=getCanonicalPath(object);if(canonicalPath.indexOf(":")!=-1&&canonicalPath.substring(0,_modelName.length)==_modelName){canonicalPath=canonicalPath.substring(_modelName.length+1,canonicalPath.length);switch(event.toLowerCase()){case "created":case "updated":case "deleted":case "fired":case "error":case "changed":return removeCommandHandler(canonicalPath,
event,handler);break;default:return removeEventHandler(canonicalPath,event,handler,_customEventsList);break}}else return removeEventHandler(canonicalPath,event,handler,_eventsList)}function observeChanges(changes){if(_isReady==true)if(changes)for(var i=0;i<changes.length;i++){var change=changes[i];switch(change.type){case "ADD":addAttribute({"type":chnage.type,"data":model.data});break;case "UPDATE":updateAttribute({"type":chnage.type,"data":model.data});break;case "DELETE":deleteAttribute({"type":chnage.type,
"data":model.data});break}_args["output"](change.type,getPath(_objectView.data,change),change.object[change.name])}}function dispose(){for(var id in _dataModel)deleteObject(id,true);_eventsList=null;_customEventsList=null;_commandHandlerList=null;_objectView=null;_dataModel=null;_ref=null;return}Object.defineProperty(this,"set",{"enumerable":false,"configurable":false,"value":function(value){setDataModel(value)}});initialize(args);Object.defineProperty(this,"model",{"enumerable":true,"configurable":false,
"value":_objectView});Object.defineProperty(this,"on",{"enumerable":true,"configurable":false,"value":function(object,event,handler){return on(object,event,handler)}});Object.defineProperty(this,"off",{"enumerable":true,"configurable":false,"value":function(object,event,handler){return off(object,event,handler)}});Object.defineProperty(this,"dispose",{"enumerable":true,"configurable":false,"writable":false,"value":dispose});return this}try{Thinfinity!=undefined}catch(e){Thinfinity={}}Thinfinity.ObserveObject=
ObserveObject})();
(function(){function LinkageConnection(args){var _ref=this;var _isRemote=false;var _isLinked=false;var _waitTime=3E3;var _waitFirstTime=500;var _waitTimeid=null;var _maxTimes=-1;var _countTimes=0;var _postMessage=null;var _linkageTimeoutId=null;var _onConnectCallBacks=[];var _onNodeConnectCallBacks=[];var _sendTimeoutHost=null;var _isFirstTimeConnectCmd=false;var _disposing=false;var _args={"namespace":"THINFINITY","mode":LinkageConnection.mode.REMOTE,"id":"LINKAGE_"+(new Date).getTime().toString(),"multipleConnections":true,
"sourceElem":null,"targetElem":null,"profileMode":null,"switchHost":false,"events":null,"channel":null};var _linkage={"id":null,"namespace":null,"mode":null,"origin":null};var _linkageList={};var _polling={"timeoutId":null,"timeout":null,"isConnected":false,"retries":-1,"maxRetries":1,"reconnectedTimeRefresh":250,"connectedTimeRefresh":4E3};var _allowMethods=["_linkageHostConnectionRequest","_linkageHostPollingRequest","_linkageHostReleaseConnection","_linkageRemoteConnectionRequest","_linkageRemotePollingRequest",
"_linkageHostSyncModelCommand","_linkageRemoteSyncModelCommand"];var _events={};var _crossDomain=false;var _targetId=undefined;var _isDisposed=false;function initialize(args){_ref["commands"]={};if(args!=null&&args!=undefined)for(var arg in _args)if(args[arg]!=undefined)_args[arg]=args[arg];if(!_args["channel"]||_args["channel"]=="")_args["channel"]="*";try{if(!parent||!parent.document)_crossDomain=true}catch(error){_crossDomain=true}_args["mode"]=_args["mode"].toUpperCase();if(_args["mode"].indexOf("REMOTE")!=
-1){_isRemote=true;if(helper.object.existsPath(args,"events.success"))onConnect(args.events.success);if(helper.object.existsPath(args,"events.failure"));}else _isRemote=false;for(var eventName in _args.events)if(helper.object.existsPath(_args,"events."+eventName)){if(!_events[eventName])_events[eventName]=[];_events[eventName].push(_args.events[eventName])}if(typeof _args["id"]=="undefined"||_args["id"]==null||_args["id"]=="")_args["id"]="Thinfinity.Linkage_"+(_isRemote?LinkageConnection.mode.REMOTE:
LinkageConnection.mode.HOST)+"_"+(new Date).getTime().toString();if(window["roleMode"]==undefined||window["roleMode"]==LinkageConnection.mode.REMOTE)window["roleMode"]=_isRemote?LinkageConnection.mode.REMOTE:LinkageConnection.mode.HOST;var errorMsg="Thinfinity.PostMessage is undefined";try{if(Thinfinity["PostMessage"]){_args["allowMethods"]=_allowMethods;_postMessage=new Thinfinity.PostMessage(_args);registerPrivateCommands()}else{_ref=null;throw new Error(errorMsg);return}}catch(error){_ref=null;
throw new Error(error.message);return}}function start(){if(_isRemote)if(!_isLinked){_disposing=false;var data={"id":_args["id"],"mode":_args["mode"],"namespace":_args["namespace"],"channel":_args["channel"]};helper.console.log("Initialize Linkage: Start [Mode: "+_args["mode"]+" , Id: "+_args["id"]+"]");if(arguments.length>0&&helper.object.getTypeOf(arguments[0])=="window"){var wnd=arguments[0];setTargetWindow(wnd,wnd.name||wnd.id||"WND_"+LinkageConnection.mode.HOST+"_"+helper.utils.generateGUID(10))}if(_maxTimes==
-1||_maxTimes>_countTimes){_countTimes++;send("_linkageHostConnectionRequest",data,undefined,true,_targetId);clearTimeout(_waitTimeid);_waitTimeid=setTimeout(start,_isFirstTimeConnectCmd!=true&&_countTimes<10?_waitFirstTime:_waitTime)}else{helper.console.log("Cannot connect to the "+LinkageConnection.mode.HOST+", disposing current element");if(helper.object.existsPath(args,"events.failure"))try{args.events.failure("Cannot connect to host")}catch(error){}disposeRemote()}}}function linkageHostConnectionRequest(data,
origin){if(args["mode"]==LinkageConnection.mode.HOST&&data["id"]!=_args["id"]&&_args["channel"]===data["channel"]){if(_linkageList[data["id"]]==undefined)_linkageList[data["id"]]={};var linkage={};linkage["origin"]=origin;for(var attrib in _linkage)if(data[attrib]!=undefined)linkage[attrib]=data[attrib];_linkageList[data["id"]]=linkage;var data={"id":_args["id"],"mode":_args["mode"],"namespace":_args["namespace"],"targetId":linkage["id"],"channel":_args["channel"]};helper.console.log("Host Connection Request Received - Linkage: [Mode: "+
_args["mode"]+" , Id: "+_args["id"]+"], Linked to: ["+linkage["id"]+"], Channel: ["+_args.channel+"], Accept connection, responding to remote...");send("_linkageRemoteConnectionRequest",data,undefined,true,linkage.id);_isLinked=true;for(var i=0;i<_onNodeConnectCallBacks.length;i++)_onNodeConnectCallBacks[i](getLinkedConfig());fireEvent("connect",{"id":_args.id,"targetId":data.targetId})}}function linkageRemoteConnectionRequest(data,origin){if(_isLinked==false&&_args["channel"]===data["channel"]){_isLinked=
true;_linkage["origin"]=origin;for(var attrib in _linkage)if(data[attrib]!=undefined)_linkage[attrib]=data[attrib];for(var i=0;i<_onConnectCallBacks.length;i++)_onConnectCallBacks[i](getLinkedConfig());helper.console.log("Remote Connection Request Complete - Linkage: [Mode: "+_args["mode"]+" , Id: "+_args["id"]+"], Linked to: ["+_linkage["id"]+"] , Channel: ["+_args.channel+"]. The Host and remote are engaged.");clearTimeout(_waitTimeid);_waitTimeid=null;setTimeout(function(){helper.console.log("Start polling... Remote: "+
_args["id"]);clearTimeout(_polling["timeoutId"]);_polling["isConnected"]=true;_polling["timeout"]=_polling["connectedTimeRefresh"];if(_polling["timeoutId"]==null){clearTimeout(_polling["timeoutId"]);_polling["timeoutId"]=null;linkageRemotePolling()}},500);_maxTimes=30;fireEvent("connect",{"id":_args.id,"targetId":data.targetId})}}function clearPolling(){clearTimeout(_polling["timeoutId"]);_polling["timeoutId"]=null}function linkageRemotePolling(){if(_isRemote&&!_disposing){clearPolling();if(_polling["isConnected"]==
false){helper.console.log("HOST was lost, retrying to connect...");_polling["timeout"]=_polling["reconnectedTimeRefresh"];if(_polling["retries"]==-1||_polling["retries"]>_polling["maxRetries"]){_isLinked=false;clearTimeout(_waitTimeid);_maxTimes=-1;_countTimes=0;_linkageList={};start();return}}else _polling["timeout"]=_polling["connectedTimeRefresh"];var data={"id":_args["id"],"mode":_args["mode"],"namespace":_args["namespace"],"channel":_args["channel"]};if(_crossDomain)data.targetId=_targetId;send("_linkageHostPollingRequest",
data,false,false);clearPolling();_polling["timeoutId"]=setTimeout(function(){_polling["isConnected"]=false;linkageRemotePolling()},_polling["timeout"])}}function linkageHostPollingRequest(data,origin){if(_args["mode"]==LinkageConnection.mode.HOST&&data["id"]!=_args["id"]&&_args["channel"]===data["channel"]){var sendData={};if(_linkageList[data["id"]]==undefined)sendData={"id":_args["id"],"mode":_args["mode"],"namespace":_args["namespace"],"targetId":data["id"],"channel":_args["channel"],"reconnect":true};
else sendData={"id":_args["id"],"mode":_args["mode"],"namespace":_args["namespace"],"targetId":data["id"],"channel":_args["channel"]};send("_linkageRemotePollingRequest",sendData,data.id,false,data.id)}}function linkageRemotePollingRequest(data,origin){if(_isRemote&&data&&data["mode"]==LinkageConnection.mode.HOST&&data["targetId"]==_args["id"]&&_args["channel"]===data["channel"]){clearTimeout(_polling["timeoutId"]);_polling["timeoutId"]=null;if(data["reconnect"]==true){_polling["isConnected"]=false;
_polling["timeout"]=_polling["reconnectedTimeRefresh"];_isLinked=false;start()}else{_polling["isConnected"]=true;_polling["timeout"]=_polling["connectedTimeRefresh"];_polling["timeoutId"]=setTimeout(function(){linkageRemotePolling()},_polling["timeout"])}}}function linkageRemoteReleaseConnection(){helper.console.log("Requesting release connection from "+LinkageConnection.mode.HOST+" list.");var data={"id":_args["id"],"mode":_args["mode"],"namespace":_args["namespace"],"targetId":_targetId,"channel":_args["channel"]};
send("_linkageHostReleaseConnection",data,false,false,_targetId)}function linkageHostReleaseConnection(data,origin){if(_args["mode"]==LinkageConnection.mode.HOST&&data["id"]!=_args["id"]&&_args["channel"]===data["channel"])releaseRemoteConnection(data.id)}function getLinkedConfig(){if(_args["mode"]==LinkageConnection.mode.HOST)return{"mode":_args["mode"],"id":_args["id"],"remotes":_linkageList};else return{"mode":_args["mode"],"id":_args["id"],"host":_linkage["id"]}}function guid(){function s4(){return Math.floor((1+
Math.random())*65536).toString(16).substring(1)}return function(){return s4()+s4()+"-"+s4()+"-"+s4()+"-"+s4()+"-"+s4()+s4()+s4()}()}function registerPrivateCommands(){if(_isRemote){_postMessage.registerCommand(_args["namespace"],"_linkageRemoteConnectionRequest",linkageRemoteConnectionRequest);_postMessage.registerCommand(_args["namespace"],"_linkageRemotePollingRequest",linkageRemotePollingRequest)}else{_postMessage.registerCommand(_args["namespace"],"_linkageHostConnectionRequest",linkageHostConnectionRequest);
_postMessage.registerCommand(_args["namespace"],"_linkageHostPollingRequest",linkageHostPollingRequest);_postMessage.registerCommand(_args["namespace"],"_linkageHostReleaseConnection",linkageHostReleaseConnection)}}function register(cmd,handler,populate,optionalName){if(cmd!=undefined&&handler!=undefined)if(_ref["commands"][cmd]==undefined){populate=populate!==false;var rcReturn=_postMessage.registerCommand(_args["namespace"],cmd,handler);if(populate&&rcReturn.result){var exposeName=typeof optionalName===
"string"&&optionalName!=""?optionalName:cmd;_ref["commands"][exposeName]=function(data){send(cmd,data,undefined,false)}}else helper.console.log("Cannot register command:["+rcReturn.message+"]")}else helper.console.log("This command is already registered: ["+cmd+"]");else helper.console.log("Cannot register command:["+cmd+"], handler is: ["+handler.toString()+"]")}function unregister(cmd,handler){if(cmd!=undefined&&handler!=undefined){if(_isRemote)delete _ref["commands"][cmd];var rcReturn=_postMessage.unregisterCommand(_args["namespace"],
cmd,handler);if(rcReturn.result!=true)helper.console.log("Cannot unregister command:["+rcReturn.message+"]")}else helper.console.log("Cannot unregister command:["+cmd+"], handler is: ["+handler.toString()+"]")}function on(event,handler){if(event==undefined||event==null||event=="")return"Event is undefined or null.";if(handler==undefined||handler==null||handler=="")return"Handler is undefined or null.";if(_events[event]==undefined)_events[event]=[];_events[event].push(handler)}function off(event,handler){if(event==
undefined||event==null||event=="")return"Event is undefined or null.";if(handler==undefined||handler==null||handler=="")return"Handler is undefined or null.";if(_events[event])for(var i=_events[event].length-1;i>=0;i--)if(_events[event][i]===handler)_events[event].splice(i,1)}function fireEvent(name,data){if(_events[name]&&_events[name].length>0)for(var i=0;i<_events[name].length;i++)try{setTimeout(function(args){_events[name][args[0]](data)},0,[i])}catch(error){}}function send(cmd,data,allRemotes,
protocol,targetId){var sendData=null;if(!targetId||targetId=="")targetId=_targetId;if(allRemotes==undefined)sendData={"namespace":_args["namespace"],"cmd":cmd,"linkageId":_args["id"],"targetId":targetId,"data":data,"allRemotes":true,"protocol":protocol};else sendData={"namespace":_args["namespace"],"cmd":cmd,"linkageId":_args["id"],"targetId":targetId,"data":data,"allRemotes":allRemotes,"protocol":protocol};if(_isRemote==false){var subcmd=helper.object.getValue(sendData,"data.cmd",undefined);if(cmd.indexOf("_linkage")==
-1&&(!_isFirstTimeConnectCmd&&subcmd=="connect"||subcmd!="reconnecting"&&subcmd!="connect")){_isFirstTimeConnectCmd=true;var item={"cmd":cmd,"data":sendData.data,"time":(new Date).getTime(),"linkageId":{}};if(_isLinked==false);else{for(var linkageId in _linkageList)item["linkageId"][linkageId]=true;_postMessage.postMessage(sendData)}}else _postMessage.postMessage(sendData)}else if(_isLinked==true||_allowMethods.indexOf(cmd)!=-1)_postMessage.postMessage(sendData);else;}function setSourceWindow(win){if(typeof win!=
"undefined"&&win!=null){_args["sourceElem"]=win;_postMessage.setSourceWindow(win);delete _ref["setSourceWindow"]}}function setTargetWindow(win,name){if(typeof win!="undefined"&&win!=null)if(_args["mode"]==LinkageConnection.mode.REMOTE||!_args["multipleConnections"]){_args["targetElem"]=win;_postMessage.setTargetWindow(win);_targetId=name;if(!_args.switchHost)delete _ref["setTargetWindow"]}else{_args["targetElem"]=null;_postMessage.setTargetWindow(win,name)}}function onConnect(callback){var isNotAdded=
true;for(var i=0;i<_onConnectCallBacks.length;i++)if(_onConnectCallBacks[i]===callback){isNotAdded=false;break}if(isNotAdded&&callback instanceof Function)if(_isLinked)callback(getLinkedConfig());else _onConnectCallBacks.push(callback)}function onNodeConnect(callback){var isNotAdded=true;for(var i=0;i<_onNodeConnectCallBacks.length;i++)if(_onNodeConnectCallBacks[i]===callback){isNotAdded=false;break}if(isNotAdded&&callback instanceof Function)if(_isLinked)callback(getLinkedConfig());else _onNodeConnectCallBacks.push(callback)}
function disposeRemote(){_disposing=true;var time=500;if(arguments.length>0)try{time=parseFloat(arguments[0])}catch(error){}if(_isDisposed)return;clearTimeout(_polling["timeoutId"]);clearTimeout(_waitTimeid);linkageRemoteReleaseConnection();if(_postMessage)_postMessage.dispose();setTimeout(function(){_ref=_postMessage=_onNodeConnectCallBacks=_onConnectCallBacks=_linkageList=_isLinked=_countTimes=_args=null;_isDisposed=true},time);return}function disposeHost(){var time=500;if(arguments.length>0)try{time=
parseFloat(arguments[0])}catch(error){}if(_isDisposed)return;if(_postMessage){_postMessage.disconnect("*");_postMessage.dispose()}setTimeout(function(){_ref=_postMessage=_onNodeConnectCallBacks=_onConnectCallBacks=_linkageList=_isLinked=_countTimes=_args=null;_isDisposed=true},time);return}function activeSessions(){var count=0;for(var link in _linkageList)count++;return count}function releaseRemoteConnection(id){delete _linkageList[id];_postMessage.disconnect(id)}function disconnectRemote(id,echo){if(echo==
undefined||!echo)linkageRemoteReleaseConnection();clearTimeout(_polling.timeoutId);_isLinked=false;_postMessage.disconnect();_args.targetElem=null}initialize(args);Object.defineProperty(this,"register",{"enumerable":true,"configurable":false,"value":register});Object.defineProperty(this,"unregister",{"enumerable":false,"configurable":false,"value":unregister});Object.defineProperty(this,"send",{"enumerable":true,"configurable":false,"value":send});if(_isRemote==true){Object.defineProperty(this,"start",
{"enumerable":true,"configurable":false,"writable":false,"value":start});Object.defineProperty(this,"isConnected",{"enumerable":true,"configurable":false,"get":function(){return _isLinked}});Object.defineProperty(this,"onConnect",{"enumerable":true,"configurable":false,"set":onConnect});Object.defineProperty(this,"dispose",{"enumerable":true,"configurable":false,"writable":false,"value":disposeRemote});if(_args.switchHost){Object.defineProperty(this,"setTargetWindow",{"enumerable":false,"configurable":true,
"value":setTargetWindow});Object.defineProperty(this,"disconnect",{"enumerable":true,"configurable":false,"writable":false,"value":disconnectRemote})}Object.defineProperty(this,"targetId",{"enumerable":false,"configurable":true,"get":function(){return _targetId},"set":function(targetId){_targetId=targetId}})}else{Object.defineProperty(this,"onNodeConnect",{"enumerable":true,"configurable":false,"set":onNodeConnect});Object.defineProperty(this,"dispose",{"enumerable":true,"configurable":false,"writable":false,
"value":disposeHost});Object.defineProperty(this,"activeSessions",{"enumerable":true,"configurable":false,"get":function(){return activeSessions()}});Object.defineProperty(this,"disconnect",{"enumerable":true,"configurable":false,"writable":false,"value":releaseRemoteConnection});Object.defineProperty(this,"id",{"enumerable":true,"configurable":false,"get":function(){return _args.id},"set":function(id){_args.id=id;if(_postMessage)_postMessage.id=id}});Object.defineProperty(this,"isConnected",{"enumerable":true,
"configurable":false,"get":function(){for(var k in _linkageList)return true;return false}})}Object.defineProperty(this,"on",{"enumerable":true,"configurable":false,"value":on});Object.defineProperty(this,"off",{"enumerable":true,"configurable":false,"value":off});if(_args["profileMode"]!=undefined&&[LinkageConnection.profileMode.JSVIEW,LinkageConnection.profileMode.CONFIGURABLE].indexOf(_args["profileMode"])!=1){Object.defineProperty(this,"setSourceWindow",{"enumerable":false,"configurable":true,
"value":setSourceWindow});if(!(_isRemote&&_args.switchHost))Object.defineProperty(this,"setTargetWindow",{"enumerable":false,"configurable":true,"value":setTargetWindow})}return this}try{Thinfinity!=undefined}catch(e){Thinfinity={}}var _profileMode=helper.object.createEnum({"NONE":"none","JSVIEW":"JsView","CONFIGURABLE":"configurable"});Object.defineProperty(LinkageConnection,"profileMode",{"enumerable":false,"configurable":false,"get":function(){return _profileMode}});var _modes=helper.object.createEnum({"HOST":"HOST",
"REMOTE":"REMOTE"});Object.defineProperty(LinkageConnection,"mode",{"enumerable":false,"configurable":false,"get":function(){return _modes}});Thinfinity.LinkageConnection=LinkageConnection})();
(function(){function PostMessage(args){var _ref=this;var _contentWindow={};var _isBidirectional=true;var _commandHandlers={};var _postMessageId=null;var _secure=true;var _origin=null;var _storageDataName="post-message-storage-data";var _linkageId={"session":{},"count":0};var _args={"mode":"REMOTE","id":"POSTMESSAGE_"+(new Date).getTime().toString(),"multipleConnections":false,"sourceElem":null,"targetElem":null,"profileMode":null,"switchHost":false,"allowMethods":null};var _maxConnectTries=0;var _windowTop=
null;var _targetValues=["_self","_blank","_top","_parent"];var _jsroManager=null;var _crossDomain=false;function initialize(args){try{if(parent&&parent.document);else _crossDomain=true}catch(error){_crossDomain=true}_postMessageId=args!=undefined&&args.id!=undefined?"postMessage_"+args.id:"postMessage_"+(new Date).getTime().toString();if(_args.mode!="HOST")_contentWindow[_args.id]=getContentWindow(null);var _windowTop=helper.url.getTopWindow(window);if(_windowTop[_storageDataName]==undefined)_windowTop[_storageDataName]=
{};_windowTop[_storageDataName][_args.id]=window;if(_isBidirectional)startListening();return true}function parseArguments(args){if(args!=null&&args!=undefined)for(var arg in _args)if(args[arg]!=undefined)_args[arg]=args[arg];_args.mode=_args.mode.toUpperCase()}function getHostContentWindow(elem){if(elem!=null){if(window.roleMode!=undefined&&window.roleMode=="HOST")return window;var iframes=(elem.document||elem.documentElement||elem.contentDocument.documentElement).getElementsByTagName("iframe");if(iframes.length>
0){for(var i=0;i<iframes.length;i++)try{if(iframes[i].contentWindow&&iframes[i].contentWindow.roleMode&&iframes[i].contentWindow.roleMode.toUpperCase()=="HOST")return iframes[i].contentWindow}catch(error){}for(var i=0;i<iframes.length;i++)try{var wnd=getHostContentWindow(iframes[i]);if(wnd&&wnd.roleMode&&wnd.roleMode=="HOST")return wnd}catch(error){}return window}else{var wnd=window.roleMode!=undefined&&window.roleMode=="HOST"?window:window.frameElement!=undefined&&window.frameElement.ownerDocument.defaultView&&
window.frameElement.ownerDocument.defaultView.roleMode=="HOST"&&window.frameElement.ownerDocument.defaultView.postMessage?window.frameElement.ownerDocument.defaultView:window.frameElement!=undefined&&window.frameElement.contentWindow!=undefined&&window.frameElement.contentWindow.top.roleMode=="HOST"?window.frameElement.contentWindow.top:iframes.length==1&&iframe[0].contentWindow.roleMode=="HOST"?iframes[0].contentWindow:null;if(wnd!=null)return wnd;else{var top=window.top;if(!_crossDomain&&top){iframes=
top.document.getElementsByTagName("iframe");for(var i=0;i<iframes.length;i++)try{if(iframes[i]&&iframes[i].contentWindow&&iframes[i].contentWindow.roleMode=="HOST")return iframes[i].contentWindow}catch(error){}}return window}}}}function getContentWindow(id,message){var winRef=null;if(message&&message.source&&!(window.Thinfinity&&window.Thinfinity.JsROManager))try{if(message.source!==window&&message.source.name);}catch(error){return message.source}if(_crossDomain)if(message&&message.source)return message.source;
else if(id&&typeof id=="object")return id;else{if(!window.Thinfinity.JsROManager)return window}else{if(window.Thinfinity&&window.Thinfinity.JsROManager){if(_jsroManager==null)_jsroManager=new Thinfinity.JsROManager;winRef=_jsroManager.getJsROContentWindow(id);if(winRef)return winRef}if(id==null&&message==null)return _args.targetElem;else if(id&&id instanceof Window)return id;if(_args.mode!="HOST"){if(_args.targetElem!=undefined&&_args.targetElem!=null)if(typeof _args.targetElem=="string")if(_targetValues.indexOf(_args.targetElem)!=
-1)switch(_args.targetElem){case "_self":break;case "_blank":winRef=window.opener!=undefined?window.opener:null;break;case "_top":break;case "_parent":break}else{winRef=document.getElementById(_args.targetElem);if(winRef==null&&(window.id||window.name)==_args.targetElem)winRef=window.contentWindow;if(winRef!=null&&winRef.nodeName.toLowerCase()=="iframe")winRef=winRef.contentWindow;if(window.top.name==_args.targetElem)winRef=window.top;else{var elems=window.top.document.getElementsByName(_args.targetElem);
if(elems.length>0)winRef=elems[0].contentWindow}if(winRef==null&&window.opener!=undefined&&(window.opener.name||window.opener.id)==_args.targetElem)winRef=window.opener}else if(typeof _args.targetElem["postMessage"]!="undefined")winRef=_args.targetElem;else winRef=_args.targetElem.contentWindow;else if(!window.parent&&window.opener!=undefined)winRef=window.opener;else winRef=getHostContentWindow(window);return winRef}else{winRef=null;if(_args.targetElem!=undefined&&_args.targetElem!=null){if(typeof _args.targetElem==
"string"){winRef=document.getElementById(_args.targetElem);if(winRef==null)if((window.id||window.name)==_args.targetElem)winRef=window;else if((window.top.id||window.top.name)==_args.targetElem)winRef=window.top;if(winRef!=null&&winRef.nodeType!=undefined&&winRef.nodeName.toLowerCase()=="iframe")winRef=winRef.contentWindow}else winRef=_args.targetElem;if(winRef==null)if(typeof _args.sourceElem=="string"&&_targetValues.indexOf(_args.sourceElem)!=-1)if(window.opener!=undefined)if(typeof _args.targetElem==
"string"&&(window.name||window.id)==_args.targetElem)winRef=window.opener;else winRef=window.opener;else winRef=null;else winRef=null}else{var getContentWindowByName=function(iframes){var frmW=null;for(var i=0;i<iframes.length;i++)if(iframes[i].contentWindow.name==id){frmW=iframes[i].contentWindow;break}if(frmW==null)frmW=window;return frmW};if(winRef==null){var iframes=document.getElementsByTagName("iframe");var windowTop=helper.url.getTopWindow(window);winRef=windowTop&&windowTop[_storageDataName]&&
windowTop[_storageDataName][id]!=undefined?windowTop[_storageDataName][id]:window.frameElement!=undefined&&window.frameElement.ownerDocument.defaultView&&window.frameElement.ownerDocument.defaultView.postMessage?window.frameElement.ownerDocument.defaultView:window.frameElement!=undefined&&window.frameElement.contentWindow!=undefined?window.frameElement.contentWindow.top:iframes.length==1?iframes[0].contentWindow:iframes.length>1?getContentWindowByName(iframes):window["postMessage"]?window:null}}return winRef}}return undefined}
function postMessage(data){function postMsg(contentWindow,data){if(contentWindow&&contentWindow.postMessage!=undefined)if(!!window.attachEvent)contentWindow.postMessage(JSON.stringify(data),"*",false);else try{contentWindow.postMessage(data,"*")}catch(error){}else{contentWindow=undefined;helper.console.log("Content windows is undefined or null.")}}var allRemotes=data&&data["allRemotes"]!=undefined?data["allRemotes"]:true;var to=_args.mode=="HOST"&&allRemotes===true?"*":allRemotes===false?data&&data.linkageId?
data.linkageId:"*":-1;if(to=="*")for(var id in _contentWindow){reAttachContentWindow(id);if(_args.id!=id){data.targetId=id;postMsg(_contentWindow[id],data)}}else{if(to!=-1)reAttachContentWindow(data.linkageId);if(_args.mode=="HOST")if(to!=-1&&data["data"]["requestId"]!=undefined)postMsg(_contentWindow[data["data"]["requestId"]],data);else{var toList=allRemotes.split(",");for(var i=0;i<toList.length;i++)if(_contentWindow[toList[i]]){reAttachContentWindow(toList[i]);postMsg(_contentWindow[toList[i]],
data)}}else{if((_contentWindow[data.linkageId]==null||_contentWindow[data.linkageId]==undefined)&&_jsroManager){var hosts=_jsroManager.getHostCollection();if(hosts.length>0)_contentWindow[data.linkageId]=hosts[0]}if(_contentWindow[data.linkageId]==null||_contentWindow[data.linkageId]==undefined)reAttachContentWindow(data.linkageId);postMsg(_contentWindow[data.linkageId],data)}}}function reAttachContentWindow(linkageId){if(linkageId!=undefined&&_contentWindow[linkageId]==undefined){_contentWindow[linkageId]=
getContentWindow(linkageId);if(_contentWindow[linkageId]!=undefined&&_isBidirectional);}}function getLinkageCount(){var count=0;for(var attrib in _linkageId["session"])count++;return count}function startListening(){if(!!window.attachEvent)window.attachEvent("onmessage",receiveMessage);else window.addEventListener("message",receiveMessage,false)}function receiveMessage(e){if(_secure)if(_origin==null)_origin=e.origin;else if(_origin!=e.origin);var obj=null;if(typeof e.data=="string")try{obj=JSON.parse(e.data)}catch(e){helper.console.warning("Cannot parse data: "+
e.data,arguments);obj=null}else obj=e.data;var tempLinkageId=helper.object.existsPath(obj,"linkageId")?obj["linkageId"]:null;var isProtocol=helper.object.existsPath(obj,"protocol")?obj["protocol"]:false;if(tempLinkageId!=null&&"postMessage_"+tempLinkageId!=_postMessageId){_maxConnectTries=0;if(_contentWindow[tempLinkageId]==undefined&&_args.mode=="HOST"&&(_args["allowMethods"]==null||_args["allowMethods"]==undefined||_args["allowMethods"].length==0||helper.object.existsPath(obj,"cmd")&&_args["allowMethods"].indexOf(obj.cmd)!=
-1))_contentWindow[tempLinkageId]=getContentWindow(tempLinkageId,e);if(_args["multipleConnections"]==false&&_contentWindow[_args.id]!=(e.source||e.srcWindow)&&_contentWindow[tempLinkageId]!=(e.source||e.srcWindow))return;if(_args["multipleConnections"]==false&&isProtocol==true&&_linkageId["count"]==0){_linkageId["session"][tempLinkageId]="connected";_linkageId["count"]=getLinkageCount()}else if(_args["multipleConnections"]==true&&isProtocol==true&&_linkageId["session"][tempLinkageId]==undefined){_linkageId["session"][tempLinkageId]=
"connected";_linkageId["count"]=getLinkageCount()}else if(_crossDomain&&helper.object.getValue(obj,"data.requestId",null)==_args.id)return;if(_linkageId["session"][tempLinkageId]==undefined){if(_args.mode=="HOST")delete _contentWindow[tempLinkageId];return}if(obj!=null)callCommand(obj.namespace,obj.cmd,obj.data,e.origin);else throw new Error("Cannot deserialize this object.");}else if(_args.mode=="REMOTE"&&tempLinkageId){_maxConnectTries++;if(_maxConnectTries>=2){_contentWindow={};_maxConnectTries=
0;_contentWindow[tempLinkageId]=getContentWindow(null,e)}}}function registerCommand(namespace,cmd,handler){var ret={"result":null,"message":null};if(namespace==null||namespace==undefined||namespace==""){ret.result=false;ret.message="Namespace cannot be null."}else if(cmd==null||cmd==undefined||cmd==""){ret.result=false;ret.message="Command cannot be null."}else if(handler==null||handler==undefined||handler==""){ret.result=false;ret.message="Handler cannot be null."}else{namespace=namespace.toUpperCase();
if(_commandHandlers[namespace]==undefined)_commandHandlers[namespace]={};if(_commandHandlers[namespace][cmd]==undefined){_commandHandlers[namespace][cmd]=handler;ret.result=true}else{ret.result=false;ret.message="The command was registered previously."}}return ret}function unregisterCommand(namespace,cmd,handler){var ret={"result":null,"message":null};if(namespace==null||namespace==undefined||namespace==""){ret.result=false;ret.message="Namespace cannot be null."}else{namespace=namespace.toUpperCase();
if(_commandHandlers[namespace]!=undefined&&_commandHandlers[namespace][cmd]!=undefined&&_commandHandlers[namespace][cmd]===handler){delete _commandHandlers[namespace][cmd];ret.result=true}else{ret.result=false;ret.message="This command is not registered."}}return ret}function callCommand(namespace,cmd,data,origin,linkageId){namespace=namespace.toUpperCase();if(_commandHandlers[namespace]!=undefined&&_commandHandlers[namespace][cmd]!=undefined)_commandHandlers[namespace][cmd](data,origin);else return null}
function setSourceWindow(win){if(typeof win!="undefined"&&win!=null){if(typeof win=="string")if(window.name==win||window.id==win)_args.sourceElem=window;else _args.sourceElem=win;else _args.sourceElem=win;delete _ref["setSourceWindow"]}}function setTargetWindow(win,name){if(typeof win!="undefined"&&win!=null)if(_args.mode=="REMOTE"||!_args["multipleConnections"]){_args.targetElem=win;_contentWindow[_args.id]=null;if(_crossDomain)_contentWindow[_args.id]=getContentWindow(win);else{var regExp=new RegExp("HTML{1}[a-zA-Z]*Element{1}|Window");
var tof=regExp.exec(helper.object.getTypeOf(win));if(win instanceof HTMLElement||tof&&tof.length>0)_contentWindow[_args.id]=getContentWindow(win);else if(typeof win=="object")_contentWindow[_args.id]=win;else{elem=document.getElementById(win);if(elem){try{elem=elem.contentWindow||elem}catch(error){}_contentWindow[_args.id]=elem}else _contentWindow[_args.id]=getContentWindow(win)}}if(!_args.switchHost)delete _ref["setTargetWindow"]}else _contentWindow[name]=win}function dispose(){if(!!window.removeEvent)window.removeEvent("onmessage",
receiveMessage);else window.removeEventListener("message",receiveMessage,false);_ref=_storageDataName=_secure=_postMessageId=_origin=_linkageId=_commandHandlers=_contentWindow=null;return}function disconnectHost(id){if(id=="*"){if(_linkageId){_linkageId.session={};_linkageId.count=0}_contentWindow={}}else{_linkageId.count--;delete _linkageId.session[id];delete _contentWindow[id]}}function disconnectRemote(){_args.targetElem=null;_contentWindow[_args.id]=null;_linkageId.session={};_linkageId.count=
0}parseArguments(args);Object.defineProperty(this,"registerCommand",{"enumerable":false,"configurable":false,"value":registerCommand});Object.defineProperty(this,"unregisterCommand",{"enumerable":false,"configurable":false,"value":unregisterCommand});Object.defineProperty(this,"postMessage",{"enumerable":true,"configurable":false,"writable":false,"value":postMessage});Object.defineProperty(this,"dispose",{"enumerable":true,"configurable":false,"writable":false,"value":dispose});if(_args.mode=="HOST"){Object.defineProperty(this,
"getRemoteSessions",{"enumerable":true,"configurable":false,"writable":false,"value":function(){return _linkageId["session"]}});Object.defineProperty(this,"disconnect",{"enumerable":true,"configurable":false,"writable":false,"value":disconnectHost});Object.defineProperty(this,"id",{"enumerable":true,"configurable":false,"get":function(){return _args.id},"set":function(id){_args.id=id}})}else if(_args.switchHost){Object.defineProperty(this,"disconnect",{"enumerable":true,"configurable":false,"writable":false,
"value":disconnectRemote});Object.defineProperty(this,"setTargetWindow",{"enumerable":false,"configurable":true,"value":setTargetWindow})}if(_args["profileMode"]!=undefined&&_args["profileMode"]=="JsView"){Object.defineProperty(this,"setSourceWindow",{"enumerable":false,"configurable":true,"value":setSourceWindow});if(!(_args.mode=="REMOTE"&&_args.switchHost))Object.defineProperty(this,"setTargetWindow",{"enumerable":false,"configurable":true,"value":setTargetWindow})}initialize(args);return this}
try{Thinfinity!=undefined}catch(e){Thinfinity={}}Thinfinity.PostMessage=PostMessage})();
(function(){function JsViewConfig(args){var _ref=this;var _args={};var _config={};function initialize(args){helper.object.merge(args,_args);if(_args!=undefined)if(typeof _args.config!="undefined"){var type=helper.object.getDataTypeOf(_args.config);switch(type.toUpperCase()){case "ARRAY":for(var i=0;i<_args.config.length;i++){var property=_args.config[i];registerProperty(property[0],property[1],property[2],typeof property[3]!="undefined"?property[3]:undefined,typeof property[4]!="undefined"?property[4]:
undefined,typeof property[5]!="undefined"?property[5]:undefined,typeof property[6]!="undefined"?property[6]:true)}break;case "JSON":for(var property in _args.config)registerProperty(property["name"],property["reference"],property["accessName"],typeof property["readonly"]!="undefined"?property["readonly"]:undefined,typeof property["nodeType"]!="undefined"?property["nodeType"]:undefined,typeof property["type"]!="undefined"?property["type"]:undefined,typeof property["populate"]!="undefined"?property["populate"]:
true);break}}}function registerProperty(name,reference,accessName,optionalReadonly,optionalNodeType,optionalType,optionalPopulate){try{if(_config[name]==undefined){if(typeof name=="undefined"||name==null)throw"Name is undefined or null";if(typeof reference=="undefined"||reference==null)throw"Reference is undefined or null";if(typeof optionalReadonly=="undefined"||optionalReadonly==null)optionalReadonly=true;if(typeof optionalNodeType=="undefined"||optionalNodeType==null)optionalNodeType="property";
if(typeof optionalType=="undefined"||optionalType==null)optionalType=helper.object.getTypeOf(reference[name])||"property";if((typeof accessName=="undefined"||accessName==null)&&(optionalNodeType!="method"&&optionalNodeType!="function"&&optionalNodeType!="local"))throw"Access Name is undefined or null";if(optionalPopulate===undefined)optionalPopulate=true;_config[name]={"name":name,"nodeType":optionalNodeType,"accessName":accessName,"reference":reference,"type":optionalType,"readonly":optionalReadonly,
"populate":optionalPopulate}}else throw"Already exists";}catch(error){helper.console.warning('Cannot register this property ["'+(accessName||name)+'"]',error)}}function getConfig(){return _config}initialize(args);Object.defineProperty(_ref,"registerProperty",{"enumerable":true,"configurable":false,"writable":false,"value":registerProperty});Object.defineProperty(_ref,"getConfig",{"enumerable":true,"configurable":false,"writable":false,"value":getConfig});return _ref}try{Thinfinity!=undefined}catch(e){Thinfinity=
{}}Thinfinity.JsViewConfig=JsViewConfig})();
function _0x20b8(){var _0x17bf3b=["KeyG","Numpad4","offsetHeight","KeyI","KeyB","undefined","Backquote","required","Insert","ArrowUp","7nVAsnb","Digit7","FnLock","screen","Numpad0","KeyZ","F12","NumpadComma","Cannot stop capturing SK","NumpadSubtract","helper","KeyQ","ShiftRight","width","KeyW","height","Digit9","unlock","5iQrLtX","getTopWindow","Backslash","exitfullscreen","NumpadMemoryAdd","Home","push","KeyF","Initializing {0} class - {1}","Cannot start capturing SK","KeyN","Minus","environment",
"console","Pause","systemKeys","lock","Digit2","Digit8","Escape","Environment is not defined","MetaRight","then","PrintScreen","Digit3","Your browser does not support capturing SK.","NumpadAdd","NumpadMemoryStore","Digit5","Tab","KeyJ","PageUp","NumpadMemoryClear","concat","cookiePrefix","F11","indexOf","document","KeyA","Numpad5","format","ShiftLeft","SystemKeys","251sBCQIF","1355662vKbiOE","Numpad1","1686000dYGvQL","url","IntlRo","211221NPhQku","2037510xzVAqh","9032malUpY","log","notRequired","enabled",
"registerPlugin","KeyS","BracketRight","KeyX","CapsLock","off","Slash","documentElement","ArrowDown","Numpad2","enterfullscreen","getValue","Numpad8","ControlLeft","NumpadMemoryRecall","BracketLeft","Comma","NumpadParenRight","Digit1","KeyM","helperPlugins","NumpadHash","214QkJgTa","KeyO","KeyC","End","Numpad9","1294404ZyYHcj","KeyL","Helper is not defined","NumpadClearEntry","NumpadMemorySubtract","AltLeft","settings","Digit0","NumpadEqual","Font","ScrollLock","Numpad7","KeyY","KeyR","Digit4","ControlRight",
"IntlBackslash","4977mzeJCY","navigator","ContextMenu","KeyT","keyboard","Quote","AltRight"];_0x20b8=function(){return _0x17bf3b};return _0x20b8()}function _0x29a8(_0x383d58,_0x33d6da){var _0x20b89e=_0x20b8();return _0x29a8=function(_0x29a8c8,_0x26c8a3){_0x29a8c8=_0x29a8c8-413;var _0x286dab=_0x20b89e[_0x29a8c8];return _0x286dab},_0x29a8(_0x383d58,_0x33d6da)}
(function(_0x47a0a4,_0x50c30f){var _0x2f294b=_0x29a8,_0x3b1a18=_0x47a0a4();while(!![])try{var _0x2005be=parseInt(_0x2f294b(477))/1*(-parseInt(_0x2f294b(511))/2)+parseInt(_0x2f294b(483))/3+-parseInt(_0x2f294b(516))/4*(-parseInt(_0x2f294b(434))/5)+-parseInt(_0x2f294b(484))/6*(-parseInt(_0x2f294b(416))/7)+parseInt(_0x2f294b(485))/8*(-parseInt(_0x2f294b(533))/9)+parseInt(_0x2f294b(480))/10+parseInt(_0x2f294b(478))/11;if(_0x2005be===_0x50c30f)break;else _0x3b1a18["push"](_0x3b1a18["shift"]())}catch(_0x29e14e){_0x3b1a18["push"](_0x3b1a18["shift"]())}})(_0x20b8,
374241),function(){var _0x2d189a=_0x29a8;function _0x2613fc(){var _0x3fc4f4=_0x29a8,_0x1dd07d=this,_0x55e1f2=!![],_0x3930e4=![],_0x59f6fa=![],_0x3788bd={"Alphanumeric":{"required":[_0x3fc4f4(546),_0x3fc4f4(436),_0x3fc4f4(504),_0x3fc4f4(491),_0x3fc4f4(505),_0x3fc4f4(523),_0x3fc4f4(507),_0x3fc4f4(451),_0x3fc4f4(458),_0x3fc4f4(530),_0x3fc4f4(462),"Digit6",_0x3fc4f4(417),_0x3fc4f4(452),_0x3fc4f4(432),"Equal",_0x3fc4f4(532),_0x3fc4f4(482),"IntlYen",_0x3fc4f4(472),_0x3fc4f4(544),_0x3fc4f4(513),"KeyD","KeyE",
_0x3fc4f4(441),_0x3fc4f4(540),"KeyH",_0x3fc4f4(543),_0x3fc4f4(464),"KeyK",_0x3fc4f4(517),_0x3fc4f4(508),_0x3fc4f4(444),_0x3fc4f4(512),"KeyP",_0x3fc4f4(427),_0x3fc4f4(529),_0x3fc4f4(490),_0x3fc4f4(536),"KeyU","KeyV",_0x3fc4f4(430),_0x3fc4f4(492),_0x3fc4f4(528),_0x3fc4f4(421),_0x3fc4f4(445),"Period",_0x3fc4f4(538),"Semicolon",_0x3fc4f4(495)],"notRequired":[]},"Functional":{"required":[_0x3fc4f4(521),_0x3fc4f4(539),"Backspace",_0x3fc4f4(493),_0x3fc4f4(535),_0x3fc4f4(502),_0x3fc4f4(531),"Enter","MetaLeft",
_0x3fc4f4(455),_0x3fc4f4(475),_0x3fc4f4(428),"Space",_0x3fc4f4(463)],"notRequired":[]},"Numpad":{"required":["NumLock",_0x3fc4f4(420),_0x3fc4f4(479),_0x3fc4f4(498),"Numpad3",_0x3fc4f4(541),_0x3fc4f4(473),"Numpad6",_0x3fc4f4(527),_0x3fc4f4(501),_0x3fc4f4(515),_0x3fc4f4(460),"NumpadDecimal","NumpadMultiply",_0x3fc4f4(425)],"notRequired":["NumpadBackspace","NumpadClear",_0x3fc4f4(519),_0x3fc4f4(423),_0x3fc4f4(524),_0x3fc4f4(510),_0x3fc4f4(438),_0x3fc4f4(466),_0x3fc4f4(503),_0x3fc4f4(461),_0x3fc4f4(520),
"NumpadParenLeft",_0x3fc4f4(506),"NumpadStar"]},"Arrowpad":{"required":["ArrowLeft",_0x3fc4f4(415),"ArrowRight",_0x3fc4f4(497)],"notRequired":[]},"FN":{"required":[_0x3fc4f4(453),"F1","F2","F3","F4","F5","F6","F7","F8","F9","F10",_0x3fc4f4(469),_0x3fc4f4(422),"Fn",_0x3fc4f4(418),_0x3fc4f4(457),_0x3fc4f4(526),_0x3fc4f4(448)],"notRequired":[]},"ControlPad":{"required":["Delete",_0x3fc4f4(514),_0x3fc4f4(439),_0x3fc4f4(414),"PageDown",_0x3fc4f4(465)],"notRequired":[]}},_0x59abfa=![],_0x5c6514=[],_0x36f202=
[],_0x3f2d3a=null,_0x31238d=![];function _0x2765dd(){var _0x1e2cdc=_0x3fc4f4;try{if(!window[_0x1e2cdc(446)])throw new Error(_0x1e2cdc(454));if(!window[_0x1e2cdc(426)])throw new Error(_0x1e2cdc(518));for(let _0x2902ef in _0x3788bd)_0x5c6514=_0x5c6514[_0x1e2cdc(467)](_0x3788bd[_0x2902ef][_0x1e2cdc(413)]),_0x36f202=_0x36f202[_0x1e2cdc(467)](_0x3788bd[_0x2902ef][_0x1e2cdc(487)]);try{if(window[_0x1e2cdc(468)]&&window[_0x1e2cdc(522)]){let _0x1cf1ae=helper["object"][_0x1e2cdc(500)](window["settings"][window["cookiePrefix"]],
_0x1e2cdc(449),null);if(_0x1cf1ae){let _0x3132ef=[];_0x1cf1ae["forEach"](_0x44276b=>{var _0x417285=_0x1e2cdc;if(_0x5c6514[_0x417285(470)](_0x44276b)!==-1)_0x3132ef["push"](_0x44276b);else if(_0x36f202[_0x417285(470)](_0x44276b)!==-1)_0x3132ef[_0x417285(440)](_0x44276b)}),_0x5c6514=_0x3132ef,_0x36f202=[],_0x55e1f2=!![]}}}catch(_0x417f05){}_0x3f2d3a=helper[_0x1e2cdc(481)][_0x1e2cdc(435)](window);if(_0x55e1f2)_0x2b03a2(_0x55e1f2)}catch(_0x549838){return _0x549838}}function _0x64aa7a(){var _0x1eb30c=
_0x3fc4f4;if(!_0x59abfa)try{_0x3f2d3a[_0x1eb30c(534)][_0x1eb30c(537)][_0x1eb30c(450)](_0x5c6514)[_0x1eb30c(456)](()=>{var _0x4bc84c=_0x1eb30c;_0x3930e4&&_0x3f2d3a[_0x4bc84c(534)][_0x4bc84c(537)][_0x4bc84c(450)](_0x36f202)[_0x4bc84c(456)](()=>{})["catch"](_0x5c43c3=>{debugger})}),_0x59abfa=!![]}catch(_0x184082){helper["console"][_0x1eb30c(486)](_0x1eb30c(443))}}function _0x3725bd(){var _0x2f3698=_0x3fc4f4;if(_0x59abfa)try{_0x3f2d3a[_0x2f3698(534)][_0x2f3698(537)][_0x2f3698(433)](_0x5c6514);if(_0x3930e4)_0x3f2d3a[_0x2f3698(534)][_0x2f3698(537)][_0x2f3698(433)](_0x36f202);
_0x59abfa=![]}catch(_0x1e0715){helper[_0x2f3698(447)][_0x2f3698(486)](_0x2f3698(424))}}function _0x2b03a2(_0x4ad05d){var _0x27fdb4=_0x3fc4f4;if(_0x3f2d3a?.["navigator"]?.[_0x27fdb4(537)]?.["lock"]){if(_0x59f6fa!=_0x4ad05d)if(_0x4ad05d){window[_0x27fdb4(446)]["on"](_0x27fdb4(499),_0x64aa7a),window["environment"]["on"](_0x27fdb4(437),_0x3725bd);if(environment["isFullscreen"]||_0x3f2d3a!==window&&_0x3f2d3a[_0x27fdb4(419)][_0x27fdb4(431)]===window["document"][_0x27fdb4(496)][_0x27fdb4(542)]&&_0x3f2d3a["screen"][_0x27fdb4(429)]===
window[_0x27fdb4(471)]["documentElement"]["offsetWidth"])_0x64aa7a();_0x59f6fa=_0x4ad05d}else window[_0x27fdb4(446)][_0x27fdb4(494)]("enterfullscreen",_0x64aa7a),window[_0x27fdb4(446)][_0x27fdb4(494)]("exitfullscreen",_0x3725bd),_0x3725bd(),_0x59f6fa=_0x4ad05d}else helper["console"]["warning"](_0x27fdb4(459));return _0x59f6fa}return _0x2765dd(),Object["defineProperty"](_0x1dd07d,_0x3fc4f4(488),{"enumerable":!![],"configurable":![],"get":function(){return _0x59f6fa},"set":_0x2b03a2}),helper[_0x3fc4f4(447)][_0x3fc4f4(486)](helper["string"][_0x3fc4f4(474)](_0x3fc4f4(442),
_0x3fc4f4(525),(new Date)["toString"]()),arguments),_0x1dd07d}typeof window[_0x2d189a(509)]==_0x2d189a(545)&&(helperPlugins={});helperPlugins[_0x2d189a(476)]=_0x2613fc;if(typeof window[_0x2d189a(426)]!=_0x2d189a(545))helper[_0x2d189a(489)](_0x2d189a(476),_0x2613fc)}();
(function(){function initHammer(){runHammer(window,document,"Hammer")}function runHammer(window,document,exportName,undefined){var VENDOR_PREFIXES=["","webkit","Moz","MS","ms","o"];var TEST_ELEMENT=document.createElement("div");var TYPE_FUNCTION="function";var round=Math.round;var abs=Math.abs;var now=Date.now;function setTimeoutContext(fn,timeout,context){return setTimeout(bindFn(fn,context),timeout)}function invokeArrayArg(arg,fn,context){if(Array.isArray(arg)){each(arg,context[fn],context);return true}return false}
function each(obj,iterator,context){var i;if(!obj)return;if(obj.forEach)obj.forEach(iterator,context);else if(obj.length!==undefined){i=0;while(i<obj.length){iterator.call(context,obj[i],i,obj);i++}}else for(i in obj)obj.hasOwnProperty(i)&&iterator.call(context,obj[i],i,obj)}function deprecate(method,name,message){var deprecationMessage="DEPRECATED METHOD: "+name+"\n"+message+" AT \n";return function(){var e=new Error("get-stack-trace");var stack=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,
"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace";var log=window.console&&(window.console.warn||window.console.log);if(log)log.call(window.console,deprecationMessage,stack);return method.apply(this,arguments)}}var assign;if(typeof Object.assign!=="function")assign=function assign(target){if(target===undefined||target===null)throw new TypeError("Cannot convert undefined or null to object");var output=Object(target);for(var index=1;index<arguments.length;index++){var source=
arguments[index];if(source!==undefined&&source!==null)for(var nextKey in source)if(source.hasOwnProperty(nextKey))output[nextKey]=source[nextKey]}return output};else assign=Object.assign;var extend=deprecate(function extend(dest,src,merge){var keys=Object.keys(src);var i=0;while(i<keys.length){if(!merge||merge&&dest[keys[i]]===undefined)dest[keys[i]]=src[keys[i]];i++}return dest},"extend","Use `assign`.");var merge=deprecate(function merge(dest,src){return extend(dest,src,true)},"merge","Use `assign`.");
function inherit(child,base,properties){var baseP=base.prototype,childP;childP=child.prototype=Object.create(baseP);childP.constructor=child;childP._super=baseP;if(properties)assign(childP,properties)}function bindFn(fn,context){return function boundFn(){return fn.apply(context,arguments)}}function boolOrFn(val,args){if(typeof val==TYPE_FUNCTION)return val.apply(args?args[0]||undefined:undefined,args);return val}function ifUndefined(val1,val2){return val1===undefined?val2:val1}function addEventListeners(target,
types,handler){each(splitStr(types),function(type){target.addEventListener(type,handler,false)})}function removeEventListeners(target,types,handler){each(splitStr(types),function(type){target.removeEventListener(type,handler,false)})}function hasParent(node,parent){while(node){if(node==parent)return true;node=node.parentNode}return false}function inStr(str,find){return str.indexOf(find)>-1}function splitStr(str){return str.trim().split(/\s+/g)}function inArray(src,find,findByKey){if(src.indexOf&&
!findByKey)return src.indexOf(find);else{var i=0;while(i<src.length){if(findByKey&&src[i][findByKey]==find||!findByKey&&src[i]===find)return i;i++}return-1}}function toArray(obj){return Array.prototype.slice.call(obj,0)}function uniqueArray(src,key,sort){var results=[];var values=[];var i=0;while(i<src.length){var val=key?src[i][key]:src[i];if(inArray(values,val)<0)results.push(src[i]);values[i]=val;i++}if(sort)if(!key)results=results.sort();else results=results.sort(function sortUniqueArray(a,b){return a[key]>
b[key]});return results}function prefixed(obj,property){var prefix,prop;var camelProp=property[0].toUpperCase()+property.slice(1);var i=0;while(i<VENDOR_PREFIXES.length){prefix=VENDOR_PREFIXES[i];prop=prefix?prefix+camelProp:property;if(prop in obj)return prop;i++}return undefined}var _uniqueId=1;function uniqueId(){return _uniqueId++}function getWindowForElement(element){var doc=element.ownerDocument||element;return doc.defaultView||doc.parentWindow||window}var MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android/i;
var SUPPORT_TOUCH=agentInfo.isTouch;var SUPPORT_POINTER_EVENTS=agentInfo.isMobile?prefixed(window,"PointerEvent")!==undefined:!agentInfo.isTouch;var SUPPORT_ONLY_TOUCH=agentInfo.isTouch||SUPPORT_TOUCH&&MOBILE_REGEX.test(navigator.userAgent);var INPUT_TYPE_TOUCH="touch";var INPUT_TYPE_PEN="pen";var INPUT_TYPE_MOUSE="mouse";var INPUT_TYPE_KINECT="kinect";var COMPUTE_INTERVAL=25;var INPUT_START=1;var INPUT_MOVE=2;var INPUT_END=4;var INPUT_CANCEL=8;var DIRECTION_NONE=1;var DIRECTION_LEFT=2;var DIRECTION_RIGHT=
4;var DIRECTION_UP=8;var DIRECTION_DOWN=16;var DIRECTION_HORIZONTAL=DIRECTION_LEFT|DIRECTION_RIGHT;var DIRECTION_VERTICAL=DIRECTION_UP|DIRECTION_DOWN;var DIRECTION_ALL=DIRECTION_HORIZONTAL|DIRECTION_VERTICAL;var PROPS_XY=["x","y"];var PROPS_CLIENT_XY=["clientX","clientY"];function Input(manager,callback){var self=this;this.manager=manager;this.callback=callback;this.element=manager.element;this.target=manager.options.inputTarget;this.domHandler=function(ev){if(boolOrFn(manager.options.enable,[manager]))self.handler(ev)};
this.init()}Input.prototype={handler:function(){},init:function(){this.evEl&&addEventListeners(this.element,this.evEl,this.domHandler);this.evTarget&&addEventListeners(this.target,this.evTarget,this.domHandler);this.evWin&&addEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&removeEventListeners(this.element,this.evEl,this.domHandler);this.evTarget&&removeEventListeners(this.target,this.evTarget,this.domHandler);this.evWin&&removeEventListeners(getWindowForElement(this.element),
this.evWin,this.domHandler)}};function createInputInstance(manager){var Type;var inputClass=manager.options.inputClass;if(inputClass)Type=inputClass;else if(SUPPORT_POINTER_EVENTS)Type=PointerEventInput;else if(SUPPORT_ONLY_TOUCH)Type=TouchInput;else if(!SUPPORT_TOUCH)Type=MouseInput;else Type=TouchMouseInput;return new Type(manager,inputHandler)}function inputHandler(manager,eventType,input){var pointersLen=input.pointers.length;var changedPointersLen=input.changedPointers.length;var isFirst=eventType&
INPUT_START&&pointersLen-changedPointersLen===0;var isFinal=eventType&(INPUT_END|INPUT_CANCEL)&&pointersLen-changedPointersLen===0;input.isFirst=!!isFirst;input.isFinal=!!isFinal;if(isFirst)manager.session={};input.eventType=eventType;computeInputData(manager,input);manager.emit("hammer.input",input);manager.recognize(input);manager.session.prevInput=input}function computeInputData(manager,input){var session=manager.session;var pointers=input.pointers;var pointersLength=pointers.length;if(!session.firstInput)session.firstInput=
simpleCloneInputData(input);if(pointersLength>1&&!session.firstMultiple)session.firstMultiple=simpleCloneInputData(input);else if(pointersLength===1)session.firstMultiple=false;var firstInput=session.firstInput;var firstMultiple=session.firstMultiple;var offsetCenter=firstMultiple?firstMultiple.center:firstInput.center;var center=input.center=getCenter(pointers);input.timeStamp=now();input.deltaTime=input.timeStamp-firstInput.timeStamp;input.angle=getAngle(offsetCenter,center);input.distance=getDistance(offsetCenter,
center);computeDeltaXY(session,input);input.offsetDirection=getDirection(input.deltaX,input.deltaY);var overallVelocity=getVelocity(input.deltaTime,input.deltaX,input.deltaY);input.overallVelocityX=overallVelocity.x;input.overallVelocityY=overallVelocity.y;input.overallVelocity=abs(overallVelocity.x)>abs(overallVelocity.y)?overallVelocity.x:overallVelocity.y;input.scale=firstMultiple?getScale(firstMultiple.pointers,pointers):1;input.rotation=firstMultiple?getRotation(firstMultiple.pointers,pointers):
0;input.maxPointers=!session.prevInput?input.pointers.length:input.pointers.length>session.prevInput.maxPointers?input.pointers.length:session.prevInput.maxPointers;computeIntervalInputData(session,input);var target=manager.element;if(hasParent(input.srcEvent.target,target))target=input.srcEvent.target;input.target=target}function computeDeltaXY(session,input){var center=input.center;var offset=session.offsetDelta||{};var prevDelta=session.prevDelta||{};var prevInput=session.prevInput||{};if(input.eventType===
INPUT_START||prevInput.eventType===INPUT_END){prevDelta=session.prevDelta={x:prevInput.deltaX||0,y:prevInput.deltaY||0};offset=session.offsetDelta={x:center.x,y:center.y}}input.deltaX=prevDelta.x+(center.x-offset.x);input.deltaY=prevDelta.y+(center.y-offset.y)}function computeIntervalInputData(session,input){var last=session.lastInterval||input,deltaTime=input.timeStamp-last.timeStamp,velocity,velocityX,velocityY,direction;if(input.eventType!=INPUT_CANCEL&&(deltaTime>COMPUTE_INTERVAL||last.velocity===
undefined)){var deltaX=input.deltaX-last.deltaX;var deltaY=input.deltaY-last.deltaY;var v=getVelocity(deltaTime,deltaX,deltaY);velocityX=v.x;velocityY=v.y;velocity=abs(v.x)>abs(v.y)?v.x:v.y;direction=getDirection(deltaX,deltaY);session.lastInterval=input}else{velocity=last.velocity;velocityX=last.velocityX;velocityY=last.velocityY;direction=last.direction}input.velocity=velocity;input.velocityX=velocityX;input.velocityY=velocityY;input.direction=direction}function simpleCloneInputData(input){var pointers=
[];var i=0;while(i<input.pointers.length){pointers[i]={clientX:round(input.pointers[i].clientX),clientY:round(input.pointers[i].clientY)};i++}return{timeStamp:now(),pointers:pointers,center:getCenter(pointers),deltaX:input.deltaX,deltaY:input.deltaY}}function getCenter(pointers){var pointersLength=pointers.length;if(pointersLength===1)return{x:round(pointers[0].clientX),y:round(pointers[0].clientY)};var x=0,y=0,i=0;while(i<pointersLength){x+=pointers[i].clientX;y+=pointers[i].clientY;i++}return{x:round(x/
pointersLength),y:round(y/pointersLength)}}function getVelocity(deltaTime,x,y){return{x:x/deltaTime||0,y:y/deltaTime||0}}function getDirection(x,y){if(x===y)return DIRECTION_NONE;if(abs(x)>=abs(y))return x<0?DIRECTION_LEFT:DIRECTION_RIGHT;return y<0?DIRECTION_UP:DIRECTION_DOWN}function getDistance(p1,p2,props){if(!props)props=PROPS_XY;var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return Math.sqrt(x*x+y*y)}function getAngle(p1,p2,props){if(!props)props=PROPS_XY;var x=p2[props[0]]-p1[props[0]],
y=p2[props[1]]-p1[props[1]];return Math.atan2(y,x)*180/Math.PI}function getRotation(start,end){return getAngle(end[1],end[0],PROPS_CLIENT_XY)+getAngle(start[1],start[0],PROPS_CLIENT_XY)}function getScale(start,end){return getDistance(end[0],end[1],PROPS_CLIENT_XY)/getDistance(start[0],start[1],PROPS_CLIENT_XY)}var MOUSE_INPUT_MAP={mousedown:INPUT_START,mousemove:INPUT_MOVE,mouseup:INPUT_END};var MOUSE_ELEMENT_EVENTS="mousedown";var MOUSE_WINDOW_EVENTS="mousemove mouseup";function MouseInput(){this.evEl=
MOUSE_ELEMENT_EVENTS;this.evWin=MOUSE_WINDOW_EVENTS;this.pressed=false;Input.apply(this,arguments)}inherit(MouseInput,Input,{handler:function MEhandler(ev){var eventType=MOUSE_INPUT_MAP[ev.type];if(eventType&INPUT_START&&ev.button===0)this.pressed=true;if(eventType&INPUT_MOVE&&ev.which!==1)eventType=INPUT_END;if(!this.pressed)return;if(eventType&INPUT_END)this.pressed=false;this.callback(this.manager,eventType,{pointers:[ev],changedPointers:[ev],pointerType:INPUT_TYPE_MOUSE,srcEvent:ev})}});var POINTER_INPUT_MAP=
{pointerdown:INPUT_START,pointermove:INPUT_MOVE,pointerup:INPUT_END,pointercancel:INPUT_CANCEL,pointerout:INPUT_CANCEL};var IE10_POINTER_TYPE_ENUM={2:INPUT_TYPE_TOUCH,3:INPUT_TYPE_PEN,4:INPUT_TYPE_MOUSE,5:INPUT_TYPE_KINECT};var POINTER_ELEMENT_EVENTS="pointerdown";var POINTER_WINDOW_EVENTS="pointermove pointerup pointercancel";if(window.MSPointerEvent&&!window.PointerEvent){POINTER_ELEMENT_EVENTS="MSPointerDown";POINTER_WINDOW_EVENTS="MSPointerMove MSPointerUp MSPointerCancel"}function PointerEventInput(){this.evEl=
POINTER_ELEMENT_EVENTS;this.evWin=POINTER_WINDOW_EVENTS;Input.apply(this,arguments);this.store=this.manager.session.pointerEvents=[]}inherit(PointerEventInput,Input,{handler:function PEhandler(ev){var store=this.store;var removePointer=false;var eventTypeNormalized=ev.type.toLowerCase().replace("ms","");var eventType=POINTER_INPUT_MAP[eventTypeNormalized];var pointerType=IE10_POINTER_TYPE_ENUM[ev.pointerType]||ev.pointerType;var isTouch=pointerType==INPUT_TYPE_TOUCH;var storeIndex=inArray(store,ev.pointerId,
"pointerId");if(eventType&INPUT_START&&(ev.button===0||isTouch)){if(storeIndex<0){store.push(ev);storeIndex=store.length-1}}else if(eventType&(INPUT_END|INPUT_CANCEL))removePointer=true;if(storeIndex<0)return;store[storeIndex]=ev;this.callback(this.manager,eventType,{pointers:store,changedPointers:[ev],pointerType:pointerType,srcEvent:ev});if(removePointer){store.splice(storeIndex,1);this.store=[]}}});var SINGLE_TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:INPUT_MOVE,touchend:INPUT_END,touchcancel:INPUT_CANCEL};
var SINGLE_TOUCH_TARGET_EVENTS="touchstart";var SINGLE_TOUCH_WINDOW_EVENTS="touchstart touchmove touchend touchcancel";function SingleTouchInput(){this.evTarget=SINGLE_TOUCH_TARGET_EVENTS;this.evWin=SINGLE_TOUCH_WINDOW_EVENTS;this.started=false;Input.apply(this,arguments)}inherit(SingleTouchInput,Input,{handler:function TEhandler(ev){var type=SINGLE_TOUCH_INPUT_MAP[ev.type];if(type===INPUT_START)this.started=true;if(!this.started)return;var touches=normalizeSingleTouches.call(this,ev,type);if(type&
(INPUT_END|INPUT_CANCEL)&&touches[0].length-touches[1].length===0)this.started=false;this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:INPUT_TYPE_TOUCH,srcEvent:ev})}});function normalizeSingleTouches(ev,type){var all=toArray(ev.touches);var changed=toArray(ev.changedTouches);if(type&(INPUT_END|INPUT_CANCEL))all=uniqueArray(all.concat(changed),"identifier",true);return[all,changed]}var TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:INPUT_MOVE,touchend:INPUT_END,
touchcancel:INPUT_CANCEL};var TOUCH_TARGET_EVENTS="touchstart touchmove touchend touchcancel";function TouchInput(){this.evTarget=TOUCH_TARGET_EVENTS;this.targetIds={};Input.apply(this,arguments)}inherit(TouchInput,Input,{handler:function MTEhandler(ev){var type=TOUCH_INPUT_MAP[ev.type];var touches=getTouches.call(this,ev,type);if(!touches)return;this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:INPUT_TYPE_TOUCH,srcEvent:ev})}});function getTouches(ev,type){var allTouches=
toArray(ev.touches);var targetIds=this.targetIds;if(type&(INPUT_START|INPUT_MOVE)&&allTouches.length===1){targetIds[allTouches[0].identifier]=true;return[allTouches,allTouches]}var i,targetTouches,changedTouches=toArray(ev.changedTouches),changedTargetTouches=[],target=this.target;targetTouches=allTouches.filter(function(touch){return hasParent(touch.target,target)});if(type===INPUT_START){i=0;while(i<targetTouches.length){targetIds[targetTouches[i].identifier]=true;i++}}i=0;while(i<changedTouches.length){if(targetIds[changedTouches[i].identifier])changedTargetTouches.push(changedTouches[i]);
if(type&(INPUT_END|INPUT_CANCEL))delete targetIds[changedTouches[i].identifier];i++}if(!changedTargetTouches.length)return;return[uniqueArray(targetTouches.concat(changedTargetTouches),"identifier",true),changedTargetTouches]}var DEDUP_TIMEOUT=2500;var DEDUP_DISTANCE=25;function TouchMouseInput(){Input.apply(this,arguments);var handler=bindFn(this.handler,this);this.touch=new TouchInput(this.manager,handler);this.mouse=new MouseInput(this.manager,handler);this.primaryTouch=null;this.lastTouches=[]}
inherit(TouchMouseInput,Input,{handler:function TMEhandler(manager,inputEvent,inputData){var isTouch=inputData.pointerType==INPUT_TYPE_TOUCH,isMouse=inputData.pointerType==INPUT_TYPE_MOUSE;if(isMouse&&inputData.sourceCapabilities&&inputData.sourceCapabilities.firesTouchEvents)return;if(isTouch)recordTouches.call(this,inputEvent,inputData);else if(isMouse&&isSyntheticEvent.call(this,inputData))return;this.callback(manager,inputEvent,inputData)},destroy:function destroy(){this.touch.destroy();this.mouse.destroy()}});
function recordTouches(eventType,eventData){if(eventType&INPUT_START){this.primaryTouch=eventData.changedPointers[0].identifier;setLastTouch.call(this,eventData)}else if(eventType&(INPUT_END|INPUT_CANCEL))setLastTouch.call(this,eventData)}function setLastTouch(eventData){var touch=eventData.changedPointers[0];if(touch.identifier===this.primaryTouch){var lastTouch={x:touch.clientX,y:touch.clientY};this.lastTouches.push(lastTouch);var lts=this.lastTouches;var removeLastTouch=function(){var i=lts.indexOf(lastTouch);
if(i>-1)lts.splice(i,1)};setTimeout(removeLastTouch,DEDUP_TIMEOUT)}}function isSyntheticEvent(eventData){var x=eventData.srcEvent.clientX,y=eventData.srcEvent.clientY;for(var i=0;i<this.lastTouches.length;i++){var t=this.lastTouches[i];var dx=Math.abs(x-t.x),dy=Math.abs(y-t.y);if(dx<=DEDUP_DISTANCE&&dy<=DEDUP_DISTANCE)return true}return false}var PREFIXED_TOUCH_ACTION=prefixed(TEST_ELEMENT.style,"touchAction");var NATIVE_TOUCH_ACTION=PREFIXED_TOUCH_ACTION!==undefined;var TOUCH_ACTION_COMPUTE="compute";
var TOUCH_ACTION_AUTO="auto";var TOUCH_ACTION_MANIPULATION="manipulation";var TOUCH_ACTION_NONE="none";var TOUCH_ACTION_PAN_X="pan-x";var TOUCH_ACTION_PAN_Y="pan-y";var TOUCH_ACTION_MAP=getTouchActionProps();function TouchAction(manager,value){this.manager=manager;this.set(value)}TouchAction.prototype={set:function(value){if(value==TOUCH_ACTION_COMPUTE)value=this.compute();if(NATIVE_TOUCH_ACTION&&this.manager.element.style&&TOUCH_ACTION_MAP[value])this.manager.element.style[PREFIXED_TOUCH_ACTION]=
value;this.actions=value.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var actions=[];each(this.manager.recognizers,function(recognizer){if(boolOrFn(recognizer.options.enable,[recognizer]))actions=actions.concat(recognizer.getTouchAction())});return cleanTouchActions(actions.join(" "))},preventDefaults:function(input){var srcEvent=input.srcEvent;var direction=input.offsetDirection;if(this.manager.session.prevented){srcEvent.preventDefault();
return}var actions=this.actions;var hasNone=inStr(actions,TOUCH_ACTION_NONE)&&!TOUCH_ACTION_MAP[TOUCH_ACTION_NONE];var hasPanY=inStr(actions,TOUCH_ACTION_PAN_Y)&&!TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_Y];var hasPanX=inStr(actions,TOUCH_ACTION_PAN_X)&&!TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_X];if(hasNone){var isTapPointer=input.pointers.length===1;var isTapMovement=input.distance<2;var isTapTouchTime=input.deltaTime<250;if(isTapPointer&&isTapMovement&&isTapTouchTime)return}if(hasPanX&&hasPanY)return;if(hasNone||
hasPanY&&direction&DIRECTION_HORIZONTAL||hasPanX&&direction&DIRECTION_VERTICAL)return this.preventSrc(srcEvent)},preventSrc:function(srcEvent){this.manager.session.prevented=true;srcEvent.preventDefault()}};function cleanTouchActions(actions){if(inStr(actions,TOUCH_ACTION_NONE))return TOUCH_ACTION_NONE;var hasPanX=inStr(actions,TOUCH_ACTION_PAN_X);var hasPanY=inStr(actions,TOUCH_ACTION_PAN_Y);if(hasPanX&&hasPanY)return TOUCH_ACTION_NONE;if(hasPanX||hasPanY)return hasPanX?TOUCH_ACTION_PAN_X:TOUCH_ACTION_PAN_Y;
if(inStr(actions,TOUCH_ACTION_MANIPULATION))return TOUCH_ACTION_MANIPULATION;return TOUCH_ACTION_AUTO}function getTouchActionProps(){if(!NATIVE_TOUCH_ACTION)return false;var touchMap={};var cssSupports=window.CSS&&window.CSS.supports;["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(val){touchMap[val]=cssSupports?window.CSS.supports("touch-action",val):true});return touchMap}var STATE_POSSIBLE=1;var STATE_BEGAN=2;var STATE_CHANGED=4;var STATE_ENDED=8;var STATE_RECOGNIZED=
STATE_ENDED;var STATE_CANCELLED=16;var STATE_FAILED=32;function Recognizer(options){this.options=assign({},this.defaults,options||{});this.id=uniqueId();this.manager=null;this.options.enable=ifUndefined(this.options.enable,true);this.state=STATE_POSSIBLE;this.simultaneous={};this.requireFail=[]}Recognizer.prototype={defaults:{},set:function(options){assign(this.options,options);this.manager&&this.manager.touchAction.update();return this},recognizeWith:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,
"recognizeWith",this))return this;var simultaneous=this.simultaneous;otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);if(!simultaneous[otherRecognizer.id]){simultaneous[otherRecognizer.id]=otherRecognizer;otherRecognizer.recognizeWith(this)}return this},dropRecognizeWith:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"dropRecognizeWith",this))return this;otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);delete this.simultaneous[otherRecognizer.id];return this},
requireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"requireFailure",this))return this;var requireFail=this.requireFail;otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);if(inArray(requireFail,otherRecognizer)===-1){requireFail.push(otherRecognizer);otherRecognizer.requireFailure(this)}return this},dropRequireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"dropRequireFailure",this))return this;otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,
this);var index=inArray(this.requireFail,otherRecognizer);if(index>-1)this.requireFail.splice(index,1);return this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(otherRecognizer){return!!this.simultaneous[otherRecognizer.id]},emit:function(input){var self=this;var state=this.state;function emit(event){self.manager.emit(event,input)}if(state<STATE_ENDED)emit(self.options.event+stateStr(state));emit(self.options.event);if(input.additionalEvent)emit(input.additionalEvent);
if(state>=STATE_ENDED)emit(self.options.event+stateStr(state))},tryEmit:function(input){if(this.canEmit())return this.emit(input);this.state=STATE_FAILED},canEmit:function(){var i=0;while(i<this.requireFail.length){if(!(this.requireFail[i].state&(STATE_FAILED|STATE_POSSIBLE)))return false;i++}return true},recognize:function(inputData){var inputDataClone=assign({},inputData);if(!boolOrFn(this.options.enable,[this,inputDataClone])){this.reset();this.state=STATE_FAILED;return}if(this.state&(STATE_RECOGNIZED|
STATE_CANCELLED|STATE_FAILED))this.state=STATE_POSSIBLE;this.state=this.process(inputDataClone);if(this.state&(STATE_BEGAN|STATE_CHANGED|STATE_ENDED|STATE_CANCELLED))this.tryEmit(inputDataClone)},process:function(inputData){},getTouchAction:function(){},reset:function(){}};function stateStr(state){if(state&STATE_CANCELLED)return"cancel";else if(state&STATE_ENDED)return"end";else if(state&STATE_CHANGED)return"move";else if(state&STATE_BEGAN)return"start";return""}function directionStr(direction){if(direction==
DIRECTION_DOWN)return"down";else if(direction==DIRECTION_UP)return"up";else if(direction==DIRECTION_LEFT)return"left";else if(direction==DIRECTION_RIGHT)return"right";return""}function getRecognizerByNameIfManager(otherRecognizer,recognizer){var manager=recognizer.manager;if(manager)return manager.get(otherRecognizer);return otherRecognizer}function AttrRecognizer(){Recognizer.apply(this,arguments)}inherit(AttrRecognizer,Recognizer,{defaults:{pointers:1},attrTest:function(input){var optionPointers=
this.options.pointers;return optionPointers===0||input.pointers.length===optionPointers},process:function(input){var state=this.state;var eventType=input.eventType;var isRecognized=state&(STATE_BEGAN|STATE_CHANGED);var isValid=this.attrTest(input);if(isRecognized&&(eventType&INPUT_CANCEL||!isValid))return state|STATE_CANCELLED;else if(isRecognized||isValid){if(eventType&INPUT_END)return state|STATE_ENDED;else if(!(state&STATE_BEGAN))return STATE_BEGAN;return state|STATE_CHANGED}return STATE_FAILED}});
function PanRecognizer(){AttrRecognizer.apply(this,arguments);this.pX=null;this.pY=null}inherit(PanRecognizer,AttrRecognizer,{defaults:{event:"pan",threshold:10,pointers:1,direction:DIRECTION_ALL},getTouchAction:function(){var direction=this.options.direction;var actions=[];if(direction&DIRECTION_HORIZONTAL)actions.push(TOUCH_ACTION_PAN_Y);if(direction&DIRECTION_VERTICAL)actions.push(TOUCH_ACTION_PAN_X);return actions},directionTest:function(input){var options=this.options;var hasMoved=true;var distance=
input.distance;var direction=input.direction;var x=input.deltaX;var y=input.deltaY;if(!(direction&options.direction))if(options.direction&DIRECTION_HORIZONTAL){direction=x===0?DIRECTION_NONE:x<0?DIRECTION_LEFT:DIRECTION_RIGHT;hasMoved=x!=this.pX;distance=Math.abs(input.deltaX)}else{direction=y===0?DIRECTION_NONE:y<0?DIRECTION_UP:DIRECTION_DOWN;hasMoved=y!=this.pY;distance=Math.abs(input.deltaY)}input.direction=direction;return hasMoved&&distance>options.threshold&&direction&options.direction},attrTest:function(input){return AttrRecognizer.prototype.attrTest.call(this,
input)&&(this.state&STATE_BEGAN||!(this.state&STATE_BEGAN)&&this.directionTest(input))},emit:function(input){this.pX=input.deltaX;this.pY=input.deltaY;var direction=directionStr(input.direction);if(direction)input.additionalEvent=this.options.event+direction;this._super.emit.call(this,input)}});function PinchRecognizer(){AttrRecognizer.apply(this,arguments)}inherit(PinchRecognizer,AttrRecognizer,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[TOUCH_ACTION_NONE]},
attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.scale-1)>this.options.threshold||this.state&STATE_BEGAN)},emit:function(input){if(input.scale!==1){var inOut=input.scale<1?"in":"out";input.additionalEvent=this.options.event+inOut}this._super.emit.call(this,input)}});function PressRecognizer(){Recognizer.apply(this,arguments);this._timer=null;this._input=null}inherit(PressRecognizer,Recognizer,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[TOUCH_ACTION_AUTO]},
process:function(input){var options=this.options;var validPointers=input.pointers.length===options.pointers;var validMovement=input.distance<options.threshold;var validTime=input.deltaTime>options.time;this._input=input;if(!validMovement||!validPointers||input.eventType&(INPUT_END|INPUT_CANCEL)&&!validTime)this.reset();else if(input.eventType&INPUT_START){this.reset();this._timer=setTimeoutContext(function(){this.state=STATE_RECOGNIZED;this.tryEmit()},options.time,this)}else if(input.eventType&INPUT_END)return STATE_RECOGNIZED;
return STATE_FAILED},reset:function(){clearTimeout(this._timer)},emit:function(input){if(this.state!==STATE_RECOGNIZED)return;if(input&&input.eventType&INPUT_END)this.manager.emit(this.options.event+"up",input);else{this._input.timeStamp=now();this.manager.emit(this.options.event,this._input)}}});function RotateRecognizer(){AttrRecognizer.apply(this,arguments)}inherit(RotateRecognizer,AttrRecognizer,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[TOUCH_ACTION_NONE]},
attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.rotation)>this.options.threshold||this.state&STATE_BEGAN)}});function SwipeRecognizer(){AttrRecognizer.apply(this,arguments)}inherit(SwipeRecognizer,AttrRecognizer,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:DIRECTION_HORIZONTAL|DIRECTION_VERTICAL,pointers:1},getTouchAction:function(){return PanRecognizer.prototype.getTouchAction.call(this)},attrTest:function(input){var direction=this.options.direction;
var velocity;if(direction&(DIRECTION_HORIZONTAL|DIRECTION_VERTICAL))velocity=input.overallVelocity;else if(direction&DIRECTION_HORIZONTAL)velocity=input.overallVelocityX;else if(direction&DIRECTION_VERTICAL)velocity=input.overallVelocityY;return this._super.attrTest.call(this,input)&&direction&input.offsetDirection&&input.distance>this.options.threshold&&input.maxPointers==this.options.pointers&&abs(velocity)>this.options.velocity&&input.eventType&INPUT_END},emit:function(input){var direction=directionStr(input.offsetDirection);
if(direction)this.manager.emit(this.options.event+direction,input);this.manager.emit(this.options.event,input)}});function TapRecognizer(){Recognizer.apply(this,arguments);this.pTime=false;this.pCenter=false;this._timer=null;this._input=null;this.count=0}inherit(TapRecognizer,Recognizer,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[TOUCH_ACTION_MANIPULATION]},process:function(input){var options=this.options;var validPointers=
input.pointers.length===options.pointers;var validMovement=input.distance<options.threshold;var validTouchTime=input.deltaTime<options.time;this.reset();if(input.eventType&INPUT_START&&this.count===0)return this.failTimeout();if(validMovement&&validTouchTime&&validPointers){if(input.eventType!=INPUT_END)return this.failTimeout();var validInterval=this.pTime?input.timeStamp-this.pTime<options.interval:true;var validMultiTap=!this.pCenter||getDistance(this.pCenter,input.center)<options.posThreshold;
this.pTime=input.timeStamp;this.pCenter=input.center;if(!validMultiTap||!validInterval)this.count=1;else this.count+=1;this._input=input;var tapCount=this.count%options.taps;if(tapCount===0)if(!this.hasRequireFailures())return STATE_RECOGNIZED;else{this._timer=setTimeoutContext(function(){this.state=STATE_RECOGNIZED;this.tryEmit()},options.interval,this);return STATE_BEGAN}}return STATE_FAILED},failTimeout:function(){this._timer=setTimeoutContext(function(){this.state=STATE_FAILED},this.options.interval,
this);return STATE_FAILED},reset:function(){clearTimeout(this._timer)},emit:function(){if(this.state==STATE_RECOGNIZED){this._input.tapCount=this.count;this.manager.emit(this.options.event,this._input)}}});function Hammer(element,options){options=options||{};options.recognizers=ifUndefined(options.recognizers,Hammer.defaults.preset);return new Manager(element,options)}Hammer.VERSION="2.0.8";Hammer.defaults={domEvents:false,touchAction:TOUCH_ACTION_COMPUTE,enable:true,inputTarget:null,inputClass:null,
preset:[[RotateRecognizer,{enable:false}],[PinchRecognizer,{enable:false},["rotate"]],[SwipeRecognizer,{direction:DIRECTION_HORIZONTAL}],[PanRecognizer,{direction:DIRECTION_HORIZONTAL},["swipe"]],[TapRecognizer],[TapRecognizer,{event:"doubletap",taps:2},["tap"]],[PressRecognizer]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var STOP=1;var FORCED_STOP=2;function Manager(element,options){this.options=assign({},
Hammer.defaults,options||{});this.options.inputTarget=this.options.inputTarget||element;this.handlers={};this.session={};this.recognizers=[];this.oldCssProps={};this.element=element;this.input=createInputInstance(this);this.touchAction=new TouchAction(this,this.options.touchAction);toggleCssProps(this,true);each(this.options.recognizers,function(item){var recognizer=this.add(new item[0](item[1]));item[2]&&recognizer.recognizeWith(item[2]);item[3]&&recognizer.requireFailure(item[3])},this)}Manager.prototype=
{set:function(options){assign(this.options,options);if(options.touchAction)this.touchAction.update();if(options.inputTarget){this.input.destroy();this.input.target=options.inputTarget;this.input.init()}return this},stop:function(force){this.session.stopped=force?FORCED_STOP:STOP},recognize:function(inputData){var session=this.session;if(session.stopped)return;this.touchAction.preventDefaults(inputData);var recognizer;var recognizers=this.recognizers;var curRecognizer=session.curRecognizer;if(!curRecognizer||
curRecognizer&&curRecognizer.state&STATE_RECOGNIZED)curRecognizer=session.curRecognizer=null;var i=0;while(i<recognizers.length){recognizer=recognizers[i];if(session.stopped!==FORCED_STOP&&(!curRecognizer||recognizer==curRecognizer||recognizer.canRecognizeWith(curRecognizer)))recognizer.recognize(inputData);else recognizer.reset();if(!curRecognizer&&recognizer.state&(STATE_BEGAN|STATE_CHANGED|STATE_ENDED))curRecognizer=session.curRecognizer=recognizer;i++}},get:function(recognizer){if(recognizer instanceof
Recognizer)return recognizer;var recognizers=this.recognizers;for(var i=0;i<recognizers.length;i++)if(recognizers[i].options.event==recognizer)return recognizers[i];return null},add:function(recognizer){if(invokeArrayArg(recognizer,"add",this))return this;var existing=this.get(recognizer.options.event);if(existing)this.remove(existing);this.recognizers.push(recognizer);recognizer.manager=this;this.touchAction.update();return recognizer},remove:function(recognizer){if(invokeArrayArg(recognizer,"remove",
this))return this;recognizer=this.get(recognizer);if(recognizer){var recognizers=this.recognizers;var index=inArray(recognizers,recognizer);if(index!==-1){recognizers.splice(index,1);this.touchAction.update()}}return this},on:function(events,handler){if(events===undefined)return;if(handler===undefined)return;var handlers=this.handlers;each(splitStr(events),function(event){handlers[event]=handlers[event]||[];handlers[event].push(handler)});return this},off:function(events,handler){if(events===undefined)return;
var handlers=this.handlers;each(splitStr(events),function(event){if(!handler)delete handlers[event];else handlers[event]&&handlers[event].splice(inArray(handlers[event],handler),1)});return this},emit:function(event,data){if(this.options.domEvents)triggerDomEvent(event,data);var handlers=this.handlers[event]&&this.handlers[event].slice();if(!handlers||!handlers.length)return;data.type=event;data.preventDefault=function(){data.srcEvent.preventDefault()};var i=0;while(i<handlers.length){handlers[i](data);
i++}},destroy:function(){this.element&&toggleCssProps(this,false);this.handlers={};this.session={};this.input.destroy();this.element=null}};function toggleCssProps(manager,add){var element=manager.element;if(!element.style)return;var prop;each(manager.options.cssProps,function(value,name){prop=prefixed(element.style,name);if(add){manager.oldCssProps[prop]=element.style[prop];element.style[prop]=value}else element.style[prop]=manager.oldCssProps[prop]||""});if(!add)manager.oldCssProps={}}function triggerDomEvent(event,
data){var gestureEvent=document.createEvent("Event");gestureEvent.initEvent(event,true,true);gestureEvent.gesture=data;data.target.dispatchEvent(gestureEvent)}assign(Hammer,{INPUT_START:INPUT_START,INPUT_MOVE:INPUT_MOVE,INPUT_END:INPUT_END,INPUT_CANCEL:INPUT_CANCEL,STATE_POSSIBLE:STATE_POSSIBLE,STATE_BEGAN:STATE_BEGAN,STATE_CHANGED:STATE_CHANGED,STATE_ENDED:STATE_ENDED,STATE_RECOGNIZED:STATE_RECOGNIZED,STATE_CANCELLED:STATE_CANCELLED,STATE_FAILED:STATE_FAILED,DIRECTION_NONE:DIRECTION_NONE,DIRECTION_LEFT:DIRECTION_LEFT,
DIRECTION_RIGHT:DIRECTION_RIGHT,DIRECTION_UP:DIRECTION_UP,DIRECTION_DOWN:DIRECTION_DOWN,DIRECTION_HORIZONTAL:DIRECTION_HORIZONTAL,DIRECTION_VERTICAL:DIRECTION_VERTICAL,DIRECTION_ALL:DIRECTION_ALL,Manager:Manager,Input:Input,TouchAction:TouchAction,TouchInput:TouchInput,MouseInput:MouseInput,PointerEventInput:PointerEventInput,TouchMouseInput:TouchMouseInput,SingleTouchInput:SingleTouchInput,Recognizer:Recognizer,AttrRecognizer:AttrRecognizer,Tap:TapRecognizer,Pan:PanRecognizer,Swipe:SwipeRecognizer,
Pinch:PinchRecognizer,Rotate:RotateRecognizer,Press:PressRecognizer,on:addEventListeners,off:removeEventListeners,each:each,merge:merge,extend:extend,assign:assign,inherit:inherit,bindFn:bindFn,prefixed:prefixed});var freeGlobal=typeof window!=="undefined"?window:typeof self!=="undefined"?self:{};freeGlobal.Hammer=Hammer;if(typeof define==="function"&&define.amd)define(function(){return Hammer});else if(typeof module!="undefined"&&module.exports)module.exports=Hammer;else window[exportName]=Hammer}
if(window?.agentInfo)if(!agentInfo.isMobile)if(agentInfo.isTouch)initHammer();else agentInfo.detectTouch(initHammer);else initHammer();else initHammer()})();
var HTML5Storage=new function(){var _storageType={"LOCAL":"localStorage","SESSION":"sessionStorage"};var _self=this;var _defaultStorage=_storageType.LOCAL;var _isSupported=function(){return _supports(_defaultStorage)};var _getStorageTypes=function(){return JSON.parse(JSON.stringify(_storageType))};var _supports=function(storageName){try{return storageName in window&&window[storageName]instanceof Storage}catch(err){return false}};var _read=function(storageName,storageType){if(typeof storageType=="undefined")storageType=
_defaultStorage;if(!_supports(storageType))return null;var storage=window[storageType];try{return storage.getItem(storageName)}catch(err){}return null};var _remove=function(storageName,storageType){if(typeof storageType=="undefined")storageType=_defaultStorage;if(!_supports(storageType))return;var storage=window[storageType];try{storage.removeItem(storageName)}catch(err){}};var _write=function(storageName,value,storageType){if(typeof storageType=="undefined")storageType=_defaultStorage;if(!_supports(storageType))return;
var storage=window[storageType];try{storage.setItem(storageName,value)}catch(err){}};var _readObject=function(storageName,storageType){try{var objData=JSON.parse(_read(storageName,storageType));if(objData!=null&&typeof objData!="undefined")return objData}catch(err){}return null};var _writeObject=function(storageName,value,storageType){try{_write(storageName,JSON.stringify(value),storageType)}catch(err){}};Object.defineProperty(this,"isSupported",{"enumerable":true,"configurable":false,"value":_isSupported});
Object.defineProperty(this,"read",{"enumerable":true,"configurable":false,"writable":false,"value":_read});Object.defineProperty(this,"readObject",{"enumerable":true,"configurable":false,"writable":false,"value":_readObject});Object.defineProperty(this,"remove",{"enumerable":true,"configurable":false,"writable":false,"value":_remove});Object.defineProperty(this,"storageType",{"enumerable":true,"configurable":false,"get":_getStorageTypes});Object.defineProperty(this,"supports",{"enumerable":true,"configurable":false,
"writable":false,"value":_supports});Object.defineProperty(this,"write",{"enumerable":true,"configurable":false,"writable":false,"value":_write});Object.defineProperty(this,"writeObject",{"enumerable":true,"configurable":false,"writable":false,"value":_writeObject});return this};
var ThreadPool=function(threadCount,script,timeout,autostartQueued){var pool={threads:[],idleThreads:0,queuedWork:[],script:script,timeout:null,watchdogTimer:null,autostartQueued:null,resultWrapperEvent:function(thread,oEvent,resultCallback){thread.working=0;++this.idleThreads;resultCallback(oEvent);if(this.autostartQueued)this.doQueuedWork()},errorWrapperEvent:function(thread,oEvent,errorCallback){if(oEvent.timeout)console.error("ThreadPool of "+this.script+": Timeout at "+(oEvent.timeout-thread.working)+
" ms.");else console.error("ThreadPool of "+this.script+": Code error at "+oEvent.filename+":"+oEvent.lineno+": "+oEvent.message);var workerOnMessage=thread.worker.onmessage;var workerOnError=thread.worker.onerror;thread.worker.terminate();delete thread.worker;thread.worker=null;thread.worker=new Worker(this.script);thread.worker.onmessage=workerOnMessage;thread.worker.onerror=workerOnError;thread.working=0;++this.idleThreads;errorCallback(oEvent);if(this.autostartQueued)this.doQueuedWork()},doQueuedWork:function(){if(!this.idleThreads||
!this.queuedWork.length)return false;var work=this.queuedWork.shift();return this.doWork(work.data,work.transfer,work.resultCallback,work.errorCallback)},doWork:function(data,transfer,resultCallback,errorCallback){if(!this.idleThreads){this.queuedWork.push({data:data,transfer:transfer,resultCallback:resultCallback,errorCallback:errorCallback});return false}var thread=null;for(var i=0;i<this.threads.length;++i)if(!this.threads[i].working){thread=this.threads[i];break}var owner=this;var resEv=this.resultWrapperEvent;
var errEv=this.errorWrapperEvent;var watchdogEv=this.watchdogEvent;thread.working=(new Date).getTime();--this.idleThreads;if(this.timeout&&this.watchdogTimer===null)this.watchdogTimer=setInterval(function(){watchdogEv.apply(owner)},this.timeout);thread.worker.onmessage=function(oEvent){resEv.apply(owner,[thread,oEvent,resultCallback])};thread.worker.onerror=function(oEvent){errEv.apply(owner,[thread,oEvent,errorCallback])};thread.worker.postMessage(data,transfer);return true},watchdogEvent:function(){if(this.idleThreads==
this.threads.length){if(this.watchdogTimer!==null){clearInterval(this.watchdogTimer);this.watchdogTimer=null}return}var currentTime=(new Date).getTime();for(var i=0;i<this.threads.length;++i){if(!this.threads[i].working||this.threads[i].working+this.timeout>currentTime)continue;this.threads[i].worker.onerror({timeout:currentTime})}}};for(var i=0;i<threadCount;++i){var thread={id:i,worker:new Worker(script),working:0};pool.threads.push(thread)}pool.idleThreads=threadCount;pool.timeout=typeof timeout!=
"number"?0:timeout;pool.autostartQueued=typeof autostartQueued!="boolean"?true:autostartQueued;return pool};
(function(){function Popups(){var _ref=this;var _establishingDialogDefProp={};var _SPLASHDIALOG_ID="establishingConnection";var splashDialogBackgroundStyles=helper.object.createEnum("NONE","TRANSPARENT","TRANSLUCID","OPAQUE");var _SPLASHDIALOG_BCK_STYLE=splashDialogBackgroundStyles.NONE;var _establishingDialog={"timeout":1E3,"timeoutId":null};var _splashDialog={"background":null,"container":null,"body":null,"h2":null,"h4":null,"img":null,"btnClose":null};var _kbUnbound=false;var _PARENTOBJECT=null;
var _POPUPDIALOG=null;var _CLOSE_DIALOG=2;var _UNBLOCKING=false;var _defaultBlockUIValues={"css":{"padding":0,"margin":0,"width":"100%","height":"100%","top":"0px","left":"0px","textAlign":"center","backgroundColor":"transparent","border":"none","cursor":"auto","z-index":"900000"},"overlayCSS":{"backgroundColor":"transparent"},"centerX":true,"centerY":true,"events":{}};var _growls={"dialogs":[],"top":15,"height":30,"type":helper.object.createEnum("MESSAGE","INFO","WARNING","ERROR")};var _consts=helper.object.createEnum({"YES":1,
"NO":0});var _offlineIcons={"icons":["alertIco","disconnectedIco"],"elems":[]};function initialize(){helper.dom.interactive(function(){if(!_PARENTOBJECT)_PARENTOBJECT=document.body;_splashDialog.container=document.getElementById(_SPLASHDIALOG_ID);_splashDialog.container?attachSplashDialog():createSplashDialog();setOfflineIcons()})}function setOfflineIcons(){for(var i=0,t=_offlineIcons.icons.length;i<t;i++){var icon=_offlineIcons.icons[i];if(!document.getElementById(icon))_offlineIcons.elems.push(helper.dom.appendJsonElement({"parentElement":document.body,
"type":"div","attributes":{"id":icon,"class":"offline-Icons "+icon}}))}}function getBtnId(){return"ACTION_BTN_"+helper.utils.generateGUID(10)}function popupDialog(owner,noPropagateEvents){this.owner=owner||(typeof THIN!="undefined"?THIN:typeof TVNC!="undefined"?TVNC:null);this.opened=false;this.currentParent=null;this.parentDialog=null;this.dlgId="";this.noPropagateEvents=typeof noPropagateEvents!=="undefined"?noPropagateEvents:true;this.captureKeyboard=false;this.verticalMiddle=false;establishingDialogHide();
this.block=function(jData){if(arguments.length>1&&!isJsonData(jData))jData={"id":arguments[0],"message":arguments[1],"parentElement":arguments[2],"events":{"block":arguments.length>3?arguments[3]:null,"unblock":arguments.length>4?arguments[4]:null}};if(jData){if(jData.message&&jData.message instanceof HTMLElement)jData.message=jData.message.outerHTML;jData=helper.object.extend(helper.object.clone(_defaultBlockUIValues),jData,false);var defaultKey=false;if(jData.buttons&&jData.buttons.length>0)defaultKey=
jData.buttons.find(function(elem){return typeof elem.defaultKey!=="undefined"});jData.onBlock=function(){self.hideCursor();self.dlgId=jData.id;self.checkSize();$(self.msg).css({"visibility":"visible"});if(self.captureKeyboard||defaultKey)self.bindKeyboard(jData.buttons);if(jData.events.block instanceof Function)jData.events.block()};jData.onUnblock=function(){if(jData.parentElement&&!!_POPUPDIALOG&&_POPUPDIALOG.opened&&typeof _POPUPDIALOG.unblockAction!="undefined")_POPUPDIALOG.unblockAction();if(jData.events.unblock instanceof
Function)jData.events.unblock()};if(jData.parentElement){if(_UNBLOCKING==false){self.currentParent=jData.parentElement;self.parentDialog=_POPUPDIALOG;$(jData.parentElement).block(jData)}}else{self.currentParent=null;self.parentDialog=_POPUPDIALOG?_POPUPDIALOG.parentDialog:null;$.blockUI(jData)}}else{helper.console.warning(helper.string.format("Cannot initialize popup, {0} is undefined or null.","jData"),arguments);return}_POPUPDIALOG=this;_POPUPDIALOG.opened=true};this.unblock=function(callback){var _e=
window.event;_UNBLOCKING=true;if(typeof callback=="undefined"&&_POPUPDIALOG&&_POPUPDIALOG.unblockAction)callback=_POPUPDIALOG.unblockAction;if(!this.currentParent)$.unblockUI({onUnblock:function(){try{self.showCursor(_e);self.unbindKeyboard();if(callback)callback();restoreHooks();if(typeof _SESSIONCONTROLLER!="undefined")_SESSIONCONTROLLER.activate()}catch(error){helper.console.warning(helper.string.format("Cannot close popup - error: {0}",error.message||error),arguments)}finally{_UNBLOCKING=false}}});
else $(this.currentParent).unblock({onUnblock:function(){try{self.showCursor(_e);self.unbindKeyboard();$(self.currentParent).focus();if(self.notParentOrTop())restoreHooks();if(callback)callback()}catch(error){helper.console.warning(helper.string.format("Cannot close popup - error: {0}",error.message||error),arguments)}finally{_UNBLOCKING=false}}});if(_POPUPDIALOG)_POPUPDIALOG=_POPUPDIALOG.parentDialog};this.hideCursor=function(){var owner=this.owner;if(owner&&owner.overrideCursor===false&&owner.vncdiv&&
owner.cursorCanvas){owner.vncdiv.style.cursor="default";owner.cursorCanvas.style.visibility="hidden"}};this.showCursor=function(e){var owner=this.owner;if(owner&&owner.overrideCursor===false&&owner.vncdiv&&owner.cursorCanvas){if(e)owner.mouseMoveAsync.position={"x":e.pageX,"y":e.pageY};setTimeout(function(){owner.vncdiv.style.cursor="none";owner.cursorCanvas.style.visibility="visible";owner.cursorCanvas.style.display="block"},100)}};this.notParentOrTop=function(){var getTopElemFromOwner=function(self){return self.owner&&
self.owner.containerId?document.getElementById(self.owner.containerId):null};return!this.currentParent||this.currentParent==getTopElemFromOwner(this)};this.checkSize=function(){var divButtons=$("#"+this.dlgId+" .divbuttons")[0];var divBody=$("#"+this.dlgId+" .messageBody")[0];if(divButtons&&divButtons.scrollWidth>divButtons.offsetWidth||divBody&&divBody.scrollWidth>divBody.offsetWidth){var sw1=!divButtons?0:Math.ceil(divButtons.scrollWidth/10+1)*10;var sw2=!divBody?0:Math.ceil(divBody.scrollWidth/
10+1)*10;var sw=Math.max(sw1,sw2);var diff=sw-divButtons.offsetWidth;$(divButtons).width(sw);$(divBody).width(sw);var w=parseInt($(divButtons).parent().width(),10)+diff+"px !important";$(divButtons).parent().attr("style","width:"+w);$("#"+_POPUPDIALOG.dlgId).attr("style","max-width: 100%; width: "+w)}if(this.verticalMiddle){var d=document.getElementById(_POPUPDIALOG.dlgId);if(d){var h=d.offsetHeight;var s=document.body.clientHeight;$("#"+_POPUPDIALOG.dlgId).css({"top":(h>s?0:(s-h)*.35)<<0+"px"})}}};
this.bindKeyboard=function(defaultButtons){if(this.owner!=null&&!_kbUnbound&&this.notParentOrTop()){disableHooks();if(typeof _SESSIONCONTROLLER!="undefined"&&_SESSIONCONTROLLER.isActive())_SESSIONCONTROLLER.deactivate()}var dlg=$("#"+this.dlgId);dlg.focus();dlg.bind("keydown",function(e){if(defaultButtons){if(self.noPropagateEvents){e.stopPropagation();e.preventDefault()}var handler=defaultButtons.find(function(elem){return elem.defaultKey&&(elem.defaultKey===e.keyCode||elem.defaultKey instanceof
Array&&elem.defaultKey.indexOf(e.keyCode)!=-1)});if(handler)try{handler.action()}catch(error){helper.console.warning(helper.string.format("Cannot complete execution of the default handler [Button:{0}]",handler.value),arguments)}}else{if(e.target.tagName=="INPUT"||e.target.tagName=="TEXTAREA")return;if(self.noPropagateEvents){e.stopPropagation();e.preventDefault()}var selectedBtn=$("#"+self.dlgId+" .divbuttons .selected");switch(e.keyCode){case 13:$(".divbuttons .selected").click();break;case 32:$(".divbuttons .selected").click();
case 27:$("#PopupTBBtnClose").click();break;case 9:case 39:case 40:var nextElement=selectedBtn.next("a");if(nextElement[0]){selectedBtn.removeClass("selected");nextElement.addClass("selected")}else{selectedBtn.removeClass("selected");$(".divbuttons a").first().addClass("selected")}break;case 37:case 38:var prevElement=selectedBtn.prev("a");if(prevElement[0]){selectedBtn.removeClass("selected");prevElement.addClass("selected")}else{selectedBtn.removeClass("selected");$(".divbuttons a").first().addClass("selected")}break}}})};
this.unbindKeyboard=function(){if(self.dlgId!="")$("#"+self.dlgId).unbind("keydown")};var self=this;return this}function createSplashDialog(){var basePath=helper.object.getValue(Thinfinity.global,"variables.basePath","/");_splashDialog.background=helper.dom.appendJsonElement({"parentElement":_PARENTOBJECT,"type":"div","attributes":{"id":_SPLASHDIALOG_ID+"_bck","class":"popup establishingConnection-background hidden "+getBackgroundStyleClass(_SPLASHDIALOG_BCK_STYLE)}});_splashDialog.container=helper.dom.appendJsonElement({"parentElement":_PARENTOBJECT,
"type":"div","attributes":{"id":_SPLASHDIALOG_ID,"class":"popup establishingConnection noDisplay"}});_splashDialog.body=helper.dom.appendJsonElement({"parentElement":_splashDialog.container,"type":"div","attributes":{"class":"msgBody"}});_splashDialog.h2=helper.dom.appendJsonElement({"parentElement":_splashDialog.body,"type":"h2","attributes":{"class":"title"},"content":consts.establishingConn});_splashDialog.img=helper.dom.appendJsonElement({"parentElement":_splashDialog.body,"type":"img","attributes":{"id":"ecWaiting",
"src":basePath+"common/images/core/loading.gif","class":"loading"},"content":consts.establishingConn});_splashDialog.h4=helper.dom.appendJsonElement({"parentElement":_splashDialog.body,"type":"h4","attributes":{"class":"message"},"content":"&nbsp"});_splashDialog.btnClose=helper.dom.appendJsonElement({"parentElement":_splashDialog.body,"type":"a","content":"Close","attributes":{"class":"popuplink selected","href":"#"},"events":{"touchend, click":function(e){suppressMouseTouchEvent(e);window.close();
if(document.referrer&&location.href!=document.referrer)location.href=document.referrer}}});helper.dom.addEvent(_splashDialog.container,"transitionend",transitionEnd,false)}function transitionEnd(e){clearTimeout(_establishingDialog.timeoutId);if(!helper.style.hasClass(_splashDialog.container,"noDisplay")){_splashDialog.h2.innerHTML="";_splashDialog.h4.innerHTML="";helper.style.add(_splashDialog.img,"hidden");helper.style.replace(_splashDialog.container,"show hidden","noDisplay")}}function getBackgroundStyleClass(value){var _className=
value;switch(value){case splashDialogBackgroundStyles.NONE:_className="";break;case splashDialogBackgroundStyles.TRANSPARENT:_className="transparent";break;case splashDialogBackgroundStyles.TRANSLUCID:_className="translucid";break;case splashDialogBackgroundStyles.OPAQUE:_className="opaque";break}return _className}function setBackgroundStyle(value){helper.style.remove(_splashDialog.background,getBackgroundStyleClass(_SPLASHDIALOG_BCK_STYLE));helper.style.remove(_splashDialog.container,getBackgroundStyleClass(_SPLASHDIALOG_BCK_STYLE));
_SPLASHDIALOG_BCK_STYLE=value;helper.style.add(_splashDialog.background,getBackgroundStyleClass(_SPLASHDIALOG_BCK_STYLE));helper.style.add(_splashDialog.container,getBackgroundStyleClass(_SPLASHDIALOG_BCK_STYLE))}function attachSplashDialog(){_splashDialog.body=_splashDialog.container.querySelector(".msgBody");_splashDialog.h2=_splashDialog.body.querySelector(".title");_splashDialog.img=_splashDialog.body.querySelector(".ecWaiting");_splashDialog.h4=_splashDialog.body.querySelector(".message");_splashDialog.btnClose=
_splashDialog.body.querySelector(".btnClose");helper.dom.addEvent(_splashDialog.btnClose,["touchend","click"],function(e){suppressMouseTouchEvent(e);window.close();if(document.referrer&&location.href!=document.referrer)location.href=document.referrer})}function establishingDialogShow(title,text,animated,closeButton){if(_splashDialog.container){helper.style.add(_splashDialog.img,"display:"+(animated?"inline-block":"none")+";");helper.style.remove(_splashDialog.img,"hidden");helper.style.add(_splashDialog.btnClose,
"display:"+(closeButton?"inline-block":"none")+";");_splashDialog.h2.innerHTML=title;_splashDialog.h4.innerHTML=text;helper.style.replace(_splashDialog.container,"noDisplay hidden","show");if(_SPLASHDIALOG_BCK_STYLE!==splashDialogBackgroundStyles.NONE)helper.style.replace(_splashDialog.background,"hidden","show")}}function establishingDialogHide(){if(_splashDialog.container&&helper.style.hasClass(_splashDialog.container,"show")){clearTimeout(_establishingDialog.timeoutId);_establishingDialog.timeoutId=
setTimeout(transitionEnd,_establishingDialog.timeout);helper.style.replace(_splashDialog.container,"show","hidden");if(_SPLASHDIALOG_BCK_STYLE!==splashDialogBackgroundStyles.NONE)helper.style.replace(_splashDialog.background,"show","hidden")}}function isJsonData(data){return["json","object"].indexOf(helper.object.getDataTypeOf(data))>=0}function choiceDialog(jData){if(arguments.length>1&&!isJsonData(jData)){jData={"parentElement":arguments[0],"class":arguments[1],"id":arguments[2],"iconType":arguments[3],
"title":arguments[4],"message":arguments[5],"buttons":[],"preAction":arguments.length>9?arguments[9]:false,"noPropagateEvents":arguments.length>10?arguments[10]:false,"events":{"block":arguments.length>11?arguments[11]:null}};if(arguments[6]){var v=arguments[6][0].split(":")[0];var c=arguments[6][0].split(":")[1];jData.buttons.push({"value":v,"class":c?c:"","action":arguments[7],"id":getBtnId()});if(arguments[6].length>1){v=arguments[6][1].split(":")[0];c=arguments[6][1].split(":")[1];jData.buttons.push({"value":v,
"class":c?c:"","action":arguments[8],"id":getBtnId()})}}}if(jData){var titleRow="";var header="";var classes="popup";if(helper.object.getHTMLType(jData.message))jData.message=jData.message.outerHTML;if(jData.iconType==""||jData.iconType==null||typeof jData.iconType=="undefined")jData.iconType="disconnectedIco";if((typeof jData.title=="undefined"||typeof jData.title=="null"||jData.title=="")&&jData.title!="none")jData.title=window.document.title;if(jData.class!="")classes+=" "+jData.class;var container=
helper.dom.createJsonElement({"type":"div","attributes":{"class":classes,"tabindex":0,"id":jData.id}});if(jData.title!="none"){var header=helper.dom.appendJsonElement({"parentElement":container,"type":"div","attributes":{"class":"header"}});var h3=helper.dom.appendJsonElement({"parentElement":header,"type":"h3","content":jData.title})}var alertBody=helper.dom.appendJsonElement({"parentElement":container,"type":"div","attributes":{"class":"alertBody"}});var title=helper.dom.appendJsonElement({"parentElement":alertBody,
"type":"div","attributes":{"id":jData.iconType},"content":"&nbsp;"});if(helper.object.getHTMLType(jData.message))alertBody.appendChild(jData.message);else alertBody.innerHTML+=jData.message;var br=helper.dom.appendJsonElement({"parentElement":container,"type":"br"});var buttons=helper.dom.appendJsonElement({"parentElement":container,"type":"div","attributes":{"class":"divbuttons"}});var context=jData.parentElement&&jData.parentElement.ownerDocument?jData.parentElement.ownerDocument:document;var strAction;
var eBlock=null;var onBlockCallBack=function(){for(var i=0;i<jData.buttons.length;i++)if(jData.buttons[i]&&jData.buttons[i].action instanceof Function){var id=jData.buttons[i].id;helper.dom.addEvent(context.getElementById(id),["touchend","click"],detectTouchWrapper(jData.buttons[i].action))}if(eBlock)eBlock()};var hasSelected=false;for(var i=0;i<jData.buttons.length;i++){if(!jData.buttons[i].class)jData.buttons[i].class="";if(!hasSelected&&jData.buttons[i].class.indexOf("selected")!=-1)hasSelected=
true}for(var i=0;i<jData.buttons.length;i++){strAction=null;if(typeof jData.buttons[i].action==="string")if(jData.buttons[i].action=="")jData.buttons[i].action=function(){unblockDialog()};else{var errorMsg="Use event function instead of 'string function name'";helper.console.warning(errorMsg,arguments);alert(errorMsg)}else if(typeof jData.buttons[i].action==="function"){var fnTemp=null;if(jData.preAction){fnTemp=function(fn){unblockDialog();fn()}.bind(null,jData.buttons[i].action);jData.buttons[i].action=
fnTemp}else{fnTemp=function(fn){fn();unblockDialog()}.bind(null,jData.buttons[i].action);jData.buttons[i].action=fnTemp}}else jData.buttons[i].action=function(){unblockDialog()};if(i==0&&!hasSelected){if(!jData.buttons[i].class)jData.buttons[i].class="";jData.buttons[i].class+=" selected"}if(jData.buttons[i].id!=="undefined")jData.buttons[i].id=getBtnId();var anchor=helper.dom.appendJsonElement({"parentElement":buttons,"type":"a","attributes":{"class":"popuplink "+(jData.buttons[i].class?jData.buttons[i].class:
""),"id":jData.buttons[i].id},"content":jData.buttons[i].value});if(i+1<jData.buttons.length)helper.dom.appendJsonElement({"parentElement":buttons,"type":"span","content":"&nbsp;"})}helper.dom.appendJsonElement({"parentElement":buttons,"type":"input","attributes":{"type":"text","class":"hiddenInput"}});jData.message=container;var popup=new popupDialog(null,jData.noPropagateEvents);if(!jData.events)jData.events={};if(jData.events.block)eBlock=jData.events.block;jData.events.block=onBlockCallBack;popup.block(jData);
return popup}else{helper.console.warning(helper.string.format("Cannot initialize {0}, {1} is undefined or null.","choiceDialog","jData"),arguments);return}}function alertDialog(jData){if(arguments.length>1&&!isJsonData(jData)||arguments.length===1&&helper.object.getTypeOf(arguments[0])==="string"){jData={"parentElement":arguments[4],"class":arguments[3],"id":arguments[2],"title":arguments[1],"message":arguments[0],"buttons":[],"noPropagateEvents":arguments.length>8?arguments[8]:false};var txt=typeof arguments[7]!=
"undefined"&&arguments[7]!=""?arguments[7]:arguments[6]&&!/.*mozilla.*/.exec(navigator.userAgent.toLowerCase())?consts.Close:consts.ok;if(arguments[5])jData.buttons.push({"value":txt,"action":arguments[5]})}if(jData){if(jData.message&&jData.message instanceof HTMLElement)jData.message=jData.message.outerHTML;var classes="popup";if((typeof jData.title=="undefined"||typeof jData.title=="null"||jData.title=="")&&jData.title!="none")jData.title=window.document.title;if(typeof jData.id=="undefined"||typeof jData.id==
"null"||jData.id=="")jData.id="alertDlg";if(jData.buttons.length==0)jData.buttons.push({"value":consts.ok,"action":"","id":getBtnId()});else if(typeof jData.buttons[0].action=="undefined"||!jData.buttons[0].action)jData.buttons[0].action="";if(jData.buttons[0].id!=="undefined")jData.buttons[0].id=getBtnId();var callback=typeof jData.buttons[0].action!==""?jData.buttons[0].action:"";if(jData.class!=""&&typeof jData.class!="undefined")classes+=" "+jData.class;var container=helper.dom.createJsonElement({"type":"div",
"attributes":{"class":classes,"tabindex":0,"id":jData.id}});if(jData.title!="none"){var header=helper.dom.appendJsonElement({"parentElement":container,"type":"div","attributes":{"class":"header"}});var h3=helper.dom.appendJsonElement({"parentElement":header,"type":"h3","content":jData.title})}var alertBody=helper.dom.appendJsonElement({"parentElement":container,"type":"div","attributes":{"class":"alertBody"}});var title=helper.dom.appendJsonElement({"parentElement":alertBody,"type":"div","attributes":{"id":"alertIco"},
"content":"&nbsp;"});if(helper.object.getHTMLType(jData.message))alertBody.appendChild(jData.message);else alertBody.innerHTML+=jData.message;var br=helper.dom.appendJsonElement({"parentElement":container,"type":"br"});var buttons=helper.dom.appendJsonElement({"parentElement":container,"type":"div","attributes":{"class":"divbuttons"}});var anchor=helper.dom.appendJsonElement({"parentElement":buttons,"type":"a","attributes":{"class":"popuplink selected","id":jData.buttons[0].id},"content":jData.buttons[0].value});
if(typeof callback==="string"&&callback=="")callback=function(){Thinfinity.Popups.unblock()};jData.message=container;var eBlock=null;var onBlockCallBack=function(){var context=null;if(typeof callback==="function"){if(jData.parentElement&&jData.parentElement.ownerDocument)context=jData.parentElement.ownerDocument;else context=document;helper.dom.addEvent(context.getElementById(jData.buttons[0].id),["touchend","click"],detectTouchWrapper(callback,this))}else if(typeof callback==="string"&&callback!==
""){var errorMsg="Use event function instead of 'string function name'";helper.console.warning(errorMsg,arguments);alert(errorMsg)}if(eBlock)eBlock()};var popup=new popupDialog(null,jData.noPropagateEvents);if(!jData.events)jData.events={};if(jData.events.block)eBlock=jData.events.block;jData.events.block=onBlockCallBack;popup.block(jData)}else{helper.console.warning(helper.string.format("Cannot initialize {0}, {1} is undefined or null.","alertDialog","jData"),arguments);return}}function messageDialog(jData){if(arguments.length>
1&&!isJsonData(jData))jData={"owner":arguments.length>5?arguments[5]:null,"parentElement":arguments[4],"class":arguments[3],"id":arguments[2],"title":arguments[1],"message":arguments[0],"standard":false,"events":{"block":arguments.length>6?arguments[6]:null},"noPropagateEvents":arguments.length>8?arguments[8]:false};if(jData){if(jData.message&&jData.message instanceof HTMLElement)jData.message=jData.message.outerHTML;jData.owner=jData.owner||(typeof THIN!="undefined"?THIN:typeof TVNC!="undefined"?
TVNC:null);var classes="popup";if(typeof jData.title=="undefined"||typeof jData.title=="null"||jData.title=="")jData.title=window.document.title;if(typeof jData.id=="undefined"||typeof jData.id=="null"||jData.id=="")jData.id="mssgDlg";if(jData.class!=""&&typeof jData.class!="undefined")classes+=" "+jData.class;if(jData.standard){var standard=helper.dom.createJsonElement({"type":"div","attributes":{"class":"standard"}});var span=helper.dom.appendJsonElement({"parentElement":standard,"type":"span"});
if(helper.object.getHTMLType(jData.message))span.appendChild(jData.message);else span.innerHTML=jData.message}var container=helper.dom.createJsonElement({"type":"div","attributes":{"class":classes,"tabindex":0,"id":jData.id}});if(jData.title!="none"){var header=helper.dom.appendJsonElement({"parentElement":container,"type":"div","attributes":{"class":"header"}});var h3=helper.dom.appendJsonElement({"parentElement":header,"type":"h3","content":jData.title})}var alertBody=helper.dom.appendJsonElement({"parentElement":container,
"type":"div","attributes":{"class":"alertBody"}});if(helper.object.getHTMLType(jData.message))alertBody.appendChild(jData.message);else alertBody.innerHTML+=jData.message;jData.message=container;var eBlock=null;var popup=new popupDialog(jData.owner,jData.noPropagateEvents);var onBlockCallBack=function(){if(eBlock)eBlock()};if(!jData.events)jData.events={};if(jData.events.block)eBlock=jData.events.block;jData.events.block=onBlockCallBack;popup.block(jData)}else{helper.console.warning(helper.string.format("Cannot initialize {0}, {1} is undefined or null.",
"messageDialog","jData"),arguments);return}}function growlDialog(jData){if(jData){var ht=_growls.top+_growls.height;var top=_growls.top+ht*_growls.dialogs.length;var type=helper.object.getValue(jData,"type",_growls.type.MESSAGE);var extraClass=_growls.type.getKey(type).toLowerCase();var destroy=function(e,container){return new Promise(function(resolve){if(e){e.preventDefault();e.stopPropagation();var src=e.srcElement||e.target;container=src.className.indexOf("growlDialogContainer")!=-1?src:src.parentElement}if(container.destroyed){resolve();
return}var nTop=container.nTop;helper.style.replace(container,"visible","hidden");setTimeout(function(){if(container?.parentElement)container.parentElement.removeChild(container);var dialog=null;var ridx=-1;for(var i=0,t=_growls.dialogs.length;i<t;i++){dialog=_growls.dialogs[i];if(dialog===container)ridx=i;else if(dialog.nTop>=nTop){dialog.nTop=_growls.dialogs[i].nTop-ht;dialog.style.top=dialog.nTop+"px"}}_growls.dialogs.splice(ridx,1);setTimeout(resolve,250)},500);container.destroyed=true})};var updateMessage=
function(msg){if(messageContainer){messageContainer.innerHTML=msg;messageContainer.title=msg}};var growlDialogContainer=helper.dom.createJsonElement({"type":"div","attributes":{"class":"growlDialogContainer hidden "+extraClass,"style":"top:"+top+"px","nTop":top}});helper.dom.addEvent(growlDialogContainer,["touchend","click"],function(e){suppressMouseTouchEvent(e);destroy(e);if(helper.object.existsPath(jData,"events.click"))jData.events.click(e)},false);var messageContainer=helper.dom.appendJsonElement({"parentElement":growlDialogContainer,
"type":"div","attributes":{"class":"messageContainer","title":jData.message.replace(/<[^>]*>/g,"")},"content":jData.message});var xContainer=helper.dom.appendJsonElement({"parentElement":growlDialogContainer,"type":"div","attributes":{"class":"xContainer thin-cancel-circled"}});document.body.appendChild(growlDialogContainer);helper.style.replace(growlDialogContainer,"hidden","visible");_growls.dialogs.push(growlDialogContainer);growlDialogContainer.destroyed=false;var obj={};Object.defineProperty(obj,
"destroy",{"enumerable":true,"configurable":false,"writable":false,"value":function(){return destroy(null,growlDialogContainer)}});Object.defineProperty(obj,"destroyed",{"enumerable":true,"configurable":false,"get":function(){return growlDialogContainer.destroyed}});Object.defineProperty(obj,"message",{"enumerable":true,"configurable":false,"set":updateMessage});return obj}else return null}function unblockGrowls(){if(_growls&&_growls.dialogs){_growls.dialogs.forEach(function(elem){helper.style.replace(elem,
"visible","hidden");elem.parentElement.removeChild(elem)});_growls.dialogs=[]}}function unblockDialog(callback){if(typeof _POPUPDIALOG!=="undefined"&&_POPUPDIALOG!==null)_POPUPDIALOG.unblock(callback)}function disableHooks(){if(typeof THIN!="undefined"&&!_kbUnbound&&typeof THIN.unbindKeyboardEvents!="undefined"){var parentElem=_POPUPDIALOG&&_POPUPDIALOG.dlgId?document.getElementById(_POPUPDIALOG.dlgId):null;if(parentElem&&parentElem.parentElement)helper.dom.addEvent(parentElem.parentElement,"click",
cancelClickPropagation);THIN.unbindKeyboardEvents();_kbUnbound=true}}function restoreHooks(){if(typeof THIN!="undefined"&&_kbUnbound&&typeof THIN.bindKeyboardEvents!="undefined"){var parentElem=_POPUPDIALOG&&_POPUPDIALOG.dlgId?document.getElementById(_POPUPDIALOG.dlgId):null;if(parentElem&&parentElem.parentElement)helper.dom.removeEvent(parentElem.parentElement,"click",cancelClickPropagation);THIN.bindKeyboardEvents();_kbUnbound=false}}function cancelClickPropagation(e){e.stopPropagation()}function suppressMouseTouchEvent(e){try{if(window["TouchEvent"]&&
e&&e instanceof TouchEvent){if(e.preventDefault)e.preventDefault();if(e.stopPropagation)e.stopPropagation()}}catch(err){helper.console.warning("[suppressMouseTouchEvent] Failed while trying to handle touch and mouse events. ",arguments)}}function detectTouchWrapper(callback,ctx){return function(e){suppressMouseTouchEvent(e);callback.apply(ctx,arguments)}}function unblockAll(){$.unblockUI()}initialize();Object.defineProperty(_establishingDialogDefProp,"show",{"enumerable":true,"configurable":false,
"writable":false,"value":establishingDialogShow});Object.defineProperty(_establishingDialogDefProp,"hide",{"enumerable":true,"configurable":false,"writable":false,"value":establishingDialogHide});Object.defineProperty(_establishingDialogDefProp,"backgroundStyle",{"enumerable":true,"configurable":false,"get":function(){return _SPLASHDIALOG_BCK_STYLE},"set":setBackgroundStyle});Object.defineProperty(_ref,"establishing",{"enumerable":true,"configurable":false,"get":function(){return _establishingDialogDefProp}});
Object.defineProperty(_ref,"CONSTS",{"enumerable":false,"configurable":false,"get":function(){return _consts}});Object.defineProperty(_ref,"popup",{"enumerable":true,"configurable":false,"writable":false,"value":popupDialog});Object.defineProperty(_ref,"choice",{"enumerable":true,"configurable":false,"writable":false,"value":choiceDialog});Object.defineProperty(_ref,"alert",{"enumerable":true,"configurable":false,"writable":false,"value":alertDialog});Object.defineProperty(_ref,"message",{"enumerable":true,
"configurable":false,"writable":false,"value":messageDialog});Object.defineProperty(_ref,"growl",{"enumerable":true,"configurable":false,"writable":false,"value":growlDialog});Object.defineProperty(_ref.growl,"type",{"enumerable":true,"configurable":false,"get":function(){return _growls.type}});Object.defineProperty(_ref.growl,"unblockAll",{"enumerable":true,"configurable":false,"writable":false,"value":unblockGrowls});Object.defineProperty(_ref,"unblock",{"enumerable":true,"configurable":false,"writable":false,
"value":unblockDialog});Object.defineProperty(_ref,"unblockDialogs",{"enumerable":true,"configurable":false,"writable":false,"value":unblockAll});Object.defineProperty(_ref,"disableHooks",{"enumerable":true,"configurable":false,"writable":false,"value":disableHooks});Object.defineProperty(_ref,"restoreHooks",{"enumerable":true,"configurable":false,"writable":false,"value":restoreHooks});Object.defineProperty(_establishingDialogDefProp,"backgroundStyles",{"enumerable":true,"configurable":false,"get":function(){return splashDialogBackgroundStyles}})}
try{Thinfinity!=undefined}catch(e){Thinfinity={}}if(!Thinfinity.Popups)Thinfinity.Popups=new Popups})();function csHTMLComponent(){}
csHTMLComponent.prototype={extend:function(ext){for(var e in ext)this[e]=ext[e]},createElement:function(type,attrColl,content){var elem=document.createElement(type);if(attrColl)for(var a in attrColl)if(a==="style"){var s=attrColl[a].replace(/ /g).split(";");s.forEach(function(item){var kvp=item.split(":");elem.style[kvp[0]]=kvp[1]})}else elem.setAttribute(a,attrColl[a]);elem.className+=" preventTouchExecution";if(content)elem.innerHTML=content;return elem},appendElement:function(parentElement,type,
attrColl,content){var elem=this.createElement(type,attrColl,content);parentElement.appendChild(elem);return elem},prependElement:function(parentElement,type,attrColl,content){var elem=this.createElement(type,attrColl,content);$(parentElement).prepend(elem);return elem}};csToolbar.prototype=new csHTMLComponent;
function csToolbar(id,jInfo,thinrdp){if(typeof id=="undefined")return;if(typeof jInfo=="undefined")return;var self=this;this.id=id;this.buttons=[];this.closeMenuTimer=null;this.buttonSelected=null;this.closeSubmenuTimer=null;this.optionSelected=null;this.itemClass="";this.tb=null;var thinrdp=typeof THIN!="undefined"?THIN:thinrdp;this.refreshLayout=function(){var w=20;var elems=self.buttons;for(e=0;e<self.buttons.length;e++){if($(self.buttons[e]).css("display")!="none")w+=$(self.buttons[e]).outerWidth(true);
self.buttons[e].mouseIn=0}$("#"+self.id).width(w)};this.attachEvents=function(elem,eventsObj){if(eventsObj.type==="action"){elem.event=eventsObj.event;let handler=function(e){e.preventDefault();e.stopPropagation();self.hideMenus();if(this.event)this.event(e)};$(elem).on("click",handler);$(elem).on("touchend",handler)}else if(eventsObj.type==="onoff"){elem.events=eventsObj.events;let handler=function(e){e.preventDefault();e.stopPropagation();self.hideMenus();if($(this).hasClass("pressed")){$(this).removeClass("pressed");
if(typeof this.events.toggle!="undefined"&&typeof this.events.toggle!="undefined")this.events.toggle(this);else if(typeof this.events!="undefined"&&typeof this.events.release!="undefined")this.events.release(this)}else{$(this).addClass("pressed");if(typeof this.events.toggle!="undefined"&&typeof this.events.toggle!="undefined")this.events.toggle(this);else if(typeof this.events!="undefined"&&typeof this.events.press!="undefined")this.events.press(this)}};$(elem).on("click",handler);$(elem).on("touchend",
handler)}else if(eventsObj.type==="submenu"){$(elem).addClass("subMenu");self.addSubMenu(elem,eventsObj.options);elem.events=eventsObj.events;$(elem).on("mouseenter touchend",function(){if(typeof this.events!="undefined"&&typeof this.events.mouseenter!="undefined")this.events.mouseenter(this);self.activeSubmenu(this)}).on("mouseleave",function(){this.mouseIn--})}};this.addMenu=function(id,options){var menu=this.appendElement(document.body,"DIV",{"id":id+"_sm","class":"toolbarMenu","style":"display:none"});
$(menu).on("mouseenter",function(){if(self.buttonSelected)self.buttonSelected.mouseIn++}).on("mouseleave",function(){if(self.buttonSelected)self.buttonSelected.mouseIn--});for(var op=0;op<options.length;op++){var opt=this.appendElement(menu,"DIV",{"id":options[op].id?options[op].id:id+"_sm_"+op},options[op].text);if(typeof options[op].attributes!="undefined")for(var at in options[op].attributes)$(opt).attr(at,options[op].attributes[at]);if(opt.className.indexOf("preventTouchExecution")==-1)opt.className+=
" preventTouchExecution";this.attachEvents(opt,options[op])}};this.clickMenuButton=function(button){button.pressed=!button.pressed;if(!button.pressed)self.releaseMenuButton(button);else{if(self.buttonSelected)self.releaseMenuButton(self.buttonSelected);self.activeMenuButton(button)}};this.activeMenuButton=function(button){$(button).addClass("pressed");$("#"+$(button).attr("id")+"_sm").css("left",$(button).offset().left-(document.body.scrollLeft||window.pageXOffset)).show();button.mouseIn=1;self.buttonSelected=
button;self.closeMenuTimer=window.setInterval(function(){if(!self.isOnMenu())self.releaseMenuButton(self.buttonSelected)},300)};this.releaseMenuButton=function(button){if(self.closeMenuTimer)window.clearInterval(self.closeMenuTimer);if(button){$(button).removeClass("pressed");$("#"+$(button).attr("id")+"_sm").hide();button.mouseIn=0;button.pressed=false}self.buttonSelected=null};this.hideMenus=function(){if(this.optionSelected)this.releaseSubmenu(this.optionSelected);if(this.buttonSelected)this.releaseMenuButton(this.buttonSelected)};
this.isOnMenu=function(){return self.buttonSelected!=null&&self.buttonSelected.mouseIn>0||this.isOnSubmenu()};this.addSubMenu=function(option,subOptions){var id=$(option).attr("id")+"_sm";var menu=this.appendElement(document.body,"DIV",{"id":id,"class":"toolbarMenu","style":"display:none"});$(menu).on("mouseenter",function(){if(self.optionSelected)self.optionSelected.mouseIn++}).on("mouseleave",function(){if(self.optionSelected)self.optionSelected.mouseIn--});for(var op=0;op<subOptions.length;op++){var opt=
this.appendElement(menu,"DIV",{"id":subOptions[op].id?subOptions[op].id:id+"_"+op},subOptions[op].text);this.attachEvents(opt,subOptions[op]);if(typeof subOptions[op].attributes!="undefined")for(var at in subOptions[op].attributes)$(opt).attr(at,subOptions[op].attributes[at]);if(opt.className.indexOf("preventTouchExecution")==-1)opt.className+=" preventTouchExecution"}};this.activeSubmenu=function(option){$(option).addClass("pressed");$("#"+$(option).attr("id")+"_sm").css("left",$(option).offset().left+
$(option).outerWidth(true)-(document.body.scrollLeft||window.pageXOffset)).css("top",$(option).offset().top-(document.body.scrollTop||window.pageYOffset)).show();option.mouseIn=1;if(self.optionSelected)self.releaseSubmenu(self.optionSelected);self.optionSelected=option;self.closeSubmenuTimer=window.setInterval(function(){if(!self.isOnSubmenu())self.releaseSubmenu(self.optionSelected)},300)};this.releaseSubmenu=function(option){if(self.closeSubmenuTimer)window.clearInterval(self.closeSubmenuTimer);
if(option){$(option).removeClass("pressed");$("#"+$(option).attr("id")+"_sm").hide();option.mouseIn=0;option.pressed=false}self.optionSelected=null};this.isOnSubmenu=function(){return self.optionSelected!=null&&self.optionSelected.mouseIn>0};this.addButton=function(btnObj){if(self.itemClass!=""){var attr=btnObj.attributes["class"];if(typeof attr!="undefined")btnObj.attributes["class"]=self.itemClass+" "+attr;else btnObj.attributes["class"]=self.itemClass}var button=this.appendElement(self.tb,"DIV",
btnObj.attributes,btnObj.html);if(btnObj.type==="tbsubmenu"){button.pressed=false;this.addMenu(btnObj.attributes.id,btnObj.options);let handlerClick=function(){self.clickMenuButton(this)};$(button).on("click",handlerClick).on("touchend",handlerClick).on("mouseleave",function(){this.mouseIn--}).on("mouseenter",function(){if(self.buttonSelected&&self.buttonSelected!=this)self.clickMenuButton(this);else this.mouseIn++})}else if(typeof btnObj.events!="undefined"){button.events={};for(var ev=0;ev<btnObj.events.length;ev++){let events=
[];if(btnObj.events[ev].name==="click")events.push("touchend","mouseup");else events.push(btnObj.events[ev].name);events.forEach(en=>{button.events[en]=btnObj.events[ev].action;$(button).on(en,function(e){button.events[e.type](e)})})}}self.buttons.push(button)};this.addButtons=function(buttons){if(!!buttons)for(var b=0;b<buttons.length;b++)this.addButton(buttons[b])};this.purgeOptions=function(buttons,restrictions){for(var tbr=0;tbr<restrictions.length;tbr++){var tbPath=restrictions[tbr].split(".");
var n=0;while(n<buttons.length&&buttons[n].attributes.id!=tbPath[0])n++;if(n<buttons.length)if(tbPath.length==1)buttons.splice(n,1);else{var elements=buttons[n].options;var level=1;while(typeof elements!="undefined"&&level<tbPath.length){n=0;while(n<elements.length&&elements[n].id!=tbPath[level])n++;if(n<elements.length&&level<tbPath.length-1)elements=elements[n].options;level++}if(level==tbPath.length&&n<elements.length)elements.splice(n,1);else console.log("item related to toolbar restriction "+
tbPath.join(".")+" not found")}else console.log("item related to toolbar restriction "+tbPath.join(".")+" not found")}};this.removeOption=function(itemName){var optBtn=document.getElementById(itemName);if(optBtn){this.removeSubMenu(itemName);$(optBtn).off();optBtn.parentElement.removeChild(optBtn)}};this.removeSubMenu=function(itemName){var sm=document.getElementById(itemName+"_sm");if(sm){var options=$(sm).find("div");for(var d=options.length-1;d>=0;d--)this.removeOption(options[d].id);$(sm).off();
sm.parentElement.removeChild(sm)}};this.destroy=function(){if(this.tb==null)return;var options=$(this.tb).find("."+self.itemClass);for(var o=options.length-1;o>=0;o--)this.removeOption(options[o].getAttribute("id"));if(this.tb.parentElement!=null)this.tb.parentElement.removeChild(this.tb);this.tb=null};this.show=function(){self.tb.style.visibility="visible"};this.hide=function(){self.tb.style.visibility="hidden"};this.expand=function(){if(!this.isVisible())$("#tbRdpHandle"+self.id).click()};this.contract=
function(){if(this.isVisible())$("#tbRdpHandle"+self.id).click()};jInfo.attributes.id=id;this.tb=this.appendElement(document.body,"DIV",jInfo.attributes);if(typeof jInfo.itemClass!="undefined")self.itemClass=jInfo.itemClass;this.addButtons(jInfo.buttons);var tbRdpHandle=this.appendElement(this.tb,"DIV",{"id":"tbRdpHandle"+self.id,"class":"tbRdpHandle flppd"},"<hr/>");let handler=function(e){e.preventDefault();e.stopPropagation();if($("#tbRdpHandle"+self.id).hasClass("flppd")){$("#"+self.id).animate({"top":"0px"},
200);$("#tbRdpHandle"+self.id).removeClass("flppd")}else{$("#"+self.id).animate({"top":"-"+$("#"+self.id).outerHeight(true)+"px"},200);$("#tbRdpHandle"+self.id).addClass("flppd")}};$("#tbRdpHandle"+self.id).on("click",handler);$("#tbRdpHandle"+self.id).on("touchend",handler);this.isVisible=function(){return!$("#tbRdpHandle"+self.id).hasClass("flppd")};return this}csNavigatorControl.prototype=new csHTMLComponent;
function csNavigatorControl(settings){this.NCM_SIMPLE=0;this.NCM_WINDROSE=1;this.NCM_MINIM=2;var self=this;var mode=this.NCM_SIMPLE;this.visible=false;this.offset=1;for(var s in settings)this[s]=settings[s];this.setMode=function(m){if(m<this.NCM_SIMPLE||m>this.NCM_MINIM)return false;mode=m};this.move=function(x,y){if(!!this.onMove)this.onMove(x,y)};this.zoomIn=function(){if(!!this.onZoomIn)this.onZoomIn()};this.zoomOut=function(){if(!!this.onZoomOut)this.onZoomOut()};this.shrinkToBrowser=function(){if(!!this.onShrinkToBrowser)this.onShrinkToBrowser()};
this.actualPixels=function(){if(!!this.onActualPixels)this.onActualPixels()};this.insertPane=function(){var navControl=document.getElementById("navControl");if(!navControl){var navControl=this.createElement("div",{"id":"navControl","style":"display:none"},null);if(mode==this.NCM_WINDROSE)navControl.className="windrose"}else navControl.innerHTML="";if(mode!=this.NCM_MINIM){this.appendElement(navControl,"div",{"class":"navCtrl_button","id":"move_up"},null);this.appendElement(navControl,"div",{"class":"navCtrl_button",
"id":"move_left"},null)}this.appendElement(navControl,"div",{"class":"navCtrl_button","id":"zoom_out"},null);this.appendElement(navControl,"div",{"class":"navCtrl_button","id":"zoom_in"},null);this.appendElement(navControl,"div",{"class":"navCtrl_button","id":"zoom_shrink"},null);this.appendElement(navControl,"div",{"class":"navCtrl_button","id":"zoom_actual"},null);if(mode!=this.NCM_MINIM){this.appendElement(navControl,"div",{"class":"navCtrl_button","id":"move_right"},null);this.appendElement(navControl,
"div",{"class":"navCtrl_button","id":"move_down"},null)}document.body.appendChild(navControl);$("#move_up, #move_down, #move_left, #move_right, #zoom_in, #zoom_out, #zoom_shrink, #zoom_actual").bind("click",function(e){switch((e.target||e.srcElement).id){case "move_up":self.move(0,-self.offset);break;case "move_down":self.move(0,self.offset);break;case "move_left":self.move(-self.offset,0);break;case "move_right":self.move(self.offset,0);break;case "zoom_in":self.zoomIn();break;case "zoom_out":self.zoomOut();
break;case "zoom_shrink":self.shrinkToBrowser();break;case "zoom_actual":self.actualPixels();break}e.stopPropagation()})};this.show=function(){var z=this.onGetZIndex?this.onGetZIndex():99999999;$("#navControl").css("z-index",z).show();this.visible=true};this.hide=function(){$("#navControl").hide();this.visible=false};this.isVisible=function(){return this.visible};return this}
(function(){function VisualEffect(args){var _ref=this;var _args={"id":null,"container":null,"btnCancelId":"cancelRecnx","allowReconnectionDialog":true,"reconnection":{"timeout":2E4},"events":{"onCancel":null}};var _elements={"wall":null,"panel":null,"button":null};function initialize(args){helper.object.parseAttributes(_args,args,"MATCH");if(supportGrayScale())helper.style.replace(_args.container,"grayscale","color")}function supportGrayScale(){var supportGrayscale=false;switch(true){case agentInfo.isMSIE&&
agentInfo.msieVersion<=10:break;default:supportGrayscale=true;break}return supportGrayscale}function getNextHighestZindex(obj){var highestIndex=0;var currentIndex=0;var elArray=Array();if(obj)elArray=obj.getElementsByTagName("*");else elArray=document.getElementsByTagName("*");for(var i=0;i<elArray.length;i++){if(elArray[i].currentStyle)currentIndex=parseFloat(elArray[i].currentStyle["zIndex"]);else if(window.getComputedStyle)currentIndex=parseFloat(document.defaultView.getComputedStyle(elArray[i],
null).getPropertyValue("z-index"));if(!isNaN(currentIndex)&&currentIndex>highestIndex)highestIndex=currentIndex}return highestIndex+1}function toGrayScale(connectionLost){if(!_elements.wall){_elements.wall=helper.dom.appendJsonElement({"parentElement":_args.container,"type":"div","attributes":{"id":_args.id,"class":"reconnectDivId in","style":helper.string.format("z-index:{0};",getNextHighestZindex(document.body))}});if(supportGrayScale())helper.style.replace(_args.container,"color","grayscale")}if(connectionLost&&
_args.allowReconnectionDialog&&!_elements.panel)setAbortPanel();return true}function setAbortPanel(){_elements.panel=helper.dom.appendJsonElement({"parentElement":_args.container,"type":"div","attributes":{"style":helper.string.format("-webkit-box-shadow: 1px 1px 15px #000;-moz-box-shadow: 1px 1px 15px #000; position:absolute; top:50%; left:50%; transform:translate3d(-50%, -50%, 0); ;z-index:{0}; padding:20px;;-moz-border-radius: 7px;border-radius: 7px; font-size:14px; font-weight:normal; text-align:center",
getNextHighestZindex(document.body)),"class":"popup connectionLost"},"content":consts.connLostReconnecting+"</br>"});_elements.button=helper.dom.appendJsonElement({"parentElement":_elements.panel,"type":"button","attributes":{"id":_args.btnCancelId,"class":"p-button"},"events":{"click":function(e){if(helper.object.existsPath(_args,"events.onCancel"))try{_args.events.onCancel(e)}catch(error){helper.console.error(error.message,error,arguments)}}},"content":consts.abort})}function toColor(){if(_elements.wall){helper.style.replace(_elements.wall,
"in","out");helper.style.replace(_args.container,"grayscale","color");if(_elements.panel){_args.container.removeChild(_elements.panel);_elements.button=null;_elements.panel=null}_args.container.removeChild(_elements.wall);_elements.wall=null}return true}initialize(args);Object.defineProperty(_ref,"toGrayScale",{"enumerable":true,"configurable":false,"value":toGrayScale});Object.defineProperty(_ref,"toColor",{"enumerable":true,"configurable":false,"value":toColor});return this}try{Thinfinity!=undefined}catch(e){Thinfinity=
{}}Thinfinity.VisualEffect=VisualEffect})();
function CanvasPrinter(events){var self=this;this.PM_NONE=-1;this.PM_FULLCOLOR=0;this.PM_GRAYSCALED=1;this.PM_INVERTEDGRAYSCALE=2;this.PM_BLACKANDWHITE=3;this.drawBorder=false;this.useIFrame=true;this.printMode=this.PM_BLACKANDWHITE;this.title="";this.footer="";this.window=window;this.events=events;this.prnW=null;this.printFrameRef=null;var PIXEL_WIDTH=144*10;var debugging=helper.url.gup("debug")=="1";var _queuePrinting={"startPrintingTime":null,"printingInterval":null,"printingIntervalTime":500,
"maxDelayPrintingTime":12E4,"isPrinting":false};this.getCanvasPrinterMode=function(mode){mode=helper.object.convertTo(mode,"number");if(!isNaN(mode)&&(mode<this.PM_NONE||mode>this.PM_BLACKANDWHITE))mode=this.PM_NONE;return mode};this.getPrintIFrame=function(){var ifrm=document.createElement("iframe");ifrm.style.position="absolute";if(agentInfo.isMobile==true&&agentInfo.isChrome==true)ifrm.id="iframeToPrint";ifrm.style.left="-20000px";document.body.appendChild(ifrm);return ifrm};this.destroyPrintIFrame=
function(){try{if(self.printFrameRef!=null){helper.dom.removeEvent(window,"onmessage",self.dispatchPrint);document.body.removeChild(self.printFrameRef);delete self.printFrameRef;delete self.prnW}}catch(error){}finally{self.printFrameRef=null;self.prnW=null}};this.cloneCanvas=function(srcCanvas){if(debugging)logDebug("start cloneCanvas");var newCanvas=document.createElement("canvas");newCanvas.width=srcCanvas.width;newCanvas.height=srcCanvas.height;var context=newCanvas.getContext("2d",{willReadFrequently:true});
context.drawImage(srcCanvas,0,0);if(this.drawBorder)context.strokeRect(0,0,srcCanvas.width,srcCanvas.height);if(debugging)logDebug("end cloneCanvas");return newCanvas};this.grayScaledCanvas=function(srcCanvas,inverted){if(debugging){logDebug("start grayScaledCanvas");logDebug("getContext")}var srcContext=srcCanvas.getContext("2d",{willReadFrequently:true});if(debugging)logDebug("getImageData");var imgPixels=srcContext.getImageData(0,0,srcCanvas.width,srcCanvas.height);var data=imgPixels.data;if(debugging)logDebug("proccess");
if(inverted)for(var i=0;i<imgPixels.data.length;i+=4){var avg=(data[i]+data[i+1]+data[i+2])/3;data[i]=data[i+1]=data[i+2]=255^avg}else for(var i=0;i<imgPixels.data.length;i+=4){var avg=(data[i]+data[i+1]+data[i+2])/3;data[i]=data[i+1]=data[i+2]=avg}if(debugging)logDebug("create new canvas");var newCanvas=document.createElement("canvas");if(debugging)logDebug("get ctx");var ctx=newCanvas.getContext("2d",{willReadFrequently:true});newCanvas.width=srcCanvas.width;newCanvas.height=srcCanvas.height;if(debugging)logDebug("putImageData");
ctx.putImageData(imgPixels,0,0,0,0,imgPixels.width,imgPixels.height);if(this.drawBorder)ctx.strokeRect(0,0,imgPixels.width,imgPixels.height);if(debugging)logDebug("end grayScaledCanvas");return newCanvas};this.BWCanvas=function(srcCanvas){if(debugging)logDebug("start BWCanvas");if(debugging)logDebug("getContext");var srcContext=srcCanvas.getContext("2d");if(debugging)logDebug("getImageData");var imgPixels=srcContext.getImageData(0,0,srcCanvas.width,srcCanvas.height);var data=imgPixels.data;var bgColor=
data[0]*255*255*255+data[1]*255*255+data[2]*255;if(debugging)logDebug("proccess");for(var i=0;i<data.length;i+=4){var color=data[i]*255*255*255+data[i+1]*255*255+data[i+2]*255;data[i]=data[i+1]=data[i+2]=color==bgColor?255:0}if(debugging)logDebug("create new canvas");var newCanvas=document.createElement("canvas");if(debugging)logDebug("get ctx");var ctx=newCanvas.getContext("2d",{willReadFrequently:true});newCanvas.width=srcCanvas.width;newCanvas.height=srcCanvas.height;if(debugging)logDebug("putImageData");
ctx.putImageData(imgPixels,0,0,0,0,imgPixels.width,imgPixels.height);if(this.drawBorder)ctx.strokeRect(0,0,imgPixels.width,imgPixels.height);if(debugging)logDebug("end BWCanvas");return newCanvas};this.setTitle=function(value){this.title=value};this.setFooter=function(value){this.footer=value};this.getScreenShot=function(canvas,mode,width,height,success){if(debugging)logDebug("GetScreenShot. Mode="+mode);if(canvas){var wc=width/canvas.width;var hc=height/canvas.height;var co=Math.min(1,wc,hc);var img=
new Image;img.width=canvas.width*co;img.height=canvas.height*co;img.onload=function(e){img.onload=null;if(e.target!=undefined&&typeof e.target.complete=="undefined"||e.target.complete==true){if(debugging)logDebug("GetScreenshot - img.onload - no retries");success(img)}else{var maxTimes=10;var countTimes=0;function retryLoadImage(){setTimeout(function(){if(countTimes>maxTimes){if(debugging)logDebug("GetScreenshot - retryLoadImage - countTimes overflow: "+countTimes);return}else if(e.target!=undefined&&
typeof e.target.complete=="undefined"||e.target.complete==true){if(debugging)logDebug("GetScreenshot - retryLoadImage - countTimes: "+countTimes);success(img)}else retryLoadImage();countTimes++},50)}}};if(debugging)logDebug("GetScreenshot - create new canvas");var newCanvas=this.printableCanvas(canvas,mode);if(debugging)logDebug("GetScreenshot - apply src");img.src=newCanvas.toDataURL("image/jpeg");if(debugging)logDebug("GetScreenshot - done")}else if(debugging)logDebug("GetScreenshot - canvas don't exists!")};
this.printableCanvas=function(canvas,mode){if(typeof mode=="undefined")mode=this.printMode;switch(mode){case this.PM_FULLCOLOR:return this.cloneCanvas(canvas);break;case this.PM_GRAYSCALED:return this.grayScaledCanvas(canvas);break;case this.PM_INVERTEDGRAYSCALE:return this.grayScaledCanvas(canvas,true);break;case this.PM_BLACKANDWHITE:return this.BWCanvas(canvas);break}};this.print=function(canvas){if(canvas)if(agentInfo.isMSIE&&agentInfo.msieVersion<=11){self.canvas=canvas;var prnInstance=window.open("",
"prnW","title='Printing',width=1,height=1,outerWidth=1, outerHeight=1",false);prnInstance.document.title=this.title;$(prnInstance.document.head).append('<style>@media print { @page{ size: 8.5in 11in landscape; } header:after {content: "'+this.title+'";} } img { width: 10.5in !important; max-width: 10.5in !important; } html,body,div {margin:0px;padding:0px;width:100%;display:table-cell;'+"text-align:center;vertical-align:middle;}</style>");var div=prnInstance.document.createElement("div");var cnv=
self.printableCanvas(canvas);var coef=cnv.height/cnv.width;var img=prnInstance.document.createElement("image");img.width=PIXEL_WIDTH;img.height=Math.floor(PIXEL_WIDTH*coef);div.appendChild(img);prnInstance.document.body.appendChild(div);img.onload=function(){function printLoadedImage(){prnInstance.focus();prnInstance.print();prnInstance.close()}if(typeof img.complete=="undefined"||img.complete==true)printLoadedImage();else{var maxTimes=10;var countTimes=0;function retryLoadImage(){setTimeout(function(){if(countTimes>
maxTimes)return;else if(img.complete)printLoadedImage();else retryLoadImage();countTimes++},50)}}};var cnv=self.printableCanvas(self.canvas);img.src=cnv.toDataURL("image/png")}else{self.destroyPrintIFrame();if(typeof keyboardHelper!="undefined"&&keyboardHelper!=null){var cnv=self.printableCanvas(canvas);if(cnv){var src=cnv.toDataURL("image/png");var img=document.createElement("img");var prnBefore=document.getElementById("prnBefore");img.style.display="inline";img.style.zIndex=9999999999999;img.style.position=
"absolute";img.style.top="0px";img.style.left="0px";document.body.insertBefore(img,prnBefore);img.onload=function(e){img.width=e.target.width;img.height=e.target.height;img.style.width=img.width+"px";img.style.height=img.height+"px";setTimeout(function(){prnBefore.style.visibility="hidden";window.focus();window.print();setTimeout(function(){document.body.removeChild(img);prnBefore.style.visibility="visible";window.focus();try{if(typeof thinZS!="undefined")thinZS.zoomDesktop(1)}catch(error){}keyboardHelper.getFocus()},
1E3);return},250)};img.src=src}}else{helper.dom.addEvent(window,"onmessage",self.dispatchPrint);if(self.useIFrame){self.printFrameRef=this.getPrintIFrame();self.prnW=self.printFrameRef.contentWindow||self.printFrameRef.contentDocument;detectingPrintEnd()}else self.prnW=window.open("","prnW","",true);self.canvas=canvas;self.prnW.location.href=`${Thinfinity.global.variables.basePath}print.html`}}else if(typeof this.events!="undefined"&&typeof this.events.onCanvasNotFound!="undefined")this.events.onCanvasNotFound();
else $(window).trigger("CANVASNOTFOUND")};function detectingPrintEnd(){function done(){clearInterval(_queuePrinting["printingInterval"]);_queuePrinting.isPrinting=false;helper.dom.removeEvent(window,"onmessage",self.dispatchPrint);window.focus()}_queuePrinting["startPrintingTime"]=(new Date).getTime();clearInterval(_queuePrinting["printingInterval"]);_queuePrinting["printingInterval"]=setInterval(function(){if(document.activeElement&&!document.hasFocus())_queuePrinting.isPrinting=true;else done();
if((new Date).getTime()-_queuePrinting["startPrintingTime"]>_queuePrinting["maxDelayPrintingTime"]){clearInterval(_queuePrinting["printingInterval"]);_queuePrinting.isPrinting=false}},_queuePrinting["printingIntervalTime"])}this.dispatchPrint=function(e){var obj=null;if(e&&e.data)try{var type=helper.object.getDataTypeOf(e.data);obj=type==="object"?e.data:type==="json"?JSON.parse(e.data):null}catch(error){obj=null}if(obj&&obj.evt&&obj.evt=="PRINT_SCREEN"){var cnv=self.printableCanvas(self.canvas);
obj={"evt":"PRINT","title":self.title,"src":cnv.toDataURL("image/png")};self.prnW.postMessage(JSON.stringify(obj),"*")}};if(window.addEventListener)window.addEventListener("message",self.dispatchPrint,false);else window.attachEvent("onmessage",self.dispatchPrint);return this}
(function(){function PrintScreenPreview(args){var _ref=this;var _args={"parentElement":null,"methods":{"getCanvas":null,"getInfo":null,"getCanvasPrinter":null,"printScreen":null},"elements":{"body":".printBody","btnPrint":".btnPrintScreenPreview","btnClose":".btnCloseScreenPreview","btnBAW":".pspBlackAndWhite","btnInvGray":".pspInvertedGrayScaled","btnGray":".pspGrayScaled","btnColor":".pspFullColor"}};var _wPrintScreenPreview=null;var _canvasPrinter=null;function initialize(args){helper.object.parseAttributes(_args,
args,"MATCH");if(_args.methods.getCanvasPrinter)_canvasPrinter=_args.methods.getCanvasPrinter();if(!_canvasPrinter)_canvasPrinter=getDefaultCanvasPrinter();if(_args.parentElement){helper.style.addClass(_args.parentElement,"printScreenPreviewPopup");helper.style.removeClass(_args.parentElement,"hidden");for(var elem in _args.elements)if(typeof _args.elements[elem]==="string")_args.elements[elem]=_args.parentElement.querySelector(_args.elements[elem])}}function getDefaultCanvasPrinter(){if(typeof CanvasPrinter!==
"undefined")return new CanvasPrinter({onCanvasNotFound:function(){helper.console.warning(helper.string.format("WARNING: Canvas not found",""),arguments)}});else helper.console.warning(helper.string.format("WARNING: CanvasPrinter not found",""),arguments);return null}function attachEvents(){helper.dom.addEvent(_args.elements.btnPrint,["touchend","click"],e=>{suppressMouseTouchEvent(e);_wPrintScreenPreview.print(function(){_wPrintScreenPreview.hide()},true)});helper.dom.addEvent(_args.elements.btnClose,
["touchend","click"],e=>{suppressMouseTouchEvent(e);closePrintScreenPreview()});helper.dom.addEvent(_args.elements.btnBAW,["touchend","click"],e=>{suppressMouseTouchEvent(e);_wPrintScreenPreview.setPrnScrMode(_args.elements.btnBAW,_canvasPrinter.PM_BLACKANDWHITE)});helper.dom.addEvent(_args.elements.btnGray,["touchend","click"],e=>{suppressMouseTouchEvent(e);_wPrintScreenPreview.setPrnScrMode(_args.elements.btnGray,_canvasPrinter.PM_GRAYSCALED)});helper.dom.addEvent(_args.elements.btnInvGray,["touchend",
"click"],e=>{suppressMouseTouchEvent(e);_wPrintScreenPreview.setPrnScrMode(_args.elements.btnInvGray,_canvasPrinter.PM_INVERTEDGRAYSCALE)});helper.dom.addEvent(_args.elements.btnColor,["touchend","click"],e=>{suppressMouseTouchEvent(e);_wPrintScreenPreview.setPrnScrMode(_args.elements.btnColor,_canvasPrinter.PM_FULLCOLOR)})}function initializePrintScreenPreview(){var self=this;var _printScreenMode=-1;var _srcElem=_args.methods.getCanvas();var _tempCanvas=null;this.show=function(){var self=this;helper.style.addClass(_args.elements.btnPrint,
"disabled");_args.parentElement.querySelectorAll(".pspscreenshot").forEach(function(elem){elem.innerHTML='<img src="'+Thinfinity.global.variables.basePath+'"/common/images/core/loadajax.gif"/>';helper.style.removeClass(elem,"selected")});$.blockUI({message:_args.parentElement,css:{"background":"transparent","top":"0px","left":"0px","padding":"0px","margin":"0px","width":"100%","height":"100%","textAlign":"center","border":"none","cursor":"auto"},centerX:true,centerY:true,onBlock:function(){_args.parentElement.style.visibility=
"visible";Thinfinity.Popups.disableHooks();self.bindKeyboard();_args.parentElement.focus();_canvasPrinter.drawBorder=true;var s=helper.size.get(_args.elements.btnBAW);var w=Math.floor(s.width*.9);var h=Math.floor(s.height*.9);_tempCanvas=self.getSrcCanvas();_canvasPrinter.getScreenShot(_tempCanvas,_canvasPrinter.PM_BLACKANDWHITE,w,h,function(img){setPrintPreviewImage(_args.elements.btnBAW,img)});_canvasPrinter.getScreenShot(_tempCanvas,_canvasPrinter.PM_GRAYSCALED,w,h,function(img){setPrintPreviewImage(_args.elements.btnGray,
img)});_canvasPrinter.getScreenShot(_tempCanvas,_canvasPrinter.PM_INVERTEDGRAYSCALE,w,h,function(img){setPrintPreviewImage(_args.elements.btnInvGray,img)});_canvasPrinter.getScreenShot(_tempCanvas,_canvasPrinter.PM_FULLCOLOR,w,h,function(img){setPrintPreviewImage(_args.elements.btnColor,img)})}})};this.hide=function(){this.unbindEvents();$.unblockUI({onUnblock:function(){Thinfinity.Popups.restoreHooks()}})};this.unbindEvents=function(){this.unbindKeyboard()};this.bindKeyboard=function(){helper.dom.addEvent(_args.parentElement,
"keydown",parentElement_keydown)};this.unbindKeyboard=function(){helper.dom.removeEvent(_args.parentElement,"keydown",parentElement_keydown)};function parentElement_keydown(e){if(e.keyCode=="27"){e.stopPropagation();_args.elements.btnClose.click()}}this.getSrcCanvas=function(){var srcCanvas=document.createElement("canvas");srcCanvas.width=_srcElem instanceof HTMLVideoElement?_srcElem.videoWidth:_srcElem.width;srcCanvas.height=_srcElem instanceof HTMLVideoElement?_srcElem.videoHeight:_srcElem.height;
var srcContext=srcCanvas.getContext("2d",{willReadFrequently:true});srcContext.drawImage(_srcElem,0,0);return srcCanvas};this.setPrnScrMode=function(elem,mode){_args.parentElement.querySelectorAll(".pspscreenshot").forEach(function(elem){helper.style.removeClass(elem,"selected")});helper.style.addClass(elem,"selected");_printScreenMode=mode;helper.style.removeClass(_args.parentElement,"disabled")};this.print=function(callback,useTempCanvas){if(_printScreenMode!=-1){var info=_args.methods.getInfo();
var _printCanvas=null;if(useTempCanvas===true)_printCanvas=_tempCanvas;else _printCanvas=this.getSrcCanvas();args.methods.printScreen(_printCanvas,info.title,info.detail,_printScreenMode,callback)}};this.setPrintScreenMode=function(mode){_printScreenMode=helper.object.getTypeOf(mode)=="string"&&"PM_FULLCOLOR;PM_INVERTEDGRAYSCALE;PM_GRAYSCALED;PM_BLACKANDWHITE".indexOf(mode.toUpperCase())!=-1?_canvasPrinter[mode.toUpperCase()]:_canvasPrinter.getCanvasPrinterMode(mode)};return this}function showPrintScreenPreview(){if(!_wPrintScreenPreview){_wPrintScreenPreview=
new initializePrintScreenPreview;attachEvents()}if(helper.object.existsPath(window,"customSettings.printScreen.defaultPrintMode")){_wPrintScreenPreview.setPrintScreenMode(window.customSettings.printScreen.defaultPrintMode);_wPrintScreenPreview.print(null)}else _wPrintScreenPreview.show()}function closePrintScreenPreview(){_wPrintScreenPreview.hide()}function setPrintPreviewImage(elem,img){var oldImg=elem.getElementsByTagName("img")[0];if(oldImg)elem.removeChild(oldImg);elem.appendChild(img)}function getCanvasPrinter(){return _canvasPrinter}
function suppressMouseTouchEvent(e){try{if(window["TouchEvent"]&&e&&e instanceof TouchEvent){if(e.preventDefault)e.preventDefault();if(e.stopPropagation)e.stopPropagation()}}catch(err){helper.console.warning("[suppressMouseTouchEvent] Failed while trying to handle touch and mouse events. ",arguments)}}initialize(args);Object.defineProperty(_ref,"show",{"enumerable":true,"configurable":false,"writable":false,"value":showPrintScreenPreview});Object.defineProperty(_ref,"hide",{"enumerable":true,"configurable":false,
"writable":false,"value":closePrintScreenPreview});Object.defineProperty(_ref,"set",{"enumerable":true,"configurable":false,"writable":false,"value":setPrintPreviewImage});Object.defineProperty(_ref,"getCanvasPrinter",{"enumerable":true,"configurable":false,"writable":false,"value":getCanvasPrinter});return this}try{Thinfinity!=undefined}catch(e){Thinfinity={}}Thinfinity.PrintScreenPreview=PrintScreenPreview})();
(function(){var protocols=helper.object.createEnum("WEBSOCKET","AJAX");var states=helper.object.createEnum("INITIALIZING","READY","SERVERCONNECTED","CONNECTING","RECONNECTING","CONNECTED","UNSTABLE","LOST","CLOSING","CLOSED");var errCodes=helper.object.createEnum({"TIMEOUT":-1,"RESTART":-2,"CONTINUE":100,"SWITCHING_PROTOCOLS":101,"OK":200,"CREATED":201,"ACCEPTED":202,"PARTIAL_INFORMATION":203,"NO_CONTENT":204,"RESET_CONTENT":205,"PARTIAL_CONTENT":206,"MULTIPLE_CHOICES":300,"MOVED_PERMANENTLY":301,
"MOVED_TEMPORARILY":302,"SEE_OTHER":303,"NOT_MODIFIED":304,"USE_PROXY":305,"BAD_REQUEST":400,"UNAUTHORIZED":401,"PAYMENT_REQUIRED":402,"FORBIDDEN":403,"NOT_FOUND":404,"METHOD_NOT_ALLOWED":405,"NOT_ACCEPTABLE":406,"PROXY_AUTHENTICATION_REQUIRED":407,"REQUEST_TIME_OUT":408,"CONFLICT":409,"GONE":410,"LENGTH_REQUIRED":411,"PRECONDITION_FAILED":412,"REQUEST_ENTITY_TOO_LARGE":413,"REQUEST_URL_TOO_LARGE":414,"UNSUPPORTED_MEDIA_TYPE":415,"SERVER_ERROR":500,"NOT_IMPLEMENTED":501,"BAD_GATEWAY":502,"OUT_OF_RESOURCES":503,
"GATEWAY_TIME_OUT":504,"HTTP_VERSION_NOT_SUPPORTED":505,"UNKNOWN":1006});var wsStates=helper.object.createEnum("CONNECTING","OPEN","CLOSING","CLOSED");var _decodeData=null;var _encodeData=null;var _comm=null;function Communication(args){var _ref=this;var _estimatedState=states.INITIALIZING;var _args={"protocol":protocols.WEBSOCKET,"withCredentials":false,"payload":false,"webSocket":{"maxTimeToOpen":1E4,"events":{"open":null,"message":null,"close":null,"error":null}},"methods":{"arraybufferToString":null},
"properties":null,"events":{"stateChange":null,"error":null}};var _protocol=null;var _ws=null;var _wsParams={"maxTimeId":null,"open":false,"closed":false,"url":null,"fastConnectTime":1E3};var _connection={"lastContactTime":null,"lostConnection":false,"unstableTime":1E4,"lostTime":25E3,"restartTime":33E3,"checkIntervalTime":1500,"maxPingTime":1500,"pingIntervalTime":15E3,"pingIntervalId":null,"pingTimeoutId":null,"wsReopenTime":2E3,"wsReopenTimeoutId":null,"unstableTimeoutId":null,"maxPing":1,"pingCount":0,
"state":states.INITIALIZING};var _timeoutDetected=false;var _pings={};var _arToStr=null;var _onmsg=null;var _noop=function(){};var _chunk={"success":function(){},"error":function(){},"url":null,"xhr":null,"id":null};var _lowNetworkDetection={"initTime":null,"openTime":null};var _commData;var _checkWorker=null;var _wsWOL={"enabled":false,"intervalId":null,"intervalTime":3E4};function initialize(){helper.object.parseAttributes(_args,args);_arToStr=_args.methods.arraybufferToString||function(data){var ar=
[];var len=data.byteLength;for(var i=0;i<len;i++)ar.push(String.fromCharCode(data[i]));return ar.join()};_onmsg=_args.webSocket.events.message;if(!_args.events.stateChange)_args.events.stateChange=_noop;if(!_args.events.error)_args.events.error=_noop;setProtocol(_args.protocol);initProtocolBuffer();_connection.state=states.READY;fireConnectionEvent(states.READY);_checkWorker=new Worker("<%=@BASEURL%>common/workers/thinfinity.communication.status.worker.js");_checkWorker.onmessage=function(e){if(e.data.cmd===
"check")checkStatus()}}function initProtocolBuffer(){if(typeof protobuf!="undefined"&&["RDP","FMX"].indexOf(window.cookiePrefix)!==-1){_commData=new protobuf.Type("CommandData");_commData.add(new protobuf.Field("type",1,"uint32"));_commData.add(new protobuf.Field("cmd",2,"string"));_commData.add(new protobuf.Field("data",3,"bytes"));let root=(new protobuf.Root).define("CommandData");root.add(_commData)}else helper.console.log(`Protocol Buffer is not available`);assignEncoder()}function assignEncoder(){if(!_encodeData)if(_commData)_encodeData=
(cmd,type,data)=>{var cd=_commData.create({"type":type==null?0:type,cmd,data});return _commData.encode(cd).finish()};else _encodeData=cmd=>{return cmd}}function setProtocol(value){switch(value){case protocols.AJAX:case protocols.WEBSOCKET:_protocol=value;break}return _protocol}function setEstimateState(value){if(_protocol===protocols.AJAX){if(states.hasValue(value))_estimatedState=value;if([states.CONNECTING,states.CONNECTED].indexOf(value)!=-1)checkingConnectionStatus()}return _estimatedState}function startAjax(){_connection.lastContactTime=
(new Date).getTime();_protocol=protocols.AJAX;setEstimateState(states.CONNECTING)}function restartAjax(state){if(_protocol===protocols.AJAX){if(state===undefined)state=Thinfinity.Communication.state.SERVERCONNECTED;_connection.lastContactTime=(new Date).getTime();setEstimateState(state)}}function sendAjax(params){if(_args.withCredentials!=undefined)params.withCredentials=_args.withCredentials;return helper.ajax[(params.method||"get").toLowerCase()](params)}function releaseQueue(queueName){helper.ajax.releaseQueue(queueName)}
function checkStatus(){if(_estimatedState>=states.CONNECTING&&_estimatedState<states.CLOSING){var elapsedTime=(new Date).getTime()-_connection.lastContactTime;if(elapsedTime<_connection.unstableTime){if(_timeoutDetected)cancelEchoPing();_timeoutDetected=false;clearTimeout(_connection.unstableTimeoutId);if(_connection.state!=states.CONNECTED){fireConnectionEvent(states.CONNECTED);_connection.state=states.CONNECTED}}else if(elapsedTime<_connection.lostTime){clearTimeout(_connection.wsReopenTimeoutId);
clearTimeout(_connection.unstableTimeoutId);if(_connection.state<states.UNSTABLE&&!_timeoutDetected){_connection.pingCount=0;_timeoutDetected=true;timeoutProcedure(reopen)}else if(_connection.state<states.UNSTABLE){_connection.pingCount=0;helper.console.warning("The connection has become unstable",arguments);fireConnectionEvent(states.UNSTABLE);_connection.state=states.UNSTABLE;unstableProcedure(reopen)}}else{if(_connection.state<states.LOST){fireConnectionEvent(states.LOST);_connection.state=states.LOST;
lostProcedure(reopen)}if(elapsedTime>_connection.restartTime){releaseOldWebSocket();stop();fireErrorEvent(states.getKey(states.LOST),errCodes.RESTART,errCodes.getKey(errCodes.RESTART))}}}else if(_estimatedState===states.CLOSED&&_args.properties.sessionEnd===true)_checkWorker.postMessage({"cmd":"stop"})}function checkingConnectionStatus(){_checkWorker.postMessage({"cmd":"start","value":_connection.checkIntervalTime})}function releaseOldWebSocket(){if(_ws&&!_wsWOL.enabled)try{_ws.onclose=function(){};
_ws.onerror=function(){};_ws.onmessage=function(){};_ws.close();_ws=null}catch(error){}}function webSocketStop(e){clearTimeout(_wsParams.maxTimeId);if(!_args.properties.sessionEnd){if(_wsParams.open){fireConnectionEvent(states.UNSTABLE);_connection.state=states.UNSTABLE;_connection.lastContactTime=(new Date).getTime()-_connection.restartTime}var cs={"code":errCodes.UNKNOWN,"message":errCodes.getKey(errCodes.UNKNOWN)};if(e.code){cs.code=e.code;cs.message=e.reason}if(!_wsParams.closed)if(_estimatedState!==
states.UNSTABLE)cs={"code":errCodes.RESTART,"message":errCodes.getKey(errCodes.RESTART)};_wsParams.closed=true;fireWSErrorEvent(errCodes.getKey(cs.code),cs.code,cs.message)}else{stop();_args.webSocket.events.close(e);if(!_wsParams.closed)fireConnectionEvent(states.CLOSED);_wsParams.closed=true}}function openWebSocket(url,fastConnectCallback){if(_estimatedState<=states.CLOSING){releaseOldWebSocket();helper.console.log("open new Web Socket",arguments);helper.webSocket(url,"arraybuffer").then(function(ws){_ws=
ws;_lowNetworkDetection.initTime=Date.now();_connection.pingCount=0;clearTimeout(_wsParams.maxTimeId);fireConnectionEvent(states.CONNECTING);_wsParams.url=url;_wsParams.maxTimeId=setTimeout(function(){helper.console.warning("WebSocket: is not responding...");if(!fastConnectCallback){if(!_wsParams.open){if(_ws)_ws.close();helper.console.warning("requesting to switch to Ajax mode.")}fireWSErrorEvent(errCodes.getKey(errCodes.TIMEOUT),errCodes.TIMEOUT,errCodes.getKey(errCodes.TIMEOUT))}else fastConnectCallback()},
fastConnectCallback?_wsParams.fastConnectTime:_args.webSocket.maxTimeToOpen);_ws.onopen=function(){helper.console.log("onopen",arguments);_wsParams.open=true;_wsParams.closed=false;_connection.lastContactTime=(new Date).getTime();checkingConnectionStatus();_lowNetworkDetection.openTime=Date.now();_lowNetworkDetection.speed=_lowNetworkDetection.openTime-_lowNetworkDetection.initTime;if(_lowNetworkDetection.speed>500)helper.console.warning("Low network access, detected latency: "+_lowNetworkDetection.speed.toString(),
arguments);clearTimeout(_wsParams.maxTimeId);fireConnectionEvent(states.CONNECTED);backToNormal();if(_args.webSocket.events.open)_args.webSocket.events.open();keepServerAlive()};_ws.onmessage=function(msg){_connection.lastContactTime=(new Date).getTime();if(_decodeData)msg=_decodeData(msg);if(msg?.data&&msg.data instanceof ArrayBuffer)if(msg.data.byteLength===11)try{if(_arToStr((new Zlib.RawInflate((new Uint8Array(msg.data)).subarray(7))).decompress())=="{}"){var t=(new Date).getTime();cancelEchoPing();
if(!_args.payload)return}}catch(error){}_onmsg(msg);msg=null};_ws.onerror=function(e){helper.console.warning(helper.string.format("onerror -- ws error - sessionEnd: {0}",_args.properties.sessionEnd),arguments);webSocketStop(e);stopServerAlive()};_ws.onclose=function(e){helper.console.warning(helper.string.format("Websocket has been closed. Code: {0} Reason: {1}",e.code,e.reason),arguments);webSocketStop(e);stopServerAlive()}}).catch(function(e){helper.console.warning(helper.string.format("onerror -- ws error - sessionEnd: {0}",
_args.properties.sessionEnd),arguments);webSocketStop(e)})}}function restartWebSocketFlow(state){if(_wsWOL.enabled)return;if(!_wsParams.closed){_wsParams.closed=true;fireConnectionEvent(states.CLOSING);fireConnectionEvent(states.CLOSED)}if(_ws)_ws.close();stop();_estimatedState=states.SERVERCONNECTED;reopen()}function setChunkHandlers(jData){_chunk.success=jData.success;_chunk.error=jData.error;_chunk.url=jData.url;_chunk.id=jData.id}function restart(protocol){if(protocol===undefined)protocol=_protocol;
switch(protocol){case protocols.AJAX:restartAjax();break;case protocols.WEBSOCKET:restartWebSocketFlow();break}}function reset(){if(_ws)_ws.close();stop();fireConnectionEvent(states.READY)}function getNextChunk(){if(_protocol===protocols.AJAX){if(_chunk.xhr)return;_chunk.xhr=helper.ajax.get({"url":_chunk.url,"withCredentials":_args.withCredentials,"dataType":"json","success":function(data){_chunk.xhr=null;_connection.lastContactTime=(new Date).getTime();_chunk.success(data)},"abort":function(e,status,
xhr){_chunk.xhr=null;if(_estimatedState<=states.UNSTABLE){_connection.lastContactTime=(new Date).getTime();_chunk.success({})}},"error":function(e,status,xhr){_chunk.xhr=null;_connection.lastContactTime=(new Date).getTime()-_connection.lostTime;_chunk.error(e,xhr)}})}}function sendWebSocket(cmd,type){if(_ws&&_estimatedState>=states.RECONNECTING&&_estimatedState<=states.CLOSING&&!_wsParams.closed)_ws.send(_encodeData(cmd,type))}function post(params){if(_args.withCredentials!=undefined)params.withCredentials=
_args.withCredentials;helper.ajax.post(params)}function wsClose(){if(_wsWOL.enabled)return;fireConnectionEvent(states.CLOSING);setTimeout(function(){fireConnectionEvent(states.CLOSED);if(_ws)_ws.close()},100)}function wsWOL(enabled){if(_wsWOL.enabled!==enabled)if(enabled){_wsWOL.enabled=true;stop();clearInterval(_wsWOL.intervalId);_wsWOL.intervalId=setInterval(function(){_ws.send("cmd=ping")},_wsWOL.intervalTime)}else{_wsWOL.enabled=false;_checkWorker.postMessage({"cmd":"start","value":_connection.checkIntervalTime})}}
function dispose(){releaseOldWebSocket();if(_chunk.xhr){_chunk.success=_noop;_chunk.error=_noop;_chunk.abort=_noop;_chunk.xhr.abort()}stop()}function stop(){clearTimeout(_wsParams.maxTimeId);_checkWorker.postMessage({"cmd":"stop"});cancelEchoPing()}function backToNormal(){clearTimeout(_connection.wsReopenTimeoutId);clearTimeout(_connection.unstableTimeoutId);clearTimeout(_connection.pingTimeoutId)}function fireConnectionEvent(state){if(state!=_estimatedState){_estimatedState=state;_args.events.stateChange(_estimatedState)}}
function sendWSPing(callback){if(_connection.pingCount<_connection.maxPing&&_connection.pingTimeoutId==null){_connection.pingCount++;if(_connection.state===states.UNSTABLE){var sp=_ws.readyState===wsStates.OPEN?"sending ping":"connection is not open";helper.console.warning("Unstable connection, "+sp+", readyState: "+wsStates.getKey(_ws.readyState))}if(_ws.readyState===wsStates.OPEN){_connection.pingTimeoutId=setTimeout(function(){_connection.pingTimeoutId=null;callback(false)},_connection.maxPingTime);
_ws.send("cmd=ping")}else callback(false)}}function sendAjaxPing(callback){if(_connection.pingCount<_connection.maxPing&&_connection.pingTimeoutId==null){_connection.pingCount++;_connection.pingTimeoutId=setTimeout(function(){_connection.pingTimeoutId=null;callback(false)},_connection.maxPingTime);helper.ajax.get({"url":"cmd?cmd=ping&id="+_chunk.id,"dataType":helper.ajax.responseType.TEXT,"cache":false,"timeout":_connection.maxPingTime,"withCredentials":_args.withCredentials,"success":function(data){clearTimeout(_connection.pingTimeoutId);
callback(true)},"error":function(e,status,xhr){callback(false)}})}}function cancelEchoPing(){_connection.pingCount=0;clearTimeout(_connection.pingTimeoutId);_connection.pingTimeoutId=null}function reopen(){if(!_args.properties.sessionEnd)return _protocol===protocols.AJAX?reopenAjax():reopenWS();else return false}function reopenWS(callback){if(_ws.readyState>wsStates.OPEN&&_connection.state<states.LOST){fireConnectionEvent(states.RECONNECTING);openWebSocket(_wsParams.url,callback)}}function reopenAjax(callback){fireConnectionEvent(states.RECONNECTING)}
function fireErrorEvent(name,code,message){try{_args.events.error(new CustomEvent(name,{"detail":{"code":code,"message":message}}))}catch(error){helper.console.warning("fireErrorEvent trough exception: "+error.message,arguments,error)}}function fireWSErrorEvent(name,code,message){_args.webSocket.events.error(new CustomEvent(name,{"detail":{"code":code,"message":message}}))}function timeoutProcedure(callback){sendPing(callback)}function unstableProcedure(callback){sendPing(callback)}function keepServerAlive(){clearInterval(_connection.pingIntervalId);
_connection.pingIntervalId=setInterval(function(){if(_protocol===protocols.WEBSOCKET)if(_ws?.readyState===wsStates.OPEN)_ws.send("cmd=ping")},_connection.pingIntervalTime)}function stopServerAlive(){clearInterval(_connection.pingIntervalId)}function sendPing(callback){if(_protocol===protocols.WEBSOCKET)if(!_wsParams.closed)sendWSPing(callback);else reopenWS(callback);else if(_protocol===protocols.AJAX)sendAjaxPing(function(response){if(response)_connection.lastContactTime=(new Date).getTime()})}function lostProcedure(callback){if(_protocol===
protocols.WEBSOCKET){if(_ws.readyState>=wsStates.CLOSING)reopen(callback)}else;}function createPing(name,jData){var name=name||helper.utils.generateGUID(12);if(_pings[name])clearInterval(_pings[name]);_pings[name]=setInterval(function(){sendAjax({url:jData.url,dataType:helper.ajax.responseType.DOCUMENT,cache:false,timeout:typeof(jData.timeout!="undefined")?jData.timeout:1E3,error:jData.error,success:jData.success})},jData.intervalTime);return name}function disposePing(name){stopServerAlive();if(name&&
_pings[name])clearInterval(_pings[name])}function recvPingResponse(){_connection.lastContactTime=(new Date).getTime()}function forceReconnect(){_connection.lastContactTime=(new Date).getTime()-_connection.unstableTime}initialize();Object.defineProperty(_ref,"state",{"enumerable":true,"configurable":false,"get":function(){return _estimatedState}});Object.defineProperty(_ref,"protocol",{"enumerable":true,"configurable":false,"get":function(){return _protocol},"set":function(value){return setProtocol(value)}});
Object.defineProperty(_ref,"restart",{"enumerable":true,"configurable":false,"writable":false,"value":restart});Object.defineProperty(_ref,"reset",{"enumerable":true,"configurable":false,"writable":false,"value":reset});Object.defineProperty(_ref,"get",{"enumerable":true,"configurable":false,"writable":false,"value":sendAjax});Object.defineProperty(_ref,"send",{"enumerable":true,"configurable":false,"writable":false,"value":sendAjax});Object.defineProperty(_ref,"post",{"enumerable":true,"configurable":false,
"writable":false,"value":post});Object.defineProperty(_ref,"releaseQueue",{"enumerable":true,"configurable":false,"writable":false,"value":releaseQueue});Object.defineProperty(_ref,"queueLength",{"enumerable":true,"configurable":false,"writable":false,"value":function(queueName){return helper.ajax.queueLength(queueName)}});Object.defineProperty(_ref,"getNextChunk",{"enumerable":true,"configurable":false,"writable":false,"value":getNextChunk});Object.defineProperty(_ref,"setChunkHandlers",{"enumerable":true,
"configurable":false,"writable":false,"value":setChunkHandlers});Object.defineProperty(_ref,"start",{"enumerable":true,"configurable":false,"writable":false,"value":startAjax});Object.defineProperty(_ref,"wsOpen",{"enumerable":true,"configurable":false,"writable":false,"value":function(url){return openWebSocket(url)}});Object.defineProperty(_ref,"wsSend",{"enumerable":true,"configurable":false,"writable":false,"value":sendWebSocket});Object.defineProperty(_ref,"binaryType",{"enumerable":true,"configurable":false,
"get":function(){return _ws?_ws.binaryType:undefined}});Object.defineProperty(_ref,"wsClose",{"enumerable":true,"configurable":false,"writable":false,"value":wsClose});Object.defineProperty(_ref,"wsWOL",{"enumerable":true,"configurable":false,"writable":false,"value":wsWOL});Object.defineProperty(_ref,"dispose",{"enumerable":true,"configurable":false,"writable":false,"value":dispose});Object.defineProperty(_ref,"createPing",{"enumerable":true,"configurable":false,"writable":false,"value":createPing});
Object.defineProperty(_ref,"disposePing",{"enumerable":true,"configurable":false,"writable":false,"value":disposePing});Object.defineProperty(_ref,"forceReconnect",{"enumerable":true,"configurable":false,"writable":false,"value":forceReconnect});Object.defineProperty(_ref,"serverConnected",{"enumerable":true,"configurable":false,"get":function(){return _estimatedState>=states.SERVERCONNECTED},"set":function(value){fireConnectionEvent(value?states.SERVERCONNECTED:states.READY)}});Object.defineProperty(_ref,
"connected",{"enumerable":true,"configurable":false,"get":function(){return _estimatedState>=states.SERVERCONNECTED&&_estimatedState<states.CLOSING}});Object.defineProperty(_ref,"recvPingResponse",{"enumerable":true,"configurable":false,"writable":false,"value":recvPingResponse});Object.defineProperty(_ref,"resetEncoding",{"enumerable":true,"configurable":false,"writable":false,"value":assignEncoder});_comm=_ref;return _ref}function registerEncoding(encoding){if(encoding){if(encoding.encode)_encodeData=
encoding.encode;if(encoding.decode)_decodeData=encoding.decode}}function unregisterEncoding(){_decodeData=_encodeData=null;if(_comm)_comm.resetEncoding()}Object.defineProperty(Communication,"protocol",{"enumerable":true,"configurable":false,"get":function(){return protocols}});Object.defineProperty(Communication,"state",{"enumerable":true,"configurable":false,"get":function(){return states}});Object.defineProperty(Communication,"errorCode",{"enumerable":true,"configurable":false,"get":function(){return errCodes}});
Object.defineProperty(Communication,"registerEncoding",{"enumerable":true,"configurable":false,"writable":false,"value":registerEncoding});Object.defineProperty(Communication,"unregisterEncoding",{"enumerable":true,"configurable":false,"writable":false,"value":unregisterEncoding});try{Thinfinity!=undefined}catch(e){Thinfinity={}}Thinfinity.Communication=Communication})();
(function(){function StatusInfo(args){var _ref=this;var _args={"container":null,"variables":null};var _statusContainer=null;var _header=null;var _close=null;var _body=null;var _update={"time":1E3,"intervalId":null};var _variables=[];var _idx=0;function initialize(){helper.object.parseAttributes(_args,args)}function initializeStatus(){if(!_args.container)_args.container=document.body;_statusContainer=helper.dom.appendJsonElement({"parentElement":_args.container,"type":"div","attributes":{"style":"position:absolute;zIndex:999999999;width:auto;height:auto;min-width:150px;min-height:45px;backgroundColor:#d6d6d6;top:20px;left:20px;display:none;"}});
_header=helper.dom.appendJsonElement({"parentElement":_statusContainer,"type":"div","attributes":{"style":"height:20px;margin:0px;top:0px;left:0px;backgroundColor:#3297d6;color:#ffffff;fontWeight:400;lineHeight:22px;fontSize:10pt;padding-left:5px;borderBottom: 1px solid #a7a7a7;"},"content":"Status"});_close=helper.dom.appendJsonElement({"parentElement":_header,"type":"div","attributes":{"style":"height: 14px; margin: 0px;top: 0px;marginRight: 6px;color: rgb(255, 255, 255);fontWeight: 400;lineHeight: 22px;fontSize: 10pt;paddingLeft: 5px;display: inline-block;float: right;"},
"events":{"click":hideStatus},"content":"X"});_body=helper.dom.appendJsonElement({"parentElement":_statusContainer,"type":"div","attributes":{"style":"width:100%;height:auto;"}});if(_args.variables)_args.variables.forEach(function(item){addVariable(item)});if(Thinfinity.Draggable)new Thinfinity.Draggable({"container":_statusContainer,"dragElem":_header});helper.dom.addEvent(window,"newStatusAPIVariables",getVariables);getVariables()}function getVariables(){if(Thinfinity.StatusAPI)addVariables(Thinfinity.StatusAPI.dump("STATUSINFO"))}
function addVariables(variables){if(variables instanceof Array)variables.forEach(function(item){addVariable(item)});else return addVariable(variables)}function addVariable(jData){var item={"name":jData.name,"title":jData.title,"index":jData.index||_idx,"get":jData.get,"obj":jData.obj,"style":jData.style,"draw":false};_variables.push(item);_idx=item.idx++;return drawVariable(item)}function appendRow(index,row){if(_body&&row){var bRow;var list=_body.querySelectorAll(".row");var i=0;while(!bRow&&i<list.length){if(index<
list[i].index)bRow=list[i];i++}if(bRow)_body.insertBefore(row,bRow);else _body.appendChild(row)}}function drawVariable(jData){if(!jData.elems){var _row=helper.dom.createJsonElement({"type":"div","attributes":{"style":"width:100%;height:20px;borderBottom:1px solid #cccccc;","class":"row","index":jData.index}});var _name=helper.dom.appendJsonElement({"parentElement":_row,"type":"div","attributes":{"style":"width:auto;display:inline-block;float:left;marginLeft:5px;marginRight:10px;fontSize:10pt;"},"content":jData.title+
" :"});var _value=helper.dom.appendJsonElement({"parentElement":_row,"type":"div","attributes":{"style":"width:auto;display:inline-block;float:right;marginRight:5px;fontSize:10pt;"},"content":jData.get?jData.get():"undefined"});jData.elems={"row":_row,"name":_name,"value":_value};jData.draw=false}if(_body)appendRow(jData.index,jData.elems.row);return _value}function removeVariable(name){for(var i=0,t=_variables.length;i<t;i++)if(_variables.name===name){_body.removeChild(_variables.row);_variables.splice(i,
1)}}function updateInfo(){clearInterval(_update.intervalId);_update.intervalId=setInterval(function(){refreshVariables()},_update.time);refreshVariables()}function refreshVariables(){_variables.forEach(function(item){if(!item.draw)drawVariable(item);var value=item.get?item.get():"undefined";item.elems.value.innerText=value;if(item.style)helper.style.add(item.elems.value,item.style(value))})}function showStatus(){if(!_statusContainer)initializeStatus();helper.style.add(_statusContainer,{"display":"block"});
updateInfo()}function hideStatus(){helper.style.add(_statusContainer,{"display":"none"});clearInterval(_update.intervalId)}initialize();Object.defineProperty(_ref,"show",{"enumerable":false,"configurable":false,"writable":false,"value":showStatus});Object.defineProperty(_ref,"hide",{"enumerable":false,"configurable":false,"writable":false,"value":hideStatus});Object.defineProperty(_ref,"add",{"enumerable":false,"configurable":false,"writable":false,"value":addVariables});Object.defineProperty(_ref,
"remove",{"enumerable":false,"configurable":false,"writable":false,"value":removeVariable});return _ref}try{Thinfinity!=undefined}catch(e){Thinfinity={}}Thinfinity.StatusInfo=new StatusInfo({})})();
(function(){var _types=helper.object.createEnum("TAP","PAN","PRESS","PRESSANDRELEASE","PINCH","SWIPE","PRESSANDTAP","PANANDTAP","RELEASE","SWIPEFROMEDGE");var _onStates=helper.object.createEnum("BEFORE","WHILE","AFTER","ALL");function GesturesConfigurator(args){var _ref=this;var _plugin=Hammer;var _pluginInstance=null;var _eventsDetails={};var _typeRecognizers=[{type:_types.TAP,recognizer:"Tap",comparor:["pointers","taps"]},{type:_types.PAN,recognizer:"Pan",comparor:["pointers","direction"],on:[{state:_onStates.BEFORE,
listeners:["start"]},{state:_onStates.WHILE,listeners:["move"]},{state:_onStates.AFTER,listeners:["end","cancel"]}]},{type:_types.PRESS,recognizer:"Press",comparor:["pointers"]},{type:_types.PRESSANDRELEASE,recognizer:"Press",comparor:["pointers"]},{type:_types.PINCH,recognizer:"Pinch",comparor:["pointers"],on:[{state:_onStates.BEFORE,listeners:["start"]},{state:_onStates.WHILE,listeners:["move"]},{state:_onStates.AFTER,listeners:["end","cancel"]}]},{type:_types.SWIPE,recognizer:"Swipe",comparor:["pointers",
"direction"]},{type:_types.PRESSANDTAP,recognizer:pressAndTapRecognizer,comparor:[]},{type:_types.PANANDTAP,recognizer:panAndTapRecognizer,comparor:[]},{type:_types.RELEASE,recognizer:releaseRecognizer,comparor:[]},{type:_types.SWIPEFROMEDGE,recognizer:swipeFromEdgeRecognizer,comparor:["direction"]}];var _args={listenElement:null,instanceOptions:{domEvents:true},gestures:[],middleware:null,middlewares:[],actions:{}};function initialize(){setArgs(args)}function startRecognition(){if(_pluginInstance)stopRecognition();
if(!_args.listenElement){helper.console.warning("[GesturesConfigurator] No _args.listenElement was provided for TouchManager.");return}_pluginInstance=new _plugin["Manager"](_args.listenElement);_pluginInstance.set(_args.instanceOptions);configureEventDetails();configureEvents();adaptRecognizers();configureHandlers()}function clearGesturesAndDetails(){_args.gestures=[];_eventsDetails={}}function configureEvents(){var flatRecognizers=Object.keys(_eventsDetails).map(function(k){return _eventsDetails[k].recognizers}).reduce(function(acc,
x){return acc.concat(x)},[]);_pluginInstance.add(flatRecognizers.filter(function(t){return!!!t.type}).sort(function(a,b){if(a.options.type===_types.TAP&&a.options.type===b.options.type&&a.options.pointers===b.options.pointers)if(a.options.taps>b.options.taps)return-1;else if(a.options.taps<b.options.taps)return 1;else return 0;return 0}));_pluginInstance.add(flatRecognizers.filter(function(t){return t.type==="PLUGINEVENT"}).map(function(t){return t.recognizer}));flatRecognizers.filter(function(t){return t.type===
"DOMEVENTLISTENER"}).forEach(function(t){t.elem.addEventListener(t.event,t.handler,false)})}function configureHandlers(){var detailsArr=Object.keys(_eventsDetails).map(function(k){return _eventsDetails[k]});var flatRecognizers=detailsArr.map(function(t){return t.recognizers}).reduce(function(acc,x){return acc.concat(x)},[]);_pluginInstance.on(detailsArr.reduce(function(accum,value){return accum.concat(value.listenTo)},[]).join(" "),onGesture);flatRecognizers.filter(function(t){return!!t.type&&t.type===
"PLUGINEVENT"}).forEach(function(t){_pluginInstance.on(createListenerName(t.recognizer.options.event,t.listenTo||"").join(" "),t.handler)})}function detachDomEvents(){var flatRecognizers=Object.keys(_eventsDetails).map(function(k){return _eventsDetails[k].recognizers}).reduce(function(acc,x){return acc.concat(x)},[]);flatRecognizers.filter(function(t){return t.type==="DOMEVENTLISTENER"}).forEach(function(t){t.elem.removeEventListener(t.event,t.handler,false);if(t.relatedHandlers)t.relatedHandlers.forEach(function(rh){rh.elem.removeEventListener(rh.event,
rh.handler,false)})})}function stopRecognition(){detachDomEvents();if(_pluginInstance){_pluginInstance.stop();_pluginInstance.destroy()}clearGesturesAndDetails();_pluginInstance=null}function compareGestures(g,t){var gType=g.type;var tType=t.type;if(gType===tType){var typeRecog=_typeRecognizers.filter(function(t){return t.type===gType})[0];if(typeRecog.comparor&&typeRecog.comparor.length>0)return typeRecog.comparor.every(function(val){return g[val]===t[val]});else return true}return false}function setArgs(optArgs){optArgs=
helper.object.clone(optArgs);if(optArgs.gestures){optArgs.gestures.forEach(function(t){try{t.type=typeof t.type==="string"&&_types[t.type.toUpperCase()]!==null&&_types[t.type.toUpperCase()]!==undefined?_types[t.type.toUpperCase()]:null;t.action=(Array.isArray(t.action)?t.action:[t.action]).filter(function(ac){ac=ac?.name??ac;return typeof ac==="string"&&ac.trim().length>0});t.action=t.action.map(function(ac){const {name,...content}=typeof ac==="string"?{name:ac.toUpperCase()}:{...ac,name:ac.name.toUpperCase()};
const onState=_onStates[content.on?.toUpperCase?.()]??null;return{name,...content,on:onState}})}catch(err){helper.console.warning("[GesturesConfigurator] Something went wrong while adding gesture ["+JSON.stringify(t)+"].");t.type=null}});optArgs.gestures=optArgs.gestures.filter(function(t){return t.type!==null});var gesturesConfiguration=optArgs.gestures;var nativeGestures=[];_args.gestures.forEach(function(t){var overriden=gesturesConfiguration.filter(function(g){return compareGestures(g,t)})[0];
if(!overriden)nativeGestures.push(t)});optArgs.gestures=optArgs.gestures.concat(nativeGestures)}helper.object.parseAttributes(_args,optArgs);if(optArgs.actions){optArgs.actions=Object.keys(optArgs.actions).reduce(function(obj,key){obj[key.toUpperCase()]=optArgs.actions[key];return obj},{});helper.object.extend(_args.actions,optArgs.actions)}}function getMiddleware(opts){var foundmw=null;for(var i=0,len=_args.middlewares.length;i<len&&!foundmw;i++){mw=_args.middlewares[i];var keys=Object.keys(mw).filter(function(t){return t!==
"processor"});var same=true;for(var k=0,klen=keys.length;k<klen&&same;k++)same=mw[keys[k]]===opts[keys[k]];foundmw=same?mw:null}return foundmw}const sensitivity={_ctx:[],_getActionCtx:function({action}){let ac=sensitivity._ctx.find(t=>t.name==action);if(!ac){ac={name:action,sensitivity:{...sensitivity._getCtx()}};sensitivity._ctx.push(ac)}return ac.sensitivity},_setCall:function({action,value},val,{add=false}={}){const ctx=sensitivity._getActionCtx({action});if(ctx)ctx.calls=add?ctx.calls+val<value?
ctx.calls+val:0:val},_getCtx:function(){return{calls:0}},call:function({action,value}){sensitivity._setCall({action,value},1,{add:true})},reset:function({action,value}){sensitivity._setCall({action,value},0)},isValid:function({action,value}){try{const ctx=sensitivity._getActionCtx({action});const {calls=0}=ctx??{};return calls%value==0}catch{console.log("[sensitivity] Error while validating sensitibity.");return true}}};function buildSensitivityHandlers(action,{value=1}={}){const shandlers=Object.keys(sensitivity).reduce((o,
fnName)=>{if(typeof sensitivity[fnName]==="function")o[fnName]=sensitivity[fnName].bind(this,{action,value});return o},{});return shandlers}function buildSubActionHandler(e,subactions){const handler=onstate=>{onGesture(e,null,onstate,subactions)};return handler}function onGesture(e,forcedType,forcedState,forcedActions){const [_type,listener]=(forcedType??e.type)?.split("_")??[];const type=_type?`${_type}_`:undefined;const evType=_eventsDetails[type].details?.type;const typeConfig=_typeRecognizers.find(t=>
t.type==evType);const typeOnState=forcedState??typeConfig?.on?.find(({listeners=[]}={})=>listeners.includes(listener))?.state;const eventActions=forcedActions??_eventsDetails[type].action;const actionsArr=Array.isArray(eventActions)?eventActions:[eventActions];let actions=actionsArr.map(function({name,on,subactions,...args}){subactions=subactions??[];on=typeof on==="string"?_onStates[on.toUpperCase()]:on;name=name?.toUpperCase?.()??name;return{name,on:on??_onStates[_args.actions[name]?.on?.toUpperCase?.()]??
_onStates.ALL,args:{...(args??{}),...{triggerAction:buildSubActionHandler(e,subactions),sensitivityValue:args.sensitivity,sensitivity:buildSensitivityHandlers(name,{value:args.sensitivity})}},subactions,callback:_args.actions[name.toUpperCase?.()]?.handler??_args.actions[name.toUpperCase?.()]}});actions=typeConfig?.on||forcedState?actions.filter(t=>t.on==_onStates.ALL||t.on===typeOnState):actions;if(actions.length>0){var executeActions=checkMiddleWares(e,_eventsDetails[type]);if(executeActions){var middlewr=
getMiddleware(_eventsDetails[type].details),_actionArgs=[e];try{if(middlewr&&middlewr.processor){var middlewres=middlewr.processor.call(this,e,_eventsDetails[type].details);if(middlewres)_actionArgs.push(middlewres)}}catch(err){helper.console.log("[GesturesConfigurator] Failed while executing middleware processor. "+JSON.stringify(middlewr))}for(let i=0,len=actions.length;i<len;i++){const t=actions[i];try{if(t.callback)t.callback.apply(this,[..._actionArgs,t.args])}catch(err){helper.console.error("[GesturesConfigurator] Error while executing action. "+
JSON.stringify(t),err)}}}}}function createListenerName(event,action){action=Array.isArray(action)?action:[action];return action.map(function(t){return event+t})}function parseGestureOptions(opts){var details={listenTo:[]};var type=opts.type;var addDefault=true;if(opts.direction)opts.direction=Hammer[opts.direction];opts.event=_types.getKey(type)+helper.utils.generateGUID(10)+"_";switch(opts.type){case _types.PRESSANDTAP:opts.pointers=1;opts.threshold=typeof opts.threshold==="number"?opts.threshold:
5;opts.time=typeof opts.time==="number"?opts.time:100;addDefault=false;break;case _types.PANANDTAP:opts.pointers=1;opts.threshold=typeof opts.threshold==="number"?opts.threshold:15;addDefault=false;break;case _types.SWIPEFROMEDGE:opts.direction=Hammer["DIRECTION_HORIZONTAL"];addDefault=false;break;case _types.PAN:details.listenTo.push.apply(details.listenTo,createListenerName(opts.event,["start","move","end","cancel"]));break;case _types.PINCH:details.listenTo.push.apply(details.listenTo,createListenerName(opts.event,
["start","move","end","cancel"]));break;case _types.PRESSANDRELEASE:details.listenTo.push.apply(details.listenTo,createListenerName(opts.event,["up"]));addDefault=false;break}if(addDefault)details.listenTo.push(opts.event);return{"options":opts,"details":details}}function detectTouchStart(e,gestureOpts){if(_eventsDetails[gestureOpts.event])_eventsDetails[gestureOpts.event]["pnttap"]=e.timeStamp}function checkMiddleWares(e,evDetails){var executeActions=true;try{if(evDetails.details.middleware)executeActions=
evDetails.details.middleware.call(this,e,evDetails.details)!==false;else if(_args.middleware&&executeActions)executeActions=_args.middleware.call(this,e,evDetails.details)!==false}catch(err){executeActions=true}return executeActions}function pressAndTapRecognizer(gestureOpts){var recognizers=[];var touchStartHandler=function(e){detectTouchStart(e,gestureOpts)};var resetGesture=function(){if(_eventsDetails[gestureOpts.event]["pntpressxy"]){_args.listenElement.removeEventListener("touchstart",touchStartHandler);
_eventsDetails[gestureOpts.event]["pntpressxy"]=null}};var press={"recognizer":new _plugin["Press"](gestureOpts),"type":"PLUGINEVENT","handler":function(e){if(checkMiddleWares(e,_eventsDetails[gestureOpts.event])){_eventsDetails[gestureOpts.event]["pntpressxy"]=e.center;_args.listenElement.addEventListener("touchstart",touchStartHandler)}else resetGesture()}};recognizers.push(press);var _touchmove_pnt=function(e){var currentPos=e.touches.length===1?{x:e.touches[0].pageX,y:e.touches[0].pageY}:{x:e.pageX,
y:e.pageY};var pressPos=_eventsDetails[gestureOpts.event]["pntpressxy"];if(pressPos&&e.touches.length===1){var a=pressPos.x-currentPos.x;var b=pressPos.y-currentPos.y;var distance=Math.sqrt(a*a+b*b);if(distance>15)resetGesture()}};recognizers.push({"type":"DOMEVENTLISTENER","elem":_args.listenElement,"event":"touchmove","handler":_touchmove_pnt,"relatedHandlers":[{"elem":_args.listenElement,"event":"touchstart","handler":touchStartHandler}]});var _touchend_pnt=function(e){var tapTimestamp=_eventsDetails[gestureOpts.event]["pnttap"];
if(!tapTimestamp)resetGesture();else if(Math.abs(tapTimestamp-e.timeStamp)<=300)onGesture(e,gestureOpts.event);_eventsDetails[gestureOpts.event]["pnttap"]=null};recognizers.push({"type":"DOMEVENTLISTENER","elem":_args.listenElement,"event":"touchend","handler":_touchend_pnt,"relatedHandlers":[{"elem":_args.listenElement,"event":"touchstart","handler":touchStartHandler}]});return recognizers}function panAndTapRecognizer(gestureOpts){var touchStartHandler=function(e){detectTouchStart(e,gestureOpts)};
var resetGesture=function(){_args.listenElement.removeEventListener("touchstart",touchStartHandler)};var recognizers=[];var pan={"recognizer":new _plugin["Pan"](gestureOpts),"type":"PLUGINEVENT","listenTo":["start","end"],"handler":function(e){if(checkMiddleWares(e,_eventsDetails[gestureOpts.event]))if(e.type.indexOf("start")!==-1)_args.listenElement.addEventListener("touchstart",touchStartHandler);else resetGesture();else resetGesture()}};recognizers.push(pan);var _touchend_pant=function(e){var tapTimestamp=
_eventsDetails[gestureOpts.event]["pnttap"];if(!tapTimestamp)resetGesture();else if(Math.abs(tapTimestamp-e.timeStamp)<=300)onGesture(e,gestureOpts.event);_eventsDetails[gestureOpts.event]["pnttap"]=null};recognizers.push({"type":"DOMEVENTLISTENER","elem":_args.listenElement,"event":"touchend","handler":_touchend_pant,"relatedHandlers":[{"elem":_args.listenElement,"event":"touchstart","handler":touchStartHandler}]});return recognizers}function releaseRecognizer(gestureOpts){return{"type":"DOMEVENTLISTENER",
"elem":_args.listenElement,"event":"touchend","handler":function(e){onGesture.call(this,e,gestureOpts.event)}}}function getSwipeStartPosition(e){var delta_x=e.deltaX;var delta_y=e.deltaY;var final_x=e.srcEvent.pageX||e.srcEvent.screenX||0;var final_y=e.srcEvent.pageY||e.srcEvent.screenY||0;return{x:final_x-delta_x,y:final_y-delta_y}}function swipeFromEdgeRecognizer(gestureOpts){var recognizers=[];var direction=gestureOpts.swipeDirection?gestureOpts.swipeDirection.toLowerCase():"left";var swipeFromEdge=
{"recognizer":new _plugin["Swipe"](gestureOpts),"type":"PLUGINEVENT","listenTo":[direction],"handler":function(e){var startPos=getSwipeStartPosition(e);var distance=direction==="left"?environment.availWidth-startPos.x:startPos.x;if(distance>=0&&distance<=20)onGesture.call(this,e,gestureOpts.event)}};recognizers.push(swipeFromEdge);return recognizers}function createRecognizers(type,gestureOpts){var recognizers=[];var t=_typeRecognizers.filter(function(t){return t.type===type})[0].recognizer;if(t){var recogs=
typeof t==="function"?t.call(this,gestureOpts):new _plugin[t](gestureOpts);recogs=Array.isArray(recogs)?recogs:[recogs];recognizers.push.apply(recognizers,recogs)}return recognizers}function recognizeAllWith(recog,recogWith){var flatRecogs=recog.map(function(t){return t.recognizers}).reduce(function(acc,x){return acc.concat(x)},[]).reduce(function(acc,x){return acc.concat(!!!x.type?x:x.recognizer?x.recognizer:[])},[]);var flatRecogWith=recogWith.map(function(t){return t.recognizers}).reduce(function(acc,
x){return acc.concat(x)},[]).reduce(function(acc,x){return acc.concat(!!!x.type?x:x.recognizer?x.recognizer:[])},[]);flatRecogs.forEach(function(t){t.recognizeWith(flatRecogWith)})}function recogAndRequestFailure(recogs,sameKey,sortBy){var maxSame=Math.max.apply(null,recogs.map(function(t){return t.details[sameKey]}));for(var ix=maxSame;ix>=0;ix--){var maxBy=Math.max.apply(null,recogs.map(function(t){return t.details[sortBy]}));for(var i=maxBy;i>=0;i--){var iitems=recogs.filter(function(t){return t.details[sameKey]===
ix&&t.details[sortBy]===i});var iless=recogs.filter(function(t){return t.details[sameKey]===ix&&t.details[sortBy]<i});var imore=recogs.filter(function(t){return t.details[sameKey]===ix&&t.details[sortBy]>i});iitems.forEach(function(t){t.recognizers[0].recognizeWith(iless.map(function(p){return p.recognizers[0]}));t.recognizers[0].requireFailure(imore.map(function(p){return p.recognizers[0]}))})}}}function adaptRecognizers(){var recognizers=Object.keys(_eventsDetails).map(function(k){return _eventsDetails[k]});
recogAndRequestFailure(recognizers.filter(function(t){return t.details.type===_types.TAP}),"pointers","taps");var pressAndRelease=recognizers.filter(function(t){return t.details.type===_types.PRESSANDRELEASE&&t.details.pointers===1});var press=recognizers.filter(function(t){return t.details.type===_types.PRESS&&t.details.pointers===1});recognizeAllWith(pressAndRelease,press);recognizeAllWith(press,pressAndRelease);var pressAndTap=recognizers.filter(function(t){return t.details.type===_types.PRESSANDTAP});
var pressAndRelease=recognizers.filter(function(t){return t.details.type===_types.PRESSANDRELEASE&&t.details.pointers===1});recognizeAllWith(pressAndTap,press);recognizeAllWith(press,pressAndTap);recognizeAllWith(pressAndRelease,pressAndTap);recognizeAllWith(pressAndTap,pressAndRelease);var panAndTap=recognizers.filter(function(t){return t.details.type===_types.PANANDTAP});var pan=recognizers.filter(function(t){return t.details.type===_types.PAN&&t.details.pointers===1});recognizeAllWith(panAndTap,
pan);recognizeAllWith(pan,panAndTap);var allSwipes=recognizers.filter(function(t){return t.details.type===_types.SWIPE});var swipeFromEdge=recognizers.filter(function(t){return t.details.type===_types.SWIPEFROMEDGE});var allPans=recognizers.filter(function(t){return t.details.type===_types.PAN});recognizeAllWith(allSwipes,allPans);recognizeAllWith(swipeFromEdge,allPans)}function configureEventDetails(){for(var i=0,len=_args.gestures.length;i<len;i++){var gestureDetails=_args.gestures[i];if(gestureDetails&&
gestureDetails.type!==null&&gestureDetails.type!==undefined)try{var parsedOptions=parseGestureOptions(gestureDetails);var gestureOpts=parsedOptions.options;_eventsDetails[gestureOpts.event]=_eventsDetails[gestureOpts.event]||{};_eventsDetails[gestureOpts.event]["details"]=gestureDetails;_eventsDetails[gestureOpts.event]["listenTo"]=parsedOptions.details.listenTo;gestureDetails.action.forEach(function({name}){if(name.trim().length>0&&!_args.actions[name])helper.console.warning("[GesturesConfigurator] Action not defined: ["+
name+"] .")});_eventsDetails[gestureOpts.event]["action"]=gestureDetails.action;_eventsDetails[gestureOpts.event]["recognizers"]=createRecognizers(gestureDetails.type,gestureOpts)}catch(err){helper.console.log("[GesturesConfigurator]: Error while adding gesture. ( "+JSON.stringify(gestureDetails)+" )")}else helper.console.log("[GesturesConfigurator]: Gesture does not have a valid type. ( "+JSON.stringify(gestureDetails)+" )")}}initialize();Object.defineProperty(_ref,"initialized",{"enumerable":true,
"configurable":false,"get":function(){return _pluginInstance!==null}});Object.defineProperty(_ref,"set",{"enumerable":false,"configurable":false,"writable":false,"value":setArgs});Object.defineProperty(_ref,"stopRecognition",{"enumerable":true,"configurable":false,"writable":false,"value":stopRecognition});Object.defineProperty(_ref,"startRecognition",{"enumerable":true,"configurable":false,"writable":false,"value":startRecognition});return _ref}try{Thinfinity!=undefined}catch(e){Thinfinity={}}Object.defineProperty(GesturesConfigurator,
"types",{"enumerable":true,"configurable":false,"writable":false,"value":_types});Object.defineProperty(GesturesConfigurator,"onStates",{"enumerable":true,"configurable":false,"writable":false,"value":_onStates});Thinfinity.GesturesConfigurator=GesturesConfigurator})();
(function(){var _MAC_CMD={"RELEASED":0,"PRESSED":1,"SENT":2};Object.freeze(_MAC_CMD);function DKeyboard(args){var _ref=this;var _args={parentElement:null,events:{keyboardEvent:null,hook:null},properties:null,methods:{sendKey:null,inputAllowed:null,sendText:null},clipboard:false};var _IMEKeyCode=229;var _IMEKeyPressed=false;var _IMEKeyboardAvailable=["virtualui","thinrdp"].indexOf(productId)!==-1;var _IMEKeyExceptions="\u00b4\u00a8`^";var _caret=null;var _currentEvent=null;var _forceKeyPress=false;
var _macCmd=0;var _lastCharCode=0;var _firefoxAltGr=false;var _MAC_Firefox_CMD={isPressed:false,isCmd:false};var fireEvent=null;var _te={};var _heapKeys={16:0,17:0,18:0,93:0};var _pressedKeys=[];var _altKeyPressed=false;var _noKeyDown=[{"key":44,"name":"PRINTSCREEN"}];var _lastKeyCode=null;var _kbdInput=null;var _allowToSwitchApps=false;function initialize(){helper.object.parseAttributes(_args,args);if(!_args.parentElement)_args.parentElement=document.body;fireEvent=(new Thinfinity.Events({"owner":_te,
"events":_args.events})).fireEvent;createInputElement()}function createInputElement(){if(agentInfo.isMac){_kbdInput=helper.dom.appendJsonElement({parentElement:_args.parentElement,type:"textarea",attributes:{id:"kbdMacInput",name:"kbdMacInput",tabindex:"0",autocapitalize:"off",autocorrect:"off",autocomplete:"off",spellcheck:"false",style:"color: #FFF; position: fixed; left: -2000px; top: 5px; overflow:hidden; width: 20px; height: 20px;"},content:"XXXX"});helper.dom.addEvent(_kbdInput,"focus",function(e){fireEvent("focus",
e)});helper.dom.addEvent(_kbdInput,"blur",function(e){e.mac=true;blur(e)});helper.dom.addEvent(_kbdInput,"keydown",macKeydown);helper.dom.addEvent(_kbdInput,"keypress",macKeypress);helper.dom.addEvent(_kbdInput,"keyup",macKeyup);if(_IMEKeyboardAvailable){helper.dom.addEvent(_kbdInput,"compositionstart",compositionStart);helper.dom.addEvent(_kbdInput,"compositionupdate",compositionUpdate);helper.dom.addEvent(_kbdInput,"compositionend",compositionEnd)}_kbdInput.focus()}else{var attributes={"id":"kbdWindowsInput",
"value":"","tabindex":"0","autocapitalize":"off","autocorrect":"off","autocomplete":"off","spellcheck":"false","style":"color: #000; fontSize:12px; position: fixed; left: -2000px; top: 5px; overflow:hidden; width: 20px; height: 20px;outline:1px;"};try{if(window.top.document)attributes.autofocus=true}catch(error){}_kbdInput=helper.dom.appendJsonElement({"parentElement":_args.parentElement,"type":"textarea","attributes":function(){var a={"id":"kbdWindowsInput","value":"","tabindex":"0","autocapitalize":"off",
"autocorrect":"off","autocomplete":"off","spellcheck":"false","style":"color: #000; fontSize:12px; position: fixed; left: -2000px; top: 5px; overflow:hidden; width: 20px; height: 20px;outline:1px;"};if(attributes.autofocus&&!_args.properties.isCrossDomain)a.autofocus="autofocus";return a}(),"events":{"focus":function(e){fireEvent("focus",{...e,...{mac:false}})},"blur":function(e){e.mac=false;blur(e)}}});helper.dom.addEvent(_kbdInput,"keydown",keydown);helper.dom.addEvent(_kbdInput,"keypress",keypress);
helper.dom.addEvent(_kbdInput,"keyup",keyup);if(_IMEKeyboardAvailable){helper.dom.addEvent(_kbdInput,"compositionstart",compositionStart);helper.dom.addEvent(_kbdInput,"compositionupdate",compositionUpdate);helper.dom.addEvent(_kbdInput,"compositionend",compositionEnd)}}}function noDetectedkeyDown(kc){return _noKeyDown.find(function(item){return kc===item.key})}function isIMEKey(e){return(e.which||e.keyCode)==_IMEKeyCode}function setCaret(cmd){if(_args.properties.hookKeyboard&&_kbdInput){_kbdInput.focus();
_caret=cmd}}function eventIndex(list,kcode){for(var k=0;k<list.length;k++)if(kcode==list[k].keyCode)return k;return-1}function containsKey(kcode){var result=false;for(var i=0;i<_pressedKeys.length;i++)if(_pressedKeys[i].keyCode==kcode){result=true;break}return result}function popEvent(kcode){var resultEvent=null;var EvIdx=eventIndex(_pressedKeys,kcode);if(EvIdx>-1){resultEvent=_pressedKeys[EvIdx];_pressedKeys.splice(EvIdx,1);popEvent(kcode)}return resultEvent}function isPrintableKey(keyCode){return keyCode>=
33&&keyCode<=126||keyCode>=193&&keyCode<=248}function isFunctionKey(keyCode){return keyCode>=112&&keyCode<=123||keyCode>=33&&keyCode<=40||keyCode>=45&&keyCode<=46||keyCode>=16&&keyCode<=20||keyCode>=91&&keyCode<=93||keyCode==13||keyCode==9||keyCode==8||keyCode==27||keyCode==144||keyCode==12||keyCode==224||keyCode==32||keyCode==145}function isAphaNumericKey(keyCode){return keyCode>=48&&keyCode<=57||keyCode>=65&&keyCode<=90||keyCode>=97&&keyCode<=122}function isControlCharacter(keyCode){return keyCode>=
0&&keyCode<=31}function isEditFunction(currentEvent){return currentEvent.ctrlKey&&(currentEvent.keyCode==67||currentEvent.keyCode==86||currentEvent.keyCode==88)&&_args.clipboard?.enable}function isNumPadKey(keyCode){var numBloq=agentInfo.isMac?12:144;switch(keyCode){case numBloq:case 111:case 106:case 109:case 107:return true;break;default:return false}}function getKeyCode(e){var kcode=e.which||e.keyCode;if(!(productId=="thinrdp"&&!_args.properties.kbdUnicode))if(kcode>=96&&kcode<=105)kcode-=48;if(agentInfo.isFirefox==
true)if(typeof e.key!="undefined"&&e.key.toLowerCase()=="dead")kcode=0;else if(kcode==0&&e.key!=undefined)kcode=e.key.charCodeAt();return kcode}function getCharCode(e){var cc=0;if(e.key!=undefined&&e.key.toLowerCase()!="dead"){var _cc=e.key.charCodeAt();if(e.keyCode==0||e.keyCode!=_cc||_cc>=58&&_cc<=63)cc=_cc}return cc}function getKeyEvent(e){var keybinfo={"type":e.type,"altKey":e.altKey,"ctrlKey":e.ctrlKey,"charCode":e.charCode,"keyCode":e.keyCode,"which":e.which,"shiftKey":e.shiftKey,"metaKey":e.metaKey};
if(_args.properties.kbdLogKeys===true)if(agentInfo.isMac);try{fireEvent("keyboardEvent",keybinfo)}catch(error){helper.console.warning("'keyboardEvent' calling attached method fail. message: "+error.message,error,arguments)}}function buildKeyEvent(e){var modificators=null;if(e.getModifierState)modificators={"alt":e.getModifierState("Alt"),"graph":e.getModifierState("AltGraph"),"ctrl":e.getModifierState("Control"),"meta":e.getModifierState("Meta")||e.getModifierState("OS"),"shift":e.getModifierState("Shift"),
"capsLock":e.getModifierState("CapsLock"),"scrollLock":e.getModifierState("Scroll"),"numLock":e.getModifierState("NumLock"),"location":e.location};else modificators={"alt":e.altKey,"graph":e.altGraphKey,"ctrl":e.ctrlKey,"meta":e.metaKey,"shift":e.shiftKey,"location":e.location};var buildKeyEventResult={"keyCode":getKeyCode(e),"timeStamp":e.timeStamp,"mod":modificators};if(agentInfo.isFirefox==true&&!_args.properties.kbdUnicode&&!isFunctionKey(e.keyCode))buildKeyEventResult["charCode"]=getCharCode(e);
buildKeyEventResult.isIMEKey=isIMEKey(e);return buildKeyEventResult}function loadKeyData(e){var charCode=agentInfo.isOpera?e.which:agentInfo.isFirefox&&e.charCode==0&&e.key!=undefined?e.key.charCodeAt():e.charCode;var IsZero=(e.keyCode||0)==0&&(charCode||0)==0;_forceKeyPress=!(isFunctionKey(e.keyCode)&&e.keyCode!=32)&&!e.altKey&&!e.ctrlKey;if(IsZero)return;if(_forceKeyPress||e.type=="keydown"){if(e.type=="keydown"&&_currentEvent&&!_forceKeyPress)popEvent(_currentEvent.keyCode);if(e.type=="keydown")_currentEvent=
null;var currentEvent=buildKeyEvent(e);if(e.type=="keydown"||e.type=="keypress"&&!_currentEvent){if(!containsKey(currentEvent.keyCode)){currentEvent.type=e.type;_pressedKeys.push(currentEvent)}if(e.type=="keypress"&&!_currentEvent)_currentEvent=currentEvent}if((isFunctionKey(e.keyCode)||(e.altKey||e.ctrlKey)&&e.altKey!=e.ctrlKey)&&!_forceKeyPress||!_args.properties.kbdUnicode){if(!isEditFunction(e)){sendKey(currentEvent,"down");e.stopPropagation();e.preventDefault()}}else if(e.type=="keydown"||!_currentEvent){_currentEvent=
currentEvent;_currentEvent.waitForKeyPress=true}}if(e.type=="keypress"&&_currentEvent){if(productId=="ZSC"&&isNumPadKey(_currentEvent.keyCode)==true)charCode=0;_currentEvent.charCode=charCode;_currentEvent.type=e.type;sendKey(_currentEvent,"down");_currentEvent.waitForKeyPress=false;e.stopPropagation();e.preventDefault();_forceKeyPress=false;_lastCharCode=charCode}else if(e.type=="keydown"){_forceKeyPress=(e.keyCode||0)==0&&(charCode||0)==0||(_lastCharCode||0)==0;_lastKeyCode=e.keyCode;_lastCharCode=
charCode}else;}function releaseKeyData(e){if(_currentEvent&&e.keyCode==_currentEvent.keyCode&&_currentEvent.waitForKeyPress){if(productId=="virtualui"&&_currentEvent.type=="keydown"&&isAphaNumericKey(e.keyCode)){sendKey(_currentEvent,"down");sendKey(_currentEvent,"up")}else;popEvent(e.keyCode);return}var keyDownEvent=popEvent(getKeyCode(e));var _sendKeyup=true;if(!keyDownEvent){_sendKeyup=false;if(noDetectedkeyDown(e.keyCode)){keyDownEvent=e;_sendKeyup=true;sendKey(keyDownEvent,"down")}}if(_sendKeyup){sendKey(keyDownEvent,
"up");e.stopPropagation();e.preventDefault()}}function sendKey(kevent,action){if(_args.properties.onlyKeyCode)_args.methods.sendKey(kevent.keyCode||0,0,action,kevent.mod.location);else _args.methods.sendKey(kevent.keyCode||0,kevent.charCode||0,action,(kevent.mod||kevent)["location"])}function keydown(e){if(_args.methods.inputAllowed(e)){if(_IMEKeyboardAvailable){if(!_IMEKeyPressed)_IMEKeyPressed=isIMEKey(e);if(_IMEKeyPressed)return true}loadKeyData(e);getKeyEvent(e);if(e.keyCode==18){_heapKeys["18"]++;
if(agentInfo.isFirefox&&e.ctrlKey)_firefoxAltGr=true}if(e.keyCode==32&&e.altKey)blur(e)}}function keypress(e){if(_args.methods.inputAllowed(e)){if(_IMEKeyboardAvailable&&_IMEKeyPressed)return true;loadKeyData(e);getKeyEvent(e)}}function keyup(e){if(_args.methods.inputAllowed(e)){if(_IMEKeyboardAvailable&&_IMEKeyPressed)return true;if(_allowToSwitchApps==true&&(e.keyCode==37||e.keyCode==39)&&e.ctrlKey==true&&e.altKey==true){var value="next";if(e.keyCode==37)value="previous";changeAppFocus(value);e.preventDefault();
e.stopPropagation();return}releaseKeyData(e);_lastKeyCode=0;getKeyEvent(e);if(e.keyCode==18)_heapKeys["18"]--;if(_firefoxAltGr&&[17,18].indexOf(e.keyCode)!=-1&&_heapKeys["18"]>0){_firefoxAltGr=false;_heapKeys["18"]--;var keyUpEvent=popEvent(18);sendKey(keyUpEvent,"up")}}}function compositionStart(e){if(_IMEKeyPressed||agentInfo.isFirefox&&agentInfo.isWindows||agentInfo.isMac){if(!agentInfo.isMSIE)_kbdInput.value="";if(agentInfo.isMac)_IMEKeyPressed=true;if(_caret){var pos=_caret.r;var size=_caret.rc;
helper.style.add(_kbdInput,{"visibility":"visible","zIndex":9999999,"left":pos.l+3+"px","top":pos.t+24+"px","width":"150px","height":20+"px","color":"#000"});size=pos=null}else helper.style.add(_kbdInput,{"visibility":"visible","zIndex":9999999,"left":"0px","top":"0px","width":"150px","height":20+"px","color":"#000"})}}function compositionUpdate(e){if(agentInfo.isMac&&e.data.length==1&&_IMEKeyExceptions.indexOf(e.data)!=-1)helper.style.add(_kbdInput,{"visibility":"visible","zIndex":0,"left":"-2000px",
"color":"#fff"})}function compositionEnd(e){if(_IMEKeyPressed||agentInfo.isFirefox&&agentInfo.isWindows){helper.style.add(_kbdInput,{"visibility":"visible","zIndex":0,"left":"-2000px","color":"#fff"});_args.methods.sendText(e.data);_kbdInput.value="";if(agentInfo.isMac||agentInfo.isWindows&&agentInfo.isMSIE)setTimeout(function(){if(agentInfo.isMac)_kbdInput.value="";_IMEKeyPressed=false},50);else _IMEKeyPressed=false;_kbdInput.focus();if(agentInfo.isMSIE){_kbdInput.parentElement.removeChild(_kbdInput);
fireEvent("onHook",false);_kbdInput.focus()}}}function blur(e){for(var keyCode in _heapKeys)_heapKeys[keyCode]=0;for(var i=0;i<_pressedKeys.length;i++){var pk=_pressedKeys[i];_args.methods.sendKey(pk.keyCode,pk.charCode||0,"up",pk.mod?pk.mod.location:0)}_pressedKeys=[];fireEvent("blur",e)}function focus(e){_heapKeys["18"]=0}function isFirefoxCmdKey(e){var kcode=getKeyCode(e);if(_MAC_Firefox_CMD.isPressed==true&&(kcode==67||kcode==86||kcode==88||e.charCode==99||e.charCode==118||e.charCode==120))return true;
else return false}function updateMacCmd(value){_macCmd=value}function macKeydown(e){if(_args.methods.inputAllowed(e)){var eloc=e.originalEvent?e.originalEvent.keyLocation||e.originalEvent.location:0;if(_IMEKeyboardAvailable){if(!_IMEKeyPressed||e.keyCode>=32&&e.keyCode<=126)_IMEKeyPressed=isIMEKey(e);if(_IMEKeyPressed)return true}var eloc=e.originalEvent?e.originalEvent.keyLocation||e.originalEvent.location:0;if(e.metaKey==false&&_macCmd!=_MAC_CMD.RELEASED){_macCmd=_MAC_CMD.RELEASED;_args.methods.sendKey(91,
0,"up",eloc)}var kcode=getKeyCode(e);if(kcode==93||agentInfo.isFirefox==true&&kcode==224&&e.key=="Meta"){_MAC_Firefox_CMD.isPressed=agentInfo.isFirefox?true:false;kcode=18}if(agentInfo.isFirefox==true)if(isFirefoxCmdKey(e)==true){_MAC_Firefox_CMD.isCmd=true;return}else{_MAC_Firefox_CMD.isCmd=false;if(_MAC_Firefox_CMD.isPressed==true&&e.keyCode!=224){_heapKeys["18"]++;_args.methods.sendKey(18,0,"down",eloc)}}if(isFunctionKey(kcode)||(e.altKey||e.ctrlKey)&&e.altKey!=e.ctrlKey)if(kcode==91||kcode==93){updateMacCmd(_MAC_CMD.PRESSED);
_lastKeyCode=kcode;return}else{if(kcode==18&&e.keyCode!=93&&e.keyCode!=224&&e.key!="Meta"){_heapKeys["17"]++;_args.methods.sendKey(17,0,"down",eloc);_heapKeys["18"]++;_args.methods.sendKey(18,0,"down",eloc)}else if(kcode>=16&&kcode<=18&&agentInfo.isFirefox==false){_heapKeys[kcode.toString()]++;if(kcode==18&&agentInfo.isFirefox==false)_args.methods.sendKey(kcode,0,"down",eloc)}else if(kcode==9&&e.altKey==true){_args.methods.sendKey(18,0,"down",eloc);_args.methods.sendKey(9,0,"down",eloc);_args.methods.sendKey(9,
0,"up",eloc);_args.methods.sendKey(18,0,"up",eloc);e.stopPropagation();e.preventDefault();return false}if(_heapKeys["18"]>0&&_args.properties.kbdUnicode==true)_lastKeyCode=kcode;else if(kcode!=18){_args.methods.sendKey(kcode,0,"down",eloc);if(!(productId=="thinrdp"&&!_args.properties.kbdUnicode&&e.altKey&&[219,221].indexOf(kcode)!=-1)){e.stopPropagation();e.preventDefault()}}}else if(_lastKeyCode==18||_heapKeys["18"]>0){_args.methods.sendKey(kcode,0,"down",eloc);if(agentInfo.isFirefox==false)_args.methods.sendKey(kcode,
0,"up",eloc);e.stopPropagation();e.preventDefault()}if(!e.altKey)_lastKeyCode=kcode;_altKeyPressed=e.altKey;if(!isMacModKey(e)){var elem=document.getElementById("kbdMacInput");elem.IMEPressed=isIMEKey(e)&&!elem.IMEPressed}getKeyEvent(e)}}function isMacModKey(e){return agentInfo.isMac&&(e.keyCode==16||e.keyCode==17||e.keyCode==18)}function macKeypress(e){if(_args.methods.inputAllowed(e)){var eloc=e.originalEvent?e.originalEvent.keyLocation||e.originalEvent.location:0;if(_IMEKeyboardAvailable&&_IMEKeyPressed)return true;
if(_macCmd!=_MAC_CMD.RELEASED&&agentInfo.isMac==true&&(agentInfo.isFirefox==true||agentInfo.isSafari==true))if(e.keyCode==99||e.keyCode==120||e.keyCode==118)return true;else{e.stopPropagation();e.preventDefault();return false}if(agentInfo.isFirefox==true&&isFirefoxCmdKey(e)==true)return;var eloc=e.originalEvent?e.originalEvent.keyLocation||e.originalEvent.location:0;var charCode=agentInfo.isOpera?e.which:e.charCode;var kcode=getKeyCode(e);if(_macCmd==_MAC_CMD.PRESSED)if(kcode!=67&&kcode!=86&&kcode!=
88){_args.methods.sendKey(_lastKeyCode,0,"down",eloc);updateMacCmd(_MAC_CMD.SENT);if(_args.properties.onlyKeyCode)_args.methods.sendKey(_lastKeyCode,0,"down",eloc);else _args.methods.sendKey(_lastKeyCode,charCode,"down",eloc)}else updateMacCmd(_MAC_CMD.RELEASED);else if(!e.altKey&&!_altKeyPressed)if(kcode!=0&&isFunctionKey(_lastKeyCode)||e.ctrlKey){e.stopPropagation();e.preventDefault();getKeyEvent(e);return}if(kcode>=16&&kcode<=18)_heapKeys[kcode.toString()]++;if(_args.properties.onlyKeyCode)_args.methods.sendKey(_lastKeyCode,
0,"down",eloc);else{if(productId=="ZSC"&&isNumPadKey(_lastKeyCode)==true)charCode=0;_lastCharCode=charCode;_pressedKeys.push({"keyCode":_lastKeyCode,"charCode":charCode});_args.methods.sendKey(_lastKeyCode,charCode,"down",eloc)}e.stopPropagation();e.preventDefault();getKeyEvent(e)}}function macKeyup(e){function resetInput(elem){elem.value="XXXX";if(elem.setSelectionRange)elem.setSelectionRange(0,elem.value.length);else{var r=elem.createTextRange();r.collapse(true);r.moveEnd("character",0);r.moveStart("character",
elem.value.length);r.select()}}if(_args.methods.inputAllowed(e)){var eloc=e.originalEvent?e.originalEvent.keyLocation||e.originalEvent.location:0;if(_IMEKeyboardAvailable&&_IMEKeyPressed)return true;var keyCode=e.keyCode;var kcode=getKeyCode(e);if(keyCode==93||agentInfo.isFirefox==true&&kcode==224&&e.key=="Meta"){keyCode=18;_MAC_Firefox_CMD.isPressed=false;if(_MAC_Firefox_CMD.isCmd==true){_MAC_Firefox_CMD.isCmd=false;_heapKeys={};return}}if(_allowToSwitchApps==true&&(e.keyCode==37||e.keyCode==39)&&
e.ctrlKey==true&&e.altKey==true){var value="next";if(e.keyCode==37)value="previous";changeAppFocus(value);e.preventDefault();e.stopPropagation();return}var eloc=e.originalEvent?e.originalEvent.keyLocation||e.originalEvent.location:0;if(keyCode==91||keyCode==93){if(_macCmd==_MAC_CMD.PRESSED&&_lastKeyCode==keyCode){_args.methods.sendKey(keyCode,0,"down",eloc);_args.methods.sendKey(keyCode,0,"up",eloc)}else if(_macCmd>=_MAC_CMD.PRESSED)_args.methods.sendKey(keyCode,0,"up",eloc);updateMacCmd(_MAC_CMD.RELEASED)}else if(keyCode==
18&&e.keyCode!=93&&(e.keyCode!=224&&e.key!="Meta")){if(_heapKeys[keyCode.toString()]<=0){_args.methods.sendKey(17,0,"down",eloc);_heapKeys["17"]++;_args.methods.sendKey(keyCode,0,"down",eloc);_heapKeys[keyCode.toString()]++}for(var k=0;k<_heapKeys[keyCode.toString()];k++){_args.methods.sendKey(keyCode,0,"up",eloc);_args.methods.sendKey(17,0,"up",eloc)}_heapKeys["17"]=0;_heapKeys[keyCode.toString()]=0;_lastKeyCode=0}else if(keyCode>=16&&keyCode<=18){if(_heapKeys[keyCode.toString()]<=0){_args.methods.sendKey(keyCode,
0,"down",eloc);_heapKeys[keyCode.toString()]++}for(var k=0;k<_heapKeys[keyCode.toString()];k++)_args.methods.sendKey(keyCode,0,"up",eloc);_heapKeys[keyCode.toString()]=0}else if(this.value!="XXXX"&&!this.IMEPressed){var str=this.value.replace("XXXX","");resetInput(this);for(var i=0;i<str.length;++i){key=str.charCodeAt(i);_args.methods.sendKey(0,key,"down",eloc);_args.methods.sendKey(0,key,"up",eloc);if(_args.properties.kbdLogKeys===true)logDebug("sendkey down and up : "+key+" ("+key+") - IMEPressed : "+
this.IMEPressed)}_lastKeyCode=0}else{_altKeyPressed=false;if(_lastKeyCode==18&&kcode!=18){_heapKeys[18]--;_args.methods.sendKey(18,0,"up",eloc)}else if(e.altKey)resetInput(this);var pEvent=popEvent(kcode);if(helper.object.existsPath(pEvent,"charCode")==true)_lastCharCode=pEvent.charCode;else _lastCharCode=0;if(pEvent!=null||!(_IMEKeyCode==_lastKeyCode)&&kcode!=0)_args.methods.sendKey(kcode,_lastCharCode,"up",eloc);else helper.console.log(helper.string.format("Missing keyup: {0}, lastCode: {1}",kcode,
_lastCharCode),arguments);_lastKeyCode=0;_lastCharCode=0}e.stopPropagation();e.preventDefault();getKeyEvent(e)}}function setSelectionRange(){if(_kbdInput){if(_kbdInput.value=="")_kbdInput.value="XXXX";if(_kbdInput.setSelectionRange)_kbdInput.setSelectionRange(0,_kbdInput.value.length);else if(_kbdInput.createTextRange){var r=_kbdInput.createTextRange();r.collapse(true);r.moveEnd("character",0);r.moveStart("character",_kbdInput.value.length);r.select()}_kbdInput.focus()}}function setFocus(){if(!document.hasFocus())document.body.focus();
if(_kbdInput)setTimeout(()=>{_kbdInput.focus()},250)}function dispose(){if(_kbdInput){_kbdInput.parentElement.removeChild(_kbdInput);_kbdInput=null}}initialize();Object.defineProperty(_ref,"focus",{enumerable:true,configurable:false,writable:false,value:setFocus});Object.defineProperty(_ref,"caret",{enumerable:true,configurable:false,get:function(){return _caret}});Object.defineProperty(_ref,"setSelectionRange",{enumerable:true,configurable:false,writable:false,value:setSelectionRange});Object.defineProperty(_ref,
"value",{enumerable:true,configurable:false,get:function(){return _kbdInput.value},set:function(value){return _kbdInput.value=value}});Object.defineProperty(_ref,"dispose",{enumerable:true,configurable:false,writable:false,value:dispose});if(agentInfo.isMac)Object.defineProperty(_ref,"updateMacCmd",{enumerable:true,configurable:false,writable:false,value:updateMacCmd});Object.defineProperty(_ref,"inputElement",{enumerable:true,configurable:false,get:function(){return _kbdInput}});Object.defineProperty(_ref,
"active",{enumerable:true,configurable:false,get:function(){return _active},set:function(value){_active=value}});return _ref}try{Thinfinity!=undefined}catch(e){Thinfinity={}}if(Thinfinity.Driver===undefined)Thinfinity.Driver={};Thinfinity.Driver.Keyboard=DKeyboard;Object.defineProperty(Thinfinity.Driver.Keyboard,"MAC_CMD",{enumerable:true,configurable:false,get:function(){return _MAC_CMD}})})();
(function(){function DMouse(args,oInterface){var _ref=this;var _noop=()=>{return null};var _args={container:null,device:null,useDblClick:false,allowOverrideCursor:true,extra:{getElementFromPoint:_noop,preventDefault:_noop}};var _methods=null;var _properties=null;var _oInterface=null;var _mousePress={"down":0,"event":{"x":null,"y":null,"button":null},"pressTime":500,"currentTime":null,"threshold":agentInfo.isMobile?45:25};var _enumMousePressStatus={"RELEASED":0,"PRESSED":1,"SENT":2};var _doubleClickThreshold=
200;var _clickDistThreshold=10;var _lastDownDblClick=false;var _mobileClickCallback=null;var _buttonDown=null;var _upClick={timeout:null,cacheX:null,cacheY:null,cacheButton:null};var _downClick={timeout:null,cacheX:null,cacheY:null,cacheButton:null};var _mouseX=0;var _mouseY=0;var _pageX=0;var _pageY=0;var _cursorCanvas=null;var _mouseLeave=false;var _overrideCursor=null;var wheelsEventNames=["DOMMouseScroll","mousewheel"];var _isBorderButton=false;var moveCursorCanvas=null;var _mouseMoveAsync={"position":{"x":parseInt(window.environment.currentWidth/
2,10),"y":parseInt(window.environment.currentHeight/2,10)},enable:true};var fireEvent=null;var _defaultEventsProps={"async":false};var _defaultZIndex=500;var _mouseMask=null;var _mouseMaskEffect=null;var _effect=false;var isRequesting=false;var requestAnimation=_noop;var _displaySize=null;var _defaultDPI=96;var _delayedCurSync={lastTime:null,minTime:2E3,enabled:productId==="thinvnc"};var _requireUserInteractionAction=false;function initialize(){helper.object.parseAttributes(_args,args);fireEvent=
(new Thinfinity.Events({"owner":_ref,"events":_args.events})).fireEvent;_oInterface=oInterface;_methods=_oInterface.methods;_properties=_oInterface.properties;_displaySize=_args.device.display;_oInterface.on("setCursor",setCursor);_oInterface.on("drawCursor",drawCursor);_oInterface.on("resetCursor",resetCursor);_oInterface.on("hideCursor",hideCursor);_oInterface.on("removeCursor",removeCursorCanvas);_oInterface.on("overrideCursor",function(o,n){setOverrideCursor(_properties.overrideCursor)});_oInterface.on("playbackStart",
function(){if(_oInterface.properties.isServerControlMouse)createMouseMask()});_oInterface.on("requireUserInteractionAction",requireUserInteractionAction);if(agentInfo.isMSIE&&agentInfo.msieVersion>=9)wheelsEventNames.push("wheel");if(agentInfo.isMobile)helper.dom.addEvent(_args.container,"touchstart",onTouchStartMobile,{"passive":false});helper.dom.addEvent(_args.container,wheelsEventNames,wheel,{"passive":false});helper.dom.addEvent(_args.container,"mousedown",onTouchStart,{"passive":false});helper.dom.addEvent(document,
"click",onDocumentClick,{"passive":false});helper.dom.addEvent(_args.container,"mouseup",onTouchEnd,{"passive":false});helper.dom.addEvent(_args.container,"mousemove",onTouchMove,{"passive":false});helper.dom.addEvent(_args.container,"mouseleave",onTouchLeave,{"passive":false});helper.dom.addEvent(_args.container,"mouseenter",onMouseEnter,{"passive":false});if(_properties.mousePressAsRightButton){helper.dom.addEvent(_args.container,"touchstart",onTouchDeviceStart,{"passive":true});helper.dom.addEvent(_args.container,
"touchmove",onTouchDeviceMove,{"passive":true});helper.dom.addEvent(_args.container,"touchend",onTouchDeviceEnd,{"passive":true})}requestAnimation=agentInfo.isMobile?window.requestAnimationFrame:helper.animationFrame.request;if(!_properties.overrideCursor)moveCursorCanvas=moveCursorCanvas_async;else moveCursorCanvas=function(){};setOverrideCursor(_properties.overrideCursor);if(agentInfo.isTouch){_oInterface.on("mouseMove",mouseMove);_oInterface.on("mouseDown",mouseDown);_oInterface.on("mouseUp",mouseUp)}}
function createMouseMask(){if(!_mouseMask)_mouseMask=helper.dom.appendJsonElement({parentElement:_args.container,type:"div",attributes:{id:"mouseMask",class:"clickEffect noTransition hidden",style:""}})}function requireUserInteractionAction(e){_requireUserInteractionAction=true}function dispatchUserInteractionGesture(e){_requireUserInteractionAction=false;_oInterface.__prototype__.fireEvent("userInteractionAction",e,{async:false})}function setCursor(o){let t=typeof o;if(t==="object")if(_properties.overrideCursor){_args.container.originalImage=
o;if(_properties.cursorVisible)_args.container.style.cursor=o.url;else _args.container.style.cursor="none";if(agentInfo.isSafari)_currentCursor.check()}else{_args.container.style.cursor="none";if(!_cursorCanvas)_cursorCanvas=createCursorCanvas(o);updateCursorCanvas(_cursorCanvas,o)}else if(_properties.overrideCursor)_args.container.style.cursor=o;else if(_cursorCanvas)if(["visible","hidden"].indexOf(o)!==-1)_cursorCanvas.style.visibility=o;else _cursorCanvas.style.display=o}function resetCursor(){if(_properties.overrideCursor){if(_args.container.style.cursor===
"none"&&_args.container.originalImage!=="")_args.container.style.cursor=_args.container.originalImage.cursor}else{if(_cursorCanvas)delete _cursorCanvas.mask;_cursorCanvas=null}}function drawCursor(item,imgpart){item.draw(_cursorCanvas.canvas.context,imgpart.x,imgpart.y)}function hideCursor(){if(_properties.overrideCursor)_args.container.style.cursor="none";else if(_cursorCanvas)_cursorCanvas.style.visibility="hidden"}function removeCursorCanvas(){if(_cursorCanvas){delete _cursorCanvas.mask;_cursorCanvas.innerHTML=
"";try{_args.container.removeChild(_cursorCanvas)}catch(err){}_cursorCanvas=null}}function createCursorCanvas(win){let hwnd=win.hwnd||0;let id=productId+"_canvas_"+hwnd;let div=document.getElementById(id);if(!div){div=document.createElement("div");div.style.position="absolute";div.style.display="inline-block"}if(!win.parent){if(!div.canvas){let canvas=document.createElement("canvas");canvas.style.left="0px";canvas.style.top="0px";canvas.width=win.width;canvas.height=win.height;canvas.style.position=
"absolute";canvas.style.zIndex=1;canvas.style.width=win.width;canvas.style.height=win.height;canvas.hwnd=hwnd;div.canvas=canvas;div.appendChild(canvas)}if(!div.canvas.context)div.canvas.context=div.canvas.getContext("2d",{willReadFrequently:true})}div.style.pointerEvents="none";var strValue="translateZ(0)";if(typeof div.style.msTransform!="undefined")div.style.msTransform=strValue;else if(typeof div.style.MozTransform!="undefined")div.style.MozTransform=strValue;else if(typeof div.style.OTransform!=
"undefined")div.style.OTransform=strValue;else if(typeof div.style.WebkitTransform!="undefined")div.style.WebkitTransform=strValue;div.id=id;if(helper.object.validate(win.parent)&&win.parent!=0){div.parent=win.parent;let parentDiv=document.getElementById(productId+"_canvas_"+win.parent);if(parentDiv)parentDiv.appendChild(div);else{div.style.display="none";div.style.visibility="hidden";_args.container.appendChild(div)}}else _args.container.appendChild(div);return div}function updateCursorCanvas(div,
win){if(win){let w=typeof win.width!=="undefined"&&win.width>0?win.width:win?.src?.width&&win.src.width>0?win.src.width:null;let h=typeof win.height!=="undefined"&&win.height>0?win.height:win?.src?.height&&win.src.height>0?win.src.height:null;let hx=win.dx||win.x||0;let hy=win.dy||win.y||0;if(w==null||h==null)return;div.style.zIndex=_properties.baseZIndex+(win.zidx||_defaultZIndex)*10;div.width=w;div.height=h;div.style.width=w+"px";div.style.height=h+"px";let cu=_properties.CUEnabled;if(w==0||h==
0){div.style.visibility="hidden";div.style.display="none"}else{if(cu||typeof win.imgs!="undefined")div.canvas.context.clearRect(0,0,w,h);if(!_properties.isServerControlMouse)if(!_properties.overrideCursor&&_mouseLeave&&productId!=="thinvnc")div.style.visibility="hidden";else{div.style.display="block";div.style.visibility="visible"}if(w!=div.canvas.width){div.canvas.width=w;div.canvas.style.width=w+"px";div.width=w;div.style.width=w+"px"}if(h!=div.canvas.height){div.canvas.height=h;div.canvas.style.height=
h+"px";div.height=h;div.style.height=h+"px"}if(win.src)if(cu)div.canvas.context.drawImage(win.src,0,0,w,h);else div.canvas.context.drawImage(win.src,hx,hy,w,h)}if(typeof win.className!="undefined")div.className=win.className;let canvas=div.canvas;if(!win.parent)canvas.style.pointerEvents="none";if(typeof hx!="undefined"){div.hotspotX=hx;div.hotspotY=hy;let x=win.left+hx;let y=win.top+hy;if(win.dpi){let s=_defaultDPI/win.dpi;_cursorCanvas.style.transform=`scale(${s})`;x*=s;y*=s;hy/=s;hx/=s}div.canvas.style.top=
-hy+"px";div.canvas.style.left=-hx+"px";if(!_delayedCurSync.enabled||Date.now()-_delayedCurSync.lastTime>_delayedCurSync.minTime){div.style.top=y+"px";div.style.left=x+"px"}}}}function createCache(timer,x,y,button){return{timeout:timer,cacheX:x,cacheY:y,cacheButton:button}}function clearCacheUp(){window.clearTimeout(_upClick.timeout);_upClick=createCache(null,null,null,null)}function clearCacheDown(){window.clearTimeout(_downClick.timeout);_downClick=createCache(null,null,null,null)}function singleClickUp(){cd=
_upClick;_methods.sendMouse(cd.cacheX,cd.cacheY,cd.cacheButton,"up");if((agentInfo.isMobile||agentInfo.isTabletMode)&&_mobileClickCallback){_mobileClickCallback(cd.cacheX,cd.cacheY,cd.cacheButton,"down");if(agentInfo.isTabletMode)_mobileClickCallback=null}clearCacheUp()}function singleClickDown(){cd=_downClick;_methods.sendMouse(cd.cacheX,cd.cacheY,cd.cacheButton,"down");clearCacheDown()}function sendMouse(X,Y,button,command){_delayedCurSync.lastTime=Date.now();if(command=="down"){if(_buttonDown!=
null)sendMouse(X,Y,_buttonDown,"up");_buttonDown=button}else if(command=="up")_buttonDown=null;if(_properties.mouseBufferAvailable===true)alert("Buffer mouse is not working");else if(!_args.useDblClick)_methods.sendMouse(X,Y,button,command);else if(command=="down"){var dist=Math.sqrt((_downClick.cacheX-X)*(_downClick.cacheX-X)+(_downClick.cacheY-Y)*(_downClick.cacheY-Y));if(_downClick.cacheButton==button&&_downClick.timeout&&dist<_clickDistThreshold){window.clearTimeout(_downClick.timeout);window.clearTimeout(_upClick.timeout);
if(productId=="ZSC"){_downClick.cacheX=X;_downClick.cacheY=Y;_lastDownDblClick=false;_downClick.cacheButton=0;_upClick.cacheButton=0;singleClickDown();singleClickUp()}_downClick.cacheX=X;_downClick.cacheY=Y;_downClick.cacheButton|=4;_upClick.cacheButton|=4;_lastDownDblClick=true;singleClickDown()}else if(_downClick.cacheButton!=button||dist>_clickDistThreshold){if(_downClick.timeout){window.clearTimeout(_downClick.timeout);singleClickDown()}_downClick=createCache(window.setTimeout(singleClickDown,
_doubleClickThreshold),X,Y,button)}}else if(command=="up"){var dist=Math.sqrt((_upClick.cacheX-X)*(_upClick.cacheX-X)+(_upClick.cacheY-Y)*(_upClick.cacheY-Y));if(_lastDownDblClick){_upClick.cacheX=X;_upClick.cacheY=Y;_lastDownDblClick=false;singleClickUp()}else if(_upClick.cacheButton!=button||dist>_clickDistThreshold){if(_upClick.timeout){window.clearTimeout(_upClick.timeout);singleClickUp()}_upClick=createCache(window.setTimeout(singleClickUp,_doubleClickThreshold),X,Y,button)}}else logError("sendMouse received unexpected command: "+
command)}function checkRemotePointer(x,y){if(_cursorCanvas){let aw=0,ah=0,th=4;if(agentInfo.isMobile){aw=_displaySize.width;ah=_displaySize.height;th=0}else{aw=window.environment.availWidth;ah=window.environment.availHeight}aw*=_properties.zoomFactor;ah*=_properties.zoomFactor;if(_mouseLeave&&!_properties.overrideCursor||(_args.container.style.cursor!="default"&&x<=th||x>=aw-th||y>=ah-th)){if(_args.container.style.cursor!="default")_args.container.style.cursor="default";if(_cursorCanvas.style.visibility===
"visible"&&!_properties.isServerControlMouse)_cursorCanvas.style.visibility="hidden"}else if(!_mouseLeave&&!_isBorderButton&&!_properties.overrideCursor&&_args.container.style.cursor!="none"&&productId!="ZSC"){_args.container.style.cursor="none";if(_cursorCanvas.style.visibility!=="visible")_cursorCanvas.style.visibility="visible"}}}function domElementOnTop(){var onTop=false;var elems=document.querySelectorAll(".blockUI.blockMsg.blockElement:not(.hidden), .systemPopup.systemDlg:not(.hidden)");var e=
0;while(!onTop&&e<elems.length){if(helper.style.getComputedStyle(elems[e],"display")!="none")onTop=true;e++}return onTop}function findPos(obj){var curleft=0;var curtop=0;do{curleft+=obj.offsetLeft;curtop+=obj.offsetTop}while(obj=obj.offsetParent);return[curleft,curtop]}function mouseDown(x,y,button){var e=arguments&&arguments.length>3?arguments[3]:null;if(!(agentInfo.isWindows&&agentInfo.isMSIE))_oInterface.__prototype__.fireEvent("setText",String.fromCharCode(32));if(!window.hasFocus)window.focus();
if(!document.hasFocus())document.body.focus();if(_properties.active&&_properties.mouseControl){var position=findPos(_args.container);var left=position[0];var top=position[1];if((agentInfo.isMobile==true||agentInfo.isTabletMode&&e&&_allowedTouchEvents.indexOf(e.type)!=-1)&&productId=="ZSC"){_mouseX=Math.round(x);_mouseY=Math.round(y)}else{var scale=_properties.scale;_mouseX=Math.round((x-left)/scale);_mouseY=Math.round((y-top)/scale)}sendMouse(_mouseX,_mouseY,button,"down");fireEvent("mouseDown",{x:_mouseX,
y:_mouseY,button:button},_defaultEventsProps)}if(_requireUserInteractionAction)dispatchUserInteractionGesture()}function mouseUp(x,y,button){var e=arguments&&arguments.length>3?arguments[3]:null;if(_properties.active&&_properties.mouseControl){var position=findPos(_args.container);var left=position[0];var top=position[1];if((agentInfo.isMobile==true||agentInfo.isTabletMode&&e&&_allowedTouchEvents.indexOf(e.type)!=-1)&&productId=="ZSC"){_mouseX=Math.round(x);_mouseY=Math.round(y)}else{var scale=_properties.scale;
_mouseX=Math.round((x-left)/scale);_mouseY=Math.round((y-top)/scale)}sendMouse(_mouseX,_mouseY,button,"up");fireEvent("mouseUp",{x:_mouseX,y:_mouseY,button:button},_defaultEventsProps)}}function mouseMove(x,y){if(_properties.active&&_properties.mouseControl){let position=findPos(_args.container);let left=position[0];let top=position[1];if(x<left)x=left;if(y<top)y=top;let zoomFactor=_properties.zoomFactor;let scale=_properties.scale;let mx=left+_displaySize.width*zoomFactor*scale;let my=top+_displaySize.height*
zoomFactor*scale;if(x>mx)x=mx;if(y>my)y=my;_mouseX=Math.round((x-left)/scale);_mouseY=Math.round((y-top)/scale);sendMouse(_mouseX,_mouseY,null,"move");moveCursorCanvas(x,y)}}function onMouseEnter(e){_mouseLeave=false;if(_properties.cursorVisible)if(!_properties.overrideCursor){if(_cursorCanvas){if(_cursorCanvas.style.visibility==="hidden")_cursorCanvas.style.visibility="visible";if(_cursorCanvas.style.display!=="block")_cursorCanvas.style.display="block";if(_args.container.style.cursor!=="none")_args.container.style.cursor=
"none"}}else _args.container.style.cursor=_args.container.originalImage?_args.container.originalImage.cursor:"default"}function onTouchDeviceStart(e){if(_properties.isServerControlMouse||!_properties.allowMouseCapture)return;var x=(e.changedTouches||e.touches)[0].pageX;var y=(e.changedTouches||e.touches)[0].pageY;_mousePress.down=_enumMousePressStatus.PRESSED;_mousePress.event.x=x;_mousePress.event.y=y;_mousePress.event.button=e.button;_mousePress.currentTime=(new Date).getTime()}function onTouchDeviceMove(e){if(_mousePress.down===
_enumMousePressStatus.PRESSED){if(_properties.isServerControlMouse||!_properties.allowMouseCapture)return;var x=typeof e.pageX!="undefined"?e.pageX:(e.changedTouches||e.touches)[0].pageX;var y=typeof e.pageY!="undefined"?e.pageY:(e.changedTouches||e.touches)[0].pageY;if(!isInsideOfArea(x-_mousePress.event.x,y-_mousePress.event.y,_mousePress.threshold))_mousePress.down=_enumMousePressStatus.RELEASED}}function onTouchDeviceEnd(e){if(_mousePress.down===_enumMousePressStatus.PRESSED){if(_properties.isServerControlMouse||
!_properties.allowMouseCapture)return;var button=2;if((new Date).getTime()-_mousePress.currentTime>_mousePress.pressTime){mouseDown(_pageX,_pageY,button);mouseUp(_pageX,_pageY,button)}}_mousePress.down=_enumMousePressStatus.RELEASED}function isInsideOfArea(x,y,rad){return Math.pow(x,2)+Math.pow(y,2)<=rad}function onDocumentClick(e){if(!document.hasFocus())fireEvent("documentClick",{},_defaultEventsProps)}function isTouchSource(e){return e?.sourceCapabilities?.firesTouchEvents===true}function onTouchStart(e){if(!_properties.allowMouseCapture||
_properties.isServerControlMouse||isTouchSource(e)||_args.extra.preventDefault(e)||!_properties.hookMouse&&agentInfo.isMobile)return;var overrideCursor=_properties.overrideCursor;if(domElementOnTop()){if(!overrideCursor&&_cursorCanvas&&_cursorCanvas.style.visibility==="visible")_cursorCanvas.style.visibility="hidden";return}else if(!overrideCursor&&_cursorCanvas&&_cursorCanvas.style.visibility==="hidden")_cursorCanvas.style.visibility="visible";var elem=_args.extra.getElementFromPoint(e);var evt=
null;if(elem){if(agentInfo.isMSIE){if(elem.switchMouseCursor!==false){evt=e.srcElement||e.target;if(evt)evt.style.cursor="default";if(_cursorCanvas&&_cursorCanvas.style.visibility==="visible")_cursorCanvas.style.visibility="hidden";if(!overrideCursor){_args.container.style.cursor="default";_cursorCanvas.canvas.style.cursor="default"}}}else if(elem.style.cursor!="none"&&_cursorCanvas&&_cursorCanvas.style.visibility==="visible")_cursorCanvas.style.visibility="hidden";return}else if(agentInfo.isMSIE&&
agentInfo.msieVersion<=10){evt=e.srcElement||e.target;if(evt)if(!overrideCursor&&productId!=="ZSC"&&(productId!=="thinrdp"||evt.style.cursor!==""&&evt.style.cursor!=="default"))evt.style.cursor="none"}else if(_cursorCanvas&&_cursorCanvas.style.visibility==="hidden")_cursorCanvas.style.visibility="visible";if(agentInfo.isMobile&&isTouchEvent(e)){var X,Y;if(productId==="ZSC"){X=serverMouseX(e,false);Y=serverMouseY(e,false)}else{X=(e.changedTouches||e.touches)[0].pageX;Y=(e.changedTouches||e.touches)[0].pageY}_pageX=
X;_pageY=Y;if((e.changedTouches||e.touches).length==1){var button=0;moveCursorCanvas(X,Y);mouseDown(X,Y,button)}else{var button=2;mouseDown(X,Y,button);mouseUp(X,Y,button)}}else{var pageX=agentInfo.isMobile?getMobileMouseLocationX(e):e.pageX;var pageY=agentInfo.isMobile?getMobileMouseLocationY(e):e.pageY;_pageX=pageX;_pageY=pageY;var button=e.button||0;_mousePress.down=_enumMousePressStatus.RELEASED;if(_properties.mousePressAsRightButton&&button<2){_mousePress.down=_enumMousePressStatus.PRESSED;_mousePress.event.x=
_pageX;_mousePress.event.y=_pageY;_mousePress.event.button=button;_mousePress.currentTime=(new Date).getTime()}else mouseDown(pageX,pageY,button)}if(e.preventDefault)e.preventDefault()}function onTouchMove(e){if(!_properties.allowMouseCapture||_properties.isServerControlMouse||isTouchSource(e)||_args.extra.preventDefault(e)||!_properties.hookMouse&&agentInfo.isMobile)return;var overrideCursor=_properties.overrideCursor;if(!overrideCursor)if(domElementOnTop()){if(_cursorCanvas&&_cursorCanvas.style.visibility!=
"hidden"){_cursorCanvas.style.visibility="hidden";if(_args.container.style.cursor==="none")_args.container.style.cursor="default"}return}else if(!_mouseLeave&&!_isBorderButton){if(_args.container.style.cursor!=="none"&&productId!=="ZSC")_args.container.style.cursor="none";if(_cursorCanvas&&_cursorCanvas.style.visibility=="hidden")_cursorCanvas.style.visibility="visible"}_isBorderButton=false;if(!overrideCursor){var elem=_args.extra.getElementFromPoint(e);if(elem)if(agentInfo.isMSIE){if(elem.switchMouseCursor!==
false){var evt=e.srcElement||e.target;if(evt)evt.style.cursor="default";if(_cursorCanvas&&_cursorCanvas.style.visibility==="visible")_cursorCanvas.style.visibility="hidden";_args.container.style.cursor="default";_cursorCanvas.canvas.style.cursor="default";return}}else if(elem.className.indexOf("borderButton")!=-1){_isBorderButton=true;if(_properties.cursorVisible){if(_args.container.style.cursor!="default")_args.container.style.cursor="default";if(_cursorCanvas.style.display!=="none")_cursorCanvas.style.display=
"none"}}else{if(elem.style.cursor!="none"){if(_cursorCanvas&&_cursorCanvas.style.visibility==="visible")_cursorCanvas.style.visibility="hidden";return}}else if(agentInfo.isMSIE){if(!overrideCursor){if(_cursorCanvas){if(_mouseLeave){_cursorCanvas.style.display="block";_mouseLeave=false}if(_cursorCanvas.style.visibility==="hidden")_cursorCanvas.style.visibility="visible"}if(productId!="ZSC"&&_args.container.style.cursor!=="none")_args.container.style.cursor="none"}if(agentInfo.msieVersion<=10){var evt=
e.srcElement||e.target;if(evt)if(productId!="ZSC"&&(productId!="thinrdp"||evt.style.cursor!=""&&evt.style.cursor!="default"))evt.style.cursor="none"}}else{if(_properties.cursorVisible&&_cursorCanvas&&_cursorCanvas.style.display==="none")_cursorCanvas.style.display="block";if(_cursorCanvas&&_cursorCanvas.style.visibility==="hidden")_cursorCanvas.style.visibility="visible"}}if(!_methods.inputAllowed())return;_pageX=typeof e.pageX!="undefined"?agentInfo.isMobile?getMobileMouseLocationX(e):e.pageX:(e.changedTouches||
e.touches)[0].pageX;_pageY=typeof e.pageY!="undefined"?agentInfo.isMobile?getMobileMouseLocationY(e):e.pageY:(e.changedTouches||e.touches)[0].pageY;var waitForPress=false;if(_properties.mousePressAsRightButton&&_mousePress.down===_enumMousePressStatus.PRESSED){waitForPress=true;if(!isInsideOfArea(_pageX-_mousePress.event.x,_pageY-_mousePress.event.y,_mousePress.threshold)){mouseDown(_mousePress.event.x,_mousePress.event.y,_mousePress.event.button);_mousePress.down=_enumMousePressStatus.SENT;waitForPress=
false}}var currentX=serverMouseX(e,false);var currentY=serverMouseY(e,false);var pageX=agentInfo.isMobile?getMobileMouseLocationX(e):e.pageX;var pageY=agentInfo.isMobile?getMobileMouseLocationY(e):e.pageY;if(_mouseX!=currentX||_mouseY!=currentY){_mouseX=currentX;_mouseY=currentY;if(!waitForPress){let _pos=null;if(agentInfo.isMobile&&isTouchEvent(e))_pos={x:(e.changedTouches||e.touches)[0].pageX,y:(e.changedTouches||e.touches)[0].pageY};else _pos={x:pageX,y:pageY};mouseMove(_pos.x,_pos.y)}}}function onTouchEnd(e){if(!_properties.allowMouseCapture||
_properties.isServerControlMouse||isTouchSource(e)||_args.extra.preventDefault(e)||!_properties.hookMouse&&agentInfo.isMobile)return;if(!_properties.overrideCursor)if(domElementOnTop()){if(_cursorCanvas&&_cursorCanvas.style.visibility==="visible")_cursorCanvas.style.visibility="hidden";return}else if(_cursorCanvas&&_cursorCanvas.style.visibility==="hidden")_cursorCanvas.style.visibility="visible";_pageX=typeof e.pageX!="undefined"?agentInfo.isMobile?getMobileMouseLocationX(e):e.pageX:(e.changedTouches||
e.touches)[0].pageX;_pageY=typeof e.pageY!="undefined"?agentInfo.isMobile?getMobileMouseLocationY(e):e.pageY:(e.changedTouches||e.touches)[0].pageY;var button=agentInfo.isMobile&&isTouchEvent(e)?0:e.button||0;var sendDeferredTime=0;if(_properties.mousePressAsRightButton&&_mousePress.down===_enumMousePressStatus.PRESSED){sendDeferredTime=25;if((new Date).getTime()-_mousePress.currentTime>_mousePress.pressTime)button=2;mouseDown(_mousePress.event.x,_mousePress.event.y,button);_mousePress.down=_enumMousePressStatus.SENT}setTimeout(function(x,
y,btn){mouseUp(x,y,btn)},sendDeferredTime,_pageX,_pageY,button);if(e.preventDefault)e.preventDefault()}function onTouchLeave(e){_mouseLeave=true;if(!_properties.allowMouseCapture||_properties.isServerControlMouse||isTouchSource(e)||_args.extra.preventDefault(e)||!_properties.hookMouse&&agentInfo.isMobile)return;var x=typeof e.pageX!="undefined"?agentInfo.isMobile?getMobileMouseLocationX(e):e.pageX:(e.changedTouches||e.touches)[0].pageX;var y=typeof e.pageY!="undefined"?agentInfo.isMobile?getMobileMouseLocationY(e):
e.pageY:(e.changedTouches||e.touches)[0].pageY;if(agentInfo.isMobile&&(productId=="virtualui"||productId=="thinrdp"||productId=="thinvnc"));else if(productId!="thinvnc"&&_cursorCanvas)_cursorCanvas.style.display="none";if(!_properties.overrideCursor){var efp=_args.extra.getElementFromPoint(e);if(efp&&efp.switchMouseCursor!==false){if(_cursorCanvas)_cursorCanvas.style.display="none";_args.container.style.cursor="default";efp=null}}if(_buttonDown!=null&&(x<5||y<5||x>$(_args.container).width()-5||y>
$(_args.container).height()-5)){_pageX=x;_pageY=y;mouseUp(_pageX,_pageY,_buttonDown);if(e.preventDefault)e.preventDefault()}else{let scale=_properties.scale;let fp=findPos(_args.container);if(x<0)x=0;else{let maxX=(_args.container.offsetWidth+fp[0])*scale;if(x>maxX)x=maxX}if(y<0)y=0;else{let maxY=(_args.container.offsetHeight+fp[1])*scale;if(y>maxY)y=maxY}mouseMove(x,y)}}function getMobileMouseLocationX(e){return e.pageX+_args.container.scrollLeft*_properties.zoomFactor}function getMobileMouseLocationY(e){return e.pageY+
_args.container.scrollTop*_properties.zoomFactor}function wheel(event){if(event.ctrlKey&&helper.object.getValue(self,"clientSettings.MouseWheelZoom",false))return true;var obj=_args.extra.getElementFromPoint(event);if(!obj){var offset=$(_args.container).offset();var s=_properties.scale;if(event.pageX>=offset.left&&event.pageX<=offset.left+$(_args.container).width()*s&&event.pageY>=offset.top&&event.pageY<=offset.top+$(_args.container).height()*s){var delta=0;var axis="y";if(!event)event=window.event;
if(typeof event.wheelDelta!="undefined"){delta=event.wheelDelta;if(typeof event.wheelDeltaY!="undefined")axis=Math.abs(event.wheelDeltaX)>Math.abs(event.wheelDeltaY)&&Math.abs(event.wheelDeltaX)>Math.abs(event.wheelDeltaZ)?"x":Math.abs(event.wheelDeltaY)>Math.abs(event.wheelDeltaZ||0)?"y":"z";if(agentInfo.isOpera)delta=-delta}else if(typeof event.delta!="undefined"){delta=event.delta;axis=Math.abs(event.deltaX)>Math.abs(event.deltaY)&&Math.abs(event.deltaX)>Math.abs(event.deltaZ)?"x":Math.abs(event.deltaY)>
Math.abs(event.deltaZ||0)?"y":"z"}else if(agentInfo.isMSIE&&typeof event.deltaX!="undefined"&&typeof event.deltaY!="undefined")if(event.deltaX!=0){delta=event.deltaX;axis="x"}else{delta=-event.deltaY;axis="y"}else if(typeof event.detail!="undefined"){delta=event.detail*-120;axis=event.axis==1?"x":event.axis==2?"y":"z"}if(!agentInfo.isMac){delta=Math[delta>0?"ceil":"floor"](delta/120)*120;if(delta>120)delta=120;else if(delta<-120)delta=-120}if(delta)if(axis=="y")_methods.sendWheel(delta,0);else{if(!agentInfo.isMSIE)delta=
-delta;_methods.sendWheel(0,delta)}event.stopPropagation();event.preventDefault()}}}function serverMouseX(e){var position=findPos(_args.container);var left=position[0];var scale=_properties.scale;if((agentInfo.isMobile||agentInfo.isTabletMode&&_allowedTouchEvents.indexOf(e.type)!=-1)&&isTouchEvent(e))return Math.floor(((e.changedTouches||e.touches)[0].pageX-left)/scale);else return Math.floor((e.pageX-left)/scale)}function serverMouseY(e){var position=findPos(_args.container);var top=position[1];
var scale=_properties.scale;if((agentInfo.isMobile||agentInfo.isTabletMode&&_allowedTouchEvents.indexOf(e.type)!=-1)&&isTouchEvent(e))return Math.floor(((e.changedTouches||e.touches)[0].pageY-top)/scale);else return Math.floor((e.pageY-top)/scale)}function isTouchEvent(e){e=e.originalEvent||e;if(e&&(e.changedTouches||e.touches)&&(e.changedTouches||e.touches).length>0)return true;return false}function onTouchStartMobile(e){e.preventDefault()}function moveCursorCanvas_sync(x,y,effect){if(!!_cursorCanvas){var position=
findPos(_args.container);var scale=_properties.scale;var cX=Math.round((x-position[0])/scale);var cY=Math.round((y-position[1])/scale);mouseCanvasX=cX;mouseCanvasY=cY;if(_cursorCanvas.style.left!=cX+"px"||_cursorCanvas.style.top!=cY+"px"){_cursorCanvas.style.left=cX+"px";_cursorCanvas.style.top=cY+"px";if(_properties.remotePointer&&!_properties.isServerControlMouse)checkRemotePointer(x,y)}if(_mouseMask&&effect){clearTimeout(_mouseMaskEffect);_mouseMask.style.left=mouseCanvasX+"px";_mouseMask.style.top=
mouseCanvasY+"px";helper.style.replace(_mouseMask,"hidden","runAnimation");_mouseMaskEffect=setTimeout(()=>{helper.style.replace(_mouseMask,"runAnimation","hidden")},200)}}}function mouseMoveCanvas_AnimationFrame(){if(!!_cursorCanvas&&(_mouseMoveAsync.position.x!=_cursorCanvas.rawLeft||_mouseMoveAsync.position.y!=_cursorCanvas.rawTop)){var position=findPos(_args.container);var scale=_properties.scale;var cX=Math.round((_mouseMoveAsync.position.x-position[0])/scale);var cY=Math.round((_mouseMoveAsync.position.y-
position[1])/scale);mouseCanvasX=cX;mouseCanvasY=cY;_cursorCanvas.rawLeft=_mouseMoveAsync.position.x;_cursorCanvas.rawTop=_mouseMoveAsync.position.y;_cursorCanvas.style.left=mouseCanvasX+"px";_cursorCanvas.style.top=mouseCanvasY+"px";if(_mouseMask&&_effect){clearTimeout(_mouseMaskEffect);_mouseMask.style.left=mouseCanvasX+"px";_mouseMask.style.top=mouseCanvasY+"px";helper.style.replace(_mouseMask,"hidden","runAnimation");_mouseMaskEffect=setTimeout(()=>{helper.style.replace(_mouseMask,"runAnimation",
"hidden")},150)}if(_properties.remotePointer)checkRemotePointer(_mouseMoveAsync.position.x,_mouseMoveAsync.position.y);_oInterface.__prototype__.fireEvent("onMouseAnimationFrameEnd")}if(!isRequesting){isRequesting=true;requestAnimation(()=>{isRequesting=false;mouseMoveCanvas_AnimationFrame()})}}function moveCursorCanvas_async(x,y){if(!!_cursorCanvas)_mouseMoveAsync.position={"x":x,"y":y}}function moveCursorCanvasExternal(x,y,effect){if(!!_cursorCanvas){if(_cursorCanvas.style.display!=="block"){_cursorCanvas.style.display=
"block";_cursorCanvas.style.visibility="visible"}let position=findPos(_args.container);let scale=_properties.scale;if(!_effect)_effect=effect;x=Math.round(x*scale+position[0]);y=Math.round(y*scale+position[1]);if(_mouseMoveAsync.enable)_mouseMoveAsync.position={x,y,effect};else moveCursorCanvas(x,y,effect)}}function setOverrideCursor(value){if(_args.allowOverrideCursor&&_overrideCursor!=value){_overrideCursor=value;if(_overrideCursor){moveCursorCanvas=function(){};if(helper.object.existsPath(_args.container,
"originalImage.cursor"))helper.style.add(_args.container,{"cursor":_args.container.originalImage.cursor});if(_cursorCanvas&&_cursorCanvas.canvas)_cursorCanvas.canvas.context.clearRect(0,0,_cursorCanvas.canvas.offsetWidth,_cursorCanvas.canvas.offsetWidth);helper.style.add(_cursorCanvas,{"display":"none"});removeProps()}else{_args.container.style.cursor="none";if(_properties.isServerControlMouse){moveCursorCanvas=moveCursorCanvas_sync;_mouseMoveAsync.enable=false}else{_mouseMoveAsync.enable=true;moveCursorCanvas=
moveCursorCanvas_async;requestAnimation(mouseMoveCanvas_AnimationFrame)}defineProps();if(!_cursorCanvas&&_args.container.originalImage)setCursor(_args.container.originalImage);helper.style.add(_cursorCanvas,{"display":"block"})}}}function defineProps(){if(!_properties.overrideCursor&&!_ref.moveCursorCanvas)Object.defineProperty(_ref,"moveCursorCanvas",{enumerable:true,configurable:false,writable:true,value:moveCursorCanvasExternal})}function removeProps(){if(_properties.overrideCursor&&_ref.moveCursorCanvas)delete _ref.moveCursorCanvas}
function dispose(){helper.dom.removeEvent(_args.container,"touchstart",onTouchStartMobile);helper.dom.removeEvent(_args.container,wheelsEventNames,wheel,{"passive":false});helper.dom.removeEvent(_args.container,"mousedown",onTouchStart,{"passive":false});helper.dom.removeEvent(_args.container,"mouseup",onTouchEnd,{"passive":false});helper.dom.removeEvent(_args.container,"mousemove",onTouchMove,{"passive":false});helper.dom.removeEvent(_args.container,"mouseleave",onTouchLeave,{"passive":false});helper.dom.removeEvent(_args.container,
"touchstart",onTouchDeviceStart,{"passive":true});helper.dom.removeEvent(_args.container,"touchmove",onTouchDeviceMove,{"passive":true});helper.dom.removeEvent(_args.container,"touchend",onTouchDeviceEnd,{"passive":true})}initialize();Object.defineProperty(_ref,"overrideCursor",{enumerable:true,configurable:false,get:function(){return _overrideCursor},set:setOverrideCursor});Object.defineProperty(_ref,"cursorCanvas",{enumerable:true,configurable:false,get:function(){return _cursorCanvas}});Object.defineProperty(_ref,
"dispose",{enumerable:true,configurable:false,writable:false,value:dispose});defineProps();return _ref}try{Thinfinity!=undefined}catch(e){Thinfinity={}}if(Thinfinity.Driver===undefined)Thinfinity.Driver={};Thinfinity.Driver.Mouse=DMouse})();
(function(){let p=agentInfo.isMobile?1:3;var _defaultTouchGestures=[{type:"tap",pointers:1,taps:1,action:["mouseMove","click"]},{type:"pan",pointers:1,threshold:Math.round(15*p),direction:"DIRECTION_ALL",action:"mouseMove"},{type:"pressAndRelease",pointers:1,threshold:Math.round(5*p),time:350,action:["pressRelease"]},{type:"press",pointers:1,threshold:Math.round(5*p),time:350,action:["mouseMove","holdLeft"]},{type:"pan",pointers:3,threshold:0,action:"zoomPan"},{type:"pinch",pointers:2,threshold:0,
action:"zoomOrWheel"},{type:"release",action:"releaseAll"},{type:"swipe","pointers":1,"threshold":Math.round(10*p),velocity:.3,direction:"DIRECTION_RIGHT",action:"swipe"},{type:"swipeFromEdge","pointers":1,"threshold":Math.round(10*p),velocity:.3,swipeDirection:"left",action:"swipeFromEdge"}];const gesturesOnStates=Thinfinity.GesturesConfigurator.onStates;var TouchManager=function(args){const isTouchable=!agentInfo.isMobile;var p={initialized:false,localGesturesInitialized:false,redirectionInitialized:false,
redirectionServerSideSupported:false,listenElement:null,localGesturesSettings:null,redirectSettings:null,gesturesConfigurator:null,fallbackCount:0,currentMode:"",currentLocalGesturesMethod:"",currentRedirectionMethod:"",currentRedirectionEventHandlers:{"Start":null,"Move":null,"End":null},currentRedirectionEvents:{"Start":null,"Move":null,"End":null},eventNamesByRedirectionMethod:{"Touch Events":{"Start":["touchstart"],"Move":["touchmove"],"End":["touchend"]},"Pointer Events":{"Start":[],"Move":[],
"End":[]}},touchEventsCapable:function(){return isTouchable},pointerEventsCapable:function(){var pointerEvents=this.eventNamesByRedirectionMethod["Pointer Events"];if(pointerEvents["Start"].length)return true;if(navigator.pointerEnabled&&navigator.maxTouchPoints>0){pointerEvents["Start"]=["pointerdown"];pointerEvents["Move"]=["pointermove"];pointerEvents["End"]=["pointerup","pointercancel"];return true}if(navigator.msPointerEnabled&&navigator.msMaxTouchPoints>0){pointerEvents["Start"]=["MSPointerDown"];
pointerEvents["Move"]=["MSPointerMove"];pointerEvents["End"]=["MSPointerUp","MSPointerCancel"];return true}return false},msTouchEventsCapable:function(){return agentInfo.isTabletMode&&document&&document.documentElement&&"onmsgesturestart"in document.documentElement},maxTouchPoints:function(){return navigator.maxTouchPoints||navigator.msMaxTouchPoints||0},addRedirectionEvents:function(owner,eventId){var eventHandlerName="touch"+eventId+"Redirection";var eventNames=this.eventNamesByRedirectionMethod[this.currentRedirectionMethod][eventId];
var eventHandler=owner[eventHandlerName];if(!this.listenElement||typeof eventNames=="undefined"||typeof eventHandler=="undefined")return;var wrappedEventHandler;if(this.currentRedirectionMethod=="Touch Events")wrappedEventHandler=eventId=="Start"||eventId=="End"?function(e){eventHandler.apply(owner,[e,e.changedTouches])}:function(e){eventHandler.apply(owner,[e,e.touches])};else wrappedEventHandler=function(e){if(e.pointerType!="touch")return;eventHandler.apply(owner,[e,[{pageX:e.clientX,pageY:e.clientY,
identifier:e.pointerId}]])};for(var i=0;i<eventNames.length;++i)this.listenElement.addEventListener(eventNames[i],wrappedEventHandler,false);this.currentRedirectionEventHandlers[eventId]=wrappedEventHandler},removeRedirectionEvents:function(eventId){if(this.currentRedirectionMethod&&this.currentRedirectionMethod!=""){var eventNames=this.eventNamesByRedirectionMethod[this.currentRedirectionMethod][eventId];if(!this.listenElement||typeof eventNames=="undefined")return;var wrappedEventHandler=this.currentRedirectionEventHandlers[eventId];
for(var i=0;i<eventNames.length;++i)this.listenElement.removeEventListener(eventNames[i],wrappedEventHandler,false)}},initLocalGestures:function(localGestureSettings){if(this.gesturesConfigurator!=null&&this.gesturesConfigurator.initialized)return;this.localGesturesInitialized=false;this.localGestureSettings=null;this.currentLocalGesturesMethod="";if(!this.gesturesConfigurator)this.gesturesConfigurator=new Thinfinity.GesturesConfigurator({listenElement:this.listenElement});if(this.gesturesConfigurator==
null){helper.console.error("TouchManager: Cannot initialize GesturesConfigurator, no local gesture processing.");return}this.localGestureSettings=localGestureSettings;this.currentLocalGesturesMethod="Hammer.js";this.localGesturesInitialized=true},initRedirection:function(redirectionSettings){this.redirectionSettings=redirectionSettings;this.currentRedirectionMethod=this.touchEventsCapable()?"Touch Events":"Pointer Events";this.redirectionInitialized=true;this.redirectionServerSideSupported=!agentInfo.isMobile&&
cookiePrefix==="VNC"||false},startLocalGestures:function(owner){if(this.gesturesConfigurator.initialized)this.gesturesConfigurator.stopRecognition();if(owner.defaultGestures)this.gesturesConfigurator.set({gestures:owner.defaultGestures});this.gesturesConfigurator.set({"gestures":this.localGestureSettings});this.gesturesConfigurator.set({middleware:owner.gesturesMiddleware,middlewares:[],actions:owner.actions});this.gesturesConfigurator.startRecognition();this.currentMode="Local Gestures";owner.localGesturesStarted()},
stopLocalGestures:function(owner){if(this.gesturesConfigurator)this.gesturesConfigurator.stopRecognition();this.currentMode="";owner.localGesturesStopped()},startRedirection:function(owner){this.listenElement.style.touchAction="none";this.listenElement.style.msTouchAction="none";this.listenElement.onselectstart=function(){return false};this.addRedirectionEvents(owner,"Start");this.addRedirectionEvents(owner,"Move");this.addRedirectionEvents(owner,"End");this.currentMode="Redirection";owner.redirectionStarted()},
stopRedirection:function(owner){this.removeRedirectionEvents("Start");this.removeRedirectionEvents("Move");this.removeRedirectionEvents("End");if(this.listenElement){delete this.listenElement.style.touchAction;delete this.listenElement.style.msTouchAction}this.currentMode="";owner.redirectionStopped()}};var _useLocalGesture=false;var touch={touchCapable:function(){return true},maxTouchPoints:function(){return p.maxTouchPoints()},localGesturesInitialized:function(){return p.localGesturesInitialized},
redirectionInitialized:function(){return p.redirectionInitialized},redirectionServerSideSupported:function(){return p.redirectionServerSideSupported},getCurrentMode:function(){return p.currentMode},getCurrentRedirectionMethod:function(){return p.currentRedirectionMethod},getCurrentLocalGesturesMethod:function(){return p.currentLocalGesturesMethod},wasInitialized:function(){return p.initialized},refine:function(){var F=function(){};F.prototype=touch;return new F},initialize:function(listenElement,
localGestureSettings,redirectionSettings){if(touch.wasInitialized()){helper.console.log("TouchManager: Already initialized, continue.");return}if(!listenElement){helper.console.error("TouchManager: Undefined listenElement, cannot initialize.");return}if(!touch.touchCapable()){helper.console.error("TouchManager: Touch capability not detected, cannot initialize.");return}if(listenElement.addEventListener=="undefined"){helper.console.error("TouchManager: listenElement.addEventListener() not supported, cannot initialize.");
return}p.listenElement=listenElement;if(typeof localGestureSettings=="object")p.initLocalGestures(localGestureSettings);if(typeof redirectionSettings=="object")p.initRedirection(redirectionSettings);if(!touch.redirectionInitialized()&&!touch.localGesturesInitialized()){helper.console.log("TouchManager: No touch handling method defined, cannot initialize.");return}touch.printStatus(true);p.initialized=true;helper.console.log("TouchManager: Initialized.");touch.reconfigureForLocalGestures()},serverSupportsRedirection:function(){if(!touch.wasInitialized()){helper.console.error("TouchManager: Not initialized.");
return}if(!touch.redirectionInitialized()){helper.console.error("TouchManager: Redirection not initialized.");return}if(agentInfo.isMobile){p.redirectionServerSideSupported=false;logDebug("TouchManager: Server supports touch redirection, but the device is mobile or surface reconfiguring to local gestures...");touch.reconfigureForLocalGestures();helper.console.log("ThinVNCTouchManager::redirectionStopped()");$("#kitouchredir").hide();$("#kitouchredir + hr").hide()}else{p.redirectionServerSideSupported=
true;helper.console.log("TouchManager: Server supports touch redirection, reconfiguring...");touch.reconfigureForRedirection()}},printStatus:function(ignoreInitialized){if(!touch.wasInitialized()&&!ignoreInitialized){helper.console.log("TouchManager: Not initialized.");return}var yesNo=function(b,y,n){var s=b?"Yes":"No";if(b&&y)s+=y;else if(!b&&n)s+=n;return s};helper.console.log("TouchManager: Touch events capable? "+yesNo(p.touchEventsCapable())+".");helper.console.log("TouchManager: Pointer events capable? "+
yesNo(p.pointerEventsCapable())+".");helper.console.log("TouchManager: Max. touch points: "+(touch.maxTouchPoints()?touch.maxTouchPoints():"not available")+".");helper.console.log("TouchManager: Local gestures initialized? "+yesNo(touch.localGesturesInitialized(),", using "+touch.getCurrentLocalGesturesMethod())+".");helper.console.log("TouchManager: Redirection initialized? "+yesNo(touch.redirectionInitialized(),", using "+touch.getCurrentRedirectionMethod())+".")},toggleCurrentMode:function(){if(touch.getCurrentMode()==
"Redirection")touch.reconfigureForLocalGestures();else if(touch.getCurrentMode()=="Local Gestures")touch.reconfigureForRedirection();else helper.console.error("TouchManager: Cannot toggle invalid current mode: "+touch.getCurrentMode())},reconfigureForLocalGestures:function(){_useLocalGesture=true;if(!touch.wasInitialized()){helper.console.error("TouchManager: Not initialized. Cannot reconfigure for local gestures.");return}if(!touch.localGesturesInitialized()){helper.console.log("TouchManager: Cannot switch to local gestures, mode not initialized. Reverting to redirect if available.");
if(touch.redirectionInitialized()&&touch.redirectionServerSideSupported())touch.reconfigureForRedirection();return}try{p.stopRedirection(touch);p.startLocalGestures(touch)}catch(err){helper.console.error("TouchManager: Failed to initialize local gesture processing: "+err);if(p.fallbackCount++)return;helper.console.error("TouchManager: Reverting to touch redirection if available.");if(touch.redirectionInitialized()&&touch.redirectionServerSideSupported())touch.reconfigureForRedirection();p.fallbackCount=
0;return}p.fallbackCount=0;helper.console.log("TouchManager: Switched to local gestures.")},enableGestures:function(){if(_useLocalGesture==true&&(p.gesturesConfigurator==null||!p.gesturesConfigurator.initialized)){p.initLocalGestures(p.localGestureSettings);p.startLocalGestures(touch)}},disableGestures:function(){if(_useLocalGesture==true&&p.gesturesConfigurator!=null)p.stopLocalGestures(touch)},reconfigureForRedirection:function(){_useLocalGesture=false;if(!touch.wasInitialized()){helper.console.error("TouchManager: Not initialized. Cannot reconfigure for redirection.");
return}if(!touch.redirectionInitialized()||!touch.redirectionServerSideSupported()){helper.console.log("TouchManager: Cannot switch to redirection, mode not initialized or no sever-side support. Reverting to local gestures if available.");if(touch.localGesturesInitialized())touch.reconfigureForLocalGestures();return}try{p.stopLocalGestures(touch);p.startRedirection(touch)}catch(err){helper.console.error("TouchManager: Failed to initialize redirection of touch events: "+err);if(p.fallbackCount++)return;
helper.console.error("TouchManager: Reverting to local gestures if available.");if(touch.localGesturesInitialized())touch.reconfigureForLocalGestures();p.fallbackCount=0;return}p.fallbackCount=0;helper.console.log("TouchManager: Switched to touch redirection.")},dispose:function(){p.stopRedirection(touch);p.stopLocalGestures(touch);p.initialized=false},touchGesture:function(e){},panStartGesture:function(e){},panGesture:function(e){},panEndGesture:function(e){},swipeGesture:function(e){},tapGesture:function(e){},
doubleTapGesture:function(e){},pressGesture:function(e){},releaseGesture:function(e){},transformStartGesture:function(e){},transformGesture:function(e){},transformEndGesture:function(e){},touchStartRedirection:function(e,touches){},touchMoveRedirection:function(e,touches){},touchEndRedirection:function(e,touches){},localGesturesStarted:function(e){},localGesturesStopped:function(e){},redirectionStarted:function(e){},redirectionStopped:function(e){},gesturesConfiguratorCustomActions:[]};Object.defineProperty(touch,
"gesturesConfigurator",{"enumerable":true,"configurable":false,"get":function(){return p.gesturesConfigurator}});return touch};function DTouch(args,oInterface){var _ref=this;var _props=null;var _methods=null;var _noop=()=>{return null};var _args={container:null,waitForTouchDevice:null,extra:{getElementFromPoint:_noop,waitForTouchDevice:null,preventDefault:_noop},gestures:null};var _defaultEventFire={async:0};var _touchManager=null;var getScrollLeft=document.documentElement?function(){return document.documentElement.scrollLeft}:
function(){return window.pageXOffset};var getScrollTop=document.documentElement?function(){return document.documentElement.scrollTop}:function(){return window.pageYOffset};var held=[];var zoomStarted=false;var startMouseX=0;var startMouseY=0;var deltaCursorX=0;var deltaCursorY=0;var divScrolling=true;var keyboardCaretWait=200;var fireEvent=null;var _defaultEventsProps={"async":false};var _readyCallback=null;var _ready=false;function initialize(){if(!agentInfo.isMobile){helper.object.parseAttributes(_args,
args);fireEvent=(new Thinfinity.Events({"owner":_ref,"events":_args.events,fireEventArgs:_defaultEventFire})).fireEvent;if(agentInfo.isTouch)postInitialize();else agentInfo.detectTouch(postInitialize)}}function postInitialize(){_props=oInterface.properties;_methods=oInterface.methods;oInterface.on("allowMouseCapture",()=>{checkControl()});checkControl()}function checkControl(){if(!_props.allowMouseCapture){if(_touchManager)_touchManager.stopLocalGestures()}else if(!_touchManager){initializeTouch();
if(_args.extra.waitForTouchDevice instanceof Function)_args.extra.waitForTouchDevice()}else _touchManager.startLocalGestures()}function initializeTouch(){_touchManager=new TouchManager({});_touchManager["defaultGestures"]=helper.object.clone(_defaultTouchGestures);_touchManager["defaultGestures"].filter(function(t){return t.type==="swipe"})[0].middleware=function(e,details){var tapElement=e&&e.target?e.target:null;var menuClass="thin-menu-container";if($(tapElement).hasClass(menuClass)||$(tapElement).parents().hasClass(menuClass))return true;
return false};oInterface.on("serverSupportsRedirection",_touchManager.serverSupportsRedirection);oInterface.on("startTouchRedirection",_touchManager.reconfigureForRedirection);oInterface.on("stopTouchRedirection",_touchManager.reconfigureForLocalGestures);if(!agentInfo.isMobile&&window.cookiePrefix==="RDP")oInterface.properties.overrideCursor=false;if(productId=="virtualui"){var errMsg="ClientSettings.Mobile.KeyboardCaretWait is not a valid value [{0}]";try{var _caretTimeout=helper.object.getValue(THIN,
"clientSettings.Mobile.KeyboardCaretWait",null);_caretTimeout=_caretTimeout!==null&&!isNaN(_caretTimeout)?parseInt(_caretTimeout):keyboardCaretWait;if(_caretTimeout>0)keyboardCaretWait=_caretTimeout;else helper.console.warning(helper.string.format(errMsg,_caretTimeout))}catch(err){helper.console.warning(helper.string.format(errMsg,_caretTimeout))}}function btnLeftClick(x,y){var x1=getTouchXFixed();var y1=getTouchYFixed();mouseScrollX=x1;mouseScrollY=y1;x1=x;y1=y;let abs=coord2Abs(x1,y1);_methods.sendMouse(abs.x,
abs.y,0,"down");_methods.sendMouse(abs.x,abs.y,0,"up")}function sendButtonRight(x,y){var x1=getTouchXFixed();var y1=getTouchYFixed();mouseScrollX=x1;mouseScrollY=y1;x1=x;y1=y;let abs=coord2Abs(x1,y1);_methods.sendMouse(abs.x,abs.y,2,"down");_methods.sendMouse(abs.x,abs.y,2,"up")}function checkPointerType(ev){if(ev)switch(ev.pointerType){case "touch":return true;case "pen":return true;case "mouse":return false;default:if(ev.changedTouches&&ev.changedTouches.length>0||ev.touches&&ev.touches.length>
0)return true}return false}function checkUIAndPointerType(e){if(!checkPointerType(e))return false;return!helper.style.hasAnyParentsClass(e&&e.target?e.target:null,"uitaptarget ignoremouse")}function getRelativeTouchByPointerType(ev){return!_props.relativeTouch||ev&&ev.pointerType==="pen"?false:_props.relativeTouch}function getTouches(ev){if(ev){switch(ev.pointerType){case "touch":case "pen":if(ev.pointers.length>0)ev=ev.pointers[0];else if(ev.changedPointers.length>0)ev=ev.changedPointers[0];break;
case "mouse":break;default:if(ev.changedTouches&&ev.changedTouches.length>0)ev=ev.changedTouches[0];else if(ev.touches&&ev.touches.length>0)ev=ev.touches[0];break}return ev}else{logDebug("No event to get Touches!");return[{"x":-1,"y":-1}]}}function getTouchX(isRelative){return getTouchXFixed()+(isRelative?0:_args.container.scrollLeft*_props.zoomFactor)}function getTouchXFixed(){var t=getTouches(lastEvent);return parseInt(t.x||t.clientX||t.pageX,10)+(window.scrollX||window.pageXOffset)}function getTouchY(isRelative){return getTouchYFixed()+
(isRelative?0:_args.container.scrollTop*_props.zoomFactor)}function getTouchYFixed(){var t=getTouches(lastEvent);return parseInt(t.y||t.clientY||t.pageY,10)+getScrollTop()}var previousTapTime=0;var touchstate=0;var lastScale=null;var pinchGestureMinDistance=20;var wheelGestureMinDistance=20;var swipeFingerCount=3;var gesture=null;var captureStartEvent=null;var captureDistanceX=0;var captureDistanceY=0;const ucKeys=Object.keys(_props.mobileKeyboardEnumKeys??{}).reduce((acc,t)=>({...acc,[t.toUpperCase()]:_props.mobileKeyboardEnumKeys[t]}),
{});var wheelSettings={"axis":null,"direction":null,"previousValue":null,"thresholdStartDetection":15,"thresholdDistance":2,"stepValue":120,"inverted":typeof _props.mouseWheelDirection!="undefined"?_props.mouseWheelDirection==-1:false,"elapsedTime":0,"lasttimeSent":0,"sentTime":150};const _actionsCtx={init:{"wheel":{beforeTriggered:false}}};if(agentInfo.isChromium&&agentInfo.agentStr.indexOf("android 4.2.2")!=-1)$(document).click(function(e){var elem=(_props.relativeTouch?document.elementFromPoint(cursorCanvasX(),
cursorCanvasY()):null)||e.target;var tapElement=e&&e.target?e.target:null;if($(elem).hasClass("taptarget")||$(elem.parentElement).hasClass("taptarget")||$(elem).hasClass("disabled")){$(elem).trigger("tap");return}if($(elem).hasClass("ignoremouse")||$(elem.parentElement).hasClass("ignoremouse"))return;if($(tapElement).hasClass("uitaptarget")||$(tapElement).parents().hasClass("uitaptarget"))return;var currentTime=(new Date).getTime();if(currentTime-previousTapTime>50){previousTapTime=currentTime;lastEvent=
e;var x=getTouchXFixed();var y=getTouchYFixed();if(!zoomStarted){button="left";touchstate=1;try{mouseScrollX=x;mouseScrollY=y;if(_props.relativeTouch){startMouseX=cursorCanvasX();startMouseY=cursorCanvasY()}else{startMouseX=getTouchX(_props.relativeTouch);startMouseY=getTouchY(_props.relativeTouch)}var x=startMouseX;var y=startMouseY;if(typeof _methods.onTap!="undefined"){let abs=coord2Abs(x,y);_methods.onTap(abs.x,abs.y);e.preventDefault()}}finally{touchstate=0}if(touchstate==3)mouseMoveIntoView()}}else return});
function getGesture(e){var ret=null;if(e&&e.pointers.length>1){var fc=e.pointers.length;if(fc>=swipeFingerCount)ret="swipe";else{var wheelDistance=Math.max(Math.abs(captureStartEvent.center.x-e.center.x),Math.abs(captureStartEvent.center.y-e.center.y));var pinchDistance=Math.max(Math.abs(Math.abs(e.pointers[0].clientX-e.pointers[1].clientX)-captureDistanceX),Math.abs(Math.abs(e.pointers[0].clientY-e.pointers[1].clientY)-captureDistanceY));if(pinchDistance>pinchGestureMinDistance&&wheelDistance<wheelGestureMinDistance)ret=
"pinch";else if(wheelDistance>wheelGestureMinDistance&&pinchDistance<pinchGestureMinDistance)ret="wheel"}}return ret}function multiGestureEnds(){if(zoomStarted)window.setTimeout(function(){zoomStarted=false},300);gesture=null;if(touchstate==3)mouseMoveIntoView();wheelSettings.axis=null;captureStartEvent=null;captureDistanceX=0;captureDistanceY=0;clearTimeout(gestureTimeout);scrollLeftCapture=null;scrollTopCapture=null}function getMouseScreenPosition(){let position=findPos(_args.container);var mouseScreenPosition=
{x:(cursorCanvasX()-position[0])/_props.scale,y:(cursorCanvasY()-position[1])/_props.scale};return mouseScreenPosition}function divScroll(X,Y){X=Math.round(X);Y=Math.round(Y);if(divScrolling){if(_props.maxWidth+X>_props.viewWidth)X=_props.viewWidth-_props.maxWidth;else if(X<0)X=0;if(_props.maxHeight+Y>_props.viewHeight)Y=_props.viewHeight-_props.maxHeight;else if(Y<0)Y=0;_args.container.scrollLeft=X;_args.container.scrollTop=Y}else{X=getScrollLeft()+(mouseScrollX-X);Y=getScrollTop()+(mouseScrollY-
Y);if(_props.maxWidth+X>_props.viewWidth)X=_props.viewWidth-_props.maxWidth;else if(X<0)X=0;if(_props.maxHeight+Y>_props.viewHeight)Y=_props.viewHeight-_props.maxHeight;else if(Y<0)Y=0;window.scroll(X,Y)}mouseScrollX=X;mouseScrollY=Y;return}var scrollLeftCapture=null;var scrollTopCapture=null;var gestureTimeout=null;var _actionsProcessors={"pinchStart":function(e){oldGesture=gesture=null;if(e&&e.pointers.length>1){e.srcEvent.stopPropagation();e.srcEvent.preventDefault()}clearTimeout(gestureTimeout);
captureStartEvent=e;captureDistanceX=Math.abs(captureStartEvent.pointers[0].clientX-captureStartEvent.pointers[1].clientX);captureDistanceY=Math.abs(captureStartEvent.pointers[0].clientY-captureStartEvent.pointers[1].clientY);lastEvent=e;startMouseX=getTouchX(_props.relativeTouch);startMouseY=getTouchY(_props.relativeTouch);if(!zoomStarted){button="left";touchstate=1}lastScale=_props.zoomFactor},"pinchMove":function(e){if(gesture==null){oldGesture=gesture;gesture=getGesture(e);clearTimeout(gestureTimeout);
gestureTimeout=setTimeout(function(){var newGesture=getGesture(e);if(newGesture!=gesture&&gesture!=null){captureStartEvent=e;captureDistanceX=Math.abs(captureStartEvent.pointers[0].clientX-captureStartEvent.pointers[1].clientX);captureDistanceY=Math.abs(captureStartEvent.pointers[0].clientY-captureStartEvent.pointers[1].clientY)}if(gesture!==newGesture)oldGesture=gesture;gesture=newGesture},3E3)}},"zoomPanStart":function(e){oldGesture=gesture=null;clearTimeout(gestureTimeout);captureStartEvent=e;
captureDistanceY=Math.abs(captureStartEvent.pointers[0].clientY-captureStartEvent.pointers[1].clientY);captureDistanceX=Math.abs(captureStartEvent.pointers[0].clientX-captureStartEvent.pointers[1].clientX);lastEvent=e;startMouseX=getTouchX(_props.relativeTouch);startMouseY=getTouchY(_props.relativeTouch)},"zoomPanMove":function(e){if(gesture==null){oldGesture=gesture;gesture=getGesture(e);clearTimeout(gestureTimeout);gestureTimeout=setTimeout(function(){var newGesture=getGesture(e);if(newGesture!=
gesture&&gesture!=null){captureStartEvent=e;captureDistanceX=Math.abs(captureStartEvent.pointers[0].clientX-captureStartEvent.pointers[1].clientX);captureDistanceY=Math.abs(captureStartEvent.pointers[0].clientY-captureStartEvent.pointers[1].clientY)}if(gesture!==newGesture)oldGesture=gesture;gesture=newGesture},3E3)}},"screenPan":function(e){if(!_props.scaled)if(divScrolling){let th=5;var mX=_props.mouseX;let sl=_args.container.scrollLeft;let mw=_props.maxWidth;let vw=_props.viewWidth;var mY=_props.mouseY;
let st=_args.container.scrollTop;let mh=_props.maxHeight;let vh=_props.viewHeight;if(sl<mX+th-mw||mX<sl&&sl>mX-sl){mX=mX<sl?mX:mX+th-mw;if(mw+mX>vw)mX=vw-mw;else if(mX<0)mX=0;_args.container.scrollLeft=mX}if(st<mY+th-mh||mY<st&&st>mY-st){mY=mY<st?mY:mY+th-mh;if(mh+mY>vh)mY=vh-mh;else if(mY<0)mY=0;_args.container.scrollTop=mY}}else{var sl=getScrollLeft();var st=getScrollTop();var sw=screenWidth;var sh=screenHeight;if(sl<_props.mouseX-sw||_props.mouseX<sl&&sl>_props.mouseX-sl)sl=_props.mouseX<sl?_props.mouseX:
_props.mouseX-sw;if(st<_props.mouseY-sh||_props.mouseY<st&&st>_props.mouseY-st)st=_props.mouseY<st?_props.mouseY:_props.mouseY-sh;window.scroll(sl,st)}},"hold":function(e,btn){var relativeTouchFromPointer=getRelativeTouchByPointerType(e);if(held.indexOf(btn)===-1){held.push(btn);mouseDown(startMouseX,startMouseY,relativeTouchFromPointer,btn)}},"release":function(e,btn){var relativeTouchFromPointer=getRelativeTouchByPointerType(e);if(held.indexOf(btn)!==-1){held=held.filter(function(t){return t!==
btn});mouseUp(startMouseX,startMouseY,relativeTouchFromPointer,btn)}}};let _doubleClick={enable:true,previousEvtTime:0,count:0,maxTime:300,pos:{x:null,y:null},threshold:20};let singleClick=(x,y,relativeTouchFromPointer,button,fe)=>{mouseDown(x,y,relativeTouchFromPointer,button);mouseUp(x,y,relativeTouchFromPointer,button);if(fe)fireEvent("tap",{x,y,relative:relativeTouchFromPointer,button},_defaultEventsProps)};var actions=_touchManager["actions"]={"zoomPan":function(e){var eType=e&&e.type?e.type.toUpperCase():
null;if(eType.indexOf("START")!=-1)_actionsProcessors.zoomPanStart.call(this,e);else if(eType.indexOf("MOVE")!=-1)_actionsProcessors.zoomPanMove.call(this,e);else if(eType.indexOf("END")!=-1||eType.indexOf("CANCEL")!=-1)multiGestureEnds();else{lastEvent=e;var deltaX=(captureStartEvent.center.x-e.center.x)/_props.zoomFactor;var deltaY=(captureStartEvent.center.y-e.center.y)/_props.zoomFactor;if(scrollTopCapture==null)scrollTopCapture=_args.container.scrollTop;if(scrollLeftCapture==null)scrollLeftCapture=
_args.container.scrollLeft;var sl=scrollLeftCapture+deltaX;var st=scrollTopCapture+deltaY;divScroll(sl,st);touchstate=3}},"zoomOrWheel":function(e,actionArgs){var eType=e&&e.type?e.type.toUpperCase():null;if(eType.indexOf("START")!=-1)_actionsProcessors.pinchStart.call(this,e);else if(eType.indexOf("MOVE")!=-1)_actionsProcessors.pinchMove.call(this,e);else if(eType.indexOf("END")!=-1||eType.indexOf("CANCEL")!=-1)multiGestureEnds();else if(gesture=="pinch")actions.zoom.call(this,e,actionArgs);else if(gesture==
"wheel")actions.wheel.handler.call(this,e,actionArgs)},"key":function(e,{code,ch=0,direction,loc=0}={}){code=typeof code=="string"?ucKeys[code.toUpperCase()]??null:code;_methods.sendKey(code,ch,direction,loc)},"wheel":{on:"ALL",handler:function(e,{direction="VERTICAL",gesture:acgesture="PAN",stepValue=wheelSettings.stepValue,speedRelative,stepValue:stepValueOg,triggerAction=()=>{},sensitivity}={}){const {type,additionalEvent,scale}={...e,type:e.type.toUpperCase(),additionalEvent:e.additionalEvent?.toUpperCase()};
if(!_actionsCtx["wheel"])_actionsCtx["wheel"]={..._actionsCtx.init.wheel};acgesture=acgesture?.toUpperCase?.()??"PAN";const matchingACGestures={"ZOOM":"pinch","PAN":"wheel"};if(type.includes("START")){_actionsProcessors.pinchStart.call(this,e);if(acgesture=="ZOOM")wheelSettings.lastScale=null;_actionsCtx["wheel"].beforeTriggered=false;sensitivity.reset()}else if(type.includes("MOVE")){if(gesture!==null)if(matchingACGestures[acgesture]==gesture)if(oldGesture==null&&!_actionsCtx["wheel"].beforeTriggered){triggerAction(gesturesOnStates.BEFORE);
_actionsCtx["wheel"].beforeTriggered=true}else triggerAction(gesturesOnStates.WHILE);_actionsProcessors.pinchMove.call(this,e);if(acgesture=="ZOOM"&&matchingACGestures[acgesture]==gesture){let pinchDirection=wheelSettings.lastScale!=null?wheelSettings.lastScale>=scale?-1:1:null;pinchDirection=!pinchDirection&&additionalEvent?additionalEvent.split("_")[1]?.includes("IN")?-1:1:pinchDirection;if(pinchDirection){let wheelX,wheelY=0;wheelSettings.lastScale=scale;const step=stepValue*pinchDirection;wheelX=
direction=="HORIZONTAL"?step:0;wheelY=direction=="VERTICAL"?step:0;if(sensitivity.isValid())_methods.sendWheel(wheelY,wheelX);sensitivity.call()}}}else if(type.includes("END")){if(gesture!==null&&matchingACGestures[acgesture]==gesture)triggerAction(gesturesOnStates.AFTER);multiGestureEnds();if(acgesture=="ZOOM")wheelSettings.lastScale=null}else{if(["PAN"].includes(acgesture))if(gesture!==null&&matchingACGestures[acgesture]==gesture)triggerAction(gesturesOnStates.WHILE);if(acgesture=="PAN"&&matchingACGestures[acgesture]==
gesture){if(wheelSettings.axis==null){if(Math.abs(e.deltaY)>wheelSettings.thresholdStartDetection)wheelSettings.axis="vertical";else if(Math.abs(e.deltaX)>wheelSettings.thresholdStartDetection)wheelSettings.axis="horizontal";wheelSettings.previousValue=0}var step=0;if(wheelSettings.axis!=null){if(typeof _props.mouseWheelStepValue!="undefined"&&wheelSettings.stepValue!=_props.mouseWheelStepValue&&_props.mouseWheelStepValue>0)wheelSettings.stepValue=_props.mouseWheelStepValue;if(typeof _props.mouseWheelDirection!=
"undefined")wheelSettings.inverted=_props.mouseWheelDirection==-1;function getStep(deltaAxis,speedAxis,{stepValue=null,speedRelative=true}={}){var delta=Math.abs(deltaAxis-wheelSettings.previousValue);speedAxis=Math.abs(speedAxis);if(delta>wheelSettings.thresholdDistance){if(wheelSettings.axis=="vertical")if(deltaAxis<wheelSettings.previousValue)wheelSettings.direction=!wheelSettings.inverted?-1:1;else wheelSettings.direction=!wheelSettings.inverted?1:-1;else if(deltaAxis<wheelSettings.previousValue)wheelSettings.direction=
!wheelSettings.inverted?1:-1;else wheelSettings.direction=!wheelSettings.inverted?-1:1;var v=Math.abs(speedAxis);step=speedRelative?v<.05?1:v<.08?2:3:1;step*=wheelSettings.stepValue*wheelSettings.direction;wheelSettings.previousValue=deltaAxis;return step}else return 0}var xStep=0,yStep=0;if(wheelSettings.axis=="horizontal")xStep=getStep(e.deltaX,e.velocityX,{stepValue:stepValueOg,speedRelative:speedRelative??(stepValueOg??true)===true});else if(wheelSettings.axis=="vertical")yStep=getStep(e.deltaY,
e.velocityY,{stepValue:stepValueOg,speedRelative:speedRelative??(stepValueOg??true)===true});if(xStep!=0||yStep!=0){var t=(new Date).getTime();if(t-wheelSettings.lasttimeSent>wheelSettings.sentTime){if(sensitivity.isValid()){_methods.sendWheel(yStep,xStep);wheelSettings.lasttimeSent=t}sensitivity.call()}}}}}}},"zoom":function(e){var eType=e&&e.type?e.type.toUpperCase():null;if(eType.indexOf("START")!=-1)_actionsProcessors.pinchStart.call(this,e);else if(eType.indexOf("MOVE")!=-1)_actionsProcessors.pinchMove.call(this,
e);else if(eType.indexOf("END")!=-1||eType.indexOf("CANCEL")!=-1)multiGestureEnds();else{if(_props.scaled)return;var scale=e.scale||e.gesture.scale;if(scale<1)scale=scale*1.075;else scale=scale*.955;var dif=Math.abs(1-scale);if(dif>.1){zoomStarted=true;var mouseScreenPosition=getMouseScreenPosition();var absX=mouseScreenPosition.x;var absY=mouseScreenPosition.y;var screenX=absX-_args.container.scrollLeft;var screenY=absY-_args.container.scrollTop;var pX=screenX*100/_props.maxWidth;var pY=screenY*
100/_props.maxHeight;_methods.zoom(lastScale*scale);var sL=absX-_props.maxWidth*pX/100;var sT=absY-_props.maxHeight*pY/100;_args.container.scrollLeft=sL;_args.container.scrollTop=sT}lastEvent=e}},"mouseMove":function(e){if(_args.extra.preventDefault(e))return;lastEvent=e;var relativeTouchFromPointer=getRelativeTouchByPointerType(e);if(relativeTouchFromPointer){if(e&&e.type&&e.type.toUpperCase().indexOf("PAN")!=-1)if(e.type.toUpperCase().indexOf("START")!=-1||e.deltaX===0&&e.deltaY===0){startMouseX=
getTouchX(relativeTouchFromPointer)-e.deltaX;startMouseY=getTouchY(relativeTouchFromPointer)-e.deltaY}else{if(e.type.toUpperCase().indexOf("MOVE")!=-1)mouseMove(getTouchX(relativeTouchFromPointer),getTouchY(relativeTouchFromPointer),relativeTouchFromPointer)}else{startMouseX=getTouchX(relativeTouchFromPointer)-e.deltaX;startMouseY=getTouchY(relativeTouchFromPointer)-e.deltaY}_actionsProcessors.screenPan(e)}else{if(e&&e.type&&e.type.toUpperCase().indexOf("PAN")!=-1&&e.type.toUpperCase().indexOf("MOVE")===
-1)return;startMouseX=getTouchX(relativeTouchFromPointer);startMouseY=getTouchY(relativeTouchFromPointer);mouseMove(startMouseX,startMouseY,relativeTouchFromPointer);_methods.forceMouseMove()}},"click":function(e){if(_args.extra.preventDefault(e))return;if(!zoomStarted){var x=getTouchXFixed();var y=getTouchYFixed();button="left";touchstate=1;var relativeTouchFromPointer=getRelativeTouchByPointerType(e);try{mouseScrollX=x;mouseScrollY=y;var x=startMouseX;var y=startMouseY;if(productId=="virtualui"){var headerBtnElem=
_args.extra.getElementFromPoint({"touches":[{"pageX":x,"pageY":y}]});if(headerBtnElem&&headerBtnElem.parentElement!=null&&headerBtnElem.parentElement.className=="buttons"){$(headerBtnElem).click();e.preventDefault();return}}let dNow=Date.now();var mPosition=coord2Abs(x,y);if(relativeTouchFromPointer)fireEvent("showMouseMask",mPosition.x+32,mPosition.y+32,"clickEffect",true,_defaultEventFire);else fireEvent("showMouseMask",x/_props.zoomFactor,y/_props.zoomFactor,"clickEffect",true,_defaultEventFire);
if(_doubleClick.enable){if(dNow-_doubleClick.previousEvtTime<_doubleClick.maxTime){let d=Math.abs(x-_doubleClick.pos.x)+Math.abs(y-_doubleClick.pos.y);if(d<_doubleClick.threshold){x=_doubleClick.pos.x;y=_doubleClick.pos.y}}_doubleClick.pos.x=x;_doubleClick.pos.y=y}_doubleClick.previousEvtTime=dNow;singleClick(x,y,relativeTouchFromPointer,button,true);if(productId!="webfmx"&&productId!="virtualui")lastMouseClickPosition=mPosition}finally{touchstate=0}if(touchstate==3)mouseMoveIntoView()}},"pressRelease":function(e){if(_args.extra.preventDefault(e))return;
var relativeTouchFromPointer=getRelativeTouchByPointerType(e);var p=findPos(_args.container);var x=relativeTouchFromPointer?cursorCanvasX():startMouseX;var y=relativeTouchFromPointer?cursorCanvasY():startMouseY;let abs=coord2Abs(x,y);_methods.pressAndRelease(abs.x,abs.y)},"holdLeft":function(e){_actionsProcessors.hold(e,"left")},"holdRight":function(e){_actionsProcessors.hold(e,"right")},"releaseLeft":function(e){_actionsProcessors.release(e,"left")},"releaseRight":function(e){_actionsProcessors.release(e,
"right")},"releaseAll":function(e){actions.releaseLeft(e);actions.releaseRight(e);fireEvent("release",e,_defaultEventFire)},"doubleClick":function(e){var relativeTouchFromPointer=getRelativeTouchByPointerType(e);var x=relativeTouchFromPointer?cursorCanvasX():startMouseX;var y=relativeTouchFromPointer?cursorCanvasY():startMouseY;btnLeftClick(x,y);btnLeftClick(x,y)},"rightClick":function(e){var relativeTouchFromPointer=getRelativeTouchByPointerType(e);var x=relativeTouchFromPointer?cursorCanvasX():
startMouseX;var y=relativeTouchFromPointer?cursorCanvasY():startMouseY;sendButtonRight(x,y)},"swipeFromEdge":function(){if(_methods.swipeFromEdge)_methods.swipeFromEdge()},"swipe":function(e){if(_methods.swipe)_methods.swipe()},"focus":function(e){}};var actionsCompatibility=[{name:"focus",products:["virtualui"]}];actionsCompatibility.forEach(function(t){if(_touchManager["actions"][t.name]&&!t.products.includes(productId))delete _touchManager["actions"][t.name]});_touchManager["gesturesMiddleware"]=
function(e){return checkUIAndPointerType(e)};_touchManager["touchStartRedirection"]=function(e,touches){_args.extra.preventDefault(e);redirectTouches("begin",touches)};_touchManager["touchMoveRedirection"]=function(e,touches){_args.extra.preventDefault(e);redirectTouches("update",touches)};_touchManager["touchEndRedirection"]=function(e,touches){_args.extra.preventDefault(e);redirectTouches("end",touches)};_touchManager.initialize(document.body,_args.gestures,{});if(_readyCallback)_readyCallback();
_ready=true}function findPos(obj){var curleft=0;var curtop=0;do{curleft+=obj.offsetLeft;curtop+=obj.offsetTop}while(obj=obj.offsetParent);return[curleft,curtop]}function redirectTouches(action,touchList){var vncd=_args.container;for(var i=0;i<touchList.length;i++){var touch=touchList[i];let s=_props.scale;var x=(touch.pageX-vncd.offsetLeft+vncd.scrollLeft)/s|0;var y=(touch.pageY-vncd.offsetTop+vncd.scrollTop)/s|0;var id=touch.identifier;_methods.sendEvent(`cmd=touch&action=${action}&id=${id}&x=${x}&y=${y}`)}}
function coord2Abs(x,y){let position=findPos(_args.container);return{x:(x-position[0])/_props.scale,y:(y-position[1])/_props.scale}}function mouseDown(x,y,isRelative,button){lastY=y;let abs=coord2Abs(getRelativeX(x,isRelative)+deltaCursorX,getRelativeY(y,isRelative)+deltaCursorY);_methods.sendMouse(abs.x,abs.y,button=="right"?2:0,"down")}function mouseUp(x,y,isRelative,button){let abs=coord2Abs(getRelativeX(x,isRelative)+deltaCursorX,getRelativeY(y,isRelative)+deltaCursorY);_methods.sendMouse(abs.x,
abs.y,button=="right"?2:0,"up")}function mouseMove(x,y,isRelative){var relX=getRelativeX(x,isRelative)+deltaCursorX;var relY=getRelativeY(y,isRelative)+deltaCursorY;let abs=coord2Abs(relX,relY);_methods.sendMouse(abs.x,abs.y,0,"move");if(lastEvent&&getRelativeTouchByPointerType(lastEvent)){startMouseX=savedX;startMouseY=savedY}}function mouseMoveIntoView(){if(_props.relativeTouch){var x=cursorCanvasX();var y=cursorCanvasY();var z=_props.zoomFactor;if(x<=_args.container.scrollLeft*z)x=_args.container.scrollLeft*
z;else if(x>=(_props.maxWidth+_args.container.scrollLeft)*z)x=(_props.maxWidth+_args.container.scrollLeft)*z;if(y<=_args.container.scrollTop*z)y=_args.container.scrollTop*z;else if(y>=(_props.maxHeight+_args.container.scrollTop)*z)y=(_props.maxHeight+_args.container.scrollTop)*z;if(x!=cursorCanvasX()||y!=cursorCanvasY()){let abs=coord2Abs(x,y);_methods.mouseMove(abs.x,abs.y)}}}function getRelativeX(X,isRelative){if(isRelative){savedX=X;X=X-startMouseX+cursorCanvasX();X=X<0?0:X}return Math.round(X)}
function getRelativeY(Y,isRelative){if(isRelative){savedY=Y;Y=Y-startMouseY+cursorCanvasY();Y=Y<0?0:Y}return Math.round(Y)}function getRelativeTouchByPointerType(ev){return!_props.relativeTouch||ev&&ev.pointerType==="pen"?false:_props.relativeTouch}function cursorCanvasX(){return _props.cursorCanvasX}function cursorCanvasY(){return _props.cursorCanvasY}function dispose(){if(_touchManager){oInterface.off("serverSupportsRedirection",_touchManager.serverSupportsRedirection);oInterface.off("startTouchRedirection",
_touchManager.reconfigureForRedirection);oInterface.off("stopTouchRedirection",_touchManager.reconfigureForLocalGestures)}_readyCallback=null;_touchManager=null;fireEvent=_noop;_ready=false}function ready(callback){if(_ready)callback();_readyCallback=callback}initialize();Object.defineProperty(_ref,"dispose",{enumerable:true,configurable:false,writable:false,value:dispose});Object.defineProperty(_ref,"ready",{enumerable:true,configurable:false,writable:false,value:ready});return _ref}try{Thinfinity!=
undefined}catch(e){Thinfinity={}}if(Thinfinity.Driver===undefined)Thinfinity.Driver={};Thinfinity.Driver.Touch=DTouch;Object.defineProperty(DTouch,"defaultTouchGestures",{"enumerable":true,"configurable":false,"get":function(){return _defaultTouchGestures}})})();
(function(){function ThinClipboard(args){var self=this;var ftPath="ft/";this.fileUpload={arrayJsonData:null,maxUploadCount:3,uploaded:0,nextUploadIdx:0,uploading:0,uploadErrors:null,filesUploading:null,uploadErrors:null,onClear:null,onFileAdd:null,onUploadFinish:null,progressBar:null,progressContainerID:"FUProgressContainer",init:function(startDrag){this.clear();if(typeof startDrag=="undefined")startDrag=true;if(startDrag&&window.File&&window.FileReader&&window.FileList&&window.Blob);},clear:function(){this.filesUploading=
new Array;if(this.progressBar!=null){for(var pb=0;pb<this.progressBar.length;pb++)if(this.progressBar[pb]){this.progressBar[pb].remove();delete this.progressBar[pb]}var fupc=document.getElementById(this.progressContainerID);if(fupc)fupc.parentElement.removeChild(fupc);document.getElementById("fileToUpload").form.reset()}this.progressBar=null;if(this.onClear)this.onClear()},add:function(file,path){this.filesUploading.push({"file":file,"path":path});if(this.onFileAdd)this.onFileAdd(file)},startNextUploads:function(){var startFrom=
this.nextUploadIdx;for(var i=startFrom;i<this.toUpload;i++){if(this.uploading>=this.maxUploadCount)break;this.uploadFile(this.filesUploading[i],i);this.nextUploadIdx++;this.uploading++}},startUploading:function(){if(this.uploading==0){this.uploaded=0;this.nextUploadIdx=0;this.uploadErrors=new Array;this.arrayJsonData=new Array}this.toUpload=this.filesUploading.length;for(var i=0;i<this.toUpload;i++)this.addProgress(this.filesUploading[i],i);this.startNextUploads()},uploadFile:function(fileItem,idx){if(typeof FormData!=
"undefined"){var fd=new FormData;fd.append("fileToUpload",fileItem.file);helper.ajax.post({"timeout":0,"url":"clip/"+encodeURIComponent(fileItem.path+(fileItem.path.length==0?"":"/")+fileItem.file.name),"beforeSend":function(xhr){if(typeof window.addEventListener!="undefined"){xhr.upload.addEventListener("progress",function(evt){if(!self.fileUpload.uploadProgress(evt,idx))xhr.abort()},false);xhr.addEventListener("load",function(evt){self.fileUpload.uploadComplete(evt,fileItem.file.name,idx)},false);
xhr.addEventListener("error",function(evt){self.fileUpload.uploadFailed(evt,fileItem.file.name,idx)},false);xhr.addEventListener("abort",function(evt){self.fileUpload.uploadCanceled(evt,idx)},false)}else if(typeof window.attachEvent!="undefined"){xhr.upload.attachEvent("progress",function(evt){if(!self.fileUpload.uploadProgress(evt,idx))xhr.abort()},false);xhr.attachEvent("load",function(evt){self.fileUpload.uploadComplete(evt,fileItem.file.name,idx)});xhr.attachEvent("error",function(evt){self.fileUpload.uploadFailed(evt,
fileItem.file.name,idx)});xhr.attachEvent("abort",function(evt){self.fileUpload.uploadCanceled(evt,idx)})}xhr.setRequestHeader("X-Request-Condition","no-webdav");xhr.setRequestHeader("X-Request-Sanitize","false");xhr.setRequestHeader("X-Request-UploadType","clip")},"data":fd})}},uploadProgress:function(evt,idx){if(!this.progressBar||!this.progressBar[idx]){logError("uploadProgress: progressBar not assigned.");return false}if(evt.lengthComputable){var pc=parseInt(evt.loaded/evt.total*100);this.progressBar[idx].maxValue=
100;this.progressBar[idx].setPos(pc)}else{this.progressBar[idx].maxValue=0;this.progressBar[idx].setMessage(thinRDPconsts.uploading)}return true},uploadComplete:function(evt,filename,idx){var fu=self.fileUpload;var src=evt.sourceElement||evt.target;if(src&&src.status!=200)if(!src.responseXML)if(typeof src.readyState=="undefined"||src.readyState!="complete"){fu.uploadFailed(evt,filename,idx);return}else this.progressBar[idx].setPos(100);else if(!src.responseText.match(/200 OK/)){fu.uploadFailed(evt,
filename,idx);return}$(window).trigger("uploadComplete");logDebug("uploadComplete "+idx);fu.uploading--;fu.uploaded++;if(fu.uploaded==fu.toUpload)fu.uploadFinish();else fu.startNextUploads()},uploadFailed:function(evt,filename,idx){var fu=self.fileUpload;$(window).trigger("uploadFailed",evt);var src=evt.sourceElement||evt.target;var sError=helper.string.sprintf("Error %s (%s) uploading '%s'",src.status,src.statusText,filename);fu.uploadErrors.push(sError);logDebug("upload failed "+idx+": "+sError);
this.progressBar[idx].setClass("failed");fu.uploading--;fu.uploaded++;if(fu.uploaded==fu.toUpload)fu.uploadFinish();else fu.startNextUploads()},uploadCanceled:function(evt,idx){var fu=self.fileUpload;$(window).trigger("uploadCanceled");logDebug("upload canceled "+idx);if(!this.progressBar||!this.progressBar[idx]){logError("uploadCanceled: progressBar not assigned.");return}this.progressBar[idx].setClass("failed");fu.uploading--;fu.uploaded++;if(fu.uploaded==fu.toUpload)fu.uploadFinish();else fu.startNextUploads()},
uploadFinish:function(){if(this.onUploadFinish)this.onUploadFinish(this);else{function clearFileUpload(){self.fileUpload.clear();Thinfinity.Popups.unblock()}clearFileUpload()}},progressContainer:function(){var fuc=document.getElementById(this.progressContainerID);if(!fuc)fuc=helper.dom.appendJsonElement({"parentElement":document.body,"type":"div","attributes":{"id":this.progressContainerID}});return fuc},addProgress:function(fileItem,idx){if(!this.progressBar)this.progressBar=new Array;if(idx<this.progressBar.length)return;
var fuc=this.progressContainer();var pb=new ProgressBar({"id":this.progressContainerID,"idx":idx,"fileName":fileItem.path+"/"+fileItem.file.name,"background-color":"#FF0","barHeight":"20px","mask":"<span class='upfilename'>"+fileItem.file.name+" ("+this.formatedSize(fileItem.file.size)+")</span><span class='upfilepercent'>$d%</span>"});pb.init();pb.setMessage(fileItem.file.name+" ("+this.formatedSize(fileItem.file.size)+")");this.progressBar[idx]=pb},formatedSize:function(val){var unit=" KB";if(val>
1048576){val=val/1048576;unit=" MB"}else val=val/1024;return Math.ceil(val*100)/100+unit}};var _ref=this;var _initialized=false;var _binded=false;var _type="clipboard";var _copyingTemplate=null;var _asyncCopy=false;var _args={inputElem:null,parentElement:null,canPasteFiles:true,properties:null,methods:{setSelectionRange:null,sendEvent:null,sendCmd:null,sendData:null,convertImgURLToBase64:null,getBasicHTMLImg:null,output:null,clearText:null,request:null},events:{copy:null,paste:null,cut:null,localPaste:null,
copyFiles:null}};var _clipboardSettings=null;var fireEvent=null;var _te={};var _untreatData=[];var _lastCopy={hash:null,types:[]};function initialize(){helper.object.parseAttributes(_args,args);if(args?.properties?.clipboard){helper.object.parseAttributes(_args,args.properties.clipboard);_clipboardSettings=args.properties.clipboard;synchronizeClipboard()}fireEvent=(new Thinfinity.Events({"owner":_te,"events":_args.events})).fireEvent;if(!agentInfo.isMac&&!_initialized)initText();bindEvents();var ct=
document.getElementById("copyingTemplate");if(ct)_copyingTemplate=ct;else if(!_copyingTemplate)_copyingTemplate=helper.dom.appendJsonElement({type:"div",parentElement:_args.parentElement,attributes:{id:"copyingTemplate",class:"copyingTemplate hidden"},content:consts.copyingMsg})}function synchronizeClipboard(){if(_clipboardSettings?.properties?.synchronizeClipboard){function isValidFormat(mimetype){return!mimetype.startsWith("image/")}navigator.permissions.query({name:"clipboard-read"}).then(permission=>
{if(permission.state==="denied")throw new Error("Not allowed to access to the clipboard.");else if(args.on){let textHash=null;var syncRemoteClipboard=e=>{let clipboardContentHandler=clipboardContents=>{_args.methods.sendEvent("cmd=cli&type=precli&action=paste&id="+_args.properties.sid);let promisesTypes=[];for(const item of clipboardContents)if(item.types)item.types.forEach(type=>{promisesTypes.push(item.getType(type))});Promise.all(promisesTypes).then(values=>{let promisesValues=[];let mimetypes=
[];if(values)values.forEach(res=>{if(res&&isValidFormat(res.type)){mimetypes.push(res.type);promisesValues.push(res.text())}else;});let arrayJsonData=[];Promise.all(promisesValues).then(values=>{let idx=0;values.forEach(text=>{arrayJsonData.push({mimetype:mimetypes[idx++],textdata:text})});let th=convertToHash(arrayJsonData.map(item=>{return item.textdata}).join(""));if(textHash!=th){textHash=th;_args.methods.sendData("cmd?id="+_args.properties.sid+"&cmd=cli&type=clipboard&action=clisync",encodeURIComponent(JSON.stringify(arrayJsonData)));
_args.methods.output({"cmd":"focus"})}})})};navigator.clipboard.read({unsanitized:["text/html"]}).then(clipboardContentHandler).catch(err=>{mustBeSynchronized=true;helper.console.log(`Cannot synchronize clipboard, ${err.message||err}`);args.__prototype__.fireEvent("requireUserInteractionAction")})};var syncLocalClipboard=obj=>{let textData=null;if(obj?.val)try{textData=JSON.parse(obj.val)}catch(err){helper.console.log(`Cannot synchronize local clipboard, invalid data.`)}if(textData){let clipItems=
{};let formatsCount=0;textData.forEach(item=>{if(ClipboardItem.supports(item.mimetype))if(item.mimetype.startsWith("image/"));else{clipItems[item.mimetype]=new Blob([item.textdata],{type:item.mimetype});formatsCount++}});if(formatsCount>0)navigator.clipboard.write([new ClipboardItem(clipItems)]).then(r=>{helper.console.log("Local clipboard was synchronized successfully!")}).catch(err=>{helper.console.log("Local clipboard cannot be synchronized.",err)})}};args.on("userInteractionAction",syncRemoteClipboard);
args.on("synchronizeRemoteClipboard",syncRemoteClipboard);args.on("synchronizeLocalClipboard",syncLocalClipboard);syncRemoteClipboard()}})}}function convertToHash(str){let maxLen=65;let arr=(new Array(maxLen)).fill(65);let pos=0;for(let i=0,t=Math.min(str.length-1,maxLen);i<t;i++){if(pos>maxLen)pos=0;arr[pos]+=str.charCodeAt(i);if(arr[pos]>127)arr[pos]=arr[pos]-128;pos++}return arr.join("")}function getHash(clipboardData,types){let hash="";let _types=[];if(clipboardData){let maxLen=65;let arr=(new Array(maxLen)).fill(65);
let pos=0;var convertToValue=function(str,arr){for(let i=0,t=str.length;i<t;i++){if(pos>maxLen)pos=0;arr[pos]+=str.charCodeAt(i);if(arr[pos]>127)arr[pos]=arr[pos]-128;pos++}};if(clipboardData instanceof DataTransfer)types.forEach(type=>{convertToValue(type+clipboardData.getData(type),arr)});else if(clipboardData instanceof Array)clipboardData.forEach(function(item){convertToValue(item.mimetype+item.textdata,arr);_types.push(item.mimetype)});else{convertToValue(types[0]+clipboardData,arr);_types=types}arr.forEach(function(v){hash+=
String.fromCharCode(v)})}return{hash,types:_types}}function isClipboardEmpty(clipboard){let isEmpty=true;if(clipboard)isEmpty=clipboard.files.length===0&&clipboard.items.length===0&&clipboard.types.length===0;return isEmpty}function bindEvents(){if(!_binded){if(!_args.inputElem)return;if(agentInfo.isMSIE)if(_args.methods.setSelectionRange)_args.methods.setSelectionRange();else{_args.inputElem.value="XXXX";_args.inputElem.setSelectionRange(0,3)}helper.dom.addEvent(_args.inputElem,"copy",copyHandler,
false);helper.dom.addEvent(_args.inputElem,"cut",cutHandler,false);helper.dom.addEvent(_args.inputElem,"paste",pasteHandler,false);helper.dom.addEvent(window,"focus",windowFocusHandler,false);if(!agentInfo.isMac)helper.dom.addEvent(_args.inputElem,"keydown",keydownHandler,false);_binded=true;_initialized=true}}function copyHandler(e){e.preventDefault();unbindEvents();var clipboardData=window.clipboardData!=undefined?window.clipboardData:e.clipboardData!=undefined?e.clipboardData:null;if(clipboardData){e.stopPropagation();
e.preventDefault();synccopy(clipboardData,false)}else bindEvents();setTimeout(function(){clear();setText("XXXX")},100)}function getFilesAndDirs(dt,finish){var dirScans=0;var dirScansDone=0;var queuedFiles=0;var addedFiles=0;var dataItems=new Array;var processFileEntry=function(item,dirPath){if(item.isDirectory){var directoryReader=item.createReader();readDirectory(directoryReader,dirPath+(dirPath.length==0?"":"/")+item.name)}else{queuedFiles++;item.file(function(file){dataItems.push({"path":dirPath,
"file":file});addedFiles++},function(){addedFiles++})}};var readDirectory=function(dirReader,dirPath){dirScans++;dirReader.readEntries(function(entries){entries.forEach(function(entry){processFileEntry(entry,dirPath)});if(entries.length>0)readDirectory(dirReader,dirPath);dirScansDone++})};if(dt&&dt.items)for(var i=0;i<dt.items.length;i++){var item=null;if(typeof dt.items[i].webkitGetAsEntry!="undefined")item=dt.items[i].webkitGetAsEntry();else if(typeof dt.items[i].getAsEntry!="undefined")item=dt.items[i].getAsEntry();
if(item)processFileEntry(item,"")}var finishInterval=setInterval(function(){if(dirScansDone>=dirScans&&addedFiles>=queuedFiles){clearInterval(finishInterval);finish(dataItems)}},20)}function pasteHandler(e){e.preventDefault();var arrayJsonData=[];e.stopPropagation();e.preventDefault();var clipboardData=window.clipboardData!=undefined?window.clipboardData:e.clipboardData!=undefined?e.clipboardData:null;if(isClipboardEmpty(clipboardData)||_lastCopy&&_lastCopy.hash===getHash(e.clipboardData,_lastCopy.types).hash)if(fireEvent("localPaste",
{},{"async":false}).preventExecution===true)return;_lastCopy=null;fireEvent("paste",{"cmd":"start"},{"async":false});var cmd="cmd=cli&type=precli&action=paste&id="+_args.properties.sid;_args.methods.sendEvent(cmd);if(clipboardData){var mimetype="text/plain";var filesToUpload=false;if(agentInfo.isMSIE&&agentInfo.msieVersion<=11){setText(clipboardData.getData("text"));arrayJsonData.push({"mimetype":mimetype,"textdata":clipboardData.getData("text")})}else{if(agentInfo.isSafari)if(clipboardData.types){clipboardData.types.length;
for(var i=0;i<clipboardData.types.length;i++){arrayJsonData.push({"mimetype":clipboardData.types[i],"textdata":clipboardData.getData(clipboardData.types[i])});if(arrayJsonData[arrayJsonData.length-1].textdata==undefined)arrayJsonData[arrayJsonData.length-1].textdata=""}var idx={"url":null,"image":null,"newItem":null};for(var i=0;i<arrayJsonData.length;i++){if(arrayJsonData[i].mimetype.substring(0,6)=="image/")idx.image=i;if(arrayJsonData[i].mimetype=="public.url")idx.url=i}if(idx.url!=null&&idx.image!=
null){arrayJsonData.push({"mimetype":"","textdata":undefined});idx.newItem=arrayJsonData.length-1;_args.methods.convertImgURLToBase64(arrayJsonData[idx.url].textdata,"image/png",function(mimetype,blob){if(blob!=null){var extension=arrayJsonData[idx.image].mimetype.substring(arrayJsonData[idx.image].mimetype.indexOf("/")+1,arrayJsonData[idx.image].mimetype.length);for(var i=arrayJsonData.length-1;i>=0;i--)if(arrayJsonData[i].mimetype.indexOf(extension)!=-1){arrayJsonData.splice(i,1);idx.newItem--}arrayJsonData[idx.newItem].mimetype=
mimetype;arrayJsonData[idx.newItem].textdata=blob}else{var response=_args.methods.getBasicHTMLImg(arrayJsonData[idx.url].textdata);if(response)arrayJsonData[idx.newItem]={"mimetype":"text/html","textdata":response};else arrayJsonData.splice(idx.newItem,1)}})}}else;else{for(var index=clipboardData.items.length-1;index>=0;index--){var item=clipboardData.items[index];if(item.kind==="file"){let hasEntry=null;try{if(typeof item.webkitGetAsEntry!="undefined")hasEntry=item.webkitGetAsEntry();else if(typeof item.getAsEntry!=
"undefined")hasEntry=item.getAsEntry()}catch(err){helper.console.debug(helper.string.format("Could not process item with getAsEntry '{0}' - type: '{1}'",item.kind,item.type),arguments)}if(hasEntry){if(!_args.canPasteFiles)continue;if(!filesToUpload){filesToUpload=true;if(self.fileUpload.uploading==0)self.fileUpload.init(false)}}else if(item.type.substring(0,6)=="image/"||item.type=="application/x-moz-file"){arrayJsonData.push({"mimetype":item.type,"item":item,"getTextData":async function(index){var blob=
arrayJsonData[index].item.getAsFile();if(agentInfo.isFirefox)arrayJsonData[index].mimetype=blob.type;var reader=new FileReader;reader.onload=function(event){arrayJsonData[index].textdata=event.target.result!=undefined?event.target.result:"";delete arrayJsonData[index].item;delete arrayJsonData[index].getTextData};reader.readAsDataURL(blob)}});arrayJsonData[arrayJsonData.length-1].getTextData(arrayJsonData.length-1)}}else if(item.kind==="string")try{mimetype=item.type;arrayJsonData.push({"mimetype":item.type,
"item":item,"getTextData":function(index){arrayJsonData[index].item.getAsString(function(elem){arrayJsonData[index].textdata=elem!=undefined?encodeURIComponent(elem):"";delete arrayJsonData[index].item;delete arrayJsonData[index].getTextData})}});arrayJsonData[arrayJsonData.length-1].getTextData(arrayJsonData.length-1)}catch(error){helper.console.warning(helper.string.format("Unknown kind: '{0}' - type: '{1}'",item.kind,item.type),arguments)}else helper.console.warning(helper.string.format("Unknown kind: '{0}' - type: '{1}'",
item.kind,item.type),arguments)}if(filesToUpload)getFilesAndDirs(clipboardData,function(fileList){function sendFiles(){var fileIndex=0;for(var fileItem of fileList){arrayJsonData.push({"mimetype":"application/octet-stream","textdata":{"index":fileIndex++,"filename":fileItem.file.name,"path":fileItem.path,"size":fileItem.file.size}});self.fileUpload.add(fileItem.file,fileItem.path)}self.fileUpload.startUploading();self.postPaste(arrayJsonData)}var url="cmd?id="+_args.properties.sid+"&cmd=cli&type="+
_type+"&action=canPasteFiles";var params={url,async:_asyncCopy,cache:false,dataType:"json",error:function(jqXHR,err){},success:function(obj){if(typeof obj=="string")obj=JSON.parse(obj);if(typeof obj.res!="undefined"&&obj.res===true)sendFiles();else{var msg=consts.pasteOperationInProgress;if(typeof obj.canRetry!="undefined"&&obj.canRetry===true)Thinfinity.Popups.choice({"parentElement":document.body,"id":"pasteRetryDlg","iconType":"alertIco","title":"Clipboard","message":msg,"buttons":[{"value":consts.ok,
"class":"","action":function(){_args.inputElem.focus()}},{"value":consts.retry,"class":"","action":sendFiles}]});else{if(typeof obj.disabled!="undefined"&&obj.disabled===true)msg=consts.clipboardFileTransferDisabled;Thinfinity.Popups.alert(msg,"Clipboard","","","",function(){Thinfinity.Popups.unblock();_args.inputElem.focus()},false)}}}};_args.methods.request(params)})}if(arrayJsonData.length==0&&!filesToUpload)setText(clipboardData.getData(mimetype))}if(!filesToUpload)var intrv=setInterval(function(){if(arrayJsonData.length>
0){for(var i=0;i<arrayJsonData.length;i++)if(typeof arrayJsonData[i].textdata=="undefined")return;clearInterval(intrv);postPaste(arrayJsonData)}},100)}if(arrayJsonData.length==0)if(agentInfo.isMac)postPaste({});else setTimeout(function(){postPaste({})},100)}function postPaste(arrayJsonData){_args.methods.sendData("cmd?id="+_args.properties.sid+"&cmd=cli&type=clipboard&action=paste",encodeURIComponent(JSON.stringify(arrayJsonData)));initText();if(agentInfo.isMac&&agentInfo.isChrome)_args.methods.output({"cmd":"focus"});
fireEvent("paste",{"cmd":"done"},{"async":false})}function cutHandler(e){e.preventDefault();unbindEvents();var clipboardData=window.clipboardData!=undefined?window.clipboardData:e.clipboardData!=undefined?e.clipboardData:null;if(clipboardData){e.stopPropagation();e.preventDefault();synccopy(clipboardData,true)}else bindEvents();setTimeout(function(){initText()},100)}function windowFocusHandler(e){if(_untreatData.length>0){if(_asyncCopy)_untreatData.forEach(function(item){writeClipboardData(null,item.clipContent,
item.eventName)});_untreatData=[]}}function keydownHandler(e){if(e.ctrlKey&&!e.altKey&&e.keyCode!=17&&agentInfo.isFirefox)if(e.keyCode==88||e.keyCode==86||e.keyCode==67){e.stopPropagation();return}}function setResponseToClipboard(clipboardData,clipContent,eventName){var hf=document.hasFocus();if(hf||!_asyncCopy)writeClipboardData(clipboardData,clipContent,eventName);else _untreatData.push({eventName,clipContent})}function writePNG(data){const img=new Image;const c=document.createElement("canvas");
const ctx=c.getContext("2d",{willReadFrequently:true});function setCanvasImage(path,callback){img.onload=function(){c.width=this.naturalWidth;c.height=this.naturalHeight;ctx.drawImage(this,0,0);c.toBlob(blob=>{callback(blob)},"image/png")};img.src=path}setCanvasImage("data:image/png;base64,"+data,imgBlob=>{_lastCopy=null;navigator.clipboard.write([new ClipboardItem({"image/png":imgBlob})]).then(res=>{delete img;delete c}).catch(e=>{helper.console.warning(e);delete img;delete c})})}function writeClipboardData(clipboardData,
clipContent,eventName){_lastCopy=null;try{if(typeof clipContent=="object"){var binData=[];for(var i=0;i<clipContent.length;i++){var content=clipContent[i];if(_asyncCopy){var blob=new Blob([content.textdata],{type:content.mimetype});binData.push(new ClipboardItem({[content.mimetype]:blob}))}else if(content.mimetype=="image/png")writePNG(content.textdata);else{var handled=false;if(content.mimetype=="application/json"){var clipData=JSON.parse(content.textdata);if(clipData.type)if(clipData.type=="fileList"&&
_clipboardSettings.properties.permissions.fileTransfer){var list=[];clipData.files.forEach(function(item){list.push({date:item.date,filename:item.filename,download:`clip/${item.filename}`,url:`clip/${item.filename}`,size:item.size})});fireEvent("copyFiles",list,{"async":false});handled=true;clipboardData.setData("text/plain","");_lastCopy=getHash("",["text/plain"])}}if(!handled){clipboardData.setData(content.mimetype,content.textdata);_lastCopy=getHash(content.textdata,[content.mimetype])}}}if(_asyncCopy)if(!document.hasFocus())fireEvent(eventName,
{"cmd":"err","msg":"DOMException: Document is not focused"},{"async":false});else navigator.clipboard.write(binData)}else{if(!_asyncCopy)clipboardData.setData("text/plain",clipContent);else navigator.clipboard.writeText(clipContent);_lastCopy=getHash(clipContent,["text/plain".mimetype])}fireEvent(eventName,{"cmd":"done"},{"async":false})}catch(err){helper.console.error("[Clipboard] Something went wrong while trying to set clipboard data.",err)}}function unbindEvents(){if(_binded==true){helper.dom.removeEvent(_args.inputElem,
"copy",copyHandler);helper.dom.removeEvent(_args.inputElem,"cut",cutHandler);helper.dom.removeEvent(_args.inputElem,"paste",pasteHandler);helper.dom.removeEvent(_args.inputElem,"keydown",keydownHandler);helper.dom.removeEvent(document,"focus",windowFocusHandler,false)}_binded=false}function initText(){clear();setText("XXXX")}function setText(text){_args.methods.output({"cmd":"settext","value":text});_args.methods.setSelectionRange()}function clear(){_args.methods.clearText()}function synccopy(clipboardData,
cut){var cmd="cmd=cli&type=precli&action="+(cut?"cut":"copy")+"&id="+_args.properties.sid;_args.methods.sendEvent(cmd);var result="";var url="cmd?id="+_args.properties.sid+"&cmd=cli&type="+_type;if(cut!=undefined&&cut)url+="&action=cut&dokey=true";else url+="&action=copy&dokey=true";var eventName=cut===true?"cut":"copy";if(fireEvent(eventName,{"cmd":"start"},{"async":false}).preventExecution!==true)helper.style.replace(_copyingTemplate,"hidden","visible");try{var params={url,async:_asyncCopy,cache:false,
dataType:"json",error:function(jqXHR,err){helper.style.replace(_copyingTemplate,"visible","hidden");bindEvents();if(fireEvent(eventName,{"cmd":"error","err":err},{"async":false}).preventExecution!==true)alert(helper.string.sprintf(consts.connectError,JSON.stringify(err)))},success:function(obj){try{bindEvents();if(obj&&typeof obj.types=="undefined")try{obj=JSON.parse(obj)}catch(error){}if(obj&&typeof obj.types!=="undefined"){var textVal="";for(var i=0;i<obj.types.length;i++)if(obj.types[i].mimetype==
"text/plain"){textVal=obj.types[i].textdata;break}if(textVal!="")setText(textVal);result=obj.types}else if(obj&&typeof obj.text!=="undefined"){setText(obj.text);result=obj.text}if(agentInfo.isMac)setText("XXXX")}catch(err){if(fireEvent(eventName,{"cmd":"error","err":err},{"async":false}).preventExecution!==true)alert(helper.string.sprintf(consts.connectError,err))}finally{helper.style.replace(_copyingTemplate,"visible","hidden")}setResponseToClipboard(clipboardData,result,eventName)}};_args.methods.request(params)}catch(e){bindEvents();
alert(e)}if(agentInfo.isMac)_args.methods.output({"cmd":"maccmd","value":"RELEASED"})}function dispose(){unbindEvents();_initialized=false}initialize();Object.defineProperty(_ref,"postPaste",{"enumerable":true,"configurable":false,"writable":false,"value":postPaste});Object.defineProperty(_ref,"setText",{"enumerable":true,"configurable":false,"writable":false,"value":setText});Object.defineProperty(_ref,"dispose",{"enumerable":true,"configurable":false,"writable":false,"value":dispose});Object.defineProperty(_ref,
"onCopy",{"enumerable":true,"configurable":false,"set":function(handler){_te.on("copy",handler)}});Object.defineProperty(_ref,"onPaste",{"enumerable":true,"configurable":false,"set":function(handler){_te.on("paste",handler)}});Object.defineProperty(_ref,"onCut",{"enumerable":true,"configurable":false,"set":function(handler){_te.on("cut",handler)}});Object.defineProperty(_ref,"onCopyFiles",{"enumerable":true,"configurable":false,"set":function(handler){_te.on("copyFiles",handler)}});Object.defineProperty(_ref,
"async",{"enumerable":true,"configurable":false,"get":function(){return _asyncCopy},"set":function(value){if(value&&!(navigator.clipboard&&window["ClipboardItem"])){value=false;var msg="";if(location.protocol==="http:")msg=`[Clipboard] Async clipboard is not supported for 'http (not secure)' protocol.`;else msg=`[Clipboard] Async clipboard not supported by current browser. Setting async to false.`;helper.console.warning(msg)}_asyncCopy=value;return _asyncCopy}});return _ref}try{Thinfinity!=undefined}catch(e){Thinfinity=
{}}Thinfinity.Clipboard=ThinClipboard})();
(function(){function PacketReceiver(args){var _ref=this;var _noop=function(){};var _args={properties:{async:false,asyncTimeout:10,checkPacketIndex:false,defaultFireEventArgs:{async:false}},methods:{getRawBinaryHandler:null,arraybufferToString:null},handlers:{0:null,1:null,2:null,3:null,5:null,6:null,7:null,8:null}};var _buffer="";var _soundBuffer="";var _te=null;var _process=null;var _handlers=null;function initialize(){helper.object.parseAttributes(_args,args);_te=new Thinfinity.Events({fireEventArgs:_args.defaultFireEventArgs,
owner:_ref});_process=_args.async===true?asyncProcess:syncProcess;_handlers=_args.handlers}function asyncProcess(data){window.setTimeout(function(){syncProcess(data)},_args.asyncTimeout)}function checkPacketIndex(pckIdx,groupIdx,eod){if(_lastPkt.idx==99&&pckIdx==0&&eod)_lastPkt.idx=-1;if(_lastPkt.idx==-1&&_lastPkt.reset){_lastPkt.reset=false;_lastPkt.idx=pckIdx-1}if(_lastPkt.idx+1!=pckIdx){let msg=null;if(_lastPkt.idx+1<pckIdx)msg=`Missing pkt: ${_lastPkt.idx+1} - last: ${_lastPkt.idx}, current: ${pckIdx}, groupIdx: ${groupIdx}`;
else msg=`Pkt treated - last: ${_lastPkt.idx}, current: ${pckIdx}, groupIdx: ${groupIdx}`;_te.fireEvent("warning",msg);if(eod)_lastPkt.idx=pckIdx;_te.fireEvent("restartConnection")}else if(eod)_lastPkt.idx=pckIdx;else if(_lastPkt.idx==-1)_lastPkt.idx=0}function syncProcess(data){if(typeof data=="object"){var arr=new Uint8Array(data);if(_args.checkPacketIndex)checkPacketIndex(((arr[2]-48)*10|0)+(arr[3]-48|0),((arr[4]-48)*100|0)+((arr[5]-48)*10|0)+(arr[6]-48|0),arr[1]-48);let processed=false;if(arr[0]==
0){var handlerImage=_args.methods.getRawBinaryHandler(arr[1],arr[2],arr[3]);if(handlerImage){handlerImage(data);processed=true}else{logDebug("No raw binary handler found for hid "+arr[1]+", opt1 "+arr[2]+", opt2 "+arr[3]);processed=false}}if(!processed)queueBinary(arr);arr=null}else if(data[0]=="{")_handlers[0](groupindex,arrayView,data);else{if(_args.checkPacketIndex)checkPacketIndex(parseInt(data.substr(2,2),10),parseInt(data.substr(4,3),10),parseInt(data[1],10));var datatype=data[0];var endofdata=
data[1];if(datatype=="2")_soundBuffer+=data.substring(7);else _buffer+=data.substring(7);if(endofdata=="0")return;if(datatype=="0")try{_handlers[0](null,null,_buffer);_buffer=""}catch(err){logError("ERROR: _buffer = "+_buffer);_buffer="";alert("websocket onmessage err: "+err)}else if(datatype=="1"){_handlers[3](_buffer);_buffer="";return}else if(datatype=="2"){_handlers[2](null,window.atob(_soundBuffer));_soundBuffer="";return}}data=null}function queueBinary(arr){var typeofdata=arr[0]-48|0;var handler=
_handlers[typeofdata];var groupindex=((arr[4]-48)*100|0)+((arr[5]-48)*10|0)+(arr[6]-48|0);var dataIndex=7;var arrayView=arr.subarray(dataIndex);if(typeofdata===2)groupindex=((arr[2]-48)*10|0)+(arr[3]-48|0);handler(groupindex,arrayView);arr=null;arrayView=null}function registerHandler(dataType,handler){if(typeof dataType!=="undefined"&&!_handlers[dataType])_handlers[dataType]=handler}initialize();Object.defineProperty(_ref,"process",{enumerable:true,configurable:false,writable:false,value:_process});
Object.defineProperty(_ref,"registerHandler",{enumerable:true,configurable:false,writable:false,value:registerHandler});return _ref}try{Thinfinity!=undefined}catch(e){Thinfinity={}}Thinfinity.PacketReceiver=PacketReceiver})();
(function(){const _options={"DO_NOT_FULL_EXTEND_OBJECT":2};Object.freeze(_options);function OInterface(args){var _ref=this;var _args={_defaultDescriptor:null,_defaultEventFire:null};var _disposeEvent=null;var _defaultDescriptor={configurable:false,writable:false,enumerable:true,readOnly:false};var _defaultEventFire={async:0};var _internalIndex=0;function initialize(){_disposeEvent=_ref.dispose;helper.object.parseAttributes(_args,args);if(_args.defaultDescriptor)helper.object.parseAttributes(_defaultDescriptor,
_args.defaultDescriptor);if(_args.defaultEventFire)helper.object.parseAttributes(_defaultEventFire,_args.defaultEventFire)}function proxyObject(own,o,p){if(!(o instanceof HTMLElement)){if(!o.__prototype__)o.__prototype__={};if(!o.__prototype__.isProxy){var _sharedOwners=[];Object.defineProperty(o.__prototype__,"isProxy",{enumerable:false,configurable:false,get:function(){return true}});Object.defineProperty(o.__prototype__,"sharedOwners",{enumerable:false,configurable:false,get:function(){return _sharedOwners},
set:function(owner){if(_sharedOwners.indexOf(owner)==-1)_sharedOwners.push(owner)}});Object.defineProperty(o.__prototype__,"path",{enumerable:false,configurable:false,get:function(){return p}});return new Proxy(o,{construct:function(target,args){return Reflect.construct(target,args)},apply:function(target,that,args){return Reflect.apply(target,that,args)},get:function(oTarget,sKey){return Reflect.get(oTarget,sKey)},set:function(oTarget,sKey,vValue){let ov=Reflect.get(oTarget,sKey);let r=Reflect.set(oTarget,
sKey,vValue);let n=(p?p+".":"")+sKey;if(ov!==n&&own){let nv=r?vValue:ov;own.__prototype__.fireEvent(n,ov,nv,_defaultEventFire);if(o.__prototype__.sharedOwners)o.__prototype__.sharedOwners.forEach(owner=>{owner.fireEvent(n,ov,nv,_defaultEventFire)})}return r},deleteProperty:function(oTarget,sKey){return Reflect.deleteProperty(oTarget,sKey)},enumerate:function(oTarget,sKey){return Reflect.enumerate(oTarget,sKey)},ownKeys:function(oTarget,sKey){return Reflect.ownKeys(oTarget,sKey)},has:function(oTarget,
sKey){return Reflect.has(oTarget,sKey)},defineProperty:function(oTarget,sKey,oDesc){return Reflect.defineProperty(oTarget,sKey,oDesc)},getOwnPropertyDescriptor:function(oTarget,sKey){return Reflect.getOwnPropertyDescriptor(oTarget,sKey)}})}else{if(typeof o?.__prototype__?.sharedOwners!=="undefined")o.__prototype__.sharedOwners=own.__prototype__;return o}}else return o}function copyEvents(o,t){if(o)for(let e in o)t[e]=o[e]}function getPointerObject(o,p){if(o){if(!(p instanceof Array))p=p.split(".");
let k=p.shift();if(k&&o.hasOwnProperty(k)){if(p.length===0)return{object:o,prop:k};return getPointerObject(o[k],p)}else return{object:o,prop:k}}else return null}function createObject(params){var proxyObject=function(own,o,p){if(!(o instanceof HTMLElement)){if(!o.__prototype__)o.__prototype__={};if(!o.__prototype__.isProxy){Object.defineProperty(o.__prototype__,"isProxy",{enumerable:false,configurable:false,get:function(){return true}});Object.defineProperty(o.__prototype__,"path",{enumerable:false,
configurable:false,get:function(){return p}});return new Proxy(o,{construct:function(target,args){Reflect.construct(target,args)},apply:function(target,that,args){return Reflect.apply(target,that,args)},get:function(oTarget,sKey){return Reflect.get(oTarget,sKey)},set:function(oTarget,sKey,vValue){let ov=Reflect.get(oTarget,sKey);let r=Reflect.set(oTarget,sKey,vValue);let n=(p?p+".":"")+sKey;if(ov!==n&&own)own.__prototype__.fireEvent(n,ov,r?vValue:ov,_defaultEventFire);return r},deleteProperty:function(oTarget,
sKey){return Reflect.deleteProperty(oTarget,sKey)},enumerate:function(oTarget,sKey){return Reflect.enumerate(oTarget,sKey)},ownKeys:function(oTarget,sKey){return Reflect.ownKeys(oTarget,sKey)},has:function(oTarget,sKey){return Reflect.has(oTarget,sKey)},defineProperty:function(oTarget,sKey,oDesc){return Reflect.defineProperty(oTarget,sKey,oDesc)},getOwnPropertyDescriptor:function(oTarget,sKey){return Reflect.getOwnPropertyDescriptor(oTarget,sKey)}})}else return o}else return o};var copyEvents=function(o,
t){if(o)for(let e in o)t[e]=o[e]};var getPropName=function(o,name){if(name.indexOf(".")!==-1){let s=name.split(".");return{n:s[s.length-1],p:name,ap:s.slice(0,s.length-1).join(".")}}else return{n:name}};var getFunctionName=function(fn){if(fn)return fn.name||helper.object.getFunctionName(fn);else{_internalIndex++;return"fn_"+_internalIndex.toString()}};var createProperty=function(mo,o,desc,obj,options){let type=helper.object.getTypeOf(desc).toUpperCase();let _p={};let t=null;switch(type){case "OBJECT":let k=
null;if(desc.source)k=typeof desc.source;else if(desc.value){k=typeof desc.value;desc.source=desc.value}if(k==="function"){_p={n:getFunctionName(desc.source),v:desc.source,w:!desc.ro,c:_defaultDescriptor.configurable,e:_defaultDescriptor.enumerable};if(desc.alias)_p.n=desc.alias}else if(k==="object"){_p.n=desc.alias;_p.g=function(){return desc.source};_p.s=desc.ro?null:function(value){return desc.source=value}}else{t=getPropName(o,desc.source);if(desc.alias){_p.n=desc.alias;mo.__prototype__.alias[desc.alias]=
desc.source}else{if(t.p&&t.n&&t.p!=t.n)mo.__prototype__.alias[t.n]=t.p;_p.n=t.n}_p.c=desc.configurable||_defaultDescriptor.configurable;_p.e=desc.enumerable||_defaultDescriptor.enumerable;if(desc.value){_p.v=desc.value;_p.w=desc.writable||_defaultDescriptor.writable}else{if(desc.get)_p.g=desc.get;else if(t.p)_p.g=function(){return helper.object.getValue(obj,t.p,undefined)};else _p.g=function(){return obj[t.n]};if(desc.set)_p.s=function(value){desc.set.call(this,arguments);mo.__prototype__.fireEvent(t.n,
undefined,value,_defaultEventFire)};else if(!(desc.ro===true)||typeof desc.ro==="undefined"&&!_defaultDescriptor.readOnly)if(t.p)_p.s=function(value){let ov=helper.object.getValue(obj,t.p,undefined);helper.object.setValue(obj,t.p,value);mo.__prototype__.fireEvent(mo.__prototype__.alias[_p.n]||_p.n,ov,value,_defaultEventFire);return helper.object.getValue(obj,t.p,undefined)};else _p.s=function(value){mo.__prototype__.fireEvent(_p.n,obj[_p.n],value,_defaultEventFire);obj[t.n]=value;return obj[t.n]};
_p.u=desc.onUpdate||desc.onChanged;if(obj){let ak=t.ap||t.n;if(typeof obj[ak]==="object")obj[ak]=proxyObject(mo,obj[ak],ak)}}}break;case "STRING":if(obj){t=getPropName(o,desc);if(t.p){_p.n=t.n;_p.g=function(){return helper.object.getValue(obj,t.p,undefined)}}else{_p.n=desc;_p.g=function(){return obj[_p.n]}}if(!_defaultDescriptor.readOnly)if(t.p)_p.s=function(value){let ov=helper.object.getValue(obj,t.n,undefined);helper.object.setValue(obj,t.n,value);mo.__prototype__.fireEvent(mo.__prototype__.alias[_p.n]||
_p.n,ov,value,_defaultEventFire);return helper.object.getValue(obj,t.n,undefined)};else _p.s=function(value){let ov=obj[_p.n];obj[_p.n]=value;mo.__prototype__.fireEvent(_p.n,ov,value,_defaultEventFire);return obj[_p.n]};_p.e=_defaultDescriptor.enumerable;_p.c=_defaultDescriptor.configurable}else return"Invalid";break;case "FUNCTION":_p={n:getFunctionName(desc),v:desc,c:_defaultDescriptor.configurable,e:_defaultDescriptor.enumerable};break}registerProperty(mo,t&&t.o?t.o:o,_p)};var registerProperty=
function(mo,o,prop){var descriptor={enumerable:prop.e,configurable:prop.c};if(prop.v){if(typeof prop.w!=="undefined")descriptor.writable=prop.w;descriptor.value=prop.v}else{if(prop.g)descriptor.get=prop.g;if(prop.s)descriptor.set=prop.s}Object.defineProperty(o,prop.n,descriptor);if(prop.u)mo.on(prop.n,prop.u)};var _masterObj=new Object;let te=new Thinfinity.Events({fireEventArgs:_defaultEventFire});_masterObj.__prototype__={};_masterObj.__prototype__.alias={};_masterObj.__prototype__.fireEvent=te.fireEvent;
_masterObj.__prototype__.disposeEventObj=te.dispose;_masterObj.__prototype__.backup={};_masterObj.__prototype__.clone=()=>{let avoidNames=["methods","properties","events"];let _cloneInterface={methods:{},properties:{},events:{}};for(let kvp in _masterObj)if(avoidNames.indexOf(kvp)===-1)_cloneInterface[kvp]=_masterObj[kvp];for(let kvp in _masterObj.methods)_cloneInterface.methods[kvp]=_masterObj.methods[kvp];_cloneInterface.properties=_masterObj.properties;_cloneInterface.events=_masterObj.events;
return _cloneInterface};Object.defineProperty(_masterObj,"on",{enumerable:true,configurable:false,writable:false,value:function(event,handler){te.on(_masterObj.__prototype__.alias[event]||event,handler)}});Object.defineProperty(_masterObj,"off",{enumerable:true,configurable:false,writable:false,value:function(event,handler){te.off(_masterObj.__prototype__.alias[event]||event,handler)}});let type=helper.object.getTypeOf(params).toUpperCase();switch(type){case "ARRAY":break;case "OBJECT":var props=
{};if(params.events)if(params.namespace===true){_masterObj.events=new Object;copyEvents(params.events,_masterObj.events)}else copyEvents(params.events,_masterObj);if(params.object&&params.properties&&params.properties.length>0){if(params.options.indexOf(_options.DO_NOT_FULL_EXTEND_OBJECT)===-1)params.object=proxyObject(_masterObj,params.object,null);let mp=_masterObj;if(params.namespace===true)mp=_masterObj.properties=new Object;params.properties.forEach(function(prop){createProperty(_masterObj,mp,
prop,params.object,params.options)})}let mm=_masterObj;if(params.namespace===true)mm=_masterObj.methods=new Object;if(params.methods&&params.methods.length>0)params.methods.forEach(function(method){createProperty(_masterObj,mm,method,null,params.options)});if(params.defaultValues)_masterObj.defaultValues=params.defaultValues;Object.defineProperty(props,"newProperty",{enumerable:true,configurable:false,writable:false,value:function(oProperty){if(oProperty instanceof Thinfinity.Object.Property){let mp=
params.namespace===true?_masterObj.properties:_masterObj;createProperty(_masterObj,mp,oProperty.property,params.object,params.options);_masterObj.__prototype__.fireEvent(oProperty.property.source,undefined,undefined,_defaultEventFire)}}});Object.defineProperty(props,"newMethod",{enumerable:true,configurable:false,writable:false,value:function(oMethod){if(oMethod instanceof Thinfinity.Object.Method){let mt=params.namespace===true?_masterObj.methods:_masterObj;createProperty(_masterObj,mt,oMethod.method,
null,params.options);_masterObj.__prototype__.fireEvent(oMethod.method.alias,undefined,undefined,_defaultEventFire)}}});break}Object.freeze(_masterObj.__prototype__);return{new:_masterObj,props}}function getPropName(o,name){if(name.indexOf(".")!==-1){let s=name.split(".");return{n:s[s.length-1],p:name,ap:s.slice(0,s.length-1).join(".")}}else return{n:name}}function getFunctionName(fn){if(fn)return fn.name||helper.object.getFunctionName(fn);else{_internalIndex++;return"fn_"+_internalIndex.toString()}}
function createProperty(mo,o,desc,obj,options){let type=helper.object.getTypeOf(desc).toUpperCase();let _p={};let t=null;switch(type){case "OBJECT":case "OMETHOD":case "OPROPERTY":let k=null;if(desc.source)k=typeof desc.source;else if(desc.value){k=typeof desc.value;desc.source=desc.value}if(k==="function"){_p={n:getFunctionName(desc.source),v:desc.source,w:!desc.ro,c:_defaultDescriptor.configurable,e:_defaultDescriptor.enumerable};if(desc.alias)_p.n=desc.alias}else if(k==="object"){_p.n=desc.alias;
_p.g=function(){return desc.source};_p.s=desc.ro?null:function(value){return desc.source=value}}else{t=getPropName(o,desc.source);if(desc.alias){_p.n=desc.alias;mo.__prototype__.alias[desc.alias]=desc.source}else{if(t.p&&t.n&&t.p!=t.n)mo.__prototype__.alias[t.n]=t.p;_p.n=t.n}_p.c=desc.configurable||_defaultDescriptor.configurable;_p.e=desc.enumerable||_defaultDescriptor.enumerable;if(desc.value){_p.v=desc.value;_p.w=desc.writable||_defaultDescriptor.writable}else{if(desc.get)_p.g=desc.get;else if(t.p)_p.g=
function(){return helper.object.getValue(obj,t.p,undefined)};else _p.g=function(){return obj[t.n]};if(desc.set)_p.s=function(value){desc.set.call(this,arguments);mo.__prototype__.fireEvent(t.n,undefined,value,_defaultEventFire)};else if(!(desc.ro===true)||typeof desc.ro==="undefined"&&!_defaultDescriptor.readOnly)if(t.p)_p.s=function(value){let ov=helper.object.getValue(obj,t.p,undefined);helper.object.setValue(obj,t.p,value);mo.__prototype__.fireEvent(mo.__prototype__.alias[_p.n]||_p.n,ov,value,
_defaultEventFire);return helper.object.getValue(obj,t.p,undefined)};else _p.s=function(value){mo.__prototype__.fireEvent(_p.n,obj[_p.n],value,_defaultEventFire);obj[t.n]=value;return obj[t.n]};_p.u=desc.onUpdate||desc.onChanged;if(obj){let ak=t.ap||t.n;if(typeof obj[ak]==="object")obj[ak]=proxyObject(mo,obj[ak],ak)}}}break;case "STRING":if(obj){t=getPropName(o,desc);if(t.p){_p.n=t.n;_p.g=function(){return helper.object.getValue(obj,t.p,undefined)}}else{_p.n=desc;_p.g=function(){return obj[_p.n]}}if(!_defaultDescriptor.readOnly)if(t.p)_p.s=
function(value){let ov=helper.object.getValue(obj,t.n,undefined);helper.object.setValue(obj,t.n,value);mo.__prototype__.fireEvent(mo.__prototype__.alias[_p.n]||_p.n,ov,value,_defaultEventFire);return helper.object.getValue(obj,t.n,undefined)};else _p.s=function(value){let ov=obj[_p.n];obj[_p.n]=value;mo.__prototype__.fireEvent(_p.n,ov,value,_defaultEventFire);return obj[_p.n]};_p.e=_defaultDescriptor.enumerable;_p.c=_defaultDescriptor.configurable}else return"Invalid";break;case "FUNCTION":_p={n:getFunctionName(desc),
v:desc,c:_defaultDescriptor.configurable,e:_defaultDescriptor.enumerable};break}registerProperty(mo,t&&t.o?t.o:o,_p)}function registerProperty(mo,o,prop){var descriptor={enumerable:prop.e,configurable:prop.c};if(prop.v){if(typeof prop.w!=="undefined")descriptor.writable=prop.w;descriptor.value=prop.v}else{if(prop.g)descriptor.get=prop.g;if(prop.s)descriptor.set=prop.s}Object.defineProperty(o,prop.n,descriptor);if(prop.u)mo.on(prop.n,prop.u)}function newObject(o){if(o)if(o instanceof OInterfaceConfig){let no=
createObject(o.config);return{new:no.new,original:o.config.object,props:no.props}}else;}function dispose(){_disposeEvent()}initialize();Object.defineProperty(_ref,"new",{enumerable:true,configurable:false,writable:false,value:newObject});Object.defineProperty(_ref,"dispose",{enumerable:true,configurable:false,writable:false,value:dispose});return _ref}function OProperty(oProp){var _ref=this;var _prop=null;var _minData=["source"];if(oProp)_prop={...oProp};else _prop={};_minData.forEach(v=>{if(!_prop[v])_prop[v]=
null});Object.defineProperty(_ref,"property",{enumerable:true,configurable:false,get:function(){return _prop}});return _ref}function OMethod(oMethod){var _ref=this;var _method=null;var _minData=["alias","value"];if(oMethod)_method={...oMethod};else _method={};_minData.forEach(v=>{if(!_method[v])_method[v]=null});Object.defineProperty(_ref,"method",{enumerable:true,configurable:false,get:function(){return _method}});return _ref}function OInterfaceConfig(config){var _ref=this;var _config=null;function initialize(){_config=
config}initialize();Object.defineProperty(_ref,"config",{enumerable:true,configurable:false,get:function(){return _config}});return _ref}try{Thinfinity!=undefined}catch(e){Thinfinity={}}if(!Thinfinity.Object)Thinfinity.Object={};Thinfinity.Object.Interface=OInterface;Thinfinity.Object.IConfig=OInterfaceConfig;Thinfinity.Object.Property=OProperty;Thinfinity.Object.Method=OMethod;Object.defineProperty(Thinfinity.Object.IConfig,"OPTIONS",{enumerable:true,configurable:false,get:function(){return _options}})})();
(function(){var _resolution=helper.object.createEnum("CUSTOM","FIT_TO_BROWSER","FIT_TO_SCREEN");function Device(args){var _ref=this;var _args={id:null,name:null,resolution:null,width:0,height:0,physicalWidth:0,physicalHeight:0,orientation:"landscape",desktopScaleFactor:1,deviceScaleFactor:1,external:false,mainDisplay:false,parentElement:null,url:"/display.controller.html",surface:{top:0,left:0},display:{width:0,height:0},window:{top:0,left:0},screen:{width:window.screen.width,height:window.screen.height},
sizeLimit:null,key:null,assigned:false};var _wpAssigned=false;var _oInterface=null;var _methods=null;var _outputInterface=null;var _ready=null;var _resolveObj=null;var _readyCallback=null;var _displayInfo=["id","width","height","physicalWidth","physicalHeight","orientation","desktopScaleFactor","deviceScaleFactor","external","mainDisplay","name","resolution","surface","window","display","screen","assigned"];var _offset={left:0,top:0};var _wndSkin={width:0,height:0};var _messages={reject:{interface:{set:"Interface not supported - TMD",
get:"Interface not supported - TMD - LGI",initializing:"Initializing interface",gettingContent:"    Getting content element",setting:"    Setting interface.",starting:"Starting interface."},load:"Element is null or undefined"},monitor:{openingTab:"Opening tab in: "}};var _remoteWnd=null;var _isEmbedded=false;var _scale=1;var _minZoomFactor=0;var _zoomFactor=1;var _hasFocus=false;var oInterface=null;var fireEvent=null;var _disposed=false;var _repaint=false;function initialize(){helper.object.parseAttributes(_args,
args);fireEvent=(new Thinfinity.Events({"owner":_ref,"events":args.events})).fireEvent;if(args.window&&helper.object.isNumber(args.window.top)&&helper.object.isNumber(args.window.left))_wpAssigned=true;postInitialize()}function postInitialize(){let msg=`Initializing "Thinfinity.Display.Device - name: ${_args.name}, `;_args.width-=_args.width%2;let w=_args.width;let h=_args.height;if(_args.resolution==2){w=window.screen.width;h=window.screen.height}assignDisplaySize(w,h);helper.console.log(msg,arguments);
if(_args.mainDisplay===true||_args.external===false){if(!_args.parentElement)_args.parentElement=document.body;_args.external=false}}function setInterface(){return new Promise((resolve,reject)=>{if(arguments&&arguments[0]instanceof Thinfinity.Display.Manager&&arguments[1]instanceof Object){_oInterface=arguments[1];if(arguments[2])helper.object.parseAttributes(_args.window,arguments[2]);createMonitorContainer().then(resolve).catch(reject)}else reject(_messages.reject.interface.set)})}function createOwnInterfaceInstance(oInterface){if(oInterface?.extra)helper.object.parseAttributes(_args,
oInterface.extra);let external=_args.external===true&&_args.mainDisplay!==true;var _avoidNames=["methods"];if(external)_avoidNames.push("properties");let _ownInterface={methods:{},properties:{}};for(let kvp in oInterface)if(_avoidNames.indexOf(kvp)===-1)_ownInterface[kvp]=oInterface[kvp];for(let kvp in oInterface.methods)_ownInterface.methods[kvp]=oInterface.methods[kvp];_ownInterface.methods.sendMouse=function(x,y,button,action){x+=_args.surface.left;y+=_args.surface.top;oInterface.methods.sendMouse(x,
y,button,action)};_ownInterface.methods.resize=function(id,size){_args.width=_args.physicalWidth=size.width-size.width%2;_args.height=_args.physicalHeight=size.height;assignDisplaySize(size.display.width,size.display.height);if(oInterface.methods.resize)oInterface.methods.resize()};if(external){_avoidNames=["scale","clipboard","zoomFactor","minZoomFactor","hasFocus","repaint"];try{for(let kvp in oInterface.properties)if(_avoidNames.indexOf(kvp)===-1)Object.defineProperty(_ownInterface.properties,
kvp,Object.getOwnPropertyDescriptor(oInterface.properties,kvp));if(oInterface.properties?.clipboard)_ownInterface.properties.clipboard=oInterface.properties.clipboard}catch(error){}}Object.defineProperty(_ownInterface.properties,"scale",{enumerable:true,configurable:false,get:function(){return _scale},set:function(value){_scale=value}});Object.defineProperty(_ownInterface.properties,"minZoomFactor",{enumerable:true,configurable:false,get:function(){return _minZoomFactor},set:function(value){_minZoomFactor=
value}});Object.defineProperty(_ownInterface.properties,"zoomFactor",{enumerable:true,configurable:false,get:function(){return _zoomFactor},set:function(value){_zoomFactor=value}});Object.defineProperty(_ownInterface.properties,"hasFocus",{enumerable:true,configurable:false,get:function(){return _hasFocus},set:function(value){_hasFocus=value}});Object.defineProperty(_ownInterface.properties,"repaint",{enumerable:true,configurable:false,get:function(){return _repaint},set:function(value){if(value!=
_repaint){_repaint=value;_oInterface.__prototype__.fireEvent("repaint",_repaint)}}});if(_ownInterface?.defaultValues)for(let kvp in _ownInterface.defaultValues)if(_ownInterface.properties[kvp])_ownInterface.properties[kvp]=_ownInterface.defaultValues[kvp];_properties=_ownInterface.properties;_methods=_ownInterface.methods;return _ownInterface}function assignDisplaySize(w,h){_args.display.width=w?w:_args.width;_args.display.height=h?h:_args.height}function getInterface(){return new Promise((resolve,
reject)=>{if(arguments&&arguments[0]instanceof Thinfinity.Display.Manager)var check=function(){if(_ready===true)resolve(_outputInterface);else if(_ready===false)reject(``);else if(!_readyCallback)_readyCallback=check()}();else reject(_messages.reject.interface.get)})}async function initializeInterface(elem){helper.console.log(_messages.reject.interface.initializing,arguments);return new Promise((resolve,reject)=>{helper.console.log(_messages.reject.interface.gettingContent,arguments);var cntWnd=elem instanceof
HTMLIFrameElement?elem.contentWindow:elem;helper.console.log(_messages.reject.interface.setting,arguments);oInterface=createOwnInterfaceInstance(_oInterface);cntWnd.Thinfinity.Display.Controller.setInterface(_ref,oInterface).then(()=>{_isEmbedded=_args.mainDisplay||_args.external!==true;helper.console.log(_messages.reject.interface.starting,arguments);if(oInterface.sizeLimit)if(!_args.sizeLimit)_args.sizeLimit=oInterface.sizeLimit;else helper.object.parseAttributes(_args.sizeLimit,oInterface.sizeLimit);
cntWnd.Thinfinity.Display.Controller.start({device:_ref,isEmbedded:_isEmbedded,sizeLimit:_args.sizeLimit,key:_args.key});cntWnd.Thinfinity.Display.Controller.getInterface(_ref).then(oInterface=>{_outputInterface=oInterface;Object.defineProperty(_ref,"processData",{enumerable:true,configurable:false,writable:false,value:_outputInterface.processData});Object.defineProperty(_ref,"processCmds",{enumerable:true,configurable:false,writable:false,value:processCmds});if(_outputInterface.processFrame)Object.defineProperty(_ref,
"processFrame",{enumerable:true,configurable:false,writable:false,value:_outputInterface.processFrame});var _continue=function(){_ready=true;resolve(true);if(_readyCallback)_readyCallback()};var _onMessageHandler=function(e){if(e&&e.data&&e.data.cmd==="CALLBACK-RESPONSE"){helper.dom.removeEvent(window,"message",_onMessageHandler);_continue()}};if(!_isEmbedded){helper.dom.addEvent(window,"message",_onMessageHandler,{passive:false});cntWnd.postMessage({cmd:"CALLBACK"},"*")}else _continue()}).catch(reject)}).catch(reject)})}
function processCmds(obj){if(obj?.cmd==="DS"){_args.display.width=obj.width;_args.display.height=obj.height;_args.surface.top=obj.top;_args.surface.left=obj.left;if(_args.mainDisplay){_properties.viewWidth=obj.width;_properties.viewHeight=obj.height}_args.assigned=true}_outputInterface.processCmds(obj)}async function onLoadHandler(elem){return new Promise((resolve,reject)=>{var _reject=err=>{_ready=false;let msg=err.message||err;helper.console.warning(msg,arguments);if(_readyCallback)_readyCallback();
reject(msg)};if(elem){elem.onload=function(){initializeInterface(elem).then(resolve).catch(_reject)};elem.onerror=e=>{_reject(e)};elem.onabort=e=>{_reject(e)}}else reject(_messages.reject.load)})}function onUnload(){if(!_disposed)_methods.removeDevice(_args.id)}async function createMonitorContainer(){return new Promise((resolve,reject)=>{let url=_args.url;let external=_args.external===true&&_args.mainDisplay!==true;if(external){let _features=`width=${_args.width+_wndSkin.width},height=${_args.height+
_wndSkin.height},left=${_args.window.left+_offset.left},top=${_args.window.top+_offset.top},menubar=yes,resizable=yes,scrollbars=yes,status=no,titlebar=yes,toolbar=yes`;helper.console.log(`${_messages.monitor.openingTab} ${_features}`,arguments);let wnd=window.open(url,"_blank",_features);if(wnd){_remoteWnd=wnd;onLoadHandler(wnd).then(response=>{_resolveObj={container:wnd,contentWindow:wnd,contentDocument:wnd.document};helper.dom.addEvent(wnd,"unload",onUnload,{passive:false});updateWindowPosition(true);
resolve(_resolveObj)}).catch(reject)}else reject({message:consts.displayPopupBlocked,code:2})}else if(Thinfinity.Display.Controller)initializeInterface(window).then(response=>{_remoteWnd=window;updateWindowPosition();_resolveObj={container:window,contentWindow:window,contentDocument:document};resolve(_resolveObj)}).catch(reject);else{let iframe=document.createElement("iframe");iframe.style.width="100%";iframe.style.height="100%";onLoadHandler(iframe).then(response=>{_remoteWnd=iframe.contentWindow;
_resolveObj={container:iframe,contentWindow:iframe.contentWindow,contentDocument:iframe.contentDocument};resolve(_resolveObj)}).catch(reject);iframe.src=url;iframe.style.position="absolute";iframe.style.backgroundColor="transparent";iframe.style.margin="0px";iframe.style.top="0px";iframe.style.left=`${_args.left}px`;iframe.style.zIndex=9999999999999;_args.parentElement.appendChild(iframe)}})}function getInfo(){let info={};updateWindowPosition();_displayInfo.forEach(function(prop){info[prop]=_args[prop]});
return info}function getSize(){return{width:_args.display.width||_args.width,height:_args.display.height||_args.height}}function setSize({width,height}=o){_args.physicalWidth=_args.width=width-width%2;_args.physicalHeight=_args.height=height}function updateWindowPosition(updateSize){if(_remoteWnd){if(updateSize)setSize({width:_remoteWnd.innerWidth,height:_remoteWnd.innerHeight});_args.window.top=_remoteWnd.screenY||_remoteWnd.screenTop;_args.window.left=_remoteWnd.screenX||_remoteWnd.screenLeft}}
function moveWndTo(left,top){if(_remoteWnd){_args.window.left=left;_args.window.top=top;if(!_isEmbedded&&_remoteWnd.moveTo)_remoteWnd.moveTo(left,top)}}function updateWindowPositionByName(name,value){let screenAxis=null;if(name==="left")screenAxis="screenX";else if(name==="top")screenAxis="screenY";if(screenAxis)if(_remoteWnd){_args.window[name]=value;_remoteWnd.moveTo(_args.window.left,_args.window.top)}else _args.window[name]=value}function dispose(){if(_resolveObj&&!_disposed){_disposed=true;_resolveObj.contentDocument.innerHTML=
"";if(_resolveObj.container instanceof HTMLIFrameElement)_resolveObj.container.parentElement.removeChild(_resolveObj.container);else if(!_isEmbedded)_resolveObj.container.close()}_resolveObj=null}initialize();Object.defineProperty(_ref,"id",{enumerable:true,configurable:false,get:function(){return _args.id},set:function(value){_args.id=value}});Object.defineProperty(_ref,"getInfo",{enumerable:true,configurable:false,writable:false,value:getInfo});Object.defineProperty(_ref,"size",{enumerable:true,
configurable:false,get:getSize,set:setSize});Object.defineProperty(_ref,"setInterface",{enumerable:true,configurable:false,writable:false,value:setInterface});Object.defineProperty(_ref,"getInterface",{enumerable:true,configurable:false,writable:false,value:getInterface});Object.defineProperty(_ref,"isWindowPositionAssigned",{enumerable:true,configurable:false,get:function(){return _wpAssigned}});Object.defineProperty(_ref,"mainDisplay",{enumerable:true,configurable:false,get:function(){return _args.mainDisplay}});
Object.defineProperty(_ref,"properties",{enumerable:true,configurable:false,get:function(){return oInterface.properties}});Object.defineProperty(_ref,"cursorCanvas",{enumerable:true,configurable:false,get:function(){return _outputInterface.cursorCanvas}});Object.defineProperty(_ref,"getMinZoomFactor",{enumerable:true,configurable:false,get:function(){return _outputInterface.getMinZoomFactor()}});var _surface={};Object.defineProperty(_ref,"surface",{enumerable:true,configurable:false,get:function(){return _surface}});
Object.defineProperty(_surface,"top",{enumerable:true,configurable:false,get:function(){return _args.surface.top},set:function(value){if(typeof value!=="undefined")_args.surface.top=value}});Object.defineProperty(_surface,"left",{enumerable:true,configurable:false,get:function(){return _args.surface.left},set:function(value){if(typeof value!=="undefined")_args.surface.left=value}});var _window={};Object.defineProperty(_ref,"window",{enumerable:true,configurable:false,get:function(){return _window}});
Object.defineProperty(_window,"top",{enumerable:true,configurable:false,get:function(){return _args.window.top},set:function(value){return updateWindowPositionByName("top",value)}});Object.defineProperty(_window,"left",{enumerable:true,configurable:false,get:function(){return _args.window.left},set:function(value){return updateWindowPositionByName("left",value)}});Object.defineProperty(_window,"moveTo",{enumerable:true,configurable:false,writable:false,value:moveWndTo});var _display={};Object.defineProperty(_ref,
"display",{enumerable:true,configurable:false,get:function(){return _display}});Object.defineProperty(_display,"width",{enumerable:true,configurable:false,get:function(){return _args.display.width}});Object.defineProperty(_display,"height",{enumerable:true,configurable:false,get:function(){return _args.display.height}});var _screen={};Object.defineProperty(_ref,"screen",{enumerable:true,configurable:false,get:function(){return _screen}});Object.defineProperty(_screen,"width",{enumerable:true,configurable:false,
get:function(){return _args.screen.width},set:function(value){return _args.screen.width=value}});Object.defineProperty(_screen,"height",{enumerable:true,configurable:false,get:function(){return _args.screen.height},set:function(value){return _args.screen.height=value}});Object.defineProperty(_ref,"width",{enumerable:true,configurable:false,get:function(){return _args.width}});Object.defineProperty(_ref,"height",{enumerable:true,configurable:false,get:function(){return _args.height}});Object.defineProperty(_ref,
"resolution",{enumerable:true,configurable:false,get:function(){return _args.resolution}});Object.defineProperty(_ref,"assigned",{enumerable:true,configurable:false,get:function(){return _args.assigned}});Object.defineProperty(_ref,"dispose",{enumerable:true,configurable:false,writable:false,value:dispose});return _ref}try{Thinfinity!=undefined}catch(e){Thinfinity={}}if(!Thinfinity.Display)Thinfinity.Display={};Thinfinity.Display.Device=Device;Object.defineProperty(Device,"RESOLUTION",{enumerable:true,
configurable:false,get:function(){return _resolution}})})();
(function(){var _eTypes={H264_RDP_SURFACE_CREATE:1,H264_RDP_SURFACE_DESTROY:2,H264_RDP_SURFACE_FRAME:3,RDP_CTX_CREATE:4,RDP_CTX_DESTROY:5,RDP_CTX_FRAME:6,RDP_CTX_CMDS:7,RDP_COMMANDS:8,GFX_RDP_SURFACE_CREATE:9,GFX_RDP_SURFACE_DESTROY:10,GFX_RDP_SURFACE_FRAME:11,GFX_RDP_INITIALIZE:12};var _eResponseCodes={SUCCESS:0,FAIL:1,POPUP_BLOCKED:2,UNSUPPORTED_INTERFACE:3,MONITOR_POSITION_IS_IN_USE:4,CANNOT_REGISTER_DEVICE:5,INVALID_SURFACE:6,IS_NOT_ADJACENT:7,UNKNOWN:8};var _eStates={NOT_INITIALIZE:0,READY:1,
DISPOSING:2,DISPOSED:3};Object.freeze(_eTypes);Object.freeze(_eResponseCodes);Object.freeze(_eStates);function Manager(config,args){var _ref=this;var _registeredDevices=[];var _last={focusId:null,focusValue:null};var _handlers={};var _db=null;var _dbSettings={name:"thinfinity.display.manager.store",store:"settings",ready:false,key:null,enabled:true};var _bufferControl={};var _blockedDevices=[];var _checkPacket=false;var _timeoutPromptId=null;var _timeoutPromptTextId=null;var _sizeLimit={max:{width:8096,
height:8096},min:{width:640,height:480}};var _prevInfo=null;var fireEvent=null;var feSettings={async:0};var _middlewares={sendFocus:null};var _origCallback=null;var _preserveConfiguration=false;var _maxRestoreTime=15E3;var _currentPromptTime=null;var _lastMergedInfo=null;var _graphicsReady=false;var _eState=_eStates.NOT_INITIALIZE;var _showCountdownTime=true;var _registeredDisplaysCmds={};var _mainDisplay=null;var _restoreSavedWindows=false;var _gfx=null;var _lastCursorCanvasId=null;var _eFitMode=
{"FIT_TO_BROWSER":"fittobrowser","FIT_TO_SCREEN":"fittoscreen","CUSTOM":"custom"};var _storageSessionData={};function initialize(){args.sizeLimit=_sizeLimit;if(_checkPacket){args.methods.processDataEcho=function(id,data){if(_bufferControl[id].q[data.p]===false)delete _bufferControl[id].q[data.p];else helper.console.log(`The packet was processed, but does not match with the original MonitorId: ${id}, Pkt: ${data.p}`,arguments);if(_bufferControl[id].q[data.p-1]===false)helper.console.warning(`Unprocessed pkt - MonitorId: ${id}, Pkt: ${data.p-
1}`,arguments)};_handlers[_eTypes.H264_RDP_SURFACE_FRAME]=function(id,data){if(_registeredDevices[id]){_bufferControl[id].q[_bufferControl[id].pkt]=false;_registeredDevices[id].processData(data);_bufferControl[id].pkt++}else helper.console.debug(`Cannot find device id: ${id}`,arguments)}}else _handlers[_eTypes.H264_RDP_SURFACE_FRAME]=function(id,data){if(_registeredDevices[id]?.processData)_registeredDevices[id].processData(data);else helper.console.warning(`Cannot find device id: ${id}`,arguments)};
_handlers[_eTypes.H264_RDP_SURFACE_CREATE]=_handlers[_eTypes.H264_RDP_SURFACE_DESTROY]=processEvent;_handlers[_eTypes.RDP_COMMANDS]=function(id,data){if(_registeredDevices[id]?.processCmds)return _registeredDevices[id].processCmds(data)};_handlers[_eTypes.GFX_RDP_INITIALIZE]=function(){if(Thinfinity?.Driver?.GFX){_gfx=new Thinfinity.Driver.GFX({methods:{frameEnd:frameId=>{args.methods.sendCmd("cmd=frameEnd&frame="+frameId)},processData:(id,data)=>{if(_registeredDevices[id]?.processData)_registeredDevices[id].processData(data)}}});
let gfxRepaintHandler=function(){helper.console.log("Repaint GFX surfaces");_gfx.repaint()};args.on("gfxRepaint",gfxRepaintHandler);_ref.on("addDevice",gfxRepaintHandler)}else{let msg=`Cannot initialize GFX Class, ${consts.technicalSupport}`;helper.console.warning(msg);throw new Error(msg);}};_handlers[_eTypes.GFX_RDP_SURFACE_FRAME]=function(id,data){_gfx.processCmd(data)};_handlers[_eTypes.GFX_RDP_SURFACE_CREATE]=function(id,data){_gfx.addSurface(data)};_handlers[_eTypes.GFX_RDP_SURFACE_DESTROY]=
function(id,data){_gfx.deleteSurface(data)};_middlewares.sendFocus=args.methods.sendFocus;args.methods.sendFocus=executeFocus;args.methods.resize=executeResize;args.methods.repaint=function(){if(_gfx)_gfx.repaint()};addHandlers();registerDisplayCommands();fireEvent=(new Thinfinity.Events({"owner":_ref,"events":args.events})).fireEvent;initializeDB();_showCountdownTime=!config?.shadowingSession;attachLocalEvents();_eState=_eStates.READY}function addHandlers(){helper.dom.addEvent(window,["beforeUnload",
"unload"],function(e){saveSettings();_registeredDevices.forEach(function(m){m.dispose()})},{passive:true})}function attachLocalEvents(){if(args?.on)args.on("localEvent",processLocalEvents)}function remoteLocalEvents(){if(args?.off)args.off("localEvent",processLocalEvents)}function processLocalEvents(data){let cmd=null;if(data.cmd)cmd=data.cmd.toLowerCase();switch(cmd){case "sessionstatus":_storageSessionData.sessionstatus=data.data;break}}function fireStorageData(name){if(args?.__prototype__?.fireEvent&&
_storageSessionData[name])args.__prototype__.fireEvent("localEvent",{cmd:"sessionstatus",data:_storageSessionData[name]})}function registerDisplayCommands(){registerDisplayCmd("DS",function(id,width,height,hwnd,left,top){let device=_registeredDevices.find(d=>{return d.id==id});if(device){helper.console.log(`DS id:${id},width:${width}, height:${height}`);_handlers[_eTypes.RDP_COMMANDS](id,{cmd:"DS",width,height,hwnd,left,top});fireEvent("desktopSize",id,width,height,hwnd,left,top,feSettings)}});registerDisplayCmd("GET_ZOOM_FACTOR",
function(value){return _registeredDevices[_mainDisplay.id].properties.zoomFactor});registerDisplayCmd("SET_ZOOM_FACTOR",function(value){return _registeredDevices[_mainDisplay.id].properties.zoomFactor=value});registerDisplayCmd("ZOOM_DESKTOP",function(value){return _handlers[_eTypes.RDP_COMMANDS](_mainDisplay.id,{cmd:"ZOOM_DESKTOP",value})});registerDisplayCmd("GET_SCALE",function(){return _registeredDevices[_mainDisplay.id].properties.scale});registerDisplayCmd("CURSOR_CANVAS",function(){return _registeredDevices[_mainDisplay.id].cursorCanvas});
registerDisplayCmd("GET_MIN_ZOOM_FACTOR",function(){return _registeredDevices[_mainDisplay.id].getMinZoomFactor});registerDisplayCmd("CENTER",function(){return _handlers[_eTypes.RDP_COMMANDS](_mainDisplay.id,{cmd:"CENTER"})});registerDisplayCmd("ZOOM_FACTOR_RESET",function(){return _handlers[_eTypes.RDP_COMMANDS](_mainDisplay.id,{cmd:"ZOOM_FACTOR_RESET"})});registerDisplayCmd("PLAYBACK_MOUSE_MOVE",function(id,data){if(id!==_lastCursorCanvasId){args.__prototype__.fireEvent("hideCursor");_lastCursorCanvasId=
id}return _handlers[_eTypes.RDP_COMMANDS](id,{cmd:"PLAYBACK_MOUSE_MOVE",data})})}async function sync(){return new Promise(resolve=>{if(_dbSettings.enabled&&_db)_db.ready(function(){resolve(true);return true});else{resolve(true);return true}})}function getKey(){return btoa(`${config.username}${config.model}`)}function initializeDB(){if(_dbSettings.enabled&&Thinfinity.IndexedDB&&config?.db!==false){_db=new Thinfinity.IndexedDB({name:_dbSettings.name,store:_dbSettings.store});_dbSettings.key=getKey();
_db.ready(function(){_dbSettings.ready=true})}}function getStoredConfiguration(){if(_dbSettings.enabled&&_dbSettings.ready&&_restoreSavedWindows)if(config?.canBeOverridden===true){let displaysInfo=_db.get(_dbSettings.key);if(displaysInfo)try{displaysInfo=JSON.parse(displaysInfo);if(displaysInfo.length===0)displaysInfo=null;else{let d0=displaysInfo[0];if(!d0.surface||!d0.display||!d0.window){helper.console.warning(`${consts.displayInvalidStoredData}`.arguments);clearCustomSettings();displaysInfo=null}if(displaysInfo){let md=
displaysInfo.find(d=>{return d.mainDisplay});if(!(md&&md.external!==true)){helper.console.warning(`${consts.displayInvalidStoredData}`.arguments);clearCustomSettings();displaysInfo=null}else{let i=displaysInfo.findIndex(d=>{return d.mainDisplay});displaysInfo.splice(i,1);displaysInfo.unshift(md);fireEvent("updateDisplaySize",md,feSettings);fireEvent("checkDistribution",displaysInfo,feSettings)}}}}catch(err){displaysInfo=null}return displaysInfo}else{clearCustomSettings();return null}else return null}
function saveSettings(){if(_dbSettings.enabled&&config?.canBeOverridden===true&&_eState===_eStates.READY)_db.add(_dbSettings.key,JSON.stringify(getDisplaysInOrder()))}function isAdjacentToTheRight(baseDisplay,newDisplay){return baseDisplay.surface.left+baseDisplay.display.width===newDisplay.surface.left&&(baseDisplay.surface.top<=newDisplay.surface.top&&newDisplay.surface.top<baseDisplay.display.height)}function isAdjacentToTheLeft(baseDisplay,newDisplay){return newDisplay.surface.left+newDisplay.display.width===
baseDisplay.surface.left&&(baseDisplay.surface.top<=newDisplay.surface.top&&newDisplay.surface.top<baseDisplay.display.height)}function isAdjacentToTheTop(baseDisplay,newDisplay){return newDisplay.surface.top+newDisplay.display.height===baseDisplay.surface.top&&(baseDisplay.surface.left<=newDisplay.surface.left&&newDisplay.surface.left<baseDisplay.display.width)}function isAdjacentToTheBottom(baseDisplay,newDisplay){return baseDisplay.surface.top+baseDisplay.display.height===newDisplay.surface.top&&
(baseDisplay.surface.left<=newDisplay.surface.left&&newDisplay.surface.left<baseDisplay.display.width)}function checkDisplaySurface(device,stopPosition){let res={code:_eResponseCodes.SUCCESS,id:null};if(device){let w=null,h=null;if(device.width<_sizeLimit.min.width)w=_sizeLimit.min.width;else if(device.width>_sizeLimit.max.width)w=_sizeLimit.max.width;if(device.height<_sizeLimit.min.height)h=_sizeLimit.min.height;else if(device.height>_sizeLimit.max.height)h=_sizeLimit.max.height;w=w||device.width;
h=h||device.height;if(device.size)device.size={width:w,height:h};else{device.physicalWidth=device.width=w;device.physicalHeight=device.height=h}w=device.width;h=device.height;let displays=getPurgeInfo();if(displays.length===0&&device.surface.top===0&&device.surface.left===0){res.id=0;return res}let attached=false;let valid=true;if(displays.length>0){let maxIdx=displays.length-1;if(typeof stopPosition!=="undefined")maxIdx=Math.min(maxIdx,stopPosition);let m=displays[0];let l=displays.length>0?displays[Math.min(displays.length-
1,maxIdx)]:null;if(isAdjacentToTheLeft(m,device)||isAdjacentToTheTop(m,device)){attached=true;res.id=0;valid=device.surface.left>=m.surface.left+m.width||device.surface.left+w<=m.surface.left||device.surface.top>=m.surface.top+m.height||device.surface.top+h<=m.surface.top}else if(isAdjacentToTheRight(l||m,device)||l&&isAdjacentToTheBottom(l,device)){attached=true;res.id=displays.length;valid=true}}if(!(attached&&valid)){let msg="";if(!attached){msg=consts.displayIsNotAdjacent;res.code=_eResponseCodes.IS_NOT_ADJACENT}if(!valid){msg+=
(msg.length>0?" ":"")+consts.displayInvalidSurface;if(res.code===_eResponseCodes.SUCCESS)res.code=_eResponseCodes.INVALID_SURFACE}res.message=msg;helper.console.warning(msg,arguments)}return res}}function getDisplaysInOrder(){var res=[];_registeredDevices.forEach(function(display){let m=display.getInfo();res.push(m)});return res.sort(function(a,b){return a.surface.top==b.surface.top?a.surface.left-b.surface.left:a.surface.top-b.surface.top})}function getMainDisplayId(){let md=_registeredDevices.find(d=>
{return d.mainDisplay});return md?.id||null}function clearCustomSettings(){return new Promise(function(resolve){if(_db)_db.resetDB(resolve);else resolve(true)})}function executeResize(){let mp=getPurgeInfo(true);if(mp.length>0){args.events.resize(mp);fireEvent("resize",mp);if(mp!==_prevInfo){_prevInfo=mp;if(_preserveConfiguration)saveSettings(mp)}}}function getPurgeInfo(isResize){let mp=getDisplaysInOrder();if(mp&&mp.length>0)mp.forEach(item=>{switch(args.properties.resolution){case _eFitMode.FIT_TO_BROWSER:if(args.properties.resizeDesktop&&
isResize){item.display.width=item.width;item.display.height=item.height}break;case _eFitMode.FIT_TO_SCREEN:if(!item.assigned){item.display.width=item.screen.width;item.display.height=item.screen.height}break;case _eFitMode.CUSTOM:break}});fireEvent("checkDistribution",mp,feSettings);return mp}function executeFocus(displayId,cmd,value){if(value!==false)_last.focusId=displayId;_middlewares.sendFocus.apply(null,arguments)}function getDisplay(id){return _registeredDevices.find(function(m){return m.id===
id})}function updateInternalIds(){_registeredDevices.forEach(function(d,i){d.id=i})}async function addDevice(displayDevice){let restoreDisplay=typeof arguments[1]!=="undefined"?arguments[1]:true;return new Promise(resolve=>{if(!(displayDevice&&displayDevice instanceof Thinfinity.Display.Device))displayDevice=new Thinfinity.Display.Device(displayDevice);if(displayDevice&&displayDevice instanceof Thinfinity.Display.Device){let res=null;if(config?.shadowingSession)res={code:_eResponseCodes.SUCCESS,id:displayDevice.id};
else res=checkDisplaySurface(displayDevice);if(res.code===_eResponseCodes.SUCCESS){displayDevice.id=res.id;_registeredDevices.splice(displayDevice.id,0,displayDevice);displayDevice.focus=false;if(displayDevice.mainDisplay)args.methods.disconnect=function(){fireEvent("disconnect")};displayDevice.setInterface(_ref,{...args,...{extra:{key:getKey()}}},displayDevice.window).then(function(response){displayDevice.elements=response;displayDevice.getInterface(_ref).then(function(rOutput){if(rOutput){displayDevice.output=
rOutput;if(_checkPacket)_bufferControl[displayDevice.id]={pkt:1,q:{}};updateInternalIds();if(!_mainDisplay&&displayDevice.mainDisplay)_mainDisplay=displayDevice;fireEvent("addDevice");if(!displayDevice.mainDisplay)fireStorageData("sessionstatus");resolve({res:true,id:displayDevice.id,message:"",code:_eResponseCodes.SUCCESS})}else{let message=consts.displayInterfaceNotSupported;helper.console.warning(message,arguments);shiftDevice(displayDevice.id);resolve({res:false,id:displayDevice.id,message,code:_eResponseCodes.UNSUPPORTED_INTERFACE})}}).catch(function(err){let res=
{...{res:false,id:displayDevice.id,code:_eResponseCodes.UNKNOWN},...err};res.message=res.message||arguments?.[0]?.message||arguments?.[0];helper.console.warning(`${res.message} ${arguments?.[0]?.stack||""}`,arguments);shiftDevice(displayDevice.id);resolve(res)})}).catch(function(err){res={...res,...{id:displayDevice.id},...err};res.code=err.code===_eResponseCodes.POPUP_BLOCKED?_eResponseCodes.POPUP_BLOCKED:_eResponseCodes.UNKNOWN;res.message=res.message||arguments?.[0]?.message||arguments?.[0];helper.console.warning(`${res.message} ${arguments?.[0]?.stack||
""}`,arguments);if(restoreDisplay){let d=shiftDevice(displayDevice.id);if(!_blockedDevices.find(function(item){return item.id===displayDevice.id}))_blockedDevices.push(d)}resolve(res)})}else{if(restoreDisplay){let d=shiftDevice(displayDevice.id);if(!_blockedDevices.find(function(item){return item.id===displayDevice.id}))_blockedDevices.push(d)}resolve(res)}}else{let message=consts.displayCannotRegisterDevice;helper.console.warning(message,arguments);shiftDevice(id);resolve({res:false,id,message,code:_eResponseCodes.CANNOT_REGISTER_DEVICE})}})}
async function restoreDevices(){return new Promise(function(resolve){_origCallback=function(){_origCallback=null;resolve(true)};shiftBlockedDevices()})}async function restoreConfigurationPrompt(){_timeoutPromptId=setTimeout(function(){Thinfinity.Popups.unblock();clearInterval(_timeoutPromptTextId);_origCallback()},_maxRestoreTime);_timeoutPromptTextId=setInterval(function(){let dlg=document.getElementById("dlgMessage");if(dlg){let s=parseInt((_maxRestoreTime-(Date.now()-_currentPromptTime))/1E3,10);
if(s>1)s=s.toString()+" "+consts.seconds;else s=s.toString()+" "+consts.second;dlg.innerHTML=helper.string.sprintf(consts.displayRestoreDevices,s)}},parseInt(_maxRestoreTime/1E3,10));await restoreDevices()}function shiftBlockedDevices(next){if(next!==false&&_blockedDevices.length>0){let bDev=_blockedDevices.shift()[0];showPromptPopup(bDev,shiftBlockedDevices)}else _origCallback()}function restoreDevice(device){return new Promise(function(resolve){addDevice(device,false).then(function(res){if(res&&
res.code!==_eResponseCodes.SUCCESS)r=false;resolve(r)}).catch(function(err){resolve(false)})})}function showPromptPopup(device,callback){let buttons=[{value:consts.open,class:"",action:function(e){helper.console.log(`Restoring devices`,arguments);clearTimeout(_timeoutPromptId);clearInterval(_timeoutPromptTextId);restoreDevice(device).then(function(res){if(callback)return callback(true)}).catch(function(err){if(callback)return callback(true)})}}];if(_showCountdownTime)buttons.push({value:consts.cancel,
class:"",action:function(e){helper.console.log(`Updating settings `,arguments);clearTimeout(_timeoutPromptId);clearInterval(_timeoutPromptTextId);if(callback)callback(false)}});let promptConfig={id:"dlgRestoreDevicePrompt",parentElement:"",class:"",iconType:"disconnectedIco",title:productName,message:`<span id="dlgMessage">${consts.displayRestoreDevices} ${_showCountdownTime?helper.string.sprintf(consts.displayPopupAutoClose,parseInt(_maxRestoreTime/1E3,10).toString()+" "+consts.seconds):""}</span>`,
buttons,noPropagateEvents:true};Thinfinity.Popups.choice(promptConfig);_currentPromptTime=Date.now()}function shiftDevice(id){helper.console.log(`Removing device ${id}`);let m=getDisplay(id);if(m){m.dispose();return _registeredDevices.splice(_registeredDevices.findIndex(function(m){return m.id===id}),1)}else return false}function removeDevice(id,silent){if(_eState===_eStates.READY)if(shiftDevice(id)){if(!silent){_registeredDevices.forEach(m=>{if(m.id>=id)m.id--});executeResize()}if(_lastMergedInfo)syncDisplayInfo(_lastMergedInfo,
true);fireEvent("removeDevice")}}function getOutputDevice(){let rd=!!_last.focusId&&_registeredDevices[_last.focusId]?_registeredDevices[_last.focusId]:getDisplay(0);return rd?rd.output:null}function focus(){let oDev=getOutputDevice();if(oDev?.setFocus)oDev.setFocus()}function setSelectionRange(){let oDev=getOutputDevice();if(oDev?.setSelectionRange)return oDev.setSelectionRange()}function textValue(){let oDev=getOutputDevice();if(oDev?.textValue)return oDev.textValue()}function updateMacCmd(){let oDev=
getOutputDevice();if(oDev?.updateMacCmd)return oDev.updateMacCmd()}function processData(id,eType,data){_handlers[eType](id,data)}function processEvent(id,data){helper.console.log(`Processing video event ${id} : ${data}`)}function registerDisplayCmd(cmd,handler){if(!_registeredDisplaysCmds[cmd])_registeredDisplaysCmds[cmd]=handler;else return false}function processDisplayCmd(cmd){if(_registeredDisplaysCmds[cmd])return _registeredDisplaysCmds[cmd].apply(null,[...arguments].splice(1));else return undefined}
function removeAllExternalDisplays(){_registeredDevices.forEach(d=>{if(!d.mainDisplay)d.dispose()})}function verifyInfo(src,tgt){var props=["width","left","id","surface"];if(src&&tgt)if(src.length!=tgt.length)return true;else src.forEach((srcItem,idx)=>{let tgtItem=tgt[idx];let d=false;props.forEach(p=>{if(srcItem[p]!==tgtItem[p])d=true});if(d)return true});else return true}async function syncDisplayInfo(displayInfo){if(_eState===_eStates.READY){let forced=arguments[1];if(displayInfo)if(forced||verifyInfo(_lastMergedInfo,
displayInfo)){helper.console.debug(`Sync display info ${JSON.stringify(displayInfo)}`);removeAllExternalDisplays();var proms=[];displayInfo.forEach(d=>{if(!d.mainDisplay){delete d.physicalHeight;delete d.physicalWidth;d.external=true;d.surface={left:d.left,top:d.top};proms.push(addDevice(new Thinfinity.Display.Device(d),true))}});let values=await Promise.all(proms);var blockedMsg=null;values.forEach(function(res){if(res&&res.code!==Thinfinity.Display.Manager.RESPONSE_CODES.SUCCESS)if(res.code===Thinfinity.Display.Manager.RESPONSE_CODES.POPUP_BLOCKED)blockedMsg=
res.message});_showCountdownTime=false;if(blockedMsg)values=await restoreDevices();restoreDevices().then(()=>{_lastMergedInfo=displayInfo;fireEvent("syncCompleted")})}}}function dispose(){_eState=_eStates.DISPOSING;_registeredDevices.forEach(m=>{removeDevice(m.id,true);m.dispose()});_eState=_eStates.DISPOSED;remoteLocalEvents();fireEvent("dispose")}initialize();Object.defineProperty(_ref,"addDevice",{enumerable:true,configurable:false,writable:false,value:addDevice});Object.defineProperty(_ref,"removeDevice",
{enumerable:true,configurable:false,writable:false,value:removeDevice});Object.defineProperty(_ref,"clearCustomSettings",{enumerable:true,configurable:false,writable:false,value:clearCustomSettings});Object.defineProperty(_ref,"getDisplaysInfo",{enumerable:true,configurable:false,writable:false,value:getPurgeInfo});Object.defineProperty(_ref,"getDisplaysInOrder",{enumerable:true,configurable:false,writable:false,value:getDisplaysInOrder});Object.defineProperty(_ref,"fireEvent",{enumerable:true,configurable:false,
writable:false,value:args.__prototype__.fireEvent});Object.defineProperty(_ref,"dispose",{enumerable:true,configurable:false,writable:false,value:dispose});Object.defineProperty(_ref,"preserveConfiguration",{enumerable:true,configurable:false,get:function(){return _preserveConfiguration},set:function(value){_preserveConfiguration=value}});Object.defineProperty(_ref,"sync",{enumerable:true,configurable:false,writable:false,value:sync});Object.defineProperty(_ref,"limits",{enumerable:true,configurable:false,
get:function(){return args.sizeLimit},set:function(value){return helper.object.parseAttributes(args.sizeLimit,value)}});Object.defineProperty(_ref,"getStoredConfiguration",{enumerable:true,configurable:false,writable:false,value:getStoredConfiguration});Object.defineProperty(_ref,"graphicsReady",{enumerable:true,configurable:false,writable:false,writable:false,value:function(){if(!_graphicsReady)executeResize();_graphicsReady=true}});Object.defineProperty(_ref,"restoreDevices",{enumerable:true,configurable:false,
writable:false,value:restoreConfigurationPrompt});Object.defineProperty(_ref,"state",{enumerable:true,configurable:false,get:function(){return _eState}});Object.defineProperty(_ref,"mainDisplayId",{enumerable:true,configurable:false,get:getMainDisplayId});Object.defineProperty(_ref,"processData",{enumerable:true,configurable:false,writable:false,value:processData});Object.defineProperty(_ref,"focus",{enumerable:true,configurable:false,writable:false,value:focus});Object.defineProperty(_ref,"setSelectionRange",
{enumerable:true,configurable:false,writable:false,value:setSelectionRange});Object.defineProperty(_ref,"textValue",{enumerable:true,configurable:false,writable:false,value:textValue});Object.defineProperty(_ref,"updateMacCmd",{enumerable:true,configurable:false,writable:false,value:updateMacCmd});Object.defineProperty(_ref,"processDisplayCmd",{enumerable:true,configurable:false,writable:false,value:processDisplayCmd});if(config?.shadowingSession)Object.defineProperty(_ref,"syncDisplayInfo",{enumerable:true,
configurable:false,writable:false,value:syncDisplayInfo});return _ref}try{Thinfinity!=undefined}catch(e){Thinfinity={}}if(!Thinfinity.Display)Thinfinity.Display={};Thinfinity.Display.Manager=Manager;Object.defineProperty(Thinfinity.Display.Manager,"EVENT_TYPES",{enumerable:true,configurable:false,get:function(){return _eTypes}});Object.defineProperty(Thinfinity.Display.Manager,"RESPONSE_CODES",{enumerable:true,configurable:false,get:function(){return _eResponseCodes}});Object.defineProperty(Thinfinity.Display.Manager,
"STATES",{enumerable:true,configurable:false,get:function(){return _eStates}})})();
(function(){var _eDistributionModes={SINGLE:0,LANDSCAPE:1,PORTRAIT:2,MATRIX:3};Object.freeze(_eDistributionModes);var _addingPosition={TOP:0,RIGHT:1,BOTTOM:2,LEFT:3,UNDEFINED:4};Object.freeze(_addingPosition);function Map(){var _ref=this;var _settings={manager:null,maxAvailable:16,icon:""};var _elements={container:null,dialog:null,body:null,mapView:null,buttonsContainers:[]};var _monitorsConfig={canBeOverridden:false,count:1};var resizeTimer=null;var RESIZE_TIMEOUT=250;var _currentMap=null;var fireEvent=
null;var _screenDetails=null;var _profile=null;var _disposed=false;var _displayAttachedCount=0;var _mainDisplayProcessed=false;var _screenDetailsSync=false;var _isNumber=null;var _getDisplayInfo=null;function initialize(args){_isNumber=helper.object.isNumber;helper.object.parseAttributes(_settings,args);helper.object.parseAttributes(_monitorsConfig,args?.monitors||null);if(args?.profile)_profile=args.profile;if(!_settings.manager){let msg=`Cannot initialize Thinfinity.Display.Map, Thinfinity.Display.Manager is null or undefined.`;
helper.console.warning(msg,arguments);throw new Error(msg);}_getDisplayInfo=_settings.manager.getDisplaysInOrder;attachHandlers();createContainer();fireEvent=(new Thinfinity.Events({"owner":_ref,"events":args.events})).fireEvent}function attachHandlers(){_settings.manager.on(["addDevice","resize"],refresh);_settings.manager.on(["removeDevice"],removeDevice);_settings.manager.on(["updateDisplaySize"],updateDisplaySize);_settings.manager.on("checkDistribution",checkDistribution);_settings.manager.on("dispose",
dispose)}function detachHandlers(){_settings.manager.off(["addDevice","resize"],refresh);_settings.manager.off(["removeDevice"],removeDevice);_settings.manager.off(["updateDisplaySize"],updateDisplaySize);_settings.manager.off("checkDistribution",checkDistribution);_settings.manager.off("dispose",dispose)}function createContainer(){var cont=document.createElement("DIV");cont.className="displaymap hidden";var background=document.createElement("DIV");background.className="background";var dialog=document.createElement("DIV");
dialog.className="dialog popup";createDialogContent(dialog);background.appendChild(dialog);cont.appendChild(background);document.body.appendChild(cont);_elements.container=cont}function createDialogContent(dialog){addHeader(dialog);addContent(dialog);addFooter(dialog)}function addHeader(dialog){var header=document.createElement("DIV");header.className="header";var htext=document.createElement("H3");htext.innerHTML=consts.displayAddNewDisplay;htext.className=_settings.icon;if(_monitorsConfig.canBeOverridden){var closeicon=
document.createElement("SPAN");closeicon.className="close thin-cancel";closeicon.onclick=hide;htext.appendChild(closeicon)}header.appendChild(htext);dialog.appendChild(header)}function addContent(dialog){_elements.body=document.createElement("DIV");_elements.body.className="body";_elements.mapText=document.createElement("H3");_elements.mapText.className="legend";_elements.mapText.innerHTML=consts.displayAddNewDisplayLegend;_elements.body.appendChild(_elements.mapText);let btnContainer=newButtonBar("portrait-add",
_addingPosition.TOP);_elements.buttonsContainers.push(btnContainer);_elements.body.appendChild(btnContainer);var mapViewContainer=document.createElement("DIV");mapViewContainer.className="mv-container";btnContainer=newButtonBar("landscape-add",_addingPosition.LEFT);_elements.buttonsContainers.push(btnContainer);mapViewContainer.appendChild(btnContainer);_elements.mapView=document.createElement("DIV");_elements.mapView.className="mapview";mapViewContainer.appendChild(_elements.mapView);btnContainer=
newButtonBar("landscape-add",_addingPosition.RIGHT);_elements.buttonsContainers.push(btnContainer);mapViewContainer.appendChild(btnContainer);_elements.body.appendChild(mapViewContainer);btnContainer=newButtonBar("portrait-add",_addingPosition.BOTTOM);_elements.buttonsContainers.push(btnContainer);_elements.body.appendChild(btnContainer);dialog.appendChild(_elements.body);_elements.dialog=dialog}function addFooter(dialog){var footer=document.createElement("DIV");footer.className="divbuttons";var btn=
document.createElement("A");btn.className="popuplink selected";btn.innerHTML=consts.Close;btn.addEventListener("click",hide);footer.appendChild(btn);var btn=document.createElement("A");btn.className="popuplink";btn.innerHTML=consts.displayIdentify;btn.addEventListener("click",function(e){_settings.manager.fireEvent("localEvent",{cmd:"identify",timeout:2500});hide()});footer.appendChild(btn);if(_monitorsConfig.canBeOverridden){var btn=document.createElement("A");btn.className="popuplink";btn.innerHTML=
consts.displayResetSettings;btn.addEventListener("click",function(){_settings.manager.clearCustomSettings();resetCustomSettings();hide()});footer.appendChild(btn)}dialog.appendChild(footer)}function newButtonBar(className,position){var btnContainer=document.createElement("DIV");btnContainer.className=className;var btn=document.createElement("span");btn.className="thin-plus-circled";btn.setAttribute("position",position);btn.addEventListener("click",processAdding);btnContainer.appendChild(btn);return btnContainer}
function hide(){if(!_disposed){_elements.container.className=_elements.container.className.replace("visible","hidden");onhide()}}function onhide(){_elements.mapView.innerHTML=""}function show(){if(!_disposed){_elements.container.className=_elements.container.className.replace("hidden","visible");onshow()}}function onshow(){render(getDisplaysMap())}async function removeDevice(id){if(_settings.manager.state===Thinfinity.Display.Manager.STATES.READY){_displayAttachedCount--;if(!_monitorsConfig.canBeOverridden)await processProfileInfo()}refresh()}
function refresh(){if(!_disposed)if(_elements.container.className.indexOf("visible")!=-1){_elements.mapView.style.visibility="hidden";if(resizeTimer)window.clearTimeout(resizeTimer);resizeTimer=window.setTimeout(function(){onhide();_elements.mapView.style.visibility="visible";onshow()},RESIZE_TIMEOUT)}}function render(map){let itemClass=_monitorsConfig.canBeOverridden?{r:"hidden",a:""}:{r:"",n:"hidden"};helper.style.replace(_elements.buttonsContainers,itemClass.r,itemClass.n);_elements.body.className=
"body distr-"+map.distribution.desc.toLowerCase();var coef=_elements.mapView.offsetWidth/map.width;var viewHeight=Math.round(map.height*coef);var offsetH=0;_elements.mapView.style.height=viewHeight+"px";if(_elements.mapView.offsetHeight<viewHeight){coef=_elements.mapView.offsetHeight/map.height;offsetH=Math.round((_elements.mapView.offsetWidth-map.width*coef)/2)}let l=0,t=0;map.surfaces.forEach(item=>{if(item.left<0)l=Math.min(item.left,l);if(item.top<0)t=Math.min(item.top,t)});l=Math.abs(l);t=Math.abs(t);
map.surfaces.forEach(item=>{var screen=document.createElement("DIV");screen.className="screen"+(item.mainDisplay?" main":"");screen.innerHTML=item.id+1;screen.style.top=Math.round((item.top+t)*coef)+"px";screen.style.width=Math.round(item.width*coef)+"px";screen.style.left=offsetH+Math.round((item.left+l)*coef)+"px";screen.style.height=screen.style.lineHeight=Math.round(item.height*coef)+"px";if(!item.mainDisplay&&_monitorsConfig.canBeOverridden){var closeBtn=document.createElement("div");closeBtn.className=
"closeBtn thin-cancel";closeBtn.addEventListener("click",function(){fireEvent("requestRemotion",item.id)});screen.appendChild(closeBtn)}_elements.mapView.appendChild(screen)})}function getSurfaces(){_getDisplayInfo()}function getDisplaysMap(surfaces){var values={height:0,width:0,stepsH:[],stepsV:[],surfaces:[]};var size={max:{width:0,height:0},min:{width:0,height:0}};surfaces=surfaces||_getDisplayInfo();if(surfaces){surfaces.forEach(element=>{var surfaceTop,surfaceLeft;surfaceTop=element.surface.top;
surfaceLeft=element.surface.left;let w=element.display.width;let h=element.display.height;var s={top:surfaceTop,left:surfaceLeft,right:surfaceLeft+w,bottom:surfaceTop+h,width:w,height:h,id:element.id,mainDisplay:element.mainDisplay};size.min.width=Math.min(size.min.width,surfaceLeft);size.max.width=Math.max(size.max.width,s.right);size.min.height=Math.min(size.min.height,surfaceTop);size.max.height=Math.max(size.max.height,s.bottom);if(values.stepsH.indexOf(surfaceLeft)==-1)values.stepsH.push(surfaceLeft);
if(values.stepsV.indexOf(surfaceTop)==-1)values.stepsV.push(surfaceTop);values.surfaces.push(s)});values.width=Math.abs(size.min.width)+size.max.width;values.height=Math.abs(size.min.height)+size.max.height;var getDistribution=function(mode){return getDistributionObj(mode)};let mode=null;if(surfaces.length===1)mode=mode=_eDistributionModes.SINGLE;else if(values.stepsV.length==1&&values.stepsH.length==1)mode=_eDistributionModes.SINGLE;else if(values.stepsH.length==1)mode=_eDistributionModes.PORTRAIT;
else if(values.stepsV.length==1)mode=_eDistributionModes.LANDSCAPE;else mode=_eDistributionModes.MATRIX;values.distribution=getDistribution(mode);if(_eDistributionModes.LANDSCAPE)values=adjustWidths(values)}_currentMap=values;return values}function checkDistribution(displays){if(!_currentMap)getDisplaysMap(displays);if(displays?.length>0)if(_currentMap.distribution.value!=_eDistributionModes.SINGLE){let mainDisplayIdx=displays.findIndex(d=>{return d.mainDisplay});let l=displays.length;let accum=0;
let aname=null;let sname=null;switch(_currentMap.distribution.value){case _eDistributionModes.LANDSCAPE:aname="left";sname="width";break;case _eDistributionModes.PORTRAIT:aname="top";sname="height";break;default:throw new Error(`Distribution mode not supported, please contact us.`);}for(let i=mainDisplayIdx-1;i>=0;i--){let m=displays[i];let s=m.display[sname];if(s+m.surface[aname]!=accum){let origVal=m.surface[aname];let newVal=(s+Math.abs(accum))*-1;m.surface[aname]=newVal;helper.console.log(`Fixing surface position,surface: (${aname} from :${origVal},to ${newVal})`)}accum=
m.surface[aname]}let mDisplay=displays[mainDisplayIdx];accum=mDisplay.display[sname];for(let i=mainDisplayIdx+1;i<l;i++){let m=displays[i];if(m.surface[aname]!=accum){let origVal=m.surface[aname];m.surface[aname]=accum;helper.console.log(`Fixing surface position,surface: (${aname} from :${origVal},to ${accum})`)}accum=m.surface[aname]+m.display[sname]}}return displays}function adjustWidths(values){var i,j,len=values.stepsH.length;for(i=1;i<len;i++)if((values.stepsH[i]-values.stepsH[i-1])%2){values.surfaces[i-
1].width--;values.surfaces[i-1].right--;for(j=i;j<len;j++){values.stepsH[j]--;values.surfaces[j].left--;values.surfaces[j].right--}values.width=values.surfaces[len-1].right}return values}function getDistributionObj(value){return{"value":value,"desc":Object.keys(_eDistributionModes)[value]}}function processAdding(e){e.stopPropagation();var elem=e.target||e.srcElement;processDisplay(null,parseInt(elem.getAttribute("position"),10),true)}function processDisplay(device,position,trigger){var data={};switch(_currentMap.distribution.value){case _eDistributionModes.SINGLE:data.width=
_currentMap.width;data.height=_currentMap.height;break;case _eDistributionModes.PORTRAIT:_currentMap.surfaces.sort((a,b)=>a.top-b.top);data.width=_currentMap.width;break;case _eDistributionModes.LANDSCAPE:_currentMap.surfaces.sort((a,b)=>a.left-b.left);data.height=_currentMap.height;break}if(!device)device={display:data};let fp=getFeaturePosition(device,position);if(trigger)addNewDevice(fp);return fp}function resetCustomSettings(){let dInfo=_getDisplayInfo();if(_monitorsConfig.count===dInfo.length);
else if(_monitorsConfig.count>dInfo.length){_displayAttachedCount=dInfo.length;processProfileInfo()}else{let getExternalDisplayId=function(){let ds=_getDisplayInfo();let id=null,i=0;while(i<ds.length&&id==null){if(!ds[i].mainDisplay&&ds[i].external)id=ds[i].id;i++}return id};let r=dInfo.length-_monitorsConfig.count;for(let i=0;i<r;i++){let id=getExternalDisplayId();if(id!=null)fireEvent("requestRemotion",id,true,{async:false})}}}async function addNewDevice(device){if(_monitorsConfig.canBeOverridden)fireEvent("addDevice",
device)}async function updateScreenDetails(){return new Promise(function(resolve){var errMsg=consts.displayScreenDetailsDenied;navigator.permissions.query({name:"window-placement"}).then(permission=>{if(permission.state!=="denied")_screenDetails=window.getScreenDetails().then(r=>{_screenDetails=r;helper.console.log(`Screen details: ${JSON.stringify(_screenDetails)}`);resolve(r)}).catch(e=>{_screenDetails=null;helper.console.log(`${consts.displayManagerError} - ${errMsg}`,arguments);resolve(e)});else{helper.console.log(errMsg,
arguments);resolve(permission)}}).catch(err=>{helper.console.log(errMsg,arguments);resolve(err)})})}function getResolutionValue(resolution){let res=null;switch(resolution){case "fittobrowser":res=ThinRDP.resolution.FIT_TO_BROWSER;break;case "fittoscreen":res=ThinRDP.resolution.FIT_TO_SCREEN;break;case "custom":default:res=ThinRDP.resolution.CUSTOM;break}return res}function updateDisplaySize(device){if(device){device.resolution=_profile?.resolution?getResolutionValue(_profile.resolution):_profile.fitmode||
ThinRDP.resolution.FIT_TO_BROWSER;let tSize=device.resolution==null?null:resolveDisplayResolution(device);let size=tSize?tSize:{width:device.display?.width||environment.availWidth,height:device.display?.height||environment.availHeight};if(!device.surface)device.surface={};if(!device.display)device.display={};device.display.height=device.physicalHeight=device.height=size.height;device.display.width=device.physicalWidth=device.width=size.width}return device}function getFeaturePosition(defaultDevice,
position){let device={surface:{top:0,left:0},window:{top:0,left:0},display:{width:0,height:0},desktopScaleFactor:1,deviceScaleFactor:1,external:true,mainDisplay:false,resolution:"landscape"};if(defaultDevice)helper.object.parseAttributes(device,defaultDevice);updateDisplaySize(device);let displays=_getDisplayInfo();let firstDisplay=displays.length>0?displays[0]:null;let lastDisplay=firstDisplay?displays[displays.length-1]:null;let top=0,left=0;switch(position){case _addingPosition.TOP:if(firstDisplay){top=
firstDisplay.surface.top-device.display.height;left=firstDisplay.surface.left}break;case _addingPosition.LEFT:if(firstDisplay){top=firstDisplay.surface.top;left=firstDisplay.surface.left-device.display.width}break;case _addingPosition.BOTTOM:if(lastDisplay){top=lastDisplay.surface.top+lastDisplay.display.height;left=lastDisplay.surface.left}break;case _addingPosition.RIGHT:if(lastDisplay){top=lastDisplay.surface.top;left=lastDisplay.surface.left+lastDisplay.display.width}break}device.surface={top,
left};let windowPosition={top:0,left:0};let customWP=device.window&&device.isWindowPositionAssigned&&_isNumber(device.window.top)&&_isNumber(device.window.left);if(device.mainDisplay){device.surface.left=0;device.surface.top=0;device.external=false;device.mainDisplay=true;if(!customWP){windowPosition.top=0;windowPosition.left=0}}else{device.external=true;device.mainDisplay=false;if(!customWP){let ml=0;let mt=0;displays.forEach(function(m){if(m.resolution==2){ml+=m.screen.width;mt+=m.screen.height}else{ml+=
m.display.width;mt+=m.display.height}});var getCurrentScreenIndex=function(display){let w=Math.min(display.display.width,display.width);let h=Math.min(display.display.height,display.height);let l=display.window.left;let t=display.window.top;let idx=_screenDetails.screens.findIndex(function(screen){return screen.left<=l&&l+w<=screen.left+screen.width&&screen.top<=t&&t+h<=screen.top+screen.height});if(idx===null)idx=_screenDetails.screens.findIndex(function(screen){return screen.left<=display.window.left&&
display.window.left<screen.left+screen.width&&screen.top<=display.surface.top&&display.surface.top<screen.top+screen.height});return idx};let mainScreenIdx=null;if(displays.length>0&&_screenDetails&&_screenDetails.screens.length>0){let np=null;let screens=[];displays.forEach(function(d){let screen={};let idx=getCurrentScreenIndex(d);if(_isNumber(idx)){if(d.mainDisplay){screen.details=_screenDetails.screens[idx];screen.available=false;screen.index=idx;screen.canBeMoved=false;mainScreenIdx=idx}else{screen.details=
_screenDetails.screens[idx];screen.available=false;screen.index=idx;screen.canBeMoved=true}screens.push(screen)}});_screenDetails.screens.forEach(function(s,i){let screen=screens.find(function(screen){return screen.index===i});if(!screen||screen.available!==false)screens.push({details:_screenDetails.screens[i],available:true,index:i,canBeMoved:false})});screens=screens.sort(function(s1,s2){return s1.index-s2.index});let availableScreenIdx=null;switch(position){case _addingPosition.TOP:case _addingPosition.LEFT:if(mainScreenIdx>
0)for(let i=0;i<mainScreenIdx;i++)if(screens[i].available)availableScreenIdx=i;break;case _addingPosition.BOTTOM:case _addingPosition.RIGHT:for(let i=screens.length-1;i>mainScreenIdx;i--)if(screens[i].available)availableScreenIdx=i;break;case _addingPosition.UNDEFINED:for(let i=screens.length-1;i>mainScreenIdx;i--){if(screens[i].available)availableScreenIdx=i;np="major"}if(availableScreenIdx==null)for(let i=0;i<screens.length-1;i++){if(screens[i].available)availableScreenIdx=i;np="minor"}break}if(availableScreenIdx==
null){let availScreen=screens.find(function(s){return s.available});if(availScreen)availableScreenIdx=availScreen.index;else{np="major";availableScreenIdx=0}}let t=0,l=0;try{t=screens[availableScreenIdx].details.top;l=screens[availableScreenIdx].details.left}catch(error){helper.console.warning(`Cannot get screen detail at: ${availableScreenIdx}, length: ${_screenDetails.screens.length}`)}finally{windowPosition.top=t;windowPosition.left=l}if(position==_addingPosition.UNDEFINED){let as=screens[availableScreenIdx].details;
let sl=l-(l+device.display.width);st=t;if(np=="major"){if(lastDisplay)if(Math.abs(as.top-lastDisplay.surface.top)>Math.abs(as.left-lastDisplay.surface.left)){st=lastDisplay.surface.top+lastDisplay.display.height;sl=lastDisplay.surface.left}else{st=lastDisplay.surface.top;sl=lastDisplay.surface.left+lastDisplay.display.width}}else if(np="minor")if(firstDisplay)if(Math.abs(as.top-firstDisplay.surface.top)>Math.abs(as.left-firstDisplay.surface.left)){st=firstDisplay.surface.top-device.display.height;
sl=firstDisplay.surface.left}else{st=firstDisplay.surface.top;sl=firstDisplay.surface.left-device.display.width}device.surface.top=st;device.surface.left=sl}}else{if(position==_addingPosition.UNDEFINED){device.surface.top=0;device.surface.left=ml}windowPosition.top=0;windowPosition.left=ml}}if(!customWP){device.window.top=windowPosition.top;device.window.left=windowPosition.left}}let msg=null;if(device.mainDisplay)msg=`Feature Position - Opening in the current tab, width: ${device.width}, height: ${device.height}`;
else msg=`Feature Position - x: ${device.window.left}, y ${device.window.top}, width: ${device.width}, height: ${device.height}`;helper.console.log(msg);return device}function resolveDisplayResolution(display){let res=null;if(display&&display.resolution!==null){let availScreens=null;let displays=_getDisplayInfo();if(_screenDetails){availScreens=_screenDetails.currentScreen;if(!display.mainDisplay&&_screenDetails.screens.length)if(_screenDetails.screens.length>displays.length)availScreens=_screenDetails.screens[displays.length];
else if(_screenDetails.screens.length<=displays.length)availScreens=_screenDetails.screens[displays.length-1]}let width=environment.availWidth;let height=environment.availHeight;if(!display.mainDisplay)switch(display.resolution){case ThinRDP.resolution.FIT_TO_SCREEN:if(availScreens){width=availScreens.width;height=availScreens.height}else{width=window.screen?.width||window.screenWidth;height=window.screen?.height||window.screenHeight}break;case ThinRDP.resolution.FIT_TO_BROWSER:if(availScreens){width=
availScreens.availWidth;height=availScreens.availHeight}else if(displays.length>0){let lastDisplay=displays[displays.length-1];width=lastDisplay.width;height=lastDisplay.height}break;case ThinRDP.resolution.CUSTOM:default:width=_profile.screenWidth;height=_profile.screenHeight;break}width=Math.max(width,_settings.manager.limits.min.width);height=Math.max(height,_settings.manager.limits.min.height);res={width,height}}return res}function setDistribution(value){getDisplaysMap();if(_currentMap?.distribution?.value)_currentMap.distribution.value=
value}function getDistribution(){let dMode=null;switch(_profile.multiMonitor.orientation){case 0:dMode=Thinfinity.Display.Map.DISTRIBUTION_MODES.LANDSCAPE;break;case 1:dMode=Thinfinity.Display.Map.DISTRIBUTION_MODES.PORTRAIT;break;case 2:case 3:default:dMode=Thinfinity.Display.Map.DISTRIBUTION_MODES.LANDSCAPE;break}return dMode}function getDeviceAndPosition(){let position=null;let device={resolution:environment.currentOrientation,desktopScaleFactor:1,deviceScaleFactor:1,mainDisplay:false,external:true};
if(!_currentMap)setDistribution(getDistribution());if(!_mainDisplayProcessed){position=Thinfinity.Display.Map.POSITION.LEFT;device.mainDisplay=true;device.external=false;_mainDisplayProcessed=true;_displayAttachedCount++}else if(_profile.multiMonitor&&_profile.multiMonitor.count>_displayAttachedCount)switch(_profile.multiMonitor.orientation){case 0:position=Thinfinity.Display.Map.POSITION.RIGHT;_displayAttachedCount++;break;case 1:position=Thinfinity.Display.Map.POSITION.BOTTOM;_displayAttachedCount++;
break;default:position=Thinfinity.Display.Map.POSITION.UNDEFINED;_displayAttachedCount++;break}if(position)return{device,position};else return null}async function processProfileInfo(){helper.console.log(`processProfileInfo multiMonitor count: ${_monitorsConfig.count}, overriden: ${_monitorsConfig.canBeOverridden}`);if(!_screenDetailsSync)await updateScreenDetails();_screenDetailsSync=true;let dp=getDeviceAndPosition();if(dp){let addingInfo=processDisplay(dp.device,dp.position);if(addingInfo){let devBlocked=
null;await _settings.manager.addDevice(new Thinfinity.Display.Device(addingInfo)).then(res=>{if(res&&res.code!==Thinfinity.Display.Manager.RESPONSE_CODES.SUCCESS)if(res.code===Thinfinity.Display.Manager.RESPONSE_CODES.POPUP_BLOCKED)devBlocked=true});if(devBlocked)await _settings.manager.restoreDevices();return await processProfileInfo()}}else return _mainDisplayProcessed}function dispose(){detachHandlers();_settings.manager=null;_elements=null;_ref=null;_disposed=true}initialize(arguments[0]);Object.defineProperty(_ref,
"show",{enumerable:false,configurable:false,writable:false,value:function(){show()}});Object.defineProperty(_ref,"hide",{enumerable:false,configurable:false,writable:false,value:function(){hide()}});Object.defineProperty(_ref,"refresh",{enumerable:false,configurable:false,writable:false,value:function(){refresh()}});Object.defineProperty(_ref,"getSurfaces",{enumerable:false,configurable:false,writable:false,value:function(){return getSurfaces()}});Object.defineProperty(_ref,"getDisplaysMap",{enumerable:false,
configurable:false,writable:false,value:function(){return getDisplaysMap()}});Object.defineProperty(_ref,"updateScreenDetails",{enumerable:true,configurable:false,writable:false,value:updateScreenDetails});Object.defineProperty(_ref,"processProfileInfo",{enumerable:false,configurable:false,writable:false,value:processProfileInfo});Object.defineProperty(_ref,"dispose",{enumerable:false,configurable:false,writable:false,value:function(){dispose()}});return _ref}try{Thinfinity!=undefined}catch(e){Thinfinity=
{}}if(!Thinfinity.Display)Thinfinity.Display={};Thinfinity.Display.Map=Map;Object.defineProperty(Map,"DISTRIBUTION_MODES",{enumerable:true,configurable:false,get:function(){return _eDistributionModes}});Object.defineProperty(Map,"POSITION",{enumerable:true,configurable:false,get:function(){return _addingPosition}})})();
function Theme(){var _themeKey="workspace_account_settings";var _eThemes=Object.freeze({LIGHT:"light-mode",DARK:"dark-mode",BLUE:"blue-mode"});var _eThemesClasses=Object.freeze({AUTOMATIC:"AUTOMATIC"});var _newVersionClass="V7";var _dataRead=false;var _eDefaultTheme=_eThemes.LIGHT;function getData(){let data=helper.storage.get(_themeKey);if((!data||!data.themeOverriden)&&!_dataRead)helper.ajax.get({"url":`${Thinfinity.global.variables.basePath}__base__/config/themes`,"dataType":helper.ajax.responseType.JSON,
"data":JSON.stringify({}),"async":false,"success":function(e){let themesData=JSON.parse(e).data;data={themeOverriden:false,themeVersion:themesData.themeVersion||_newVersionClass,themeName:themesData.defaultTheme||_eThemesClasses.AUTOMATIC,lightMode:themesData.lightMode||_eThemes.LIGHT,darkMode:themesData.darkMode||_eThemes.DARK};helper.storage.set(_themeKey,data);_dataRead=true},"error":function(e,status,xhr){if(!data){data={themeOverriden:false,themeVersion:_newVersionClass,themeName:_eThemesClasses.AUTOMATIC,
lightMode:_eThemes.LIGHT,darkMode:_eThemes.DARK};helper.storage.set(_themeKey,data)}}});return data}function setData(theme,themeName,themeVersion,overriden=true){let t={themeVersion};if(theme)t.theme=theme;if(themeName)t.themeName=themeName;t.themeOverriden=overriden;let d=getData();if(d)t={...t,...d};if(themeVersion===null)delete t.themeVersion;helper.storage.set(_themeKey,t);return t}function on(handler){if(handler instanceof Function)return helper.storage.on(_themeKey,handler);else return false}
function off(handler){if(handler instanceof Function)return helper.storage.off(_themeKey,handler);else return false}function applyBodyStyle(data){let applyThemeClass=({themeClass,oldClass})=>{if(themeClass==_eThemesClasses.AUTOMATIC&&window.matchMedia)themeClass=window.matchMedia("(prefers-color-scheme: dark)").matches?data.darkMode:data.lightMode;if(!!oldClass&&helper.style.hasClass(document.body,oldClass))helper.style.replace(document.body,oldClass,themeClass);else helper.style.addClass(document.body,
themeClass)};if(Object.getOwnPropertyNames(data).length>0){if(window.cookiePrefix)helper.style.add(document.body,window.cookiePrefix);var td=getData();if(td?.themeVersion)helper.style.add(document.body,td.themeVersion);else helper.style.remove(document.body,_newVersionClass);let themeClass=data.themeName;let oldClass=null;if(data instanceof StorageEvent){let nv=JSON.parse(data.newValue);if(nv){oldClass=JSON.parse(data.oldValue).themeName;themeClass=nv.themeName}}if(!oldClass&&themeClass==_eThemesClasses.AUTOMATIC)oldClass=
window.matchMedia("(prefers-color-scheme: dark)").matches?data.lightMode:data.darkMode;applyThemeClass({...{themeClass},...(oldClass?{oldClass}:{})});helper.style.remove(document.body,"non-visible")}}function applyTheme(options){let setStyle=data=>{if(!document.body)helper.dom.interactive(function(){applyBodyStyle(data)});else applyBodyStyle(data)};let ver=null;let d=getData();let tv=null;if(options){if(options.auto===true)on(setStyle);if(!(d?.themeName?.length>0))if(options.default?.length>0)d={themeName:options.default};
else d={themeName:_eDefaultTheme};if(options.hasOwnProperty("themeVersion")){ver=true;tv=options.themeVersion}else if(options.hasOwnProperty("version")){ver=true;tv=options.version}if(ver)d=setData(d.theme,d.themeName,tv)}if(d){setStyle(d);if(options?.callback)options.callback()}else return false}function getVersion(){let d=getData();if(d)return d?.themeVersion?d.themeVersion.toUpperCase():null;else null}function init(){if(window.matchMedia)window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",
function(e){applyBodyStyle(getData())})}Object.defineProperty(this,"get",{enumerable:true,configurable:false,writable:false,value:getData});Object.defineProperty(this,"version",{enumerable:true,configurable:false,get:function(){return getVersion()}});Object.defineProperty(this,"set",{enumerable:true,configurable:false,writable:false,value:setData});Object.defineProperty(this,"on",{enumerable:true,configurable:false,writable:false,value:on});Object.defineProperty(this,"off",{enumerable:true,configurable:false,
writable:false,value:off});Object.defineProperty(this,"apply",{enumerable:true,configurable:false,writable:false,value:applyTheme});Object.defineProperty(this,"themes",{enumerable:true,configurable:false,get:function(){return _eThemes}});Object.defineProperty(this,"default",{enumerable:true,configurable:false,get:function(){return _eDefaultTheme}});init();return this}try{Thinfinity!=undefined}catch(e){Thinfinity={}}Thinfinity.Theme=new Theme;
(function(){function MController(args){var _ref=this;var productId=null;var _args={id:null,name:null,device:null,sizeLimit:{min:{width:640,height:480},max:{width:8192,height:8192}},viewWidth:0,viewHeight:0};var _oInterface=null;var _methods=null;var _properties=null;var _output={textValue:null,setSelectionRange:null,updateMacCmd:null,processData:null,processCmds:null,processFrame:null,cursorCanvas:null,getMinZoomFactor:null};var _keyboardHandler=null;var _container=null;var _initialized=false;var _resizeTimeout=
false;var _waitToResize=500;var _registerdCmds=[];var _orphan={timeoutId:null,timeout:5E3,enabled:false,maxTimeoutBeforeClose:15E3};var _enumPictureType=helper.object.createEnum({CANVAS:0,H264:1,GFX:2});var _isEmbedded=true;var _currentCursor={"intervalId":null,"intervalTime":25,"count":0,"maxCount":20,"checkUpdate":function(){if(_container.style.cursor!=_container.originalImage.cursor)if(_currentCursor.count<=_currentCursor.maxCount){_container.style.cursor="none";_container.style.cursor=_container.originalImage.cursor}else{clearInterval(_currentCursor.intervalId);
helper.console.log(helper.string.format("Cannot assign current cursor image: {0}",_container.originalImage.cursor),arguments)}else if(_currentCursor.count>=_currentCursor.maxCount)clearInterval(_currentCursor.intervalId);_currentCursor.count++},"check":function(){_currentCursor.count=0;clearInterval(_currentCursor.intervalId);_currentCursor.intervalId=setInterval(_currentCursor.checkUpdate,_currentCursor.intervalTime)}};var _noop=function(){};var _messages={reject:{interface:{set:"Invalid interface data - TMC-SI",
get:"Invalid interface data - TMC-GI"}},error:{missingContainer:"Cannot find a valid container"},initializing:{start:"    Starting monitor controller.",ready:"    -- > Monitor controlled initialized"}};var _clipObj=null;var _mouseDriver=null;var _touchDriver=null;var wndTop=null;var _identify={timeout:5E3,timeoutId:null,containerElem:null,blockElem:null,idContainerElem:null,idElem:null};var _vncContainer=null;var _blockDisplayElem=null;var _deviceRef=null;var _bodyHeight=0;var _bodyWidth=0;var _sizeElem=
null;var _isLegacy=typeof legacyVersion!="undefined"?legacyVersion:true;var _setFocusHandler=_noop;let _webV7FrameElement=null;function initialize(){helper.dom.ready(function(){Thinfinity.Theme?.apply({auto:true});waiting();wndTop=helper.url.getTopWindow(window);if(!window.ThinVNC&&window.opener===null&&wndTop===window&&!Thinfinity?.Monitor?.Manager){clearTimeout(_orphan.timeoutId);_orphan.timeoutId=setTimeout(runOrphan,_orphan.timeout)}_output.getMinZoomFactor=getMinZoomFactor})}function getWebV7Frame(){if(_webV7FrameElement)return _webV7FrameElement;
else try{_webV7FrameElement=window.__webV7__&&window.frameElement?window.frameElement.parentElement:false}catch(err){_webV7FrameElement=false}return _webV7FrameElement}function canRunResize(){let res=true;let fe=getWebV7Frame();if(fe)try{let display=fe.style.getPropertyValue("display");if(display==="none")res=false}catch(error){}return res}function execScaled(){let r=setScaled(_properties.scaled);zoomDesktop();return r}function waiting(){if(Thinfinity?.Popups?.establishing&&!_isLegacy)Thinfinity.Popups.establishing.show(consts.loading,
consts.connecting,true,false)}function runOrphan(){let msg=consts.displayCancelled;helper.console.warning(msg,arguments);msg+=`</br><button id="btnClose" onclick="window.close();let btn = document.getElementById('btnClose'); btn.parentElement.removeChild(btn);">${consts.displayCloseTab}</button>`;document.body.innerText="";helper.dom.appendJsonElement({"parentElement":document.body,"type":"div","attributes":{"class":"bye"},"content":msg});setTimeout(function(){window.close()},_orphan.maxTimeoutBeforeClose)}
function setInterface(){return new Promise((resolve,reject)=>{if(arguments&&typeof arguments[0]==="object"&&typeof arguments[1]==="object"){_deviceRef=arguments[0];_deviceRef.screen.width=window.screen.width;_deviceRef.screen.height=window.screen.height;_oInterface=arguments[1];_methods=_oInterface.methods;_properties=_oInterface.properties;productId=_properties.productId;_oInterface.on("scaled",execScaled);resolve(true)}else reject(_messages.reject.interface.set)})}function getInterface(){return new Promise((resolve,
reject)=>{if(arguments&&arguments[0])resolve(_output);else reject(_messages.reject.interface.get)})}function initializeFocus(){Thinfinity.TabFocusHook.on("visible",function(e){_properties.hasFocus=true;_methods.sendFocus(_args.device.id,"tabvisible",true)}).on("hidden",function(e){_properties.hasFocus=false;_methods.sendFocus(_args.device.id,"tabvisible",false)}).on("focus",function(e){_properties.hasFocus=true;if(_keyboardHandler)_keyboardHandler.focus();_methods.sendFocus(_args.device.id,"focus",
true)}).on("blur",function(e){_properties.hasFocus=false;_methods.sendFocus(_args.device.id,"focus",false)}).on("visibility",function(e){_properties.hasFocus=["visible"].indexOf(e.visibilityState)!==-1;_methods.sendFocus(_args.device.id,"visibility",e.visibilityState)});if(_isEmbedded)setTimeout(function(){_properties.hasFocus=document.hasFocus();_methods.sendFocus(_args.device.id,"focus",document.hasFocus())},250)}function resize(){let wnd=window;let devInfo={width:wnd.environment.availWidth,height:wnd.environment.availHeight,
display:{width:_container.offsetWidth,height:_container.offsetHeight}};if(_args.sizeLimit?.min){let min=_args.sizeLimit.min;devInfo.width=Math.max(min.width,devInfo.width);devInfo.height=Math.max(min.height,devInfo.height)}helper.console.log(`Resize monitor - id ${_args.device.id}, info: ${JSON.stringify(devInfo)}`,arguments);_methods.resize(_args.device.id,devInfo)}function resizeHandler(){if(_resizeTimeout){clearTimeout(_resizeTimeout);_resizeTimeout=null}updateBodySize();zoomDesktop()}function resizeCompleteHandler(){if(_resizeTimeout)clearTimeout(_resizeTimeout);
_resizeTimeout=setTimeout(function(){resize();zoomDesktop()},_waitToResize)}function initializeResize(){setScaled(_properties.scaled);updateBodySize();zoomDesktop();window.environment.on("resize",resizeHandler);window.environment.on("resizeComplete",resizeCompleteHandler);if(!_isEmbedded)setTimeout(resize,1E3)}function registerCmds(cmd,handler){if(!_registerdCmds[cmd])_registerdCmds[cmd]=handler}function processCmds(obj){if(_registerdCmds[obj.cmd])return _registerdCmds[obj.cmd](obj)}function promptTextCountdown(constMsg,
time,callback){let getSprintfText=null;let _timeoutTextId=null;if(time){let _currentPromptTime=Date.now();getSprintfText=function(){let s=parseInt((time-(Date.now()-_currentPromptTime))/1E3,10);if(s>1)s=s.toString()+" "+consts.seconds;else s=s.toString()+" "+consts.second;return helper.string.sprintf(constMsg,s)};_timeoutTextId=setInterval(function(){let dlg=document.getElementById("dlgH264Message");if(dlg)dlg.innerHTML=getSprintfText();if(Date.now()-_currentPromptTime>=time){clearInterval(_timeoutTextId);
if(callback)callback()}},1E3)}else getSprintfText=function(){return helper.string.sprintf(constMsg)};Thinfinity.Popups.choice({id:"dlgDecoderError",parentElement:"",class:"",iconType:"disconnectedIco",title:productName,message:`<span id="dlgH264Message">${getSprintfText().toString()}</span>`,buttons:[{value:!time?consts.Close:consts.retry,class:"",action:function(e){clearInterval(_timeoutTextId);if(callback)callback()}}],noPropagateEvents:true});_currentPromptTime=Date.now()}function initializeVideoDriver(data){var videoDriverError=
null;if(_properties.enableH264)if(agentInfo.h264){if(helper.object.existsPath(window,"Thinfinity.Driver.Video")){let h264Key="#__Thinfinity.Video.Driver__"+(data.key||"");var h264Decoders=[Thinfinity.Driver.Video.DECODER_TYPES.TINYBSD,Thinfinity.Driver.Video.DECODER_TYPES.JMUXER,Thinfinity.Driver.Video.DECODER_TYPES.BSD,Thinfinity.Driver.Video.DECODER_TYPES.BSDWORKER];var _currentDecoderIdx=0;let getDecoder=function(){let d=helper.storage.get(h264Key);if(d){_currentDecoderIdx=d.cdi;return h264Decoders[_currentDecoderIdx]}else return h264Decoders[_currentDecoderIdx]};
let switchDecoder=function(){if(_currentDecoderIdx<h264Decoders.length-1){_currentDecoderIdx++;helper.storage.add(h264Key,{cdi:_currentDecoderIdx});promptTextCountdown(consts.h264DecodeError,3E3,function(){window.location.reload()})}else promptTextCountdown(consts.h264DecoderError,null,function(){helper.storage.clear(h264Key);if(_methods.disconnect)_methods.disconnect()})};_videoDriver=new Thinfinity.Driver.Video({"id":data.id,"container":_container,"player":"player","decoderType":getDecoder(),"methods":{"sendCmd":_methods.sendCmd,
"registerCanvas":_methods.registerCanvas},"events":{"pictureSize":function(width,height){},"processDataEcho":_methods.processDataEcho?function(data){_methods.processDataEcho(_args.device.id,data)}:_noop,"error":function(obj){videoDriverError=true;if(_isEmbedded){if(obj)switch(obj.code){case Thinfinity.Driver.Video.ERROR_CODE.NONE_PICTURE_PROCESSED:helper.console.warning(`Invalid decoder type, arrayBuffer data is not compatible with the current decoder.`);switchDecoder();break;default:break}setTimeout(function(){let oError=
{message:obj.msg||obj};_oInterface.__prototype__.fireEvent("onServerError",oError)},500)}}}});_output.processData=_videoDriver.processData}}else _videoDriver={"processData":function noop(){}};else if(_properties.enableGfx){_videoDriver=new Thinfinity.Driver.GFXProcessor({"id":data.id,"size":{width:data.device.width,height:data.device.height},"container":_container,"methods":{"sendCmd":_methods.sendCmd,"registerCanvas":_methods.registerCanvas,"repaint":()=>{_oInterface.__prototype__.fireEvent("gfxRepaint")}}});
_oInterface.on("repaint",()=>{if(_properties.repaint&&_properties.isShadowSession)_videoDriver.forceRepaint=true;_properties.repaint=false});_output.processData=_videoDriver.processData}else try{videoDriverError=false}catch(error){_oInterface.__prototype__.fireEvent("onServerError",{message:`Cannot start ctx driver. ${error.message}`});videoDriverError=true}return!videoDriverError}function preventDefault(e){if(e)if(helper.style.hasAnyClass(e.srcElement||e.target,"thin-allowcontrol preventTouchExecution")){e.preventDefault();
return true}}function showStdKdbHandler(){if(_properties.cursorCanvasY>=0)_keyboardHandler.inputElement.style.top=`${_properties.cursorCanvasY}px`;_keyboardHandler.focus(true)}function documentClickHandler(){if(!document.hasFocus()){document.body.focus();_keyboardHandler.focus()}}function initializeKeyboardDriver(data){if(!_keyboardHandler&&!agentInfo.isMobile){_keyboardHandler=new Thinfinity.Driver.Keyboard({parentElement:document.body,clipboard:_oInterface.properties.clipboard?.properties,methods:_methods,
properties:_properties,events:{keyboardEvent:function(){},hook:function(value){},focus:function(e){},blur:function(e){}}});_output.setSelectionRange=_keyboardHandler.setSelectionRange;_output.textValue=function(){return _keyboardHandler.inputElement.value};_output.updateMacCmd=agentInfo.isMac?_keyboardHandler.updateMacCmd:_noop;if(!agentInfo.isMobile)_oInterface.on("showStdKdb",showStdKdbHandler);_mouseDriver.on("documentClick",documentClickHandler);if(!agentInfo.isMobile){let isTouchEvt=false;_setFocusHandler=
()=>{if(!isTouchEvt)_keyboardHandler.focus()};if(_mouseDriver)_mouseDriver.on("mouseDown",_setFocusHandler);let isTap=false;if(_touchDriver)_touchDriver.ready(()=>{document.addEventListener("keydown",e=>{let iType=(e?.target?.type||e?.target?.nodeName||"").toUpperCase();if(["TEXT","PASSWORD","TEXTAREA"].indexOf(iType)!==-1)return true;if(_keyboardHandler.inputElement!==document.activeElement){isTouchEvt=false;_setFocusHandler()}});_touchDriver.on("tap",()=>{isTap=true});_touchDriver.on("release",
e=>{isTouchEvt=["touchstart","touchmove","touchend"].indexOf(e.type)!==-1;if(isTap)setTimeout(_setFocusHandler,250);isTap=false})})}}}function getElementFromPoint(e){let hasChildOfByClassName=(classname,child)=>{var elems=document.getElementsByClassName(classname);for(var i=0;i<elems.length;i++)if(elems[i].contains(child))return true;return false};var x,y;if((e.changedTouches||e.touches)&&(e.changedTouches||e.touches).length>0){x=(e.changedTouches||e.touches)[0].pageX-document.body.offsetLeft;y=(e.changedTouches||
e.touches)[0].pageY-document.body.offsetTop}else if(e.clientX!=undefined||e.pageX!=undefined){x=e.clientX||e.pageX-document.body.offsetLeft;y=e.clientY||e.pageY-document.body.offsetTop}else if(e.pointers!=undefined&&e.pointers.length>0){x=e.pointers[0].pageX-document.body.offsetLeft;y=e.pointers[0].pageY-document.body.offsetTop}var idMask=productId+"_canvas_";var selectedElement=document.elementFromPoint(x,y);if(selectedElement&&(!helper.style.hasClass(selectedElement,"__uselocalmouse__")&&!hasChildOfByClassName("__uselocalmouse__",
selectedElement)&&(selectedElement.tagName=="CANVAS"||selectedElement.name=="caret"||selectedElement.id=="caret"||selectedElement==_args.container||selectedElement.id.indexOf(idMask)!=-1||helper.style.hasClass(selectedElement,"ignoremouse"))))return null;else return selectedElement}function initializeMouseDriver(data){if(!_mouseDriver){_mouseDriver=new Thinfinity.Driver.Mouse({container:_container,device:data.device,extra:{getElementFromPoint,preventDefault}},_oInterface);Object.defineProperty(_output,
"cursorCanvas",{enumerable:true,configurable:false,get:()=>{return _mouseDriver?.cursorCanvas}})}}function initializeTouchDriver(data){if(!_touchDriver&&!agentInfo.isMobile&&Thinfinity?.Driver?.Touch){let moveCursorCanvas=_mouseDriver&&_mouseDriver.moveCursorCanvas?_mouseDriver.moveCursorCanvas:_noop;let _cOInterface=_oInterface.__prototype__.clone();_cOInterface.methods.sendMouse=function(x,y,button,action){moveCursorCanvas(x,y);_oInterface.methods.sendMouse(x,y,button,action)};var localGestures=
[...(helper.object.getValue(window,"customSettings.touch.gestures",[],{ignoreCase:true})??[]),...(helper.object.getValue(window.THIN,"clientSettings.mobile.gestures",null,{ignoreCase:true})??[]),...(helper.object.getValue(window.THIN?.rcParams,"mobile.gestures",null,{ignoreCase:true})??[]),...(helper.object.getValue(window,"customSettings.mobile.gestures",[],{ignoreCase:true})??[])];_touchDriver=new Thinfinity.Driver.Touch({container:_container,device:data.device,extra:{getElementFromPoint,waitForTouchDevice:()=>
{setTimeout(()=>{moveCursorCanvas=_mouseDriver&&_mouseDriver.moveCursorCanvas?_mouseDriver.moveCursorCanvas:_noop;_oInterface.methods.fireEvent("onTouchDeviceDetected")},200)},preventDefault},gestures:localGestures},_cOInterface)}}function initializeClipboard(){if(!_clipObj&&_oInterface.properties.clipboard?.properties?.enable&&Thinfinity.Clipboard&&_keyboardHandler)_clipObj=new Thinfinity.Clipboard({...{inputElem:_keyboardHandler.inputElement,parentElement:_container,canPasteFiles:_oInterface.properties.canPasteFiles},
..._oInterface})}function getEnvironmentValues(){let scale=agentInfo.isFirefox||agentInfo.isOpera||agentInfo.isChrome||agentInfo.isSafari||agentInfo.isIE9?getScale():1;let border=_properties.border;let crop={"widht":0,"height":0};if(productId==="thinrdp")crop=environment.crop||crop;let width=_container.offsetWidth*scale-(productId==="thinrdp"?crop.width/2:0)-(border.left+border.right);let height=_container.offsetHeight*scale-(productId==="thinrdp"?crop.height/2:0)-(border.top+border.bottom);return{scale,
border,width,height}}function center(){if(agentInfo.isMobile){_container.style.top="0px";_container.style.marginTop="0px";_container.style.left="0px";_container.style.marginLeft="0px"}else{let gev=getEnvironmentValues();if(_properties.centered&&_properties.scaled)if(gev.scale!=1)applyCenter(gev,_properties.centeredMode);else{_container.style.top="0px";_container.style.marginTop="0px";_container.style.left="0px";_container.style.marginLeft="0px"}else{let cm="";let lw=gev.width<=document.body.offsetWidth;
let lh=gev.height<=document.body.offsetHeight;if(lw&&lh)cm="both";else if(lw)cm="horizontal";else if(lh)cm="vertical";if(cm.length>0)applyCenter(gev,cm);else{_container.style.top="0px";_container.style.marginTop="0px";_container.style.left="0px";_container.style.marginLeft="0px";if(_properties.overflow)_container.parentElement.style.overflow=_properties.overflow}}}}function applyCenter({width,height,border}=obj,centeredMode){let ml=width/2;let mt=height/2;if(["horizontal","both"].indexOf(centeredMode)!==
-1){_container.style.left="50%";_container.style.marginLeft=-ml+"px"}else{_container.style.left=border.left;_container.style.marginLeft="0px"}if(["vertical","both"].indexOf(centeredMode)!==-1){_container.style.top="50%";_container.style.marginTop=-mt+"px"}else{_container.style.top=border.top;_container.style.marginTop="0px"}applyOverflow({width,height})}function applyOverflow({width,height}=obj){if(!width)width=1;if(!height)height=1;if(_properties.scaled)_container.parentElement.style.overflow="hidden";
else if(_properties.overflow&&(width-1>document.body.offsetWidth||height-1>document.body.offsetHeight))_container.parentElement.style.overflow=_properties.overflow;else _container.parentElement.style.overflow="hidden"}function updateDesktopSize(width,height){if(width&&!(agentInfo.isMobile&&_args.viewWidth>window.screen.width))_container.style.width=_vncContainer.style.width=width+"px";if(height&&!(agentInfo.isMobile&&_args.viewHeight>window.screen.height))_container.style.height=_vncContainer.style.height=
height+"px"}function updateBodySize(){let size=helper.size.get(_sizeElem);var border=_properties.border;_bodyHeight=size.height-(border.top+border.bottom+(productId==="thinrdp"?environment.crop.height:0));_bodyWidth=size.width-(border.left+border.right+(productId==="thinrdp"?environment.crop.width:0))}function setScaled(scaled,hwnd){var virtualui=productId=="webfmx"||productId=="virtualui";if(_properties.rdpMode&&!scaled)updateDesktopSize(_args.viewWidth,_args.viewHeight);applyOverflow(getEnvironmentValues());
if(_properties.fitmode==0||_properties.fitToBrowser==true)if(scaled){_container.parentElement.style.overflow="hidden";updateDesktopSize(_args.viewWidth,_args.viewHeight)}else{var tempWidth=0;var tempHeight=0;var mw=_args.viewWidth;var mh=_args.viewHeight;var border=_properties.border;if(window.environment.isFullscreen){tempWidth=border.left+Math.max(mw,_args.viewWidth)+border.right;tempHeight=border.top+Math.max(mh,_args.viewHeight)+border.bottom}else{tempWidth=border.left+Math.min(mw,_args.viewWidth)+
border.right;tempHeight=border.top+Math.min(mh,_args.viewHeight)+border.bottom}if(productId!="thinrdp")updateDesktopSize(tempWidth,tempHeight);if(_properties.overflow)_container.parentElement.style.overflow=_properties.overflow}else if(virtualui)if(_properties.fitmode==1){var tempWidth=0;var tempHeight=0;var maxSize=_properties.maxSize;var border=_properties.border;if(!agentInfo.isMobile){tempWidth=Math.max(maxSize.width,_args.viewWidth);tempHeight=Math.max(maxSize.height,_args.viewHeight);if(window.environment.isFullscreen==
true){tempWidth=Math.max(window.environment.rawWidth,tempWidth);tempHeight=Math.max(window.environment.rawHeight,tempHeight)}}else{tempWidth=border.left+Math.min(maxSize.width,_args.viewWidth)+border.right;tempHeight=border.top+Math.min(maxSize.height,_args.viewHeight)+border.bottom}updateDesktopSize(border.left+tempWidth+border.right,border.top+tempHeight+border.bottom);if(_args.viewHeight>window.environment.availHeight||_args.viewWidth>window.environment.availWidth)_container.parentElement.style.overflow=
"scroll";else if(_properties.overflow)_container.parentElement.style.overflow=_properties.overflow}else if(_properties.fitmode==2){_container.parentElement.style.overflow="hidden";updateDesktopSize(_args.viewWidth,_args.viewHeight)}if(!(virtualui||typeof hwnd=="undefined")&&(_properties.fitToBrowser||_properties.fitmode==0))if(_isEmbedded){var win={"left":0,"top":0,"width":_args.viewWidth,"height":_args.viewHeight,"hwnd":hwnd,"zidx":_properties.baseZIndex};_oInterface.__prototype__.fireEvent("createCanvas",
win)}_properties.scaled=scaled;_properties.scale=getScale()}function getScale(){if(!_properties.scaled)return _properties.zoomFactor;var c1=_bodyHeight/_args.viewHeight;var c2=_bodyWidth/_args.viewWidth;if(c1>1&&c2>1)return _properties.serverDPR.enabled?_properties.serverDPR.originalValue&&_properties.serverDPR.originalValue<1?Math.min(c1,c2):1:c2<c1?c2:c1;else{if(_properties.serverDPR.enabled&&_properties.zoomFactor>1)_properties.zoomFactor=1;return c2<c1?c2:c1}}function zoomFactorReset(){var c1=
_bodyHeight/((window.environment.height/window.environment.currentDevicePixelRatio-(window.environment.margin.top+window.environment.margin.bottom))*window.environment.currentDevicePixelRatio);var c2=_bodyWidth/((window.environment.width/window.environment.currentDevicePixelRatio-(window.environment.margin.left+window.environment.margin.right))*window.environment.currentDevicePixelRatio);_properties.minZoomFactor=c1>1&&c2>1?1:c2<c1?c2:c1;return _properties.minZoomFactor}function getMinZoomFactor(){_properties.minZoomFactor=
agentInfo.isMobile&&_properties.scaled?1:_properties.minZoomFactor;return _properties.minZoomFactor?_properties.minZoomFactor:zoomFactorReset()}function zoomDesktop(scale){if(canRunResize()){if(scale!=undefined){if(scale>=getMinZoomFactor())_properties.zoomFactor=scale;_properties.scale=scale}else _properties.scale=getScale();if(_properties.centered&&(!agentInfo.isMobile||_properties.scaled))center();var s=_container.style;var strTransformOrigin="top left";if(typeof s.msTransform!="undefined"){_container.style.msTransformOrigin=
strTransformOrigin;_container.style.msTransform="scale("+_properties.scale+")"}else if(typeof s.MozTransform!="undefined"){_container.style.MozTransformOrigin=strTransformOrigin;_container.style.MozTransform="scale("+_properties.scale+")"}else if(typeof s.OTransform!="undefined"){_container.style.OTransformOrigin=strTransformOrigin;_container.style.OTransform="scale("+_properties.scale+")"}else if(typeof s.WebkitTransform!="undefined"){_container.style.WebkitTransformOrigin=strTransformOrigin;_container.style.WebkitTransform=
"scale("+_properties.scale+")"}}}function initializeHandlers(){if(_isEmbedded)helper.dom.addEvent(window,["beforeUnload","unload"],function(e){_methods.removeDevice(_args.device.id);dispose()},{passive:false})}function getContainer(){let container=null;let containers=document.getElementsByClassName("render-container");if(containers&&containers.length)container=containers[0];else{container=document.getElementById("deskdiv");if(!container)container=document.getElementById("virtualui");if(!container)container=
document.getElementById("zsdiv");if(!container)throw new Error(_messages.error.missingContainer);}_vncContainer=container;return container}function initializeCommands(){let _clickEffectDown=false;registerCmds("DS",function(win){helper.console.log(`Device: ${_args.device.id+1}, processing DS, width: ${win.width}, height:${win.height}, current scale: ${_properties.scale}`);_properties.repaint=Thinfinity.TabFocusHook.isHidden;_args.viewWidth=win.width;_args.viewHeight=win.height;updateDesktopSize(win.width,
win.height);updateBodySize();setScaled(_properties.scaled,win.hwnd);zoomDesktop()});registerCmds("ZOOM_DESKTOP",function(win){zoomDesktop(win?.value||undefined)});registerCmds("CENTER",center);registerCmds("ZOOM_FACTOR_RESET",zoomFactorReset);registerCmds("PLAYBACK_MOUSE_MOVE",function(cmd){if(cmd.data.mouseEffectVisible&&!_clickEffectDown)_clickEffectDown=true;else if(!cmd.data.mouseEffectVisible)_clickEffectDown=false;_mouseDriver.moveCursorCanvas(cmd.data.x,cmd.data.y,_clickEffectDown)})}function sessionStatus(data){initializeClipboard()}
function asyncCopyHandler(h){if(h&&_clipObj)_clipObj.async=h}function contextMenuHandler(e){if(e)e.preventDefault();return false}function attachHandlers(){_oInterface.on("asyncCopy",asyncCopyHandler);_oInterface.on("localEvent",processLocalEvents);helper.dom.addEvent(_container,"contextmenu",contextMenuHandler,{passive:false})}function removeHandlers(){_oInterface.off("asyncCopy",asyncCopyHandler);_oInterface.off("localEvent",processLocalEvents);_oInterface.off("showStdKdb",showStdKdbHandler);helper.dom.removeEvent(_container,
"contextmenu",contextMenuHandler);helper.dom.removeEvent(window,"message",onMessageHandler);window.environment.off("resize",resizeHandler);window.environment.off("resizeComplete",resizeCompleteHandler);if(_touchDriver){_touchDriver.off("tap");_touchDriver.off("release")}if(_mouseDriver){_mouseDriver.off("mouseDown",_setFocusHandler);_mouseDriver.on("documentClick",documentClickHandler)}}function processLocalEvents(data){let cmd=null;if(data.cmd)cmd=data.cmd.toLowerCase();switch(cmd){case "identify":drawId(data.timeout||
_identify.timeout);break;case "connected":unblockDisplay();break;case "connectionrestored":case "connectionunstable":case "connectionLost":blockDisplay();break;case "disconnect":stop();break;case "servercmdresult":if(data.obj)if(_properties.pictureType===_enumPictureType.CANVAS){if(data.obj?.viewWidth){_args.viewWidth=data.obj.viewWidth;updateDesktopSize(_args.viewWidth)}if(data.obj?.viewHeight){_args.viewHeight=data.obj.viewHeight;updateDesktopSize(null,_args.viewHeight)}}break;case "sessionstatus":sessionStatus(data.data);
break}}function blockDisplay(){if(!_isEmbedded){if(!_blockDisplayElem)_blockDisplayElem=helper.dom.createJsonElement({type:"div",attributes:{class:"displayControllerBlocker"}});document.body.appendChild(_blockDisplayElem)}}function unblockDisplay(){if(!_isEmbedded)if(_blockDisplayElem)_blockDisplayElem.parentElement.removeChild(_blockDisplayElem)}function drawId(timeout){if(!_identify.containerElem){_identify.containerElem=helper.dom.appendJsonElement({type:"div",parentElement:document.body,attributes:{class:"displayController"}});
_identify.blockElem=helper.dom.appendJsonElement({type:"div",parentElement:_identify.containerElem,attributes:{class:"background"}});_identify.idContainerElem=helper.dom.appendJsonElement({type:"div",parentElement:_identify.containerElem,attributes:{class:"identifyContainer"+(_isEmbedded?" embedded":"")}});_identify.idElem=helper.dom.appendJsonElement({type:"div",parentElement:_identify.idContainerElem,attributes:{class:"identify"}})}else document.body.appendChild(_identify.containerElem);_identify.idElem.innerText=
_args.device.id+1;clearTimeout(_identify.timeoutId);_identify.timeoutId=setTimeout(function(){document.body.removeChild(_identify.containerElem)},timeout)}function start(data){helper.console.log(_messages.initializing.start,arguments);clearTimeout(_orphan.timeoutId);if(!_initialized){_initialized=true;_container=getContainer();_sizeElem=_container.parentElement.tagName=="BODY"?window:_container.parentElement;_args.viewWidth=data.device.width;_args.viewHeight=data.device.height;helper.object.parseAttributes(_args,
data);initializeCommands();attachHandlers();_isEmbedded=data.isEmbedded;initializeFocus();updateDesktopSize(data.device.width,data.device.height);initializeVideoDriver(data);initializeMouseDriver(data);initializeTouchDriver(data);initializeKeyboardDriver(data);initializeHandlers();initializeResize();if(!_isEmbedded){helper.dom.addEvent(window,"message",onMessageHandler,{passive:false});setTimeout(function(){Thinfinity.Popups.unblock();Thinfinity.Popups.establishing.hide()},1E3);execScaled()}_output.processCmds=
processCmds;helper.console.log(_messages.initializing.ready)}}function onMessageHandler(e){if(e&&e.data&&e.data.cmd==="CALLBACK"){e.source.postMessage({cmd:"CALLBACK-RESPONSE"},"*");helper.dom.removeEvent(window,"message",onMessageHandler)}}function stop(){Thinfinity.TabFocusHook.stop();removeHandlers();if(_touchDriver)_touchDriver.dispose();_touchDriver=null;_mouseDriver=null;_initialized=false}function dispose(){stop()}initialize();Object.defineProperty(_ref,"start",{enumerable:true,configurable:false,
writable:false,value:start});Object.defineProperty(_ref,"stop",{enumerable:true,configurable:false,writable:false,value:stop});Object.defineProperty(_ref,"dispose",{enumerable:true,configurable:false,writable:false,value:dispose});Object.defineProperty(_ref,"getInterface",{enumerable:true,configurable:false,writable:false,value:getInterface});Object.defineProperty(_ref,"setInterface",{enumerable:true,configurable:false,writable:false,value:setInterface});Object.defineProperty(_ref,"keyboardHandler",
{enumerable:true,configurable:false,get:function(){return _keyboardHandler}});return _ref}try{Thinfinity!=undefined}catch(e){Thinfinity={}}if(typeof Thinfinity.Display==="undefined")Thinfinity.Display={};Thinfinity.Display.Controller=new MController})();
(function(){function AnimationFrame(args){var _ref=this;var _args={fps:window.agentInfo?.isMobile?15:30,time:0};var _animationWorker=null;var _isRunning=false;var _hasFocus=true;var _callbackRequest=[];function initialize(args){try{_args.time=parseInt(1E3/_args.fps,10);_animationWorker=new Worker("<%=@BASEURL%>common/workers/animation.frame.worker.js");if(_animationWorker)_animationWorker.onmessage=e=>{if(e.data.cmd==="tick")runCallbacks()};if(typeof Thinfinity.TabFocusHook!=="undefined")initializeTabFocus();
helper.object.parseAttributes(_args,args)}catch(error){return error}}function startWorker(){if(!_isRunning){_isRunning=true;_animationWorker.postMessage({cmd:"start",value:_args.time})}}function stopWorker(){if(_isRunning){_isRunning=false;_animationWorker.postMessage({cmd:"stop"});runCallbacks()}}function runCallbacks(){let tempCB=_callbackRequest;_callbackRequest=[];tempCB.forEach(cb=>{cb()})}function initializeTabFocus(){Thinfinity.TabFocusHook.on("visible",function(e){checkState(true)}).on("focus",
function(e){checkState(true)}).on("hidden",function(e){checkState(false)}).on("blur",function(e){checkState(false)}).on("visibility",function(e){checkState(["visible"].indexOf(e.visibilityState)!==-1)})}function checkState(hasFocus){_hasFocus=hasFocus;if(_hasFocus)stopWorker();else startWorker()}function request(callback){if(_hasFocus)window.requestAnimationFrame(callback);else _callbackRequest.push(callback)}initialize();Object.defineProperty(_ref,"request",{"enumerable":true,"configurable":false,
"writeable":false,"value":request});helper.console.log(helper.string.format("Initializing {0} class - {1}","Font",(new Date).toString()),arguments);return _ref}if(typeof window.helperPlugins=="undefined")helperPlugins={};helperPlugins.AnimationFrame=AnimationFrame;if(typeof window.helper!="undefined")helper.registerPlugin("animationFrame",AnimationFrame)})();jQuery.support.cors=true;if(!window.hasOwnProperty("productId"))window.productId="thinvnc";
ThinVNC=function(){var TVNC=this;var cmdCache=null;this.cookiesLoaded=false;this.browserCapabilitiesAvailable=helper.object.getValue(window,"customSettings.browserCapabilities",false);this.mouseX=-1;this.mouseY=-1;this.lastMouseAction="";this.caretX=0;this.caretY=0;this.mouseMoved=false;this.vncdiv;this.baseZIndex=8E5;this.majorVersion;this.firefoxVersion;this.iphone;this.ios;this.mac;this.mobile;this.supportsCanvas;this.startPending=true;this.jsonTimeoutValue=7E4;this.disposeTimeoutValue=25;this.disposeTimeout;
this.endingsession=false;this.pageX=0;this.pageY=0;this.button="";this.imagesLoading=0;this.fs=null;this.cacheLoaded=false;this.startCmdToSend=false;this.dbFiles=[];this.centered=true;this.vncdivId="mainPanel";this.vncContainer=null;this.reconnectDivId="recnx";this.canvasER=null;this.processNextScreenEnabled=true;this.deferCallBySetTimeout=false;this.queueRequestName="requestQueue";this.queueRecycleImg=new Array;this.recycleImgTimeoutValue=5E3;this.reconnectDelay=0;this.runInPublicServer=false;this.ws=
null;this.wsEnabled=false;this.wsAsyncRecv=false;this.wsAsyncRecvTimeout=10;this.wsSendReady=false;this.imgLoaderThreadPool=null;this.connecting=false;this.xmlHttpJson=null;this.lastKeyCode=0;var _onlyKeyCode=false;this.reconnecting=false;this.touching=false;this.crossdomain=false;this.imageCache2=[new Array(600),new Array(600),new Array(2048),new Array(4096),new Array(2048)];this.imageCacheV=[new Array(200),new Array(200),new Array(200),new Array(200),new Array(200)];this.brushCache=new Array(100);
this.offscreenCache=new Array(100);this.rdpGlyphArray=new Array(12);this.textCache=new Array(256);this.offscreenCanvas=null;this.MouseHooked=false;this.KeyboardHooked=false;this.containerWidth=0;this.containerHeight=0;this.msgQueue=[];this.imgQueue=null;this.imgQueueTimeout=1E4;this.imgIndex=0;this.imageListType=0;this.registeredDrawCmds={};this.registeredOOBCmds={};this.registeredCustomDataTypes={};this.registeredCustomCmds={};this.screenHeight=window.environment.rawHeight||window.screen.height;
this.screenWidth=window.environment.rawWidth||window.screen.width;this.canvasPrinter=null;this.xoff=false;this.useBufferedCanvas=false;this.gatewayAccessKey="";var _preferredBrokerKey="__#thinfinity.preferredBrokerId__";var _oturlDataPassKey="oturlDataPass";var _sessionStoragePreservedKeys=[_oturlDataPassKey,_preferredBrokerKey];this.savedMaxWidth=0;this.savedMaxHeight=0;this.inputEnabled=false;this.cmdCacheProps={};this.controlFactory=null;this.enableCmdCache=false;this.canvasInitiallyHidden=false;
this.logger=new JSLogAPI(this);this.printerManager=null;this.rdpMode=false;this.usedDPR=1;this.apiUrl="__base__/";var _CUEnabled=false;var _navigationTypes=helper.object.createEnum({"navigate":0,"reload":1,"back_forward":2,"prerender":3,"reserved":255});var isNewNavigation=function(){var result=false;var nt=_navigationTypes.navigate;if(window.performance){nt=_navigationTypes.getKey(helper.object.getValue(window.performance,"navigation.type",0));if(window.performance.getEntriesByType){var entries=
window.performance.getEntriesByType("navigation");nt=entries.length>0?_navigationTypes[entries[0].type]:nt}}result=!(nt===_navigationTypes.reload||nt===_navigationTypes.back_forward);return result};var currentWindowName=function(){try{var sname=window.name!=""?window.name:window.id!=undefined&&window.id!=""?window.id:window.frameElement?window.frameElement.id||window.frameElement.name:null;if(sname)return"CWN["+sname+"]"}catch(error){return null}};var wndId=currentWindowName()||"_sid";var ID={"key":function(){return(location.pathname.replace(/\//g,
"")+"_"+wndId).toLowerCase()},"get":function(){var k=sessionStorage.getItem(this.key());return k},"set":function(id){sessionStorage.setItem(this.key(),id)},"remove":function(){sessionStorage.removeItem(this.key())}};var WNDOpener={"key":function(){return(location.pathname.replace(/\//g,"")+"_hasOpener").toLowerCase()},"get":function(){var k=sessionStorage.getItem(this.key());return k},"set":function(hasOpener){sessionStorage.setItem(this.key(),hasOpener)},"remove":function(){sessionStorage.removeItem(this.key())}};
if(window.sessionStorage&&!isNewNavigation()){var sid=ID.get();var opener=WNDOpener.get();let len=sessionStorage.length;let i=0;for(i=0;i<len;i++){let k=sessionStorage.key(i);if(_sessionStoragePreservedKeys.indexOf(k)===-1)sessionStorage.removeItem(k)}if(sid)ID.set(sid);if(!window.opener&&opener){WNDOpener.set(true);window.opener=true}}else{WNDOpener.set(window.opener?true:false);ID.remove()}this.rcParams={pcId:"",publickey:"",id:null,clipboard:true,clipboardFileTransfer:false,active:false,showOnStart:true,
hookKeyboard:true,hookMouse:true,centered:true,centeredMode:"both",exitURL:"about:blank",monitor:0,monitorCount:0,viewLeft:0,viewTop:0,viewWidth:0,viewHeight:0,maxWidth:0,maxHeight:0,borderLeft:0,borderRight:0,borderTop:0,borderBottom:0,screenResX:0,screenResY:0,mouseControl:true,touchControl:true,kbdControl:true,kbdUnicode:true,kbdLogKeys:false,clientAck:-1,scraper:null,scraperArgs:null,quality:90,pixelFormat:0,grayscale:false,imageMethod:2,wallpaper:false,wscompression:true,cursorVisible:true,remotePointer:true,
relativeTouch:agentInfo.isMobile,mousePressAsRightButton:false,dragDist:32,scaled:true,divId:null,server:null,protocol:null,url:null,reconnectDelay:3E3,address:"",ticket:"",pin:"",sessionKey:"",externalId:"",userid:null,password:null,playsession:false,serverControlMouse:false,forceAjax:false,delayTouch:250,tbSize:"",xoffEnabled:true,xoffThreshold:20,xonThreshold:5,persistentCache:false,rleThreshold:70,useSendThread:false,lfn:null,useDblClick:false,fitToBrowser:true,fitmode:0,overflow:"auto",useFocus:false,
isCrossDomain:false,savesession:false,forceDesktop:false,rfxEnabled:false,sound:{enabled:false},isAutoFocusEnabled:true,isJsROEnabled:true,UBRWID:null,extraData:null,mouseMoveProcessInterval:10,overrideCursor:false,enableH264:false,enableGfx:false,events:{onServerError:null,onExecRemoteApp:null,onExecResult:null,onFileDownload:null,onOpenLink:null,onServerMessage:null,onFileReady:null,onFileStream:null,onRemoteCommand:null,onServerAuthenticationRequired:null,onServerNeedCredentials:null,onScreenReceived:null,
onServerConnect:null,onDisplayInteractionRequired:null,onBrokerError:null,onServerConnectionError:null,onServerCommandEvent:null,onServerCommandResult:null,onServerDisconnect:null,onServerRedirect:null,onServerConnecting:null,onSessionStart:null,onSessionEnd:null,onSessionStop:null,onProcessWindow:null,onDeleteWindow:null,onWindowStateChanged:null,onReceiveMessage:null,onPropertyChange:null,onSendKey:null,onKeyCode:null,onKeyDown:null,onKeyPress:null,onKeyUp:null,onPlaybackEnds:null,onCanvasResize:null,
onZoomDesktop:null,onConnectionLost:null,onConnectionRestored:null,onMouseAnimationFrameEnd:null,onLicenseMsg:null,onPrintHandler:null,onWakeOnLan:null,onWaitForVM:null,onSessionTimeout:null,onCopy:null,onPaste:null,onCut:null,onCopyFiles:null,onReconnectionAttempt:null,onShadowingStatus:null,onCreateCanvas:null,onReleaseCanvas:null,onTouchDeviceDetected:null},cursorCanvas:{x:0,y:0},synchronizeClipboard:true,isShadowSession:false};var WebPImageFormat=new function(){var supportsLossyWebp=null;var supportsLosslessWebp=
null;this.getSupportsWebP=function(){var res=0;if(supportsLosslessWebp!=null&&supportsLossyWebp!=null){if(supportsLosslessWebp)res|=2;if(supportsLossyWebp)res|=1}return res};this.supportsWebP=function(){if(supportsLosslessWebp==null||supportsLossyWebp==null){var img=new Image;img.onload=function(){supportsLossyWebp=img.width==4&&img.height==4};img.onerror=function(){supportsLossyWebp=false};img.src="data:image/webp;base64,UklGRkYAAABXRUJQVlA4IDoAAABwAgCdASoEAAQAAYcIhYWIhYSIiQIADAzdrBLeABAAAAEAAAEAAPKn5Nn/0v8//Zxn/6H3QAAAAAA=";
var img2=new Image;img2.onload=function(){supportsLosslessWebp=img.width==4&&img.height==4};img2.onerror=function(){supportsLosslessWebp=false};img2.src="data:image/webp;base64,UklGRiYAAABXRUJQVlA4TBoAAAAvA8AAAA8w//M///MfeFDTtgEL3+5G9D+AHA=="}return this.getSupportsWebP()};this.supportsWebP()};var RdpGlyph=function(font,character,offset,baseLine,width,height,fontData){this.font=font;this.character=character;this.offset=offset;this.baseLine=baseLine;this.width=width;this.height=height;this.fontData=
fontData};function TextEntry(size,data){this.size=size;this.data=data}var codec={binaryTable:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,0,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1],decode:function(data){var btable=
codec.binaryTable,len,bindex,dindex,e,j,n=0,u=0;len=data.indexOf("=");if(len<0)len=data.length;var output=Array((len>>2)*3+Math.floor(len%4/1.5));e=0;for(j=0;j<data.length;j++){bindex=btable[data.charCodeAt(j)&127];dindex=data.charAt(j)==="=";if(bindex===-1)logError("Illegal character '"+data.charCodeAt(j)+"'");else{u=u<<6|bindex;n+=6;if(n>=8){n-=8;output[e++]=u>>n&255;u&=(1<<n)-1}}}if(n)throw"Invalid base64 encoding";return output}};this.emptyRecycleImgTimeout=null;this.allowMouse=false;if(helper.object.existsPath(arguments,
"0.clientSettings"))self.clientSettings=arguments[0].clientSettings;this.observable={"useAjax":true,"connected":null,"viewHeight":0,"viewWidth":0,"isOTURLSession":false};var _restartConnectTimeout=2E3;var allowOverrideCursor=!agentInfo.isMobile&&cookiePrefix!=="VNC"&&(!agentInfo.isFirefox||window.devicePixelRatio==1)&&!agentInfo.isMSIE&&productId!="ZSC"?true:false;if(allowOverrideCursor&&helper.object.existsPath(self,"clientSettings.OverrideCursor"))TVNC.rcParams.overrideCursor=self.clientSettings.OverrideCursor;
TVNC.rcParams.overrideCursor=!(agentInfo.isMobile||agentInfo.isTouch);var _visualEffect=null;var _customEventsHandler={};var _allowMouseCapture=true;var _checkSizeAndResolutionTimeoutId=null;var _deltaYMultiplier=agentInfo.isOpera?-1:1;var _enumCloseStatusReason=helper.object.createEnum({"ERROR":-1,"DISCONNECT":0,"CLOSE":1});var _isPktIdxEnabled=false;var _lastPkt={"idx":0,"group":0,"reset":false};Object.defineProperty(this,"pktIdxEnabled",{"enumerable":false,"configurable":false,"get":function(){return _isPktIdxEnabled},
"set":function(value){_isPktIdxEnabled=helper.object.convertTo(value,"boolean");if(_isPktIdxEnabled){_lastPkt.reset=true;_lastPkt.idx=-1}}});var _avoidConnectionLostPopup=false;var _mouseQueueTimeout=null;var _blob={"threshold":4E3,"on":typeof ThinVNCApp=="undefined","processedScreenUrl":[],"processedMouseUrl":[],"revoked":false};var _usedImgQueueItems=[];var _location="";var _virtualPathProfile="";var _fromBroker=typeof window.fromBroker!="undefined"?window.fromBroker:false;var rePP=RegExp(/\?|&/);
var STATE_INITIAL=0,STATE_PENDING=1,STATE_ACTIVE=2,STATE_EXPIRED=3,STATE_ERROR=4,STATE_BUSY=5,RDP_NO_INFO=0,RDP_LOGIN_START=1,RDP_LOGIN_INFO=2,RDP_LOGIN_END=3,RDP_LOGIN_ERROR=4;var PROVISSIONING_CREATING=4096,PROVISSIONING_UPDATING=8192,PROVISSIONING_FAILED=16384,PROVISSIONING_SUCCEEDED=32768,PROVISSIONING_DELETING=65536,PROVISSIONING_MIGRATING=131072,POWERSTATE_CREATING=1,POWERSTATE_STARTING=2,POWERSTATE_RUNNING=4,POWERSTATE_STOPPING=8,POWERSTATE_STOPPED=16,POWERSTATE_DEALLOCATING=32,POWERSTATE_DEALLOCATED=
64;var _urlCreator=window.URL||window.webkitURL;var _SIDName=(typeof window.cookiePrefix!="undefined"?window.cookiePrefix+"_":"")+"SID";var _splashCssName=".establishingConnection";var _isSessionEnded=false;var _noop=function(){};var _pendingGrowlsPopups=[];var _licenseTypes=helper.object.createEnum("ERR_TYPE_INFO","ERR_TYPE_WARNING","ERR_TYPE_ERROR");const generateId=()=>`${performance.now()}${Math.random().toString().slice(5)}`.replace(".","");var _getServerUrl={"timeout":1E3,"normal_timeout":1E3,
"vm_timeout":5E3,"id":generateId(),"forceNewRedirection":false,"forceNewRedirectionUsed":false,oturlMaxRetries:4,retriesCount:0};var _xhrStatusExitCodes=[Thinfinity.Communication.errorCode.PAYMENT_REQUIRED,Thinfinity.Communication.errorCode.UNAUTHORIZED];if(helper.url.gup("serviceScreen")!="")if(Thinfinity.ServiceScreen){window.serviceScreen=new Thinfinity.ServiceScreen({"parentElement":document.body});window.serviceScreen.addValue("Use-Ajax",function(){return TVNC.useAjax});window.serviceScreen.addValue("Force-Ajax",
function(){return TVNC.rcParams.forceAjax.toString()})}var _isTemporalConnection=helper.object.convertTo(helper.url.gup("sdk")!="","bool");var _defaultResponseType=helper.ajax.responseType.JSON;var _comm=null;var _avoidSendMouseMove=false;Object.defineProperty(this,"avoidSendMouseMove",{"enumerable":true,"configurable":false,"get":function(){return _avoidSendMouseMove},"set":function(value){_avoidSendMouseMove=value;if(!_avoidSendMouseMove)TVNC.sendMouseMove()}});var _syncCookies={syncCookiesTime:2500,
syncCookiesTOUT:null,syncCookiesEnabled:true,data:{}};var _componentsInitialized=false;var _componentRegistrationServices=null;var _registeredEventsServicesList={};var _enumEventsServices=helper.object.createEnum({"SENDEVENT":1});var _url={"baseUrl":"","gatewayAccess":null,"httpConnection":"","wsConnection":"","brokerUrl":""};Object.defineProperty(this,"baseUrl",{"configurable":false,"enumerable":true,"get":function(){return _url.baseUrl},"set":function(baseUrl){_url.baseUrl=baseUrl}});Object.defineProperty(this,
"httpConnection",{"configurable":false,"enumerable":true,"get":function(){return _url.httpConnection}});Object.defineProperty(this,"hasSecondaryGateway",{"configurable":false,"enumerable":true,"get":function(){return _url.gatewayAccess&&_url.gatewayAccess!==""}});Object.defineProperty(this,"brokerUrl",{"configurable":false,"enumerable":true,"get":function(){return _url.brokerUrl}});var _clipSynchronized=false;function padZero(num,size){return("00000000"+num).substr(-size)}function setPlugin(plugin){if(plugin==
undefined||plugin==null){var arPluginName=null;for(var plugin in _plugins)if(helper.object.getValue(_plugins,plugin+".enabled",false)){if(arPluginName==null)arPluginName=[];arPluginName.push(plugin)}return arPluginName}else if(helper.object.validate(plugin)&&helper.object.validate(plugin["name"])&&helper.object.validate(plugin["obj"])){if(_plugins[plugin["name"]]==undefined)_plugins[plugin["name"]]={"obj":null};_plugins[plugin["name"]]["enabled"]=plugin["enabled"]||true;_plugins[plugin["name"]]["obj"]=
plugin["obj"]}else return helper.string.sprintf(consts.errorExternalPlugin)}function on(name,handler){if(!_customEventsHandler[name])_customEventsHandler[name]=[];var wasAdded=false;for(var i=0;i<_customEventsHandler[name].length;i++)if(_customEventsHandler[name]===handler){wasAdded=true;break}if(!wasAdded)_customEventsHandler[name].push(handler)}function off(name,handler){if(_customEventsHandler[name])for(var i=_customEventsHandler[name].length-1;i>=0;i--)if(_customEventsHandler[name]===handler)_customEventsHandler[name].splice(i,
1)}function triggerCustomEvent(name,data){if(_customEventsHandler&&_customEventsHandler[name])for(var i=0;i<_customEventsHandler[name].length;i++)try{return _customEventsHandler[name][i](data)}catch(error){}}function addValidCanvas(canvas){if(_validCanvas.indexOf(canvas)===-1)_validCanvas.push(canvas)}Object.defineProperty(this,"useAjax",{"enumerable":true,"configurable":true,"get":function(){return TVNC.observable.useAjax},"set":function(value){TVNC.observable.useAjax=value}});Object.defineProperty(this,
"connected",{"enumerable":true,"configurable":true,"get":function(){return _comm.connected},"set":function(value){_comm.connected=value}});Object.defineProperty(this.rcParams,"viewWidth",{"enumerable":true,"configurable":true,"get":function(){return TVNC.observable.viewWidth},"set":function(value){TVNC.observable.viewWidth=value}});Object.defineProperty(this.rcParams,"viewHeight",{"enumerable":true,"configurable":true,"get":function(){return TVNC.observable.viewHeight},"set":function(value){TVNC.observable.viewHeight=
value}});Object.defineProperty(this,"containerId",{"enumerable":true,"configurable":true,"get":function(){return TVNC.rcParams.divId}});Object.defineProperty(this,"setKeyboardFocus",{"enumerable":true,"configurable":false,"writable":false,"value":function(){return _displayManager.focus()}});var _displayObj={};Object.defineProperty(this,"display",{"enumerable":true,"configurable":false,"get":function(){return _displayObj}});Object.defineProperty(_displayObj,"manager",{"enumerable":true,"configurable":false,
"get":function(){return _displayManager}});Object.defineProperty(_displayObj,"managerInterface",{"enumerable":true,"configurable":false,"get":function(){return _oInterface.new}});Object.defineProperty(this,"allowMouseCapture",{"enumerable":true,"configurable":true,"get":function(){return _allowMouseCapture},"set":function(value){if(!TVNC.rcParams.serverControlMouse||!value)_allowMouseCapture=value}});Object.defineProperty(this,"overrideCursor",{"enumerable":true,"configurable":true,"get":function(){return allowOverrideCursor&&
TVNC.rcParams.overrideCursor},"set":function(value){if(allowOverrideCursor)TVNC.rcParams.overrideCursor=value}});Object.defineProperty(this,"on",{"enumerable":true,"configurable":true,"writable":false,"value":on});Object.defineProperty(this,"off",{"enumerable":true,"configurable":true,"writable":false,"value":off});Object.defineProperty(this,"__recvPingResponse",{"enumerable":false,"configurable":false,"value":function(){return _comm.recvPingResponse()}});Object.defineProperty(this,"plugins",{"enumerable":false,
"configurable":true,"value":function(plugin){return setPlugin(plugin)}});Object.defineProperty(this,"location",{"enumerable":true,"configurable":true,"get":function(){return _location}});Object.defineProperty(this,"virtualPath",{"enumerable":true,"configurable":true,"get":function(){return _virtualPathProfile}});Object.defineProperty(this,"fromBroker",{"enumerable":false,"configurable":true,"get":function(){return _fromBroker},"set":function(value){return _fromBroker=helper.object.convertTo(value,
"boolean")}});Object.defineProperty(this,"splashCssName",{"enumerable":false,"configurable":true,"get":function(){return _splashCssName},"set":function(value){return _splashCssName=value}});Object.defineProperty(this,"isTemporal",{"enumerable":false,"configurable":true,"get":function(){_isTemporalConnection}});Object.defineProperty(this,"H264",{"enumerable":false,"configurable":false,"get":function(){return _ePictureType===_enumPictureType.H264}});Object.defineProperty(this,"GFX",{"enumerable":false,
"configurable":false,"get":function(){return _ePictureType===_enumPictureType.GFX}});Object.defineProperty(this,"availableAudio",{"enumerable":true,"configurable":false,"get":()=>{return window.AudioContext?true:false}});Object.defineProperty(this,"enumCloseStatusReason",{"enumerable":true,"configurable":false,"get":function(){return _enumCloseStatusReason}});Object.defineProperty(this,"onSendEvent",{"enumerable":false,"configurable":false,"set":function(handler){if(handler&&handler instanceof Function)_registeredEventsServicesList[_enumEventsServices.SENDEVENT]=
handler}});this.allowFullscreenShortcut=productId=="thinrdp"?true:false;this.multiRowMinSize=40;if(agentInfo.isMSIE&&agentInfo.msieVersion<10)this.partialAnimationFrameUpdate=function(callback){setTimeout(callback,0)};else this.partialAnimationFrameUpdate=function(callback){callback()};var mouseCanvasX=0;var mouseCanvasY=0;var previousOrientation=null;var waitOrientationChangeTime=1E3;var elapsedOrientationTime=null;var allowSendingCommands=false;function createPrintDialog(){return typeof PrintDialog!=
"undefined"&&PrintDialog!=null?new PrintDialog({"onHide":function(){TVNC.pingIgnore=false},"onAssignDocument":function(){TVNC.pingIgnore=true},"owner":TVNC}):null}var printDialog=createPrintDialog();var timeBeforeReconnect=250;var timeoutIdBeforeReconnect=null;var resetTimeId=null;var isReset=false;var currentActiveWindow=null;var oLastError={"message":null,"code":null,"date":null,"timeoutId":null,"elapsedTime":1E4};var errorOccurs=0;var connection={"fromReconnection":false,"firstConnection":true,
"first404IncomingTime":null,"maxTimeBeforeRemoveGatewayAccessKey":3E4,reconnectingCount:0,reconnectingMax:8};var serverDPR={"enabled":false,"originalValue":null};var serverCmdResultOrientation=null;var restartOnOrientationChange=false;var mouseBuffer={"queue":[],"isAvailable":false};var ENUM_CODES={authenticationCodeErrors:["10009","10010"]};var UintArrayConfig={"size":5E4,"sliceMethod":typeof Uint8Array!="undefined"?(new Uint8Array).splice!=undefined?"slice":"subarray":"slice","method":"apply"};
var emulcont=null;var _getComputedStyle=helper.style.getComputedStyle;var _enumPictureType=helper.object.createEnum({CANVAS:0,H264:1,GFX:2});var _ePictureType=_enumPictureType.CANVAS;var _gfx=null;var _validCanvas=[];var _displayManager=null;var _packetReceiver=null;var _audioDriver=null;var _preventKeys={available:true,keys:{67:{"ctrlKey":true},99:{"ctrlKey":true},86:{"ctrlKey":true},118:{"ctrlKey":true},88:{"ctrlKey":true},120:{"ctrlKey":true}}};var _oInterface=null;var _oClipboard=null;var _iClipboard=
null;var _pendingsCommandsCallback=[];var _pendingDisplayResize=null;var _eMode=helper.object.createEnum({"HOST":0,"API":1,"SKEY":2,"OTURL":10,"SDK":11});var _isDisconnecting=false;var _connectResult={max:10,count:0};function getOrientation(){if(window.matchMedia)if(window.matchMedia("(orientation: portrait)").matches)return"portrait";else{if(window.matchMedia("(orientation: landscape)").matches)return"landscape"}else return"landscape"}this.getOrientation=getOrientation;function initialize(){previousOrientation=
window.environment.currentOrientation||getOrientation();var commArgs={"protocol":Thinfinity.Communication.protocol.WEBSOCKET,"withCredentials":TVNC.crossDomain(),"webSocket":{"maxTimeToOpen":1E4,"events":{"open":function(e){BTP_WS_OPEN=null;TVNC.wsEnabled=true;resetLastError();logDebug("TVNC.ws.onopen. TVNC.wsEnabled = true");TVNC.useAjax=false;TVNC.start();try{if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onConnectionKindChange==null)$(document).trigger("connectionKindChange");
else TVNC.rcParams.events.onConnectionKindChange()}catch(error){helper.console.warning("'onConnectionKindChange' calling attached method fail. message: "+error.message,error,arguments)}callPendingCommands()},"message":function(msg){errorOccurs=0;_packetReceiver.process(msg.data)},"close":function(e){BTP_WS_CLOSE1=null},"error":function(e){BTP_WS_ERR=null;var msg=consts.unknownError;var code="";if(e&&e.detail){code=e.detail.code;if(e.detail.message!="")msg=e.detail.message;if(e.detail.code===Thinfinity.Communication.errorCode.TIMEOUT){BTP_WS_TOUT=
null;helper.console.log("WebSocket: is not responding...",arguments);BTP_PWS_CLS2=null}}helper.console.warning(helper.string.format("TVNC.ws.error - {0}, ({1})",msg,code),arguments)}}},"methods":{arraybufferToString:TVNC.arbufToStringU8},"properties":{},"events":{"stateChange":function(state){connectionStateChanged(state)},"error":function(e){var msgDetail=helper.object.getValue(e,"detail.message","");helper.console.warning(helper.string.format("Something went wrong: {0}, protocol: {1}, state: {2}",
msgDetail,_comm.protocol,_comm.state),arguments);if(e.detail&&e.detail.code===Thinfinity.Communication.errorCode.RESTART)restart(true)}}};Object.defineProperty(commArgs.properties,"sessionEnd",{"enumerable":true,"configurable":false,"get":function(){return _isSessionEnded}});_comm=new Thinfinity.Communication(commArgs)}var _commLastState=0;let _commStateLost=false;function connectionStateChanged(state){if(state===Thinfinity.Communication.state.CONNECTED){if(_commLastState!=state){_displayManager.fireEvent("localEvent",
{cmd:"connected"});TVNC.closeReconnectDiv();if(_commLastState>Thinfinity.Communication.state.RECONNECTING&&_commLastState<Thinfinity.Communication.state.LOST||_commStateLost)try{BTP_PC_RST=null;var cs={"code":3,"message":consts.connRestored};_displayManager.fireEvent("localEvent",{...{cmd:"connectionRestored"},cs});if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onConnectionRestored==null)window.dispatchEvent(new CustomEvent(consts.connRestored,cs));else TVNC.rcParams.events.onConnectionRestored(cs)}catch(error){helper.console.error(consts.connRestored+
" - code: 3",error,arguments)}}_commStateLost=false}else if(state===Thinfinity.Communication.state.UNSTABLE){if(_commLastState!=state)try{BTP_PC_UNS=null;var cs={"code":1,"message":consts.connUnstable};_displayManager.fireEvent("localEvent",{...{cmd:"connectionUnstable"},cs});if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onConnectionLost==null)window.dispatchEvent(new CustomEvent(consts.connUnstable,cs));else _avoidConnectionLostPopup=TVNC.rcParams.events.onConnectionLost(cs);
if(!_avoidConnectionLostPopup)TVNC.showReconnectDiv(false)}catch(error){helper.console.error(consts.connUnstable+" - code: 1",error,arguments)}_commStateLost=true}else if(state===Thinfinity.Communication.state.LOST){try{BTP_PC_LST=null;var cs={"code":2,"message":consts.connLostReconnecting};_displayManager.fireEvent("localEvent",{...{cmd:"connectionLost"},cs});if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onConnectionLost==null)window.dispatchEvent(new CustomEvent(consts.connLost,
cs));else _avoidConnectionLostPopup=TVNC.rcParams.events.onConnectionLost(cs);if(!_avoidConnectionLostPopup)TVNC.showReconnectDiv(true)}catch(error){helper.console.error(consts.connLostReconnecting+" - code: 2",error,arguments)}_commStateLost=true}_commLastState=state}function callPendingCommands(){_pendingsCommandsCallback.forEach(function(handler){try{handler()}catch(error){}});_pendingsCommandsCallback=[]}this.showReconnectDiv=function(connLost){if(!checkSplashPopup())if(_visualEffect)_visualEffect.toGrayScale(connLost);
else{var elem=document.getElementById(TVNC.reconnectDivId);var d=helper.dom.appendJsonElement({"parentElement":elem&&elem.parentElement?elem.parentElement:document.body,"type":"div","attributes":{"style":helper.string.format("-webkit-box-shadow: 1px 1px 15px #000;-moz-box-shadow: 1px 1px 15px #000; position:absolute; top:50%; left:50%; transform:translate3d(-50%, -50%, 0); background:#111111;z-index:{0}; padding:20px;color:#FFF;-moz-border-radius: 7px;border-radius: 7px; font-size:14px; font-weight:normal; width:250px;height:68px; text-align:center",
TVNC.getNextHighestZindex(document.body))},"content":consts.connLostReconnecting+"</br>"});var button=helper.dom.appendJsonElement({"parentElement":d,"type":"input","attributes":{"id":"cancelRecnx","type":"button","style":"margin-top:20px;padding:6px;"},"events":{"click":function(e){TVNC.closeReconnectDiv();TVNC.disconnect();TVNC.dispose(true);$(document).unbind();$("#"+TVNC.vncdivId).unbind()}},"content":consts.abort})}};previousOrientation=window.environment.currentOrientation||getOrientation();
this.pingIgnore=false;this.closeReconnectDiv=function(abort){if(_avoidConnectionLostPopup!==true)if(_visualEffect)_visualEffect.toColor();else{$("#cancelRecnx").parent().remove();$("#"+TVNC.reconnectDivId).remove()}};this.connectWebSocket=function(fastConnect,callback){BTP_WS_INIT=null;if(_comm.state<=Thinfinity.Communication.state.CLOSING)_comm.wsOpen(TVNC.getWsUrl())};function restartConnection(){TVNC.reset();_comm.releaseQueue(TVNC.queueRequestName);var buildResolutionArgs=function(){var args=
"";var w=TVNC.rcParams.width;var h=TVNC.rcParams.height;var fitmode="";if(typeof this.agentName=="undefined")TVNC.resolveAgent();var screenWidth=window.environment.rawWidth||window.screen.width;var screenHeight=window.environment.rawHeight||window.screen.height;w=window.environment.detectedWidth;h=window.environment.detectedHeight;if(helper.object.existsPath(self,"clientSettings.UseViewportSize")&&self.clientSettings.UseViewportSize){w=window.environment.viewportWidth;h=window.environment.viewportHeight}if(typeof TVNC.rcParams.fitmode!=
"undefined"){fitmode=TVNC.rcParams.fitmode;if(fitmode!=undefined&&typeof fitmode=="string"&&fitmode.toLowerCase()!="fixed"&&fitmode.indexOf("x")>0){fitmode="&fitmode=1";var res=fitmode.split("x");w=res[0];h=res[1]}}else if(TVNC.rcParams.resolution=="fittobrowser")fitmode="&fitmode=0";else if(TVNC.rcParams.resolution=="fittoscreen")fitmode="&fitmode=2";else if(TVNC.rcParams.resolution=="fixed"){fitmode="&fitmode=1";w=TVNC.rcParams.width;h=TVNC.rcParams.height}else if(TVNC.rcParams.resolution.indexOf("x")>
0){fitmode="&fitmode=1";var res=TVNC.rcParams.resolution.split("x");w=res[0];h=res[1]}var pos=TVNC.vncdiv!=null?TVNC.findPos(TVNC.vncdiv):[0,0];var offset={"left":pos[0],"top":pos[1]};args+="&browserWidth="+(w-offset.left)+"&browserHeight="+(h-offset.top);args+="&screenWidth="+screenWidth+"&screenHeight="+screenHeight;args+=fitmode;return args};var isLandscape=window.environment.currentOrientation=="landscape"?true:false;var args="cmd=start&subcmd=restart"+buildResolutionArgs()+"&devicePixelRatio="+
(environment.initialDevicePixelRatio||1)+"&isMobile="+agentInfo.isMobile+"&isLandscape="+isLandscape+"&supportsFullScreen="+window.environment.supportsFullScreen+"&webapp="+window.environment.webapp;TVNC.start(args)}function restart(hasBeenLost){if(hasBeenLost)helper.console.error("The Connection has been lost.",null,arguments);if(_isSessionEnded){helper.console.error("The Session has ended. Cannot restart the connection.",null,arguments);return}helper.console.warning("Restarting connection...",null,
arguments);if(_comm.state>=Thinfinity.Communication.state.CLOSING)return;TVNC.rcParams.clientAck=-1;TVNC.rcParams.clientAck=TVNC.rcParams.clientAck<=0&&!TVNC.useAjax?0:Math.max(TVNC.rcParams.clientAck,1);if(_fromBroker)_url.baseUrl=_virtualPathProfile;TVNC.reconnect()}this.rop3CanvasNoType=function(context,cmd,imageData,auxImageData){var data=imageData.data;var auxData=auxImageData.data;for(var offset=0;offset<cmd.cx*cmd.cy*4;offset+=4){var auxDataPixel=auxData[offset]|auxData[offset+1]<<8|auxData[offset+
2]<<16;var dataPixel=data[offset]|data[offset+1]<<8|data[offset+2]<<16;dataPixel=this.doROP3(cmd.o,auxDataPixel,dataPixel,cmd.bc,cmd.fc);data[offset]=dataPixel&255;data[offset+1]=dataPixel>>>8&255;data[offset+2]=dataPixel>>>16&255;data[offset+3]=255}context.putImageData(imageData,cmd.x,cmd.y)};this.rop3CanvasU32=function(context,cmd,imageData,auxImageData){var data=new Uint32Array(imageData.data.buffer);var auxData=new Uint32Array(auxImageData.data.buffer);for(var offset=0;offset<cmd.cx*cmd.cy;offset++)data[offset]=
this.doROP3(cmd.o,auxData[offset]&16777215,data[offset]&16777215,cmd.bc,cmd.fc)|4278190080;context.putImageData(imageData,cmd.x,cmd.y);auxData=data=null};this.rop3Canvas=agentInfo.hasTypedArrays?this.rop3CanvasU32:this.rop3CanvasNoType;this.u8ArrayToDataUri=function(mime,raw){if(_blob.on&&raw.length>_blob.threshold)return _urlCreator.createObjectURL(new Blob([raw],{type:mime}));else return"data:"+mime+";base64,"+window.btoa(TVNC.arbufToStringU8(raw))};this.arbufToStringU8ConcatMethod=function(data){var str=
"";var len=data.byteLength;for(var i=0;i<len;i++)str+=String.fromCharCode(data[i]);return str};this.arbufToStringU8ApplyMethod=function(data){if(data.length<UintArrayConfig["size"])return String.fromCharCode.apply(null,data);else{var str="";var i=0;var n=data.length;while(i<n)str+=String.fromCharCode.apply(null,data[UintArrayConfig["sliceMethod"]](i,i+=UintArrayConfig["size"]));return str}};this.arbufToStringU8=UintArrayConfig["method"]=="apply"?this.arbufToStringU8ApplyMethod:this.arbufToStringU8ConcatMethod;
function clone(oldObject){return $.extend(true,{},oldObject)}this.crossDomain=function(){return TVNC.crossdomain||TVNC.rcParams.isCrossDomain};this.completeAjaxParams=function(params){if(TVNC.crossDomain()){params.beforeSend=function(xhr){xhr.withCredentials=true};params.crossDomain=true}return params};function initializeImageQueue(sessionId){if(TVNC.imgQueue==null||TVNC.imgQueue.sessionId!=sessionId){helper.console.log("Initializing Image Queue");this.imageCache2=[new Array(600),new Array(600),new Array(2048),
new Array(4096),new Array(2048)];this.imageCacheV=[new Array(200),new Array(200),new Array(200),new Array(200),new Array(200)];TVNC.purgeImageQueue(TVNC.imgQueue);TVNC.imgQueue=null;TVNC.imgQueue=TVNC.createImageQueue(sessionId);_usedImgQueueItems=[]}}this.createImageQueue=function(sessionId){var newItem={"sessionId":sessionId,"items":{},"loaded":0,"startTime":0,"count":0,"group":0,"aborted":function(){return false},"timeout":450,"watchdogTimer":null,"watchdogStart":function(){var self=this;this.startTime=
(new Date).getTime();if(this.watchdogTimer!==null){logError("imageQueue watchdog already running!");this.watchdogStop()}this.watchdogTimer=setTimeout(function(){if(self.timeout>0)logError("imageQueue idx: "+TVNC.resumeItem.qidx+" timeout at "+((new Date).getTime()-self.startTime)+" ms!");if(TVNC.resumeItem){TVNC.resumeItem.processed=true;if(TVNC.executeDeferred)TVNC.executeDeferred();else logDebug("Missing function executeDeferred. --\x3e TVNC.executeDeferred()")}},this.timeout)},"watchdogStop":function(){if(this.watchdogTimer!==
null){clearTimeout(this.watchdogTimer);self.timeout=1E3;this.watchdogTimer=null}}};return newItem};this.purgeImageQueue=function(imgQueue){if(!imgQueue)return;imgQueue.watchdogStop();for(var i=0;i<imgQueue.items.length;i++){var item=imgQueue.items[i];if(item)if(!item.purgeAll)logDebug("Not an item object in imgQueue, idx: "+i);else{item.purgeAll();TVNC.returnImageItem(item)}delete imgQueue.items[i]}};function ab2str(buf){return String.fromCharCode.apply(null,new Uint16Array(buf))}function str2ab(str){var buf=
new ArrayBuffer(str.length*2);var bufView=new Uint16Array(buf);for(var i=0,strLen=str.length;i<strLen;i++)bufView[i]=str.charCodeAt(i);return buf}function getImageCacheList(usecompression){if(TVNC.dbFiles.length>0){var dbSrc=TVNC.dbFiles.join("-");if(usecompression){var dbZip=new Zlib.RawDeflate(dbSrc);var dbB64=$.base64.encode(dbZip);return dbB64}else return dbSrc}else return""}this.toDataUrl=function(url,callback){helper.ajax.get({"url":url,"responseType":"blob","success":function(response){var reader=
new FileReader;reader.onloadend=function(){callback(reader.result)};reader.readAsDataURL(response)}})};this.convertImgURLToBase64=function(source,type,callback){var loadImage=function(internalCallback){var img=new Image;img.crossOrigin="Anonymous";img.onload=function(e){if(typeof e.target.complete=="undefined"||e.target.complete==true)internalCallback(img,e);else{var maxTimes=10;var countTimes=0;function retryLoadImage(){setTimeout(function(){if(countTimes>maxTimes){helper.console.warning("Cannot get image source.",
arguments);internalCallback(null)}else if(typeof e.target.complete=="undefined"||e.target.complete==true)internalCallback(img,e);else retryLoadImage();countTimes++},50)}}};img.onerror=function(e){internalCallback(null,e)};img.onabort=function(e){internalCallback(null,e)};img.srcImage=souce;img.src=source};loadImage(function(img,e){if(img){var canvas=document.createElement("canvas");canvas.appendChild(img);var base64=canvas.toDataURL(type);callback(type,base64)}else callback(type,null)})};this.getBasicHTMLImg=
function(url){if(url)return'<html><body>\x3c!--StartFragment--\x3e<img src="'+url+'"/>\x3c!--EndFragment--\x3e</body></html>';else return null};function getClipboardInterface(){if(!_oClipboard){let _clipboard={};let permissions={};Object.defineProperty(permissions,"fileTransfer",{configurable:false,enumerable:true,get:function(){return TVNC.rcParams.clipboardFileTransfer}});_oClipboard=(new Thinfinity.Object.Interface({defaultEventFire:{async:0}})).new(new Thinfinity.Object.IConfig({namespace:true,
options:[Thinfinity.Object.IConfig.OPTIONS.DO_NOT_FULL_EXTEND_OBJECT],object:TVNC,properties:[{source:"KeyboardHandler.kbdInput",ro:true,alias:"inputElement"},{source:"vncdiv",ro:true,alias:"parentElement"},{source:permissions,ro:true,alias:"permissions"},{source:"enable",ro:true,get:function(){return TVNC.rcParams.clipboard}},{source:"synchronizeClipboard",ro:true,get:function(){return TVNC.rcParams.synchronizeClipboard}}],methods:[{alias:"output",value:function(jData){if(jData.cmd)switch(jData.cmd.toLowerCase()){case "focus":_displayManager.focus();
break;case "settext":_displayManager.textValue=jData.value;break;case "maccmd":if(jData.value==="RELEASED")_displayManager.updateMacCmd(Thinfinity.Driver.Keyboard.MAC_CMD.RELEASED);break}}},{alias:"sendData",value:function(url,data){if(TVNC.useAjax){var url=_url.httpConnection+"cmd?id="+url;_comm.post({"url":url,"data":data})}else{var cmd=url+"&linemode=LF&data="+data;TVNC.sendCmd(cmd)}}},{alias:"request",value:function(params){params.url=TVNC.addExtraParams(_url.httpConnection+params.url);var cors=
TVNC.crossdomain||TVNC.rcParams.isCrossDomain;if(cors&&_comm.protocol!==_args.comm.protocol.AJAX)params.xhrFields={"withCredentials":true};_comm.send(params)}},{alias:"convertImgURLToBase64",value:TVNC.convertImgURLToBase64},{alias:"getBasicHTMLImg",value:TVNC.getBasicHTMLImg},{alias:"sendEvent",value:TVNC.sendEvent},{alias:"setSelectionRange",value:function(){_displayManager.setSelectionRange(0,_displayManager.textValue.length)}},{alias:"getTextValue",value:function(){return _displayManager.textValue}},
{alias:"clearText",value:function(){_displayManager.textValue=""}}],events:{copy:TVNC.rcParams.events.onCopy,paste:TVNC.rcParams.events.onPaste,cut:TVNC.rcParams.events.onCut,localPaste:function(){if(_preventKeys.available){TVNC.sendKey(86,0,"down",0);TVNC.sendKey(86,0,"up",0);return true}else return false},copyFiles:TVNC.rcParams.events.onCopyFiles}}));_iClipboard=_oClipboard.new}return{oObject:_oClipboard,iObject:_iClipboard}}this.findPos=function(obj){var curleft=0;var curtop=0;do{curleft+=obj.offsetLeft;
curtop+=obj.offsetTop}while(obj=obj.offsetParent);return[curleft,curtop]};this.emptyRecycleImg=function(onetime){while(TVNC.queueRecycleImg.length>0){img=TVNC.queueRecycleImg.pop();img=null}if(onetime==true)return;clearTimeout(TVNC.emptyRecycleImgTimeout);TVNC.emptyRecycleImgTimeout=setTimeout(TVNC.emptyRecycleImg,TVNC.recycleImgTimeoutValue)};this.setMaxSize=function(width,height){TVNC.rcParams.maxWidth=width;TVNC.rcParams.maxHeight=height};this.splitKey=function(key){var sk;if(!key.length)sk={"isVolatile":false,
"arr":0,"pos":key};else{sk={"isVolatile":key.length>6,"arr":parseInt(key.substring(0,2),10)};sk.pos=parseInt(sk.isVolatile?key.substring(6):key.substring(2,6),10)}return sk};this.getFromImageCache=function(key){var sk=this.splitKey(key);if(sk.isVolatile)return this.imageCacheV[sk.arr][sk.pos];else return this.imageCache2[sk.arr][sk.pos]};this.setToImageCache=function(item,key){if(!item)logError("Error on setToImageCache: null item.");var sk=this.splitKey(key);if(sk.isVolatile){BTP_IMG_CHV=null;if(this.imageCacheV[sk.arr][sk.pos])TVNC.returnImageItem(this.imageCacheV[sk.arr][sk.pos]);
this.imageCacheV[sk.arr][sk.pos]=item}else{BTP_IMG_CH2=null;if(this.imageCache2[sk.arr][sk.pos])TVNC.returnImageItem(this.imageCache2[sk.arr][sk.pos]);this.imageCache2[sk.arr][sk.pos]=item}};this.createCanvas=function(win){let div=document.createElement("div");div.style.position="absolute";div.style.left=win.left-TVNC.rcParams.viewLeft+"px";div.style.top=win.top-TVNC.rcParams.viewTop+"px";let r=0;let b=0;if(productId==="virtualui"){r=typeof win.right!=="undefined"?win.right:win.left;b=typeof win.bottom!==
"undefined"?win.bottom:win.top;if(win&&win.hwnd!=0&&TVNC.rcParams?.events?.onCreateCanvas)TVNC.rcParams.events.onCreateCanvas(win)}div.style.zIndex=this.baseZIndex+win.zidx*10;let w=win.width+r;let h=win.height+b;div.width=w;div.height=h;div.style.width=w+"px";div.style.height=h+"px";div.style.display="inline-block";if(win.hwnd>0)div.style.overflow="hidden";if(win.wndClass)div.setAttribute("wndClass",win.wndClass);if(TVNC.rdpMode&&win.hwnd==1){TVNC.vncContainer.style.width=w+"px";TVNC.vncContainer.style.height=
h+"px"}if(typeof win.className!="undefined")div.className=win.className;if(!win.parent){div.mask=new Object;div.mask.color="#000";div.mask.visible=false;var canvas=document.createElement("canvas");canvas.style.left="0px";canvas.style.top="0px";canvas.width=win.width;canvas.height=win.height;canvas.style.position="absolute";canvas.style.zIndex=1;canvas.style.width=win.width;canvas.style.height=win.height;canvas.hwnd=win.hwnd;helper.dom.addEvent(canvas,"contextmenu",function(e){if(e)e.preventDefault();
return false});div.canvas=canvas;div.appendChild(canvas)}if(agentInfo.isMobile)helper.dom.addEvent(div,"click",function(){});if(this.canvasInitiallyHidden&&win.hwnd!=0&&!win.parent){div.style.display="none";TVNC.fireCustomEvents("canvasInitiallyHidden",win)}div.id=productId+"_canvas_"+win.hwnd;var parentDiv=this.vncContainer;if(helper.object.validate(win.parent)&&win.parent!=0){div.parent=win.parent;parentDiv=document.getElementById(productId+"_canvas_"+win.parent);if(parentDiv)parentDiv.appendChild(div);
else{div.style.display="none";div.style.visibility="hidden";if(!this.canvasInitiallyHidden&&win.hwnd!=0)TVNC.fireCustomEvents("canvasHidden",win);this.vncContainer.appendChild(div)}}else parentDiv.appendChild(div);for(var i=this.vncContainer.childNodes.length-1;i>=0;i--){var elem=this.vncContainer.childNodes[i];if(elem.parent){var parentCanvas=document.getElementById(productId+"_canvas_"+elem.parent);if(parentCanvas){parentCanvas.appendChild(elem);elem.style.display="inline";if(elem.parent!=0)TVNC.fireCustomEvents("canvasShow",
elem.parent)}}}if(TVNC.controlFactory)TVNC.controlFactory.insertPending();return div};this.decode=function(data){return codec.decode(data)};this.cacheFont=function(cmd){var glyph=new RdpGlyph(cmd.fnt,cmd.chr,cmd.ofs,cmd.bl,cmd.w,cmd.h,this.decode(cmd.data));if(glyph.font<12&&glyph.character<256)this.rdpGlyphArray[glyph.font][glyph.character]=glyph;else throw logError("put font: font="+glyph.font+" c="+glyph.character),"Could not put font in cache";};this.getGlyph=function(font,character){if(font<
12&&character<256){var glyph=this.rdpGlyphArray[font][character];if(glyph!=null)return glyph}throw logError("Could not get Font:"+font+", "+character);};this.clearFontCache=function(){for(var i=0;i<12;i++)for(var j=0;j<256;j++){delete this.rdpGlyphArray[i][j];this.rdpGlyphArray[i][j]=null}};this.clearImageCache=function(){var i,j;try{for(i=0;i<this.imageCache2.length;i++){for(j=0;j<this.imageCache2[i].length;j++)if(this.imageCache2[i][j]){delete this.imageCache2[i][j].data;this.imageCache2[i][j]=
null}for(j=0;j<this.imageCacheV[i].length;j++)if(this.imageCacheV[i][j]){delete this.imageCacheV[i][j].data;this.imageCacheV[i][j]=null}}}catch(e){logError(e.Message)}};this.clearTextCache=function(){for(var i=0;i<this.textCache.length;i++){delete this.textCache[i];this.textCache[i]=null}};this.cachePutText=function(cache_id,data,idx,len){var carray=Array(len);for(n=0;n<len;n++)carray[n]=data[idx+n];textEntry=new TextEntry(len,carray);if(cache_id<this.textCache.length)this.textCache[cache_id]=textEntry;
else throw"Could not put Text in cache";};this.cacheGetText=function(cache_id){var entry=null;if(cache_id<this.textCache.length){entry=this.textCache[cache_id];if(entry!=null&&entry.data!=null)return entry}};this.toRGB=function(color){var rgb="rgba("+(color>>16&255)+",";rgb+=(color>>8&255)+",";rgb+=(color&255)+",1)";return rgb};this.putRdpText=function(cmd,context){var text=this.decode(cmd.text),idx=0,ch=0;if(cmd.bcx!=-1){context.fillStyle=this.toRGB(cmd.bc);context.fillRect(cmd.bx,cmd.by,cmd.bcx,
cmd.bcy);cmd.lx=cmd.bx;cmd.ly=cmd.by;cmd.lcx=cmd.bcx;cmd.lcy=cmd.bcy}else if(cmd.mm==1){context.fillStyle=this.toRGB(cmd.bc);context.fillRect(cmd.lx,cmd.ly,cmd.lcx,cmd.lcy)}cmd.maxX=cmd.lx+cmd.lcx-1;cmd.maxY=cmd.ly+cmd.lcy-1;if(cmd.lcx*cmd.lcy==0)return;var imgdata=null;var length=cmd.len;var j=0;var vert=(cmd.fl&4)==4;var horiz_implicit=(cmd.fl&32)!=0;while(j<length)switch(text[j]&255){case 255:if(j+2<cmd.len)this.cachePutText(text[j+1],text,0,text[j+2]&255);else throw"Index out of range!";length-=
j+3;text=text.slice(j+3);j=0;break;case 254:var entry=this.cacheGetText(text[j+1]&255);if(entry){if(entry.data[1]==0&&!horiz_implicit)if(!vert)cmd.x+=text[j+2]&255;else cmd.y+=text[j+2]&255;for(k=0;k<entry.size;k++){if(!imgdata)imgdata=context.getImageData(cmd.lx,cmd.ly,cmd.lcx,cmd.lcy);k+=this.doGlyph(context,imgdata,cmd,entry.data,k)}}j+2<length?j+=3:j+=2;length-=j;text=text.slice(j);j=0;break;default:if(!imgdata)imgdata=context.getImageData(cmd.lx,cmd.ly,cmd.lcx,cmd.lcy);j+=this.doGlyph(context,
imgdata,cmd,text,j);j++}if(imgdata)context.putImageData(imgdata,cmd.lx,cmd.ly)};this.doGlyph=function(context,imgdata,cmd,text,idx){var xyoffset=0,j=0,advanceCount=0,Bpp=Math.floor((cmd.bpp+7)/8);glyph=this.getGlyph(cmd.fnt,text[idx+j]&255);if(glyph){if(!(cmd.fl&32))if(cmd.oc)if(cmd.fl&4)cmd.y+=cmd.oc;else cmd.x+=cmd.oc;else{xyoffset=text[idx+ ++j]&255;advanceCount+=1;if(xyoffset==128){xyoffset=text[idx+j+1]&255|(text[idx+j+2]&255)<<8;advanceCount+=2}if(cmd.fl&4)cmd.y+=xyoffset;else cmd.x+=xyoffset}this.drawGlyph(context,
imgdata,cmd,glyph,Bpp);if(cmd.fl&32)cmd.x+=cmd.oc?cmd.oc:glyph.width}return advanceCount};this.drawGlyph=function(context,imgdata,cmd,glyph,Bpp){var x=cmd.x+glyph.offset&65535,y=cmd.y+glyph.baseLine&65535,dataWidth=Math.ceil(glyph.width/8)*8,glyphWidth=glyph.width,glyphHeight=glyph.height,fontData=glyph.fontData,desktopWidth=TVNC.rcParams.viewWidth,desktopHeight=TVNC.rcParams.viewHeight,foreColor=cmd.fc,backColor=cmd.bc,bit=128,line,pixel;if(x+glyphWidth<cmd.lx||x>cmd.maxX||y+glyphHeight<cmd.ly||
y>cmd.maxY)return;var data=imgdata.data;if(!(x>desktopWidth||y>desktopHeight))for(line=0;line<glyphHeight;line++)if(line+y>=cmd.ly&&line+y<=cmd.maxY)for(var pixel=0;pixel<glyphWidth;pixel++)if(pixel+x>=cmd.lx&&pixel+x<=cmd.maxX){var pixelOffset=((line+(y-cmd.ly))*cmd.lcx+pixel+(x-cmd.lx))*4;var byteIndex=Math.floor((line*dataWidth+pixel)/8);bit=fontData[byteIndex]>>7-pixel%8&1;try{if(bit)this.setPixel(data,pixelOffset,foreColor);else if(cmd.mm==1)this.setPixel(data,pixelOffset,backColor)}catch(err){logError(err)}}};
this.setPixel32=function(data,pixelOffset,color){data[pixelOffset]=color};this.setPixel=function(data,pixelOffset,color){data[pixelOffset]=color>>16&255;data[pixelOffset+1]=color>>8&255;data[pixelOffset+2]=color&255;data[pixelOffset+3]=255};this.doROP=function(rop,src,dst){switch(rop){case 0:return 0;case 1:return~(src|dst);case 2:return~src&dst;case 3:return~src;case 4:return src&~dst;case 5:return~dst;case 6:return src^dst;case 7:return~(src&dst);case 8:return src&dst;case 9:return~src^dst;case 10:return dst;
case 11:return~src|dst;case 12:return src;case 13:return src|~dst;case 14:return src|dst;case 15:return~0;case 16:return~src&~dst}return dst};this.doROP3=function(rop,src,dst,bc,fc){switch(rop){case 0:return 0;case 1:return~(src|dst);case 2:return~src&dst;case 3:return~src;case 4:return src&~dst;case 5:return~dst;case 6:return src^dst;case 7:return~(src&dst);case 8:return src&dst;case 9:return~src^dst;case 10:return dst;case 11:return~src|dst;case 12:return src;case 13:return src|~dst;case 14:return src|
dst;case 15:return~0;case 16:return~src&~dst;case 17:return~src&fc;case 18:return src==0?bc:fc;case 19:return dst|(fc|~src);case 20:return src==0?bc^dst:fc^dst;case 21:return src&fc|~src&dst;case 22:return src&~fc;case 23:return dst^~fc}return dst};this.registerDrawCmd=function(cmd,callback){TVNC.registeredDrawCmds[cmd]=callback};this.registerOOBCmd=function(cmd,callback){TVNC.registeredOOBCmds[cmd]=callback};this.unregisterOOBCmd=function(cmd){if(cmd&&TVNC.registeredOOBCmds[cmd])delete TVNC.registeredOOBCmds[cmd]};
this.fireOOBCmd=function(cmd,data){var res=false;if(typeof TVNC.registeredOOBCmds[cmd]!="undefined"){res=true;try{TVNC.registeredOOBCmds[cmd](data,cmd==="vchannel"?_url:null)}catch(error){helper.console.log(`Cannot process this package with OOB handler: [cmd:${cmd}, data:${JSON.stringify(data)}]`,arguments)}}return res};this.registerCustomCmd=function(cmds,callback){var fnRegistered=function(cmd){if(TVNC.registeredCustomCmds[cmd]==undefined)TVNC.registeredCustomCmds[cmd]=[];TVNC.registeredCustomCmds[cmd].push(callback)};
if(cmds&&callback&&typeof callback=="function")if(cmds instanceof Array)for(var i=0;i<cmds.length;i++)fnRegistered(cmds[i]);else fnRegistered(cmds)};this.unregisterCustomCmd=function(cmds,callback){var fnUnregistered=function(cmd){if(TVNC.registeredCustomCmds[cmd])for(var i=TVNC.registeredCustomCmds[cmd].length-1;i>=0;i--)if(TVNC.registeredCustomCmds[cmd][i]==callback)TVNC.registeredCustomCmds[cmd].splice(i,1)};if(cmds&&callback&&typeof callback=="function")if(cmds instanceof Array)for(var j=0;j<
cmds.length;j++)fnUnregistered(cmds[j]);else fnUnregistered(cmds)};this.registerCustomDataType=function(dataType,handler){if(handler instanceof Function)TVNC.registeredCustomDataTypes[dataType]=handler};this.unregisterCustomDataType=function(dataType){if(TVNC.registeredCustomDataTypes[dataType])delete TVNC.registeredCustomDataTypes[dataType]};TVNC.registeredCustomDataTypes[7]=function(){};this.fireCustomEvents=function(cmd,obj){if(cmd&&TVNC.registeredCustomCmds[cmd])for(var i=0;i<TVNC.registeredCustomCmds[cmd].length;i++)try{TVNC.registeredCustomCmds[cmd][i](obj)}catch(error){}};
this.fireCustomEvents=function(cmd,obj){if(cmd&&TVNC.registeredCustomCmds[cmd])for(var i=0;i<TVNC.registeredCustomCmds[cmd].length;i++)try{TVNC.registeredCustomCmds[cmd][i](obj)}catch(error){}};this.drawCmdFillRect=function(cmd,context){var isXOR=cmd.pm&&cmd.pm==14;var isBSHollow=cmd.bs&&cmd.bs==1;if(isXOR){context.save();try{var imgdata=null;try{imgdata=context.getImageData(cmd.x,cmd.y,cmd.w,cmd.h)}catch(e){if(helper.object.existsPath(window.netscape,"security.PrivilegeManager.enablePrivilege"))try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");
imgdata=context.getImageData(cmd.x,cmd.y,cmd.w,cmd.h)}catch(error){helper.console.log(JSON.stringify(error),arguments)}}if(imgdata){var data=imgdata.data;var canPaint=true;var x,y=0,offset=0,r,g,b,pixel,color;for(y=0;y<cmd.h;y++)for(x=0;x<cmd.w;x++,offset+=4){canPaint=!isBSHollow||(y==0||y==cmd.h-1)||(x==0||x==cmd.w-1);if(canPaint){if(isXOR){r=4294967295&imgdata.data[offset];g=4294967295&imgdata.data[offset+1];b=4294967295&imgdata.data[offset+2];pixel=r<<16&16777215|g<<8&16777215|b;color=this.doROP(6,
pixel,4294967295&cmd.clr)}else color=4294967295&cmd.clr;this.setPixel(data,offset,color)}}context.putImageData(imgdata,cmd.x,cmd.y)}}finally{context.globalCompositeOperation="source-over";context.restore()}}else{context.fillStyle=this.toRGB(cmd.clr);if(cmd.pm&&cmd.pm==14)context.globalCompositeOperation="xor";context.fillRect(cmd.x,cmd.y,cmd.w,cmd.h);context.globalCompositeOperation="source-over"}};this.drawCmdLineTo=function(cmd,context){context.save();try{if(cmd.cw&&cmd.ch){context.beginPath();
context.rect(cmd.cl,cmd.ct,cmd.cw,cmd.ch);context.clip()}var isHorizOrVert=false;var lineW=1,lineH=1;if(cmd.ey-cmd.y==0){isHorizOrVert=true;lineW=cmd.w;if(lineW==0)lineW=1}if(cmd.ex-cmd.x==0){isHorizOrVert=true;lineH=cmd.w;if(lineH==0)lineH=1}var isXOR=cmd.o&&cmd.o==7;var isNOT=cmd.o&&cmd.o==6;if(isHorizOrVert&&isXOR){var ox=Math.min(cmd.ex,cmd.x);var oy=Math.min(cmd.ey,cmd.y);cmd.cx=Math.abs(cmd.ex-cmd.x)+lineW;cmd.cy=Math.abs(cmd.ey-cmd.y)+lineH;var imgdata=null;try{imgdata=context.getImageData(ox,
oy,cmd.cx,cmd.cy)}catch(e){if(helper.object.existsPath(window.netscape,"security.PrivilegeManager.enablePrivilege"))try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");imgdata=context.getImageData(ox,oy,cmd.cx,cmd.cy)}catch(error){helper.console.log(JSON.stringify(error),arguments)}}if(imgdata){var data=imgdata.data;var x,y=0,offset=0,r,g,b,pixel,color;for(y=0;y<cmd.cy;y++)for(x=0;x<cmd.cx;x++,offset+=4){if(isXOR||isNOT){r=4294967295&imgdata.data[offset];g=4294967295&imgdata.data[offset+
1];b=4294967295&imgdata.data[offset+2];pixel=r<<16&16777215|g<<8&16777215|b;if(isXOR)color=this.doROP(6,pixel,4294967295&cmd.fg);else color=this.doROP(3,pixel,4294967295)}else color=4294967295&cmd.fg;this.setPixel(data,offset,color)}context.putImageData(imgdata,ox,oy)}}else{if(cmd.ey-cmd.y==0){cmd.y+=.5;cmd.ey+=.5}if(cmd.ex-cmd.x==0){cmd.x+=.5;cmd.ex+=.5}context.beginPath();if(isXOR||isNOT)context.globalCompositeOperation="xor";context.moveTo(cmd.x,cmd.y);context.lineTo(cmd.ex,cmd.ey);context.lineWidth=
cmd.w;if(isNOT)context.strokeStyle=this.toRGB(4294967295);else context.strokeStyle=this.toRGB(cmd.fg);context.stroke()}}finally{context.globalCompositeOperation="source-over";context.restore()}};this.drawCmdScreenBlt=function(cmd,canvas,context){var imagedata=null;try{imagedata=context.getImageData(cmd.sx,cmd.sy,cmd.cx,cmd.cy)}catch(e){if(helper.object.existsPath(window.netscape,"security.PrivilegeManager.enablePrivilege"))try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");
imagedata=context.getImageData(cmd.sx,cmd.sy,cmd.cx,cmd.cy)}catch(error){helper.console.log(JSON.stringify(error),arguments)}}if(imagedata)context.putImageData(imagedata,cmd.x,cmd.y)};this.drawCmdScreenBltSlower=function(cmd,canvas,context){var buffer=document.createElement("canvas");buffer.width=cmd.cx;buffer.height=cmd.cy;buffer.getContext("2d",{willReadFrequently:true}).drawImage(canvas,-cmd.sx,-cmd.sy);context.drawImage(buffer,cmd.x,cmd.y)};this.getKeyFromCmd=function(group,qidx){return padZero(group,
3).concat(padZero(qidx,5))};this.drawCmdDrawEdge=function(cmd,context){cmd.ex=cmd.x+cmd.w;cmd.ey=cmd.y+cmd.h;var borderStyles={BDR_RAISEDOUTER:1,BDR_SUNKENOUTER:2,BDR_RAISEDINNER:4,BDR_SUNKENINNER:8,BDR_OUTER:3,BDR_INNER:12,BDR_RAISED:5,BDR_SUNKEN:10};var edge={EDGE_RAISED:borderStyles.BDR_RAISEDOUTER|borderStyles.BDR_RAISEDINNER,EDGE_SUNKEN:borderStyles.BDR_SUNKENOUTER|borderStyles.BDR_SUNKENINNER,EDGE_ETCHED:borderStyles.BDR_SUNKENOUTER|borderStyles.BDR_RAISEDINNER,EDGE_BUMP:borderStyles.BDR_RAISEDOUTER|
borderStyles.BDR_SUNKENINNER};var borderFlags={BF_LEFT:1,BF_TOP:2,BF_RIGHT:4,BF_BOTTOM:8,BF_DIAGONAL:16,BF_MIDDLE:2048,BF_SOFT:4096,BF_ADJUST:8192,BF_FLAT:16384,BF_MONO:32768};var borderFlag={BF_TOPLEFT:borderFlags.BF_TOP|borderFlags.BF_LEFT,BF_TOPRIGHT:borderFlags.BF_TOP|borderFlags.BF_RIGHT,BF_BOTTOMLEFT:borderFlags.BF_BOTTOM|borderFlags.BF_LEFT,BF_BOTTOMRIGHT:borderFlags.BF_BOTTOM|borderFlags.BF_RIGHT,BF_RECT:borderFlags.BF_TOP|borderFlags.BF_LEFT|borderFlags.BF_BOTTOM|borderFlags.BF_RIGHT,BF_DIAGONAL_ENDTOPRIGHT:borderFlags.BF_DIAGONAL|
borderFlags.BF_TOP|borderFlags.BF_RIGHT,BF_DIAGONAL_ENDTOPLEFT:borderFlags.BF_DIAGONAL|borderFlags.BF_TOP|borderFlags.BF_LEFT,BF_DIAGONAL_ENDBOTTOMLEFT:borderFlags.BF_DIAGONAL|borderFlags.BF_BOTTOM|borderFlags.BF_LEFT,BF_DIAGONAL_ENDBOTTOMRIGHT:borderFlags.BF_DIAGONAL|borderFlags.BF_BOTTOM|borderFlags.BF_RIGHT};context.save();if(cmd.pm&&cmd.pm==14)context.globalCompositeOperation="xor";context.lineWidth=cmd.pw;context.strokestyle=this.toRGB(cmd.clr);if(cmd.e==edge.EDGE_SUNKEN&&cmd.f&borderFlags.BF_SOFT==
borderFlags.BF_SOFT);if(cmd.e==edge.EDGE_RAISED&&cmd.f&borderFlags.BF_SOFT==borderFlags.BF_SOFT);if(cmd.f&borderFlags.BF_TOP==borderFlags.BF_TOP){context.beginPath();context.moveTo(cmd.x,cmd.y);context.lineTo(cmd.ex,cmd.y);context.stroke()}if(cmd.f&borderFlags.BF_LEFT==borderFlags.BF_LEFT){context.beginPath();context.moveTo(cmd.x,cmd.y);context.lineTo(cmd.x,cmd.ey);context.stroke()}if(cmd.f&borderFlags.BF_BOTTOM==borderFlags.BF_BOTTOM){context.beginPath();context.moveTo(cmd.x,cmd.ey);context.lineTo(cmd.ex,
cmd.ey);context.stroke()}if(cmd.f&borderFlags.BF_RIGHT==borderFlags.BF_RIGHT){context.beginPath();context.moveTo(cmd.ex,cmd.y);context.lineTo(cmd.ex,cmd.ey);context.stroke()}context.globalCompositeOperation="source-over";context.restore()};this.deferCall=function(item,f,params){if(!TVNC.resumeItem){TVNC.imgQueue.watchdogStop();TVNC.imgQueue.watchdogStart();TVNC.resumeItem=item;var df=function(){f.apply(null,params)};if(TVNC.deferCallBySetTimeout)setTimeout(df,1);else TVNC.resumeProcess=df}};this.executeDeferred=
function(){if(TVNC.imgQueue)TVNC.imgQueue.watchdogStop();if(!TVNC.deferCallBySetTimeout&&TVNC.resumeProcess){var rp=TVNC.resumeProcess;TVNC.resumeProcess=null;TVNC.resumeItem=null;rp()}};this.processDrawCmds=function(root,win,canvas,context){var oriContext=context;TVNC.processNextScreenEnabled=false;if(win.idx){if(!cmdCache)cmdCache=new Array(1E5);if(win.cmds){for(i=0;i<win.cmds.length;i++){var cmd=win.cmds[i];cmdCache[cmd.z]=clone(cmd)}win.cmds.splice(0,win.cmds.length)}for(i=0;i<win.idx.length;i++){var cmd=
cmdCache[win.idx[i]];win.cmds.push(clone(cmd))}}if(win.cmds){var cmd,i,img,item,sx,sy;for(i=0;i<win.cmds.length;i++){if(TVNC.offscreenCanvas)context=TVNC.offscreenCanvas.getContext("2d",{willReadFrequently:true});else context=oriContext;cmd=win.cmds[i];if(cmd.processed)continue;cmd.processed=true;if(typeof cmd.z!="undefined"){var idx=cmd.z;if(!cmdCache)cmdCache=new Array(1E5);if(typeof cmd.c=="undefined"){win.cmds[i]=clone(cmdCache[idx]);cmd=win.cmds[i]}else cmdCache[idx]=clone(cmd)}if(TVNC.enableCmdCache){for(var p in cmd)if(cmd[p]!==
""&&cmd[p]!=null)TVNC.cmdCacheProps[p]=cmd[p];else if(typeof TVNC.cmdCacheProps[p]!="undefined")delete TVNC.cmdCacheProps[p];win.cmds[i]=TVNC.cmdCacheProps;cmd=clone(TVNC.cmdCacheProps);if(typeof cmd.originalValues!="undefined"){for(var q in cmd.originalValues)TVNC.cmdCacheProps[q]=cmd.originalValues[q];delete TVNC.cmdCacheProps.originalValues;delete cmd.originalValues}}if(cmd.c=="IC"){if(typeof cmd.qidx!="undefined"&&cmd.qidx>=0&&typeof root.imgQueue!="undefined"){item=TVNC.peekImageItem(root,cmd.qidx);
if(!item)continue;if(!item.ready||!item.image||!item.image.data){win.cmds[i].processed=false;TVNC.deferCall(win.cmds[i],TVNC.processDrawCmds,[root,win,canvas,context]);return}TVNC.setToImageCache(TVNC.extractImageItem(root,cmd.qidx),cmd.k)}else{item=TVNC.getFromImageCache(cmd.k);if(!item)continue}if(!item||!item.ready){logError("Cache: image "+cmd.k+" is not loaded, qidx: "+cmd.qidx);continue}if(typeof cmd.x=="undefined")continue;sx=0,sy=0;if(typeof cmd.sx!="undefined"){sx=cmd.sx;sy=cmd.sy}if(typeof cmd.o==
"undefined"||cmd.o==12)try{item.draw(context,cmd.x,cmd.y,cmd.cx,cmd.cy,sx,sy,cmd.cx,cmd.cy)}catch(err){logError("error in item.draw():"+cmd.k+",sx:"+sx+",sy:"+sy+",cmd.x:"+cmd.x+",cmd.y:"+cmd.y+",cmd.cx:"+cmd.cx+",cmd.cy:"+cmd.cy+",img.width:"+item.getWidth()+",img.height:"+item.getHeight())}else{var auxCanvas=document.createElement("canvas");auxCanvas.width=item.getWidth();auxCanvas.height=item.getHeight();var auxContext=auxCanvas.getContext("2d",{willReadFrequently:true});try{item.draw(auxContext,
0,0)}catch(err){logError("error on auxContext.drawImage")}var auxImageData=null;try{auxImageData=auxContext.getImageData(sx,sy,cmd.cx,cmd.cy)}catch(e){if(helper.object.existsPath(window.netscape,"security.PrivilegeManager.enablePrivilege"))try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");auxImageData=auxContext.getImageData(sx,sy,cmd.cx,cmd.cy)}catch(error){helper.console.log(JSON.stringify(error),arguments)}}var imagedata=null;try{imagedata=context.getImageData(cmd.x,
cmd.y,cmd.cx,cmd.cy)}catch(e){if(helper.object.existsPath(window.netscape,"security.PrivilegeManager.enablePrivilege"))try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");imagedata=context.getImageData(cmd.x,cmd.y,cmd.cx,cmd.cy)}catch(error){helper.console.log(JSON.stringify(error),arguments)}}if(auxImageData&&imagedata)TVNC.rop3Canvas(context,cmd,imagedata,auxImageData)}}else if(cmd.c=="IP"){var sx=0,sy=0;if(typeof cmd.sx!="undefined"){sx=cmd.sx;sy=cmd.sy}item=TVNC.peekImageItem(root,
cmd.qidx);if(!item)continue;if(!item.ready){win.cmds[i].processed=false;TVNC.deferCall(win.cmds[i],TVNC.processDrawCmds,[root,win,canvas,context]);return}try{item.draw(context,cmd.x,cmd.y,cmd.cx,cmd.cy,sx,sy,cmd.cx,cmd.cy)}catch(ex){logError("IP: item.draw() failed. cmd.qidx="+cmd.qidx);if(item)logError("size: "+item.getWidth()+"x"+item.getHeight())}TVNC.returnImageItem(TVNC.extractImageItem(root,cmd.qidx))}else if(cmd.c=="CB"){if(TVNC.brushCache[cmd.idx])TVNC.returnImageItem(TVNC.brushCache[cmd.idx]);
item=TVNC.extractImageItem(root,cmd.qidx);if(!item){logError("pattern cache update error; item missing");continue}TVNC.brushCache[cmd.idx]=item}else if(cmd.c=="FR")TVNC.drawCmdFillRect(cmd,context);else if(cmd.c=="PB"){var auxCanvas=document.createElement("canvas");auxCanvas.width=cmd.cx;auxCanvas.height=cmd.cy;var auxContext=auxCanvas.getContext("2d",{willReadFrequently:true});cmd.fc&=16777215;cmd.bc&=16777215;var normalProcess=true;if(cmd.bs==0){auxContext.fillStyle=TVNC.toRGB(cmd.fc);auxContext.fillRect(0,
0,cmd.cx,cmd.cy)}else{if(cmd.cidx>=0)item=TVNC.brushCache[cmd.cidx];else item=TVNC.extractImageItem(root,cmd.qidx);if(typeof item!="undefined")if(typeof item.image.data.complete=="undefined"||item.image.data.complete==true){var ptrn=auxContext.createPattern(item.image.data,"repeat");auxContext.fillStyle=ptrn;auxContext.fillRect(0,0,cmd.cx,cmd.cy)}else{normalProcess=false;TVNC.delayProcessImagePattern(auxContext,item,cmd)}else helper.console.log("pattern missing, or empty image",arguments)}if(normalProcess){var auxImageData=
auxContext.getImageData(0,0,cmd.cx,cmd.cy);var imagedata=context.getImageData(cmd.x,cmd.y,cmd.cx,cmd.cy);if(auxImageData&&imagedata)TVNC.rop3Canvas(context,cmd,imagedata,auxImageData)}}else if(cmd.c=="SB")TVNC.drawCmdScreenBlt(cmd,canvas,context);else if(cmd.c=="LI")TVNC.drawCmdLineTo(cmd,context);else if(cmd.c=="PL"){if(cmd.p.length>0){var n;var px=cmd.p[0].x;var py=cmd.p[0].y;var cx;var cy;var vertical=false;var horizontal=false;for(n=1;n<cmd.p.length;n++){cx=cmd.p[n].x;cy=cmd.p[n].y;if(cx-px==
0){if(!vertical)cmd.p[n-1].x+=.5;vertical=true;cmd.p[n].x+=.5}else vertical=false;if(cy-py==0){if(!horizontal)cmd.p[n-1].y+=.5;horizontal=true;cmd.p[n].y+=.5}else horizontal=false;px=cx;py=cy}context.save();if(cmd.cw&&cmd.ch){context.beginPath();context.rect(cmd.cl,cmd.ct,cmd.cw,cmd.ch);context.clip()}if(cmd.pm&&cmd.pm==14)context.globalCompositeOperation="xor";context.beginPath();context.moveTo(cmd.p[0].x,cmd.p[0].y);for(n=1;n<cmd.p.length;n++)context.lineTo(cmd.p[n].x,cmd.p[n].y);context.lineWidth=
cmd.w;context.strokeStyle=TVNC.toRGB(cmd.fg);context.stroke();context.globalCompositeOperation="source-over";context.restore()}}else if(cmd.c=="DE")TVNC.drawCmdDrawEdge(cmd,context);else if(cmd.c=="CR"){context.save();if(cmd.r.length==0){context.beginPath();context.rect(0,0,0,0);context.clip()}else{context.beginPath();for(n=0;n<cmd.r.length;n++){var r=cmd.r[n];context.rect(r.x,r.y,r.cx,r.cy)}context.clip()}}else if(cmd.c=="ER"){var canvasid="canvasER";TVNC.canvasER=document.getElementById(canvasid);
if(!TVNC.canvasER){TVNC.canvasER=document.createElement("canvas");TVNC.canvasER.style.zIndex=TVNC.baseZIndex+499;TVNC.canvasER.style.position="absolute";TVNC.canvasER.style.left="0px";TVNC.canvasER.style.top="0px";TVNC.canvasER.id=canvasid;TVNC.vncContainer.appendChild(TVNC.canvasER)}addValidCanvas(TVNC.canvasER);TVNC.canvasER.width=TVNC.rcParams.viewWidth;TVNC.canvasER.height=TVNC.rcParams.viewHeight;var auxContext=TVNC.canvasER.getContext("2d",{willReadFrequently:true});auxContext.restore();auxContext.clearRect(0,
0,TVNC.canvasER.offsetWidth,TVNC.canvasER.offsetHeight);auxContext.fillStyle=canvas.parentElement.mask.color;for(n=0;n<cmd.r.length;n++){var r=cmd.r[n];auxContext.fillRect(r.x,r.y,r.cx,r.cy)}}else if(cmd.c=="EA"){BTP_PRA_SRT=null;if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onExecRemoteApp==null)$(window).trigger("execRemoteApp",[cmd]);else TVNC.rcParams.events.onExecRemoteApp([cmd])}else if(cmd.c=="EX"){BTP_PRA_STS=null;if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onExecResult==
null)$(window).trigger("execResult",[cmd]);else TVNC.rcParams.events.onExecResult([cmd])}else if(cmd.c=="TX")try{TVNC.putRdpText(cmd,context)}catch(err){logError(err)}else if(cmd.c=="FC")TVNC.cacheFont(cmd);else if(cmd.c=="DB")TVNC.dstblt(context,cmd.o,0,cmd.x,cmd.y,cmd.cx,cmd.cy);else if(cmd.c=="OB")TVNC.CreateOffscreenBitmap(cmd.id,cmd.cx,cmd.cy,cmd.dlist);else if(cmd.c=="SS")TVNC.SwitchSurface(cmd.id);else if(cmd.c=="MO"){if(!cmd.sx)cmd.sx=0;if(!cmd.sy)cmd.sy=0;TVNC.MembltOffscreen(oriContext,
cmd.o,cmd.id,cmd.x,cmd.y,cmd.cx,cmd.cy,cmd.sx,cmd.sy)}else if(cmd.c=="RC")if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onRemoteCommand==null)$(window).trigger("remoteCommand",[cmd.r]);else TVNC.rcParams.events.onRemoteCommand(cmd.r);else if(cmd.c=="FD"){var mime="";if(typeof cmd.mime!="undefined")mime=cmd.mime;var fileName=cmd.fn;if(typeof cmd.url!="undefined")fileName=cmd.url;if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onFileDownload==null)$(window).trigger("fileDownload",
[fileName,mime]);else TVNC.rcParams.events.onFileDownload([fileName],mime)}else if(cmd.c=="DS"){let m=cmd.m;helper.console.log(`incoming "DS" command: ${JSON.stringify(cmd)}`,arguments);if(!m)m=[{id:_displayManager.mainDisplayId,w:cmd.w,h:cmd.h,hwnd:win.hwnd}];for(let i=0,t=m.length;i<t;i++){let wnd=m[i];_displayManager.processDisplayCmd(cmd.c,wnd.id,wnd.w,wnd.h,win.hwnd,wnd.x,wnd.y)}if(window!=window.top&&typeof TVNC.rcParams.events!="undefined"&&helper.object.validate(TVNC.rcParams.events.onDesktopResize))TVNC.rcParams.events.onDesktopResize(cmd.m)}else if(cmd.c==
"PR")TVNC.processPrint(cmd);else if(cmd.c=="LE"){BTP_PCL_ERR=null;try{helper.console.log(helper.string.format("Logon Error - code: {0}, data: {1}, description: {2}",cmd.ec,cmd.d,cmd.s),arguments)}catch(error){helper.console.warning("Cannot log 'LogonError'",error,arguments)}}else if(cmd.c=="CU"){_CUEnabled=true;item=TVNC.peekImageItem(root,cmd.qidx);if(!item)continue;if(!item.ready){win.cmds[0].processed=false;TVNC.deferCall(win.cmds[0],TVNC.processDrawCmds,[root,win,canvas,context]);return}if(item.image.data){let dx=
item.image.data.width-cmd.hx;let dy=item.image.data.height-cmd.hy;_displayManager.fireEvent("setCursor",{"src":item.image.data,"x":dx,"y":dy,"url":`url(${item.image.data.srcImage||item.image.data.src}) ${dx} ${dy}, auto`})}}else if(typeof TVNC.registeredDrawCmds[cmd.c]!="undefined")TVNC.registeredDrawCmds[cmd.c](cmd,win,context)}}TVNC.processImages(root,win,oriContext)};this.delayProcessImagePattern=function(ctx,item,cmd){helper.console.log("delayProcessImagePattern on image idx: "+item.idx,arguments);
var iCount=0;var createPattern=function(ctx,item,cmd){var ptrn=ctx.createPattern(item.image.data,"repeat");ctx.fillStyle=ptrn;ctx.fillRect(0,0,cmd.cx,cmd.cy);var auxImageData=ctx.getImageData(0,0,cmd.cx,cmd.cy);var imagedata=ctx.getImageData(cmd.x,cmd.y,cmd.cx,cmd.cy);if(auxImageData&&imagedata)TVNC.rop3Canvas(ctx,cmd,imagedata,auxImageData)};var processImagePattern=function(){if(iCount<5){if(typeof item.image.data.complete=="undefined"||item.image.data.complete==true)createPattern(ctx,item,cmd);
else setTimeout(function(){processImagePattern()},25);iCount++}else helper.console.log("cannot load this image: "+item.idx+" ,is not completed",arguments)};processImagePattern()};this.CreateOffscreenBitmap=function(id,cx,cy,dlist){if(this.offscreenCache[id])delete this.offscreenCache[id];var canvas=document.createElement("canvas");canvas.visibility="visible";canvas.display="block";canvas.style.position="absolute";canvas.style.left=-cx;canvas.style.top=-cy;canvas.style.zIndex=-1;canvas.width=cx;canvas.height=
cy;this.offscreenCache[id]=canvas;for(var i=0;i<dlist.length;i++)if(this.offscreenCache[dlist[i]]){delete this.offscreenCache[dlist[i]];this.offscreenCache[dlist[i]]=null}};this.SwitchSurface=function(id){if(id==65535)this.offscreenCanvas=null;else this.offscreenCanvas=this.offscreenCache[id]};this.MembltOffscreen=function(context,o,id,x,y,cx,cy,sx,sy){var srcContext=this.offscreenCache[id].getContext("2d",{willReadFrequently:true});var srcImageData=srcContext.getImageData(sx,sy,cx,cy);context.putImageData(srcImageData,
x,y)};this.clearOffscreenCache=function(){for(var i=0;i<this.offscreenCache.length;i++){if(this.offscreenCache[i])delete this.offscreenCache[i];this.offscreenCache[i]=null}};this.dstblt=function(context,rop,srccolor,x,y,cx,cy){var imagedata=null;try{imagedata=context.getImageData(x,y,cx,cy)}catch(e){if(helper.object.existsPath(window.netscape,"security.PrivilegeManager.enablePrivilege"))try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");imagedata=context.getImageData(x,
y,cx,cy)}catch(error){helper.console.log(JSON.stringify(error),arguments)}}if(imagedata){var data=imagedata.data;var offset=0;for(var line=0;line<cy;line++)for(var col=0;col<cx;col++,offset+=4){var color=srccolor;if(rop!=12){var r=4294967295&data[offset];var g=4294967295&data[offset+1];var b=4294967295&data[offset+2];var pixel=r<<16&16777215|g<<8&16777215|b;color=this.doROP(rop,color,pixel)}data[offset]=color>>16&255;data[offset+1]=color>>8&255;data[offset+2]=color&255}imagedata.data=data;context.putImageData(imagedata,
x,y)}};this.revokeImageUrl=function(){var d=((new Date).getTime()-4*1E3).toString();for(var k in _blob.processedScreenUrl)if(k<=d){for(var i=0;i<_blob.processedScreenUrl[k].length;i++)_urlCreator.revokeObjectURL(_blob.processedScreenUrl[k][i]);delete _blob.processedScreenUrl[k]}else break};this.addRevokeObjectURL=function(items){if(!_blob.revoked){var bUrls=[];var d=(new Date).getTime();for(var k in items)if(items[k]&&items[k].image&&items[k].image.data&&items[k].image.data.blobImage&&!items[k].image.data.mouseImage)bUrls.push(items[k].image.data.srcImage||
items[k].image.data.src);if(bUrls.length>0){if(!_blob.processedScreenUrl[d])_blob.processedScreenUrl[d]=[];_blob.processedScreenUrl[d].push.apply(_blob.processedScreenUrl[d],bUrls)}}};this.addRevokeStringURL=function(src){if(!_blob.revoked)if(src!=""){var bUrls=[src];var d=(new Date).getTime();if(!_blob.processedScreenUrl[d])_blob.processedScreenUrl[d]=[];_blob.processedScreenUrl[d].push.apply(_blob.processedScreenUrl[d],bUrls)}};this.removeUsedItems=function(imgQueue){if(_usedImgQueueItems&&_usedImgQueueItems.length>
0&&imgQueue){for(var i=0;i<_usedImgQueueItems.length;i++)delete imgQueue[_usedImgQueueItems[i]];_usedImgQueueItems=[]}};this.processNextScreen=function(){if(!TVNC.imagesLoading&&TVNC.processNextScreenEnabled&&TVNC.msgQueue.length>0){var m=TVNC.msgQueue.shift();TVNC.receiveScreen(m);TVNC.revokeImageUrl();if(m.imgQueue){TVNC.addRevokeObjectURL(m.imgQueue.items);TVNC.removeUsedItems(m.imgQueue.items)}}};this.incImagesLoading=function(){TVNC.imagesLoading++};this.decImagesLoading=function(){TVNC.imagesLoading--};
this.noImagesLoading=function(){return TVNC.imagesLoading==0};this.preserveOriginalValue=function(obj,prop,localCache){if(typeof localCache!="undefined"&&typeof localCache[prop]!="undefined"&&typeof obj[prop]=="undefined")obj[prop]=localCache[prop];if(typeof obj.originalValues=="undefined")obj.originalValues={};if(typeof obj[prop]=="undefined")obj[prop]=TVNC.cmdCacheProps[prop];else if(typeof localCache!="undefined")localCache[prop]=obj[prop];obj.originalValues[prop]=obj[prop]};function imgQueueItemFromImageDecoderData(u8Array,
type,hash,key){var e=this.encoded;e.width=u8Array[0]|u8Array[1]<<8;e.height=u8Array[2]|u8Array[3]<<8;e.bpp=u8Array[4];e.decoder=u8Array[5];e.option1=u8Array[6];e.option2=u8Array[7];e.offset=u8Array.buffer.byteLength-u8Array.length+8;e.size=u8Array.buffer.byteLength-e.offset;e.data=u8Array.buffer;TVNC.InsertIntoImgQueueAndExecute(key,this)}function imgQueueItemFromImageArray(u8Array,type,hash,key){var cacheEnabled=hash.length&&TVNC.fs;var insertAndExecute=true;if(u8Array.length){this.encoded.data=
TVNC.u8ArrayToDataUri("image/"+type,u8Array);if(cacheEnabled)TVNC.fs.write(hash,this.encoded.data)}else if(cacheEnabled){insertAndExecute=false;var imgItem=this;TVNC.fs.read(hash,function(stream){imgItem.encoded.data=stream;TVNC.InsertIntoImgQueueAndExecute(key,imgItem)})}if(insertAndExecute)TVNC.InsertIntoImgQueueAndExecute(key,this)}function imgQueueItemFromLegacyStringData(stringBinaryData,type,hash,key){var cacheEnabled=hash.length&&TVNC.fs;var insertAndExecute=true;if(stringBinaryData.length){this.encoded.data=
TVNC.getImageStreamFromTB64(type,window.btoa(stringBinaryData));if(cacheEnabled)TVNC.fs.write(hash,this.encoded.data)}else if(cacheEnabled){insertAndExecute=false;var imgItem=this;TVNC.fs.read(hash,function(stream){imgItem.encoded.data=stream;TVNC.InsertIntoImgQueueAndExecute(key,imgItem)})}if(insertAndExecute)TVNC.InsertIntoImgQueueAndExecute(key,this)}function drawImgQueueItem(context,x,y,w,h,sx,sy,sw,sh){if(!this.image.data){if(!sw||!sh){logError("drawImgQueueItem(): image of type "+this.image.type+
", sw and sh are null for idx # "+this.idx+", error: "+this.error);return}this.drawError(context,"#800080","#FFFFFF",x,y,sw,sh);return}if(this.image.type=="img"){if(!w)w=this.getWidth();if(!h)h=this.getHeight();if(sx!=null&&sy!=null){if(!sw)sw=w;if(!sh)sh=h;context.drawImage(this.image.data,sx,sy,sw,sh,x,y,w,h)}else context.drawImage(this.image.data,x,y,w,h)}else if(this.image.type=="canvas")if(sx!=null&&sy!=null){if(!sw)sw=this.getWidth();if(!sh)sh=this.getHeight();context.putImageData(this.image.data,
x-sx,y-sy,sx,sy,sw,sh)}else context.putImageData(this.image.data,x,y);else{logError("drawImgQueueItem(): unknown image->type for idx # "+this.idx+", error: "+this.error);return}}function drawDummyImgQueueItem(context,fillStyle,strokeStyle,x,y,w,h){context.fillStyle=fillStyle;context.strokeStyle=strokeStyle;w-=1;h-=1;context.beginPath();context.rect(x,y,w,h);context.moveTo(x,y);context.lineTo(x+w,y+h);context.moveTo(x,y+h);context.lineTo(x+w,y);context.closePath();context.fill();context.stroke()}function getImgQueueItemWidth(){if(!this.image.data)return this.encoded.width;
return this.image.data.width}function getImgQueueItemHeight(){if(!this.image.data)return this.encoded.height;return this.image.data.height}function purgeImgQueueItemEncoded(){var e=this.encoded;e.width=0;e.height=0;e.decoder=0;e.option1=0;e.option2=0;e.bpp=0;e.offset=0;e.size=0;e.data=null}function purgeImgQueueItemImage(){delete this.image.data;this.image.data=null;this.image.type=null;this.ready=false;this.error=0}function purgeImgQueueItemAll(){this.purgeEncoded();this.purgeImage()}function imgQueueItemLoadFailed(error){this.purgeAll();
this.ready=true;this.error=error?error:255;TVNC.executeDeferred()}function imgQueueItemLoadSucceeded(){this.purgeEncoded();this.ready=true;this.error=0;TVNC.executeDeferred()}function imgQueueItemSetImg(loadedCallback,errorCallback,src){this.purgeImage();this.image.type="img";this.image.data=document.createElement("img");this.image.data.detachEvents=function(){this.onload=null;this.onerror=null;this.onabort=null};this.image.data.onload=function(e){if(typeof e.target.complete=="undefined"||e.target.complete==
true){this.detachEvents();loadedCallback(e)}else{helper.console.log("Image data is not completed but it is loaded.",arguments);var maxTimes=10;var countTimes=0;function retryLoadImage(){setTimeout(function(){if(countTimes>maxTimes){helper.console.log("Cannot process this image.",arguments);return}else if(typeof e.target.complete=="undefined"||e.target.complete==true){this.detachEvents();loadedCallback(e)}else retryLoadImage();countTimes++},50)}}};this.image.data.onerror=function(e){this.detachEvents();
errorCallback(e)};this.image.data.onabort=function(e){this.detachEvents();errorCallback(e)};this.image.data.blobImage=src.substr(0,4)=="blob";this.image.data.srcImage=src;this.image.data.src=src}function imgQueueItemSetCanvas(context,arData){if(this.image.type!="canvas"||!this.image.data||this.image.width!=this.encoded.width||this.image.height!=this.encoded.height){this.purgeImage();this.image.type="canvas";this.image.data=context.createImageData(this.encoded.width,this.encoded.height)}this.image.data.data.set(new Uint8ClampedArray(arData))}
this.getImageItem=function(){return TVNC.createImgQueueItem()};this.returnImageItem=function(item){item.purgeEncoded();if(_blob.on)TVNC.addRevokeObjectURL({0:item});item=null};this.createImgQueueItem=function(){return{ready:false,error:0,image:{type:null,data:null},encoded:{width:0,height:0,decoder:0,option1:0,option2:0,bpp:0,offset:0,size:0,data:null},fromImageDecoderData:imgQueueItemFromImageDecoderData,fromImageArray:imgQueueItemFromImageArray,fromLegacyStringData:imgQueueItemFromLegacyStringData,
draw:drawImgQueueItem,drawError:drawDummyImgQueueItem,getWidth:getImgQueueItemWidth,getHeight:getImgQueueItemHeight,purgeEncoded:purgeImgQueueItemEncoded,purgeImage:purgeImgQueueItemImage,purgeAll:purgeImgQueueItemAll,loadFailed:imgQueueItemLoadFailed,loadSucceeded:imgQueueItemLoadSucceeded,setImg:imgQueueItemSetImg,setCanvas:imgQueueItemSetCanvas}};this.getImageStreamFromTB64=function(imageType,imageBase64){return"data:image/"+imageType+";base64,"+imageBase64};this.buildImgQueue=function(msg){try{var w,
win,c,cmds,cmd,i,currCmd,localCache={};msg.group=0;if(msg.windows)for(w=0;w<msg.windows.length;w++){win=msg.windows[w];if(win.cmds){cmds=win.cmds;if(typeof TVNC.cmdCacheProps["c"]!="undefined")currCmd=TVNC.cmdCacheProps["c"];for(i=0;i<cmds.length;i++){cmd=cmds[i];if(typeof cmd.c!="undefined")currCmd=cmd.c;if(currCmd=="IC"||currCmd=="IP"||currCmd=="CB"||currCmd=="PB")if(TVNC.fs||typeof cmd.d!="undefined"&&cmd.d!=="")this.addToImgQueue(msg.imgQueue,cmd,"c",localCache);else cmd.qidx=-1}}if(win.imgs){imgs=
win.imgs;for(i=0;i<imgs.length;i++){img=imgs[i];this.addToImgQueue(msg.imgQueue,img,"i")}}}}catch(e){logError("buildImgQueue error: "+e.message)}};this.addToImgQueue=function(imgQueue,oJS,srcType,localCache){oJS.qidx=++TVNC.imgIndex%99999;var idx=TVNC.getKeyFromCmd(0,oJS.qidx);if(imgQueue.items[idx])delete imgQueue.items[idx];var item=TVNC.getImageItem();var processImgItem=true;if(srcType=="c"){this.preserveOriginalValue(oJS,"t",localCache);var cacheEnabled=oJS.hash&&oJS.hash.length&&TVNC.fs;if(oJS.d.length){if(cacheEnabled)TVNC.fs.write(oJS.hash,
"data:image/"+oJS.t+";base64,"+oJS.d)}else if(cacheEnabled){processImgItem=false;TVNC.fs.read(oJS.hash,function(stream){item.encoded.data=stream;item.idx=idx;delete oJS.d;delete oJS.t;imgQueue.items[idx]=item;TVNC.processImgQueueItem(item)})}if(processImgItem)item.encoded.data="data:image/"+oJS.t+";base64,"+oJS.d}else{item.encoded.data=oJS.img;delete oJS.img}if(processImgItem){delete oJS.d;delete oJS.t;item.idx=idx;imgQueue.items[idx]=item;TVNC.processImgQueueItem(item)}};this.InsertIntoImgQueueAndExecute=
function(idx,item){if(TVNC.imgQueue.items&&TVNC.imgQueue.items[idx])delete TVNC.imgQueue.items[idx];item["idx"]=idx;TVNC.imgQueue.items[idx]=item;TVNC.imgQueue.count++;this.processImgQueueItem(item)};this.addToImgQueueAndExecute=function(imgQueue,item){var i=imgQueue.items.length;item["idx"]=i;imgQueue.items.push(item);this.processImgQueueItem(item);return i};this.processImgQueueItem=function(item){var decoderFunc=TVNC.getImageDecoder(item.encoded.decoder);if(!decoderFunc){logError("raw decoder "+
item.encoded.decoder+" not found for image key "+item.idx);item.loadFailed()}else decoderFunc(item)};this.processImgQueue=function(imgQueue){if(!imgQueue.items)return;for(var i=0;i<imgQueue.items.length;i++)this.processImgQueueItem(imgQueue,imgQueue.items[i])};this.registerImageDecoder=function(id,fnc){if(!TVNC.imageDecoders)TVNC.imageDecoders=[];TVNC.imageDecoders[id]=fnc};this.getImageDecoder=function(id){if(!TVNC.imageDecoders)return null;return TVNC.imageDecoders[id]};this.registerImageDecoder(0,
function(item){item.setImg(function(){item.loadSucceeded();TVNC.processNextScreen()},function(){item.loadFailed();logError("image # "+item.idx+" with errors")},item.encoded.data)});this.registerRawBinaryHandler=function(idList,fnc){if(!TVNC.rawBinaryHandlers)TVNC.rawBinaryHandlers=[];for(var i=0;i<idList.length;++i)TVNC.rawBinaryHandlers[idList[i]]=fnc};function getRawBinaryHandler(hid,opt1,opt2){if(!TVNC.rawBinaryHandlers)return null;if(!hid)hid=0;if(!opt1)opt1=0;if(!opt2)opt2=0;var id=(hid&255)<<
16|(opt1&255)<<8|opt2&255;return TVNC.rawBinaryHandlers[id]}this.extractImageItem=function(root,qidx){var id=TVNC.getKeyFromCmd(root.group,qidx);var item=root.imgQueue.items[id];_usedImgQueueItems.push(id);return item};this.peekImageItem=function(root,qidx){return root.imgQueue?root.imgQueue.items[TVNC.getKeyFromCmd(root.group,qidx)]:null};this.processImages=function(root,win,context){if(typeof win.imgs!=="undefined"){var imgpart,item;for(var i=0;i<win.imgs.length;i++){imgpart=win.imgs[i];if(imgpart.processed)continue;
imgpart.processed=true;if(!root.imgQueue){logError("Error on processImages: root.imgQueue not found.");return}item=TVNC.peekImageItem(root,imgpart.qidx);if(!item)continue;if(!item.ready){imgpart.processed=false;TVNC.deferCall(imgpart,TVNC.processImages,[root,win,context]);return}else try{if(win.hwnd==0)if(TVNC.rcParams.overrideCursor){if(typeof item.image.data!="undefined"&&item.image.data!=null){var mx=agentInfo.isMobile?window.devicePixelRatio:environment.xZoom/100/environment.currentDevicePixelRatio;
_displayManager.fireEvent("setCursor",{"src":item.image.data,"x":imgpart.x,"y":imgpart.y,"url":`url(${item.image.data.srcImage||item.image.data.src}) ${win.dx*mx-imgpart.x} ${win.dy*mx-imgpart.y}, auto`})}if(_blob.on&&item.image.data.blobImage){if(_blob.processedMouseUrl.length>16)_urlCreator.revokeObjectURL(_blob.processedMouseUrl.shift());_blob.processedMouseUrl.push(item.image.data.srcImage||item.image.data.src);delete root.imgQueue.items[item.idx]}else TVNC.returnImageItem(TVNC.extractImageItem(root,
imgpart.qidx))}else{_displayManager.fireEvent("drawCursor",item,imgpart,{async:0});TVNC.returnImageItem(TVNC.extractImageItem(root,imgpart.qidx))}else{item.draw(context,imgpart.x,imgpart.y);TVNC.returnImageItem(TVNC.extractImageItem(root,imgpart.qidx))}}catch(ex){logError("Error on processImages: "+ex.message)}}}if(TVNC.useBufferedCanvas)helper.animationFrame.request(function(){win.realcanvas.getContext("2d",{willReadFrequently:true}).drawImage(context.canvas,0,0)});TVNC.processWindows(root)};this.processLayerInfo=
function(root,win,div,context){if(win.layerinfo){div.layerinfo=null;if(win.layerinfo.flags)div.layerinfo=clone(win.layerinfo)}if(div.layerinfo){if((div.layerinfo.flags&2)==2){div.style.opacity=div.layerinfo.alpha/255;div.style.MozOpacity=div.layerinfo.alpha/255;div.style.filter="alpha(opacity="+div.layerinfo.alpha/2.55+")"}if((div.layerinfo.flags&1)==1&&context.canvas.width>0&&context.canvas.height>0){var color=div.layerinfo.crkey;var key={r:color>>16&255,g:color>>8&255,b:color&255};var d=10;var frame=
context.getImageData(0,0,context.canvas.width,context.canvas.height);for(var j=0;j<frame.data.length;j+=4){var r=frame.data[j];var g=frame.data[j+1];var b=frame.data[j+2];if(key.r-d<=r&&r<key.r+d&&key.g-d<=g&&g<key.g+d&&key.b-d<=b&&b<key.b+d)frame.data[j+3]=0}context.putImageData(frame,0,0)}}};this.processWindows=function(obj,success){if(success)obj.success=success;if(obj.nextWindow>=obj.windows.length)obj.success();else{var win=obj.windows[obj.nextWindow];obj.nextWindow++;TVNC.processWindow(obj,
win)}};this.processWindow=function(root,win){if(typeof win.hwnd=="undefined"){setTimeout(TVNC.reload,1);return}var canvasid=productId+"_canvas_"+win.hwnd;var canvas=document.getElementById(canvasid);if(_blob.on&&win.hwnd=="0"&&win.imgs&&win.imgs.length)for(var i=0;i<win.imgs.length;i++){var k=TVNC.getKeyFromCmd(root.group,win.imgs[i].qidx);if(helper.object.existsPath(root.imgQueue.items[k],"image.data"))root.imgQueue.items[k].image.data.mouseImage=true}if(!canvas&&win.hwnd!==0)canvas=this.createCanvas(win);
if(typeof win.className!="undefined")canvas.className=win.className;var realcanvas=canvas.canvas;if(!realcanvas)return;var context=realcanvas.getContext("2d",{willReadFrequently:true});var vw=helper.object.validate(win.width);if(win.hwnd==0){if(_blob.on&&win.imgs&&win.imgs.length)for(var i=0;i<win.imgs.length;i++){var k=TVNC.getKeyFromCmd(root.group,win.imgs[i].qidx);if(helper.object.existsPath(root.imgQueue.items[k],"image.data"))root.imgQueue.items[k].image.data.mouseImage=true}_displayManager.fireEvent("setCursor",
win)}else{var canvasid=productId+"_canvas_"+win.hwnd;var canvas=document.getElementById(canvasid);var realcanvas=null;var context=null;if(!canvas)canvas=this.createCanvas(win);if(typeof win.className!="undefined")canvas.className=win.className;realcanvas=canvas.canvas;if(!realcanvas)return;context=realcanvas.getContext("2d",{willReadFrequently:true});var vw=helper.object.validate(win.width);if(win.width==0||win.height==0){canvas.style.visibility="hidden";canvas.style.display="none";TVNC.fireCustomEvents("canvasHidden",
win);if(productId==="virtualui")if(win.hwnd!=0&&TVNC.rcParams?.events?.onReleaseCanvas)TVNC.rcParams.events.onReleaseCanvas(win)}else{if(helper.object.validate(win.left)&&(win.width==canvas.width&&win.height==canvas.height||canvas.width*canvas.height==0)){canvas.style.left=win.left-TVNC.rcParams.viewLeft+"px";canvas.style.top=win.top-TVNC.rcParams.viewTop+"px"}if(vw&&(win.width!=canvas.width||win.height!=canvas.height)||canvas.resizing)if(canvas.width*canvas.height==0){canvas.width=win.width;canvas.height=
win.height;canvas.style.width=win.width+"px";canvas.style.height=win.height+"px";realcanvas.width=win.width;realcanvas.height=win.height;realcanvas.style.width=win.width+"px";realcanvas.style.height=win.height+"px"}else if(helper.object.validate(TVNC.rcParams.events.onCanvasResize))if(TVNC.rcParams.events.onCanvasResize(win,canvas))TVNC.updateCanvasSize(canvas,win.left-TVNC.rcParams.viewLeft,win.top-TVNC.rcParams.viewTop,win.width,win.height);else canvas.resizing=true;else TVNC.updateCanvasSize(canvas,
win.left-TVNC.rcParams.viewLeft,win.top-TVNC.rcParams.viewTop,win.width,win.height);if(vw){if(productId!="virtualui")canvas.style.display="block";TVNC.fireCustomEvents("canvasShow",win);canvas.style.visibility="visible"}canvas.style.zIndex=this.baseZIndex+win.zidx*10}}if(typeof TVNC.rcParams.events!="undefined"&&helper.object.validate(TVNC.rcParams.events.onProcessWindow))TVNC.rcParams.events.onProcessWindow(root,win,canvas);if(TVNC.useBufferedCanvas){if(!realcanvas.bufferedCanvas){realcanvas.bufferedCanvas=
document.createElement("canvas");realcanvas.bufferedCanvas.width=realcanvas.width;realcanvas.bufferedCanvas.height=realcanvas.height}var bufferedContext=realcanvas.bufferedCanvas.getContext("2d",{willReadFrequently:true});win.realcanvas=realcanvas;TVNC.partialAnimationFrameUpdate(function(){TVNC.processDrawCmds(root,win,realcanvas,bufferedContext);TVNC.processLayerInfo(root,win,canvas,context);context=null})}else TVNC.partialAnimationFrameUpdate(function(){TVNC.processDrawCmds(root,win,realcanvas,
context);if(canvas)TVNC.processLayerInfo(root,win,canvas,context);context=null});if(!this.rcParams.cursorVisible)_displayManager.fireEvent("hideCursor");else if(TVNC.rcParams.overrideCursor)_displayManager.fireEvent("resetCursor");if(agentInfo.isIOS&&agentInfo.iosVersion<=7&&win.hwnd==0)_displayManager.fireEvent("setCursor","visible")};this.updateCanvasSize=function(canvas,newLeft,newTop,newWidth,newHeight){var imagedata=null;var realcanvas=canvas.canvas;canvas.resizing=false;var context=realcanvas.getContext("2d",
{willReadFrequently:true});if(realcanvas.width<newWidth||realcanvas.height<newHeight){try{imagedata=context.getImageData(0,0,realcanvas.width,realcanvas.height)}catch(e){if(helper.object.existsPath(window.netscape,"security.PrivilegeManager.enablePrivilege"))try{netscape.security.PrivilegeManager.enablePrivilege("UniversalBrowserRead");imagedata=context.getImageData(0,0,newWidth,newHeight)}catch(error){helper.console.log(JSON.stringify(error),arguments)}}realcanvas.width=newWidth;realcanvas.height=
newHeight;realcanvas.style.width=newWidth+"px";realcanvas.style.height=newHeight+"px";if(imagedata)context.putImageData(imagedata,0,0);else if(canvas.hwnd!==0){context.fillStyle="#CCC";context.fillRect(0,0,newWidth,newHeight)}}canvas.width=newWidth;canvas.height=newHeight;if(!isNaN(newLeft))canvas.style.left=newLeft+"px";if(!isNaN(newTop))canvas.style.top=newTop+"px";canvas.style.width=newWidth+"px";canvas.style.height=newHeight+"px";var hwnd=canvas.hwnd!=undefined&&canvas.hwnd==0?canvas.hwnd:canvas.id.indexOf("_0")!=
-1?0:1;if(productId=="thinrdp"&&hwnd==1){TVNC.vncdiv.style.width=TVNC.vncContainer.style.width=newWidth+"px";TVNC.vncdiv.style.height=TVNC.vncContainer.style.height=newHeight+"px"}imagedata=null};this.processControls=function(div,canvas){return};this.newPrintDialog=function(obj){try{if(printDialog==null)printDialog=createPrintDialog();if(!printDialog){if(typeof obj.progress=="undefined"||!obj.progress)TVNC.openPrnWindow({"url":obj.url,"title":obj.title,"obj":obj},true);return}if(helper.object.existsPath(self,
"clientSettings.PrintDialog")){if(helper.object.existsPath(self.clientSettings.PrintDialog,"DefaultMethod"))printDialog.defaultPrintMethod=self.clientSettings.PrintDialog.DefaultMethod;if(helper.object.existsPath(self.clientSettings.PrintDialog,"BypassDialog"))printDialog.bypassPrintDialog=self.clientSettings.PrintDialog.BypassDialog}var fUrl=obj.url;if(_url.httpConnection!==""){var surl=_url.httpConnection.split("/");var i=surl.length-1;var vp="";while(i>=0&&vp===""){if(surl[i]!==""){vp=surl[i];
i=0}i--}fUrl=helper.url.parseUrl(_url.httpConnection+obj.url.replace(vp,"")).toUrl()}printDialog.setDocument(fUrl,obj.title,obj.preview,obj.progress,TVNC.rcParams.events.onPrintHandler)}catch(error){if(typeof obj.progress=="undefined"||!obj.progress)TVNC.openPrnWindow({"url":obj.url,"title":obj.title,"obj":obj},true)}};this.processPrint=function(obj){var base=cookiePrefix==="VNC"?helper.url.parseUrl(location.href).toUrl("-vp-o"):_url.baseUrl;var url=base+obj.file.substring(1)+"?SID="+TVNC.rcParams.id;
if(TVNC.runInPublicServer&&window.top!=window)url="https://www.thinvnc.net"+url;obj.url=url;if(typeof TVNC.rcParams.events==="undefined"||!TVNC.rcParams.events.onFileReady)TVNC.newPrintDialog(obj);else TVNC.rcParams.events.onFileReady({"url":url,"title":obj.title,"obj":obj})};this.getProtocol=function(){var proto=TVNC.rcParams.protocol?TVNC.rcParams.protocol:window.location.protocol;return proto.toLowerCase()};this.getAjaxUrl=function(){var url="";var baseUrl="";url=TVNC.rcParams.server?TVNC.getProtocol()+
"//"+TVNC.rcParams.server:"";baseUrl=_url.baseUrl;var paths=baseUrl.substr(0,baseUrl.length-2).split("/");if(paths.length>2){url+="/"+paths[1];baseUrl=baseUrl.substr(baseUrl.indexOf("/",1))}if(TVNC.gatewayAccessKey!="")if(url.indexOf("/"+TVNC.gatewayAccessKey)<0)url+="/"+TVNC.gatewayAccessKey;url+=(baseUrl[0]!=="/"?"/":"")+baseUrl;return url};this.getCrossDomainDataType=function(){return _defaultResponseType};this.getCrossDomainUrl=function(url){return url};this.sendAck=function(){if(TVNC.rcParams.clientAck>
0)_comm.wsSend("cmd=ready")};this.sendXoff=function(){if(!TVNC.xoff&&TVNC.rcParams.xoffEnabled){helper.console.warning("***********************",arguments);helper.console.warning("SENDING XOFF CMD !!!!!!",arguments);helper.console.warning("***********************",arguments);_comm.wsSend("cmd=xoff");TVNC.xoff=true}};this.sendXon=function(){if(TVNC.xoff&&TVNC.rcParams.xoffEnabled){helper.console.warning("***********************",arguments);helper.console.warning("SENDING XON CMD !!!!!!!",arguments);
helper.console.warning("***********************",arguments);_comm.wsSend("cmd=xon");TVNC.xoff=false}};this.sendPostAjaxCmd=function(query,data){_comm.post({"url":_url.httpConnection+"cmd?"+query,"data":data})};this.sendServerCmd=function(cmd,query){if(allowSendingCommands)if(_comm.protocol===Thinfinity.Communication.protocol.AJAX){if(TVNC.rcParams.id)_comm.send(TVNC.completeAjaxParams({"queueName":this.queueRequestName,"url":_url.httpConnection+cmd+"?"+query+"&id="+this.rcParams.id,"dataType":_defaultResponseType,
"success":TVNC.serverCmdResult,"error":function(msg,xhr){TVNC.throwErrorConnection(msg,xhr)}}))}else _comm.wsSend(query+"&id="+this.rcParams.id)};this.receiveScreen=function(obj){if(!helper.object.validate(obj)||obj.status==2){setTimeout(TVNC.reload,1);return}if(obj.status==4){if(typeof obj.cmd!="undefined"&&obj.cmd=="openLinkDlg")if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onOpenLink==null)$(window).trigger("OpenLink",obj);else TVNC.rcParams.events.onOpenLink(obj);else{TVNC.processPrint(obj);
setTimeout(TVNC.reload,1)}return}if(obj.status==9){BTP_PRA_END=null;TVNC.disconnect();BTP_PS_END1=null;TVNC.dispose();return}if(helper.object.validate(obj.caret)){var fEvent=TVNC.caretX!=obj.caret.x||TVNC.caretY!=obj.caret.y;TVNC.caretX=obj.caret.x;TVNC.caretY=obj.caret.y;if(fEvent)TVNC.fireCustomEvents("updateCaretPosition",{"x":TVNC.caretX,"y":TVNC.caretY})}if(typeof obj.windows!="undefined"){obj.nextWindow=0;TVNC.processWindows(obj,function(){for(var i=TVNC.vncContainer.childNodes.length-1;i>=
0;i--){var elem=TVNC.vncContainer.childNodes[i];if(!elem)break;else if(_validCanvas.indexOf(elem)!==-1)continue;else if(elem.tagName=="CANVAS"||elem.tagName=="DIV"&&elem.id.match(/.*_canvas.*/)){var found=false;if(_CUEnabled&&elem.id==productId+"_canvas_0")found=true;for(j=0;j<obj.windows.length&&!found;j++){var canvasid=productId+"_canvas_"+obj.windows[j].hwnd;if(elem.id==canvasid||(elem.id==productId+"_canvasborder"+obj.windows[j].hwnd||cookiePrefix==="RDP"&&elem.id!==productId+"_canvas_0"))found=
true}if(elem==TVNC.canvasER)found=true;if(!found){elem.style.display="none";var hwnd=elem.id.replace(productId+"_canvas_","");if(hwnd!=0)TVNC.fireCustomEvents("canvasHidden",{"hwnd":hwnd});if(elem.mask){delete elem.mask;elem.mask=null}if(typeof TVNC.rcParams.events!="undefined"&&helper.object.validate(TVNC.rcParams.events.onDeleteWindow))TVNC.rcParams.events.onDeleteWindow(elem);elem.innerHTML="";try{TVNC.vncContainer.removeChild(elem)}catch(err){elem.innerHTML="";elem.style.display="none";logError("receiveScreen: "+
err)}elem=null}}}TVNC.processNextScreenEnabled=true;setTimeout(function(){TVNC.processNextScreen()},0)})}if(helper.object.validate(obj.sound))for(i=0;i<obj.sound.length;i++){var chunk=obj.sound[i].chunk;TVNC.sound.play(null,window.atob(unescape(chunk)))}if(!TVNC.rcParams.remotePointer&&!TVNC.rcParams.mouseControl&&!TVNC.rcParams.overrideCursor)_displayManager.fireEvent("setCursor","default");if(TVNC.rcParams.mouseControl&&!TVNC.rcParams.remotePointer&&helper.object.validate(obj.cursor))if(obj.cursor.shape!=
undefined)_displayManager.fireEvent("setCursor",obj.cursor.shape);TVNC.zoomDesktop();if(obj.status==3)if(productId=="thinrdp"&&TVNC.useAjax==true)TVNC.disconnect();else setTimeout(TVNC.reconnect,1);else if(TVNC.rcParams.active)setTimeout(TVNC.reload,1);if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onScreenReceived==null)$(window).trigger("screenReceived",obj);else TVNC.rcParams.events.onScreenReceived(obj)};function resetLastError(){oLastError.message=null;oLastError.code=null;
oLastError.date=null}this.throwErrorConnection=function(oError,xhr){errorOccurs++;clearTimeout(oLastError.timeoutId);var msg=helper.object.validate(oError)?typeof oError.message!="undefined"?oError.message:oError:"";if(errorOccurs>5){oLastError.timeoutId=setTimeout(function(){resetLastError()},oLastError.elapsedTime);if(oError!=""){oLastError.date=new Date;oLastError.message=msg;oLastError.code=typeof oError.code!="undefined"?oError.code:""}try{if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onServerError==
null)$(window).trigger("serverError",oError);else TVNC.rcParams.events.onServerError(oError);helper.console.log("'serverError' disconnecting. "+msg,arguments)}catch(error){helper.console.warning("'serverError' disconnecting. message: "+error.message,error,arguments)}TVNC.disconnect();return}else{helper.console.log("'serverError' reconnecting... "+msg,arguments);if(xhr&&xhr.status===Thinfinity.Communication.errorCode.NOT_FOUND)_comm.forceReconnect();else{_comm.restart(Thinfinity.Communication.protocol.AJAX);
TVNC.reset();TVNC.reconnect()}return}};this.stopCheckingConnectionLost=function(obj){return false};this.serverCmdResult=function(data){if(Object.startObserve)Object.startObserve();if(agentInfo.isMobile)_displayManager.fireEvent("setCursor","block");var obj=null;if(TVNC.useAjax&&!TVNC.crossDomain())obj=typeof data!="object"?JSON.parse(data):data;else obj=data;if(typeof obj=="undefined"){helper.console.error(consts.appProfileMissing+", "+consts.technicalSupport,{},arguments);obj={}}if(typeof obj.id==
"undefined")return;if(typeof obj.clipboardEnabled!="undefined"){TVNC.rcParams.clipboard=obj.clipboardEnabled;if(["ZSC"].indexOf(window.cookiePrefix)!=-1)TVNC.rcParams.synchronizeClipboard=false;else TVNC.rcParams.synchronizeClipboard=window?.customSettings?.synchronizeClipboard??window?.clientSettings?.SynchronizeClipboard??true;TVNC.rcParams.clipboardFileTransfer=obj.clipboardFileTransferEnabled||false;_displayManager.fireEvent("localEvent",{cmd:"sessionstatus",data});_preventKeys.available=["thinrdp"].indexOf(productId)!==
-1&&TVNC.rcParams.clipboard}TVNC.rcParams.sound=obj.soundEnabled;if(TVNC.rcParams.sound&&!_audioDriver){_audioDriver=new Thinfinity.Driver.Audio({methods:{sendCmd:this.sendCmd}});_packetReceiver.registerHandler(2,_audioDriver.play)}if(productId==="thinvnc"&&obj.cmd=="sessionStatus")_displayManager.processDisplayCmd("DS",0,obj.viewWidth,obj.viewHeight,null,0,0);let oData=null;let oError={message:"",code:0};if(typeof data.errormsg==="object"){oData=data.errormsg;oError={...oError,...oData}}oError.message=
(oData?.msg??obj.errormsg)||(typeof obj.errmsg!="undefined"?obj.errmsg:typeof obj.errstr!="undefined"?obj.errstr:"");oError.code=oData?.code||obj.rc||obj.code||obj.errno||0;if(obj.id==0){let resetLastError=function(){clearTimeout(oLastError.timeoutId);oLastError.timeoutId=setTimeout(function(){resetLastError()},oLastError.elapsedTime);if(oError!=""&&typeof oError.code!="undefined"){oLastError.date=new Date;oLastError.message=oError.message;oLastError.code=oError.code}};BTP_PS_ERR=null;if(!(oData&&
(oData.code!="undefined"||oError.code==-1))){helper.console.warning(`The connection has ended with errors: id: ${obj.id}, code: ${oError.code}, message: ${oError.message}, Session has ended: true`,arguments);_isSessionEnded=true;_comm.wsClose();resetLastError()}else _comm.reset();try{if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onServerError==null)$(window).trigger("serverError",oError);else TVNC.rcParams.events.onServerError(oError)}catch(error){helper.console.warning("'serverError' calling attached method fail. Message: "+
error.message,error,arguments)}if(helper.object.existsPath(oError,"code")&&ENUM_CODES.authenticationCodeErrors.indexOf(oError.code.toString())!=-1){if(oError.message!="")helper.console.warning(oError.message);if(window.environment.supportsFullScreen&&window.environment.isFullscreen)window.environment.exitFullscreen(false);if(Object.stopObserve)Object.stopObserve()}else;if(_isSessionEnded)_comm.dispose();return}else if(obj.cmd=="sessionStatus"&&oError.message=="Not authenticated"){TVNC.throwErrorConnection(oError,
{"status":0});return}else if(obj.cmd=="reconnectionAttempt"){if(typeof TVNC.rcParams.events==="undefined"||TVNC.rcParams.events.onReconnectionAttempt===null)$(window).trigger("onReconnectionAttempt",[obj]);else TVNC.rcParams.events.onReconnectionAttempt(obj);return}if(obj.id=="##"){TVNC.disconnect();return}if(obj.id=="!!"){if(obj.cmd==="wakeonlan"){if(_comm.protocol===Thinfinity.Communication.protocol.WEBSOCKET)_comm.wsWOL(true);if(_fromBroker)keepHTTPAlive(true);if(typeof TVNC.rcParams.events===
"undefined"||TVNC.rcParams.events.onWakeOnLan===null)$(window).trigger("wakeOnLan",[obj]);else TVNC.rcParams.events.onWakeOnLan(obj)}else if(obj.cmd==="waitforvm"){if(_comm.protocol===Thinfinity.Communication.protocol.WEBSOCKET)_comm.wsWOL(true);if(_fromBroker)keepHTTPAlive(true);if(typeof TVNC.rcParams.events==="undefined"||TVNC.rcParams.events.onWakeForVM===null)$(window).trigger("waitForVM",[obj]);else TVNC.rcParams.events.onWaitForVM(obj)}else if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onServerCommandEvent==
null)$(window).trigger("serverCmdResult",[obj]);else TVNC.rcParams.events.onServerCommandEvent(obj);return}else if(_comm.protocol===Thinfinity.Communication.protocol.WEBSOCKET)_comm.wsWOL(false);serverDPR.enabled=helper.object.existsPath(obj,"smartZoom")?helper.object.convertTo(obj.smartZoom,"boolean"):false;var rcActive=TVNC.rcParams.active;TVNC.rcParams.active=typeof obj.active!="undefined"?obj.active:TVNC.rcParams.active;TVNC.rcParams.monitor=typeof obj.monitor!="undefined"?obj.monitor:TVNC.rcParams.monitor;
TVNC.rcParams.monitorCount=typeof obj.monitorCount!="undefined"?obj.monitorCount:TVNC.rcParams.monitorCount;TVNC.rcParams.viewLeft=typeof obj.viewLeft!="undefined"?obj.viewLeft:TVNC.rcParams.viewLeft;TVNC.rcParams.viewTop=typeof obj.viewTop!="undefined"?obj.viewTop:TVNC.rcParams.viewTop;TVNC.rcParams.viewWidth=typeof obj.viewWidth!="undefined"?obj.viewWidth:TVNC.rcParams.viewWidth;TVNC.rcParams.viewHeight=typeof obj.viewHeight!="undefined"?obj.viewHeight:TVNC.rcParams.viewHeight;TVNC.rcParams.rfxEnabled=
typeof obj.rfxEnabled!="undefined"?obj.rfxEnabled:false;if(productId=="virtualui"){if(TVNC.vncContainer.parentElement)if(agentInfo.isMobile&&(agentInfo.isIOS&&agentInfo.ipadModel>=3||agentInfo.isMSIE)){TVNC.vncContainer.parentElement.style.width=Math.min(environment.rawWidth,TVNC.rcParams.viewWidth)+"px";TVNC.vncContainer.parentElement.style.height=Math.min(environment.rawHeight,TVNC.rcParams.viewHeight)+"px"}else{TVNC.vncContainer.parentElement.style.width=TVNC.rcParams.viewWidth+"px";TVNC.vncContainer.parentElement.style.height=
TVNC.rcParams.viewHeight+"px"}}else if((typeof obj.viewHeight!="undefined"||typeof obj.viewWidth!="undefined")&&typeof TVNC.rcParams.events!="undefined"&&helper.object.validate(TVNC.rcParams.events.onDesktopResize))TVNC.rcParams.events.onDesktopResize(TVNC.rcParams.viewWidth,TVNC.rcParams.viewHeight);TVNC.rcParams.mouseControl=typeof obj.mouseControl!="undefined"?obj.mouseControl:TVNC.rcParams.mouseControl;TVNC.rcParams.touchControl=typeof obj.touchControl!="undefined"?obj.touchControl:TVNC.rcParams.touchControl;
if(productId==="thinvnc")TVNC.rcParams.serverControlMouse=!TVNC.rcParams.mouseControl;TVNC.rcParams.kbdControl=typeof obj.kbdControl!="undefined"?obj.kbdControl:TVNC.rcParams.kbdControl;TVNC.rcParams.kbdUnicode=typeof obj.kbdUnicode!="undefined"?obj.kbdUnicode:TVNC.rcParams.kbdUnicode;TVNC.rcParams.showOnStart=typeof obj.showOnStart!="undefined"?obj.showOnStart:TVNC.rcParams.showOnStart;TVNC.rcParams.UBRWID=typeof obj.UBRWID!="undefined"?obj.UBRWID:TVNC.rcParams.UBRWID;if(obj.scraper!=null){TVNC.rcParams.scraper=
typeof obj.scraper!="undefined"?obj.scraper:TVNC.rcParams.scraper;if(obj.scraperArgs!=null)TVNC.rcParams.scraperArgs=typeof obj.scraperArgs!="undefined"?obj.scraperArgs:TVNC.rcParams.scraperArgs}TVNC.rcParams.quality=typeof obj.quality!="undefined"?obj.quality:TVNC.rcParams.quality;TVNC.rcParams.imageQuality=typeof obj.imageQuality!="undefined"?obj.imageQuality:TVNC.rcParams.imageQuality;TVNC.rcParams.wallpaper=typeof obj.wallpaper!="undefined"?obj.wallpaper:TVNC.rcParams.wallpaper;TVNC.rcParams.pixelFormat=
typeof obj.pixelFormat!="undefined"?obj.pixelFormat:TVNC.rcParams.pixelFormat;TVNC.rcParams.grayscale=typeof obj.grayscale!="undefined"?obj.grayscale:TVNC.rcParams.grayscale;if(typeof obj.remotePointer!="undefined"&&!obj.remotePointer)TVNC.rcParams.remotePointer=obj.remotePointer;TVNC.rcParams.imageMethod=typeof obj.imageMethod!="undefined"?obj.imageMethod:TVNC.rcParams.imageMethod;if(typeof obj.imageList!="undefined")if(obj.imageList=="json")TVNC.imageListType=0;else if(obj.imageList=="text")TVNC.imageListType=
1;else if(obj.imageList=="binary")TVNC.imageListType=2;TVNC.rcParams.fitmode=typeof obj.quality!="undefined"?obj.fitmode:TVNC.rcParams.fitmode;var fitResolutionMode="";switch(TVNC.rcParams.fitmode){case 1:fitToBrowser=false;fitResolutionMode="fixed";break;case 2:fitResolutionMode="fittoscreen";break;case 0:default:fitResolutionMode="fittobrowser";TVNC.rcParams.fitToBrowser=true;break}TVNC.rcParams.fitToBrowser=fitResolutionMode!="fittobrowser"?false:true;TVNC.rcParams.resolution=fitResolutionMode;
if(TVNC.savedMaxWidth==0||TVNC.rcParams.maxWidth==0)if(!agentInfo.isMobile)TVNC.rcParams.maxWidth=window.environment.rawWidth||screen.width;else if(productId=="virtualui")TVNC.rcParams.maxWidth=window.environment.currentWidth||screen.height;else TVNC.rcParams.maxWidth=window.environment.rawWidth||screen.width;if(TVNC.savedMaxHeight==0||TVNC.rcParams.maxHeight==0)if(!agentInfo.isMobile)TVNC.rcParams.maxHeight=window.environment.rawHeight||screen.height;else if(productId=="virtualui")TVNC.rcParams.maxHeight=
window.environment.currentHeight||screen.height;else TVNC.rcParams.maxHeight=window.environment.rawHeight||screen.height;if(obj.accessKey)TVNC.gatewayAccessKey=obj.accessKey;TVNC.savedMaxWidth=TVNC.rcParams.maxWidth;TVNC.savedMaxHeight=TVNC.rcParams.maxHeight;var version=parseInt(obj.version||0,10);if(version>=2)mouseBuffer.isAvailable=true;else mouseBuffer.isAvailable=false;if(TVNC.rcParams.active&&TVNC.rcParams.mouseControl)if(mouseBuffer.isAvailable==true)TVNC.sendMouseQueue();else TVNC.sendMouseMove();
if(TVNC.rcParams.fitmode==0||TVNC.rcParams.fitToBrowser==true)if(typeof obj.dpr!="undefined"){var zoomBottomLimit=1;if(obj.dpr!=window.environment.currentDevicePixelRatio||TVNC.usedDPR!=window.environment.currentDevicePixelRatio||window.environment.currentOrientation!=serverCmdResultOrientation){serverCmdResultOrientation=window.environment.currentOrientation;window.environment.currentDevicePixelRatio=obj.dpr>0?obj.dpr:1;TVNC.usedDPR=window.environment.currentDevicePixelRatio;if(typeof obj.marginLeft!=
"undefined")window.environment.margin.left=obj.marginLeft;if(typeof obj.marginTop!="undefined")window.environment.margin.top=obj.marginTop;if(typeof obj.marginRight!="undefined")window.environment.margin.right=obj.marginRight;if(typeof obj.marginBottom!="undefined")window.environment.margin.bottom=obj.marginBottom;if(typeof obj.fullscreen!="undefined")window.environment.fullScreenAvailable=true;TVNC.savedMaxWidth=TVNC.rcParams.maxWidth;TVNC.savedMaxHeight=TVNC.rcParams.maxHeight;zoomBottomLimit=1/
window.environment.currentDevicePixelRatio;if(agentInfo.isMobile==true){if(productId!="ZSC"){adjustMainSize();TVNC.zoomFactor=zoomBottomLimit;zoom(zoomBottomLimit)}window.scrollTo(0,0)}else{screenHeight=environment.detectedHeight;screenWidth=environment.detectedWidth;if(serverDPR.enabled)serverDPR.originalValue=obj.dpr;if(productId==="virtualui")zoomBottomLimit=1;if(TVNC.zoomFactor!=zoomBottomLimit)TVNC.zoomDesktop(zoomBottomLimit);TVNC.rcParams.maxWidth=Math.round(screenWidth/zoomBottomLimit);TVNC.rcParams.maxHeight=
Math.round(screenHeight/zoomBottomLimit)}}}else if(serverDPR.enabled==false)window.environment.fixDevicePixelRatio();if(agentInfo.isMobile==true&&productId=="thinrdp"&&helper.object.validate(obj.reconnectOnResize))restartOnOrientationChange=obj.reconnectOnResize;if(TVNC.startPending)setTimeout(TVNC.start,1);if(helper.object.existsPath(self,"clientSettings.OverrideCursor"))TVNC.overrideCursor=self.clientSettings.OverrideCursor;if(helper.object.existsPath(self,"clientSettings.MousePressAsRightButton"))TVNC.rcParams.mousePressAsRightButton=
self.clientSettings.MousePressAsRightButton;if(rcActive!=obj.active){if(obj.active){TVNC.hookKM();TVNC.reload();syncCookies(startCookiesSync);if(cookiePrefix!="FMX")stopSyncCookies();BTP_PS_STR=null;if(typeof TVNC.rcParams.asyncCopy!=="undefined")_displayManager.fireEvent("asyncCopy",TVNC.rcParams.asyncCopy);_getServerUrl.retriesCount=_connectResult.count=0;if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onSessionStart==null)$(window).trigger("sessionStart",obj);else TVNC.rcParams.events.onSessionStart(obj);
initializeComponents(data);if(cookiePrefix!=="VNC"&&agentInfo.isMobile)TVNC.rcParams.scaled=false}else{BTP_PS_STP=null;if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onSessionStop==null)$(window).trigger("sessionStop",obj);else TVNC.rcParams.events.onSessionStop(obj)}if(obj.isShadowSession!==true)_displayManager.preserveConfiguration=true}TVNC.observable.isOTURLSession=obj.isOTURLSession;_displayManager.fireEvent("localEvent",{cmd:"serverCmdResult",obj});if(typeof TVNC.rcParams.events==
"undefined"||TVNC.rcParams.events.onServerCommandResult==null)$(window).trigger("onServerCommandResult",obj);else TVNC.rcParams.events.onServerCommandResult(obj);if(productId.toLowerCase()=="virtualui"){let scrollPoint=document.getElementById(TVNC.vncdivId+"_ScrollPoint");if(scrollPoint)helper.style.addClass(scrollPoint,`top:${TVNC.rcParams.viewHeight}px;left:${TVNC.rcParams.viewWidth}px`);else if(TVNC.vncdiv)helper.dom.appendJsonElement({parentElement:TVNC.vncdiv,type:"DIV",attributes:{id:TVNC.vncdivId+
"_ScrollPoint",style:`height:1px;width:1px;backgroundColor:transparent;position:absolute;top:${TVNC.rcParams.viewHeight}px;left:${TVNC.rcParams.viewWidth}px;zIndex:-1;`}})}TVNC.sendCmd("cmd=started")};this.sendCmd=function(query){return TVNC.sendServerCmd("cmd",query)};this.setMouseControl=function(value){TVNC.sendCmd("cmd=params&mouseControl="+value+"&kbdControl="+!TVNC.rcParams.kbdControl+"&touchControl="+!TVNC.rcParams.touchControl)};this.setQuality=function(value){TVNC.sendCmd("cmd=params&quality="+
value)};this.setimageMethod=function(value){TVNC.sendCmd("cmd=params&imageMethod="+value)};this.setGrayscale=function(value){TVNC.sendCmd("cmd=params&grayscale="+value)};this.setKbdControl=function(value){TVNC.sendCmd("cmd=params&kbdControl="+value)};this.setRemotePointer=function(value){TVNC.sendCmd("cmd=params&remotePointer="+value)};this.setPixelFormat=function(value){TVNC.sendCmd("cmd=params&pixelFormat="+value)};this.setMonitor=function(m){if(m>=this.rcParams.monitorCount)m=0;TVNC.sendCmd("cmd=params&monitor="+
m)};this.revokeObjectURLs=function(){if(_blob.on&&!_blob.revoked){if(_blob.processedMouseUrl)for(var i=0;i<_blob.processedMouseUrl.length;i++)_urlCreator.revokeObjectURL(_blob.processedMouseUrl[i]);_blob.processedMouseUrl=null;if(_blob.processedScreenUrl)for(var d in _blob.processedScreenUrl)for(var i=0;i<_blob.processedScreenUrl[d].length;i++)_urlCreator.revokeObjectURL(_blob.processedScreenUrl[d][i]);_blob.processedScreenUrl=null;_blob.revoked=true}};this.disconnect=function(){_isDisconnecting=
true;if(!_comm.state<=Thinfinity.Communication.state.CLOSING){sessionStorage.removeItem(_preferredBrokerKey);let connected=_comm.state>=Thinfinity.Communication.state.CONNECTING;if(connected&&_displayManager)_displayManager.fireEvent("localEvent",{cmd:"disconnect"});keepHTTPAlive(false);if(!_isSessionEnded)try{let msg=productId!=="virtualui"?consts.thisSessionHasEnded:consts.applicationClosed;if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onSessionEnd==null)$(window).trigger("sessionEnd",
msg);else TVNC.rcParams.events.onSessionEnd(msg)}catch(error){helper.console.warning("'sessionEnd' calling attached method fail. message: "+error.message,error,arguments)}if(_displayManager){_displayManager.dispose();_displayManager.preserveConfiguration=false}BTP_PS_END2=null;connection.fromReconnection=false;TVNC.closeReconnectDiv();TVNC.disposeTimeout=setTimeout(function(){if(TVNC&&TVNC.dispose)TVNC.dispose()},TVNC.disposeTimeoutValue);TVNC.removeCanvases();if(window.environment.supportsFullScreen&&
window.environment.isFullscreen)exitFullscreen();TVNC.sendCmd("cmd=disconnect");stopSyncCookies();_isSessionEnded=true;TVNC.rcParams.id=0;TVNC.sendMouseMove=function(){};clearTimeout(TVNC.emptyRecycleImgTimeout);TVNC.purgeImageQueue(TVNC.imgQueue);ID.remove();sessionStorage.removeItem("oturlDataPass");_comm.wsClose();if(_audioDriver?.dispose)_audioDriver.dispose()}};this.removeCanvases=function(){$('[id^="'+productId+'_"]').remove()};this.removeListeners=function(){$(document).unbind();$(window).unbind();
$("#"+TVNC.vncdivId).unbind()};this.dispose=function(releaseAll,status){if(productId=="virtualui"&&TVNC.vncContainer.parentElement){TVNC.vncContainer.parentElement.style.width="100%";TVNC.vncContainer.parentElement.style.height="100%"}if(Thinfinity.Popups&&Thinfinity.Popups.growl)Thinfinity.Popups.growl.unblockAll();releaseAll=releaseAll!=false?true:false;clearTimeout(TVNC.disposeTimeout);if(!TVNC.useAjax){BTP_PWS_CLS3=null;_comm.wsClose()}_comm.releaseQueue(TVNC.queueRequestName);_comm.dispose();
if(helper.object.existsPath(oLastError,"code")&&ENUM_CODES.authenticationCodeErrors.indexOf(oLastError.code.toString())!=-1)connection.state=Thinfinity.Communication.state.CLOSING;if(releaseAll)TVNC.removeListeners();try{if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onServerDisconnect==null)$(window).trigger("serverDisconnect");else{TVNC.rcParams.events.onServerDisconnect(status);if(TVNC.events){if(TVNC.rcParams.events.splice&&TVNC.rcParams.events.length)TVNC.rcParams.events.splice(0,
TVNC.rcParams.events.length);TVNC.events=null}}}catch(error){helper.console.warning("'onServerDisconnect' calling attached method fail. message: "+error.message,error,arguments)}window.dispatchEvent(new CustomEvent("onServerDisconnect"));if(releaseAll){if(_displayManager)_displayManager.dispose();if(TVNC.clipboard)TVNC.clipboard.dispose();TVNC.removeCanvases()}if(TVNC.xmlHttpJson){TVNC.xmlHttpJson.abort();TVNC.xmlHttpJson=null}TVNC.emptyRecycleImg(true);if(releaseAll)if(!!TVNC.canvasER)TVNC.canvasER=
null;TVNC.clearImageCache();TVNC.clearTextCache();TVNC.clearFontCache();TVNC.clearOffscreenCache();if(window.environment.supportsFullScreen&&window.environment.isFullscreen)exitFullscreen();TVNC.rcParams.id=0;TVNC.sendMouseMove=function(){};if(TVNC.sound){TVNC.sound.dispose();TVNC.sound=null}TVNC.clipboard=null;clearTimeout(TVNC.emptyRecycleImgTimeout);TVNC.purgeImageQueue(TVNC.imgQueue);if(TVNC.imgQueue)TVNC.imgQueue.watchdogStop();TVNC.deferCall=function(){};TVNC.imgQueue=null;setTimeout(function(){if(Object.stopObserve)Object.stopObserve()},
5E3);TVNC.revokeObjectURLs();TVNC.imageListHelper=null;if(_componentRegistrationServices)_componentRegistrationServices.dispose()};this.usingDisplayManager=function(){return(agentInfo.gfx&&TVNC.rcParams.enableGfx||agentInfo.h264&&TVNC.rcParams.enableH264)&&_displayManager};this.reset=function(){this.rcParams.maxHeight=0;this.rcParams.maxWidth=0;if(!this.usingDisplayManager())for(var i=TVNC.vncContainer.childNodes.length-1;i>=0;i--){var canvas=TVNC.vncContainer.childNodes[i];if(canvas.tagName=="CANVAS"){canvas.style.display=
"none";var hwnd=canvas.hwnd||canvas.id.replace(productId+"_canvas_","");if(hwnd!=0)TVNC.fireCustomEvents("canvasHidden",{"hwnd":hwnd});if(canvas.mask)canvas.mask={};canvas.innerHTML="";try{TVNC.vncContainer.removeChild(canvas)}catch(err){logError("receiveScreen: "+err)}canvas=null}}TVNC.emptyRecycleImg(true);_displayManager.fireEvent("resetCursor");TVNC.clearImageCache();TVNC.clearTextCache();TVNC.clearFontCache();TVNC.clearOffscreenCache()};function exitFullscreen(){var el=document;if(window.frameElement)el=
helper.url.getTopWindow(window).document;window.environment.exitFullscreen(el)}this.setFullScreen=function(active){var el=document.documentElement;if(active)window.environment.requestFullscreen(el);else window.environment.exitFullscreen(el)};this.stop=function(){TVNC.sendCmd("cmd=stop")};this.start=function(cmdv){if(TVNC.useAjax)_isPktIdxEnabled=false;this.startCmdToSend=true;BTP_PR_STR=null;TVNC.sendStart(cmdv)};this.removeBrowserSize=function(scraperArgs){return this.removeArguments(scraperArgs,
["browserheight","browserwidth","screenheight","screenwidth"])};this.removeArguments=function(queryStr,args,ignoreCase){if(queryStr&&args&&args instanceof Array){ignoreCase=typeof ignoreCase==="undefined"?true:ignoreCase;if(ignoreCase)args=args.map(function(elem){return elem.toString().toLowerCase()});var lStr="";var rStr=queryStr;var nParams="";var idx=queryStr.indexOf("?");if(idx!=-1){lStr=queryStr.substr(0,idx);rStr=queryStr.substr(idx+1)}var fElem=true;var params=rStr.split("&");params.forEach(function(elem){var kvp=
elem.split("=");if(kvp.length>0){kvp[0]=kvp[0].toString();if(ignoreCase)kvp[0]=kvp[0].toLowerCase();if(args.indexOf(kvp[0])==-1){nParams+=(fElem?"":"&")+elem;fElem=false}}else{nParams+=(fElem?"":"&")+elem;fElem=false}});var u="";if(idx!=-1)u="?";return lStr+u+nParams}};this.sendStart=function(cmdv){if(!this.cacheLoaded)return;if(!this.startCmdToSend)return;this.startPending=false;this.rcParams.active=false;var cmd="cmd=start";if(typeof cmdv!="undefined")cmd=cmdv;if(connection.fromReconnection&&productId==
"thinrdp")cmd+="&subcmd=restart";connection.fromReconnection=false;if(this.rcParams.scraper!=null){cmd=cmd+"&scraper="+this.rcParams.scraper;if(this.rcParams.scraperArgs!=null){var scraperArgs=helper.object.getDataTypeOf(this.rcParams.scraperArgs)=="json"?helper.object.jsonToString(this.rcParams.scraperArgs,"&",false):this.rcParams.scraperArgs;if(cmdv!=undefined&&cmdv.indexOf("screenWidth")!=-1)cmd=cmd+this.removeBrowserSize(scraperArgs);else{var cmdLastChar=cmd.substr(cmd.length-1);var scrFirstChar=
scraperArgs.substr(0,1);var amp="";if(cmdLastChar!="&"&&scrFirstChar!="&")amp="&";cmd=cmd+amp+scraperArgs}}}if(!TVNC.useAjax)if(_comm.binaryType&&(!agentInfo.isFirefox||agentInfo.firefoxVersion>15)){cmd+="&imageList=binary";TVNC.imageListType=2}cmd+="&mouseControl="+this.rcParams.mouseControl+"&kbdControl="+this.rcParams.kbdControl+"&touchControl="+this.rcParams.touchControl;cmd+="&pixelFormat="+this.rcParams.pixelFormat;cmd+="&wallpaper="+this.rcParams.wallpaper;cmd+="&rleThreshold="+this.rcParams.rleThreshold;
cmd+="&useSendThread="+this.rcParams.useSendThread;cmd+="&monitor="+this.rcParams.monitor;TVNC.rcParams.clientAck=TVNC.rcParams.clientAck<=0&&!TVNC.useAjax?0:Math.max(TVNC.rcParams.clientAck,1);cmd+="&supportsWebP="+WebPImageFormat.supportsWebP();cmd+="&clientAck="+TVNC.rcParams.clientAck;if(TVNC.rcParams.screenResX>0)cmd+="&screenResX="+TVNC.rcParams.screenResX+"&screenResY="+TVNC.rcParams.screenResY;if(this.rcParams.pin)cmd+="&pin="+this.rcParams.pin;if(this.rcParams.sessionKey)cmd+="&sessionKey="+
this.rcParams.sessionKey;if(TVNC.controlFactory)cmd+="&nativeClasses="+TVNC.controlFactory.getClassList();if(TVNC.rcParams.persistentCache)cmd+="&imgCache="+getImageCacheList();var isLandscape=window.environment.currentOrientation=="landscape"?true:false;cmd+="&devicePixelRatio="+(window.environment.initialDevicePixelRatio||1)+"&isMobile="+agentInfo.isMobile+"&isLandscape="+isLandscape+"&supportsFullScreen="+window.environment.supportsFullScreen+"&webapp="+window.environment.webapp;if(TVNC.rcParams.extraData!=
null)cmd+="&extraData="+encodeURIComponent(JSON.stringify(TVNC.rcParams.extraData));allowSendingCommands=true;TVNC.sendCmd(cmd);if(TVNC.rcParams.showOnStart)TVNC.show()};this.purgeQuery=function(q){try{var pairs=q.split("&");var collection=[];var pair;var qq="";for(var p=0;p<pairs.length;p++)if(pairs[p]!=""){pair=pairs[p].split("=");if(pair.length=2)collection[pair[0]]=pair[1]}qq="";for(var c in collection)qq+=c+"="+collection[c]+"&";qq=qq.substr(0,qq.length-1);return qq}finally{collection=pairs=
pair=qq=null}};var _gettingSeverUrl=false;function addBaseUrl(baseUrl){var elem=document.getElementById("baseUrlTag");if(!elem){elem=document.createElement("base");elem.id="baseUrlTag";var head=document.querySelector("head");if(head){var fn=head.querySelector("script");if(fn)head.insertBefore(elem,fn);else head.appendChild(elem)}else helper.console.warning("Cannot insert 'script' tag, base url",arguments)}elem.href=baseUrl}function removeBaseUrl(){var elem=document.getElementById("baseUrlTag");elem.parentElement.removeChild(elem)}
function encodeResponseUrl(urlResponse){if(urlResponse){var surl=urlResponse.split("/");if(surl.length>2){urlResponse="";for(var i=0;i<Math.min(surl.length-1,2);i++)if(surl[i]!="")urlResponse+="/"+surl[i];for(var i=2;i<surl.length;i++)if(surl[i]!="")urlResponse+="/"+encodeURIComponent(surl[i]);urlResponse+="/"}}return urlResponse}function setUrls(response){var _browseUrl="__browser__";var basePath=Thinfinity.global.variables.basePath;if(TVNC.rcParams.sessionKey&&TVNC.rcParams.sessionKey!==""){var bp=
Thinfinity.global.variables.basePath.split("/").filter(function(p){return p!==""});var ru=response.url.split("/").filter(function(p){return p!==""});var i=bp.length-1;while(i>=0){if(bp[i]!==""&&ru.find(function(r){return r===bp[i]})){var f=bp[i];basePath=Thinfinity.global.variables.basePath=("/"+bp.splice(0,i).join("/")+"/").replaceAll("//","/");response.url=("/"+ru.slice(ru.indexOf(f),ru.length).join("/")+"/").replaceAll("//","/");i=-1}i--}}else if(productId==="thinvnc"){if(Thinfinity.global.variables.basePath.length>
1&&Thinfinity.global.variables.basePath!=="/"&&response.url.length>1){let bp=Thinfinity.global.variables.basePath.replaceAll("/","");if(response.url.split("/").find(p=>{return p===bp}))response.url="/"+response.url.split("/").filter(p=>{return p!=""}).splice(1).join("/")+"/"}if(Thinfinity.global.variables.gatewayPin.length>1)basePath=basePath.replace(Thinfinity.global.variables.gatewayPin,"").replaceAll("//","/")}_url.baseUrl=helper.url.parseUrl(Thinfinity.global.variables.basePath+response.url).toUrl();
_url.brokerUrl=helper.url.parseUrl(location.href).toUrl("-o-a-r");if(basePath!=="/"){if(basePath.substr(0,1)!=="/")basePath="/"+basePath;if(basePath.substr(basePath.length-1)!=="/")basePath+="/"}if(response.gateway&&response.gateway!==""){_url.httpConnection=helper.url.parseUrl(response.gateway+response.url).toUrl();_url.gatewayAccess=response.gateway;_url.wsConnection=helper.url.parseUrl(response.gateway+_browseUrl+response.url).toUrl();_url.wsConnection=_url.wsConnection.replace("http","ws");_location=
helper.url.parseUrl(response.gateway+response.url).toUrl();_url.baseUrl=_virtualPathProfile}else{if(_url.baseUrl!=="/"){if(_url.baseUrl.substr(0,1)!=="/")_url.baseUrl="/"+_url.baseUrl;if(_url.baseUrl.substr(_url.baseUrl.length-1)!=="/")_url.baseUrl+="/"}_url.httpConnection="";var sp=TVNC.rcParams.server?TVNC.rcParams.server.split("/").filter(function(p){return p!==""}):"";var bp=basePath.split("/").filter(function(p){return p!==""});var i=bp.length-1;var fIdx=-1;while(i>=0){fIdx=sp.findIndex(function(r){return r===
bp[i]});if(fIdx!=-1){TVNC.rcParams.server=sp.splice(0,fIdx).join("/");i=-1}i--}_url.wsConnection=TVNC.rcParams.server?TVNC.getProtocol().replace("http","ws")+"//"+TVNC.rcParams.server:window.location.origin.replace("http","ws");_url.wsConnection+=basePath+_browseUrl+_url.baseUrl.substr(basePath.length-1);_url.wsConnection=helper.url.parseUrl(_url.wsConnection).toUrl();addBaseUrl(_url.baseUrl);_location=TVNC.getAjaxUrl()}if(connection.fromReconnection)TVNC.fireOOBCmd("vchannel",{"msg":{"cmd":"update.gateway"}})}
this.getWsUrl=function(){var wsUrl=_url.wsConnection;if(TVNC.gatewayAccessKey!="")if(wsUrl.indexOf("/"+TVNC.gatewayAccessKey)<0)wsUrl+="/"+TVNC.gatewayAccessKey;return wsUrl+TVNC.rcParams.id+"?_gwsid="+Thinfinity.global.variables.gwsid};this.connect=function(userid,password){if(_isDisconnecting)return;if(!_fromBroker){TVNC.rcParams.id=null;ID.remove()}else if(TVNC.rcParams.id===null)TVNC.rcParams.id=ID.get();helper.ajax.addHeaderValue("X-Thinfinity-GWSID",Thinfinity.global.variables.gwsid);BTP_REM_CO=
null;keepHTTPAlive(true);if(_fromBroker){BTP_PCG_STR=null;if(!_gettingSeverUrl){TVNC.gatewayAccessKey="";_gettingSeverUrl=true;if(_virtualPathProfile==""){_virtualPathProfile=TVNC.rcParams.url?TVNC.rcParams.url:helper.url.parseUrl(window.location.href).toUrl("-o-a");if(_virtualPathProfile[_virtualPathProfile.length-1]!="/")_virtualPathProfile+="/"}connection.reconnectingCount=0;if(connection.firstConnection)updateConnectionStatus({action:1,description:consts.establishingConn});TVNC.getServerUrl(function(response){if(response)if(response.url){helper.console.log(helper.string.format("getServerUrl response. Redirect --\x3e URL:{0} ",
response.url),arguments);TVNC.gatewayAccessKey="";sessionStorage.setItem(_preferredBrokerKey,response.brokerid||"");setUrls(response);BTP_PCG_END=null;postConnect(userid,password);_gettingSeverUrl=false}else{_gettingSeverUrl=false;var errStr="";if(response.state===STATE_ERROR)errStr=response.description!=""?response.description:response.errstr!=""?response.errstr:consts.unknownError;else if(response.errno>=400)errStr=response.errno==404?consts.sessionError404:helper.string.format(consts.clientErrorNum,
response.errno);if(errStr){if(connection.fromReconnection)TVNC.closeReconnectDiv();var responseStr=response.description+(errStr&&errStr!==response.description?" "+errStr:"");var res=false;var status={"state":response.state,"description":response.description,"errstr":errStr,"errno":response.errno};if(_fromBroker&&response.errno===404&&_isTemporalConnection===true){helper.console.warning(helper.string.format("getServerUrl - status: {0}",responseStr),arguments);status.description=consts.brokerDown;status.temp=
true;status.brokerDown=true;status.originalEvent=true;try{if(helper.object.existsPath(TVNC,"rcParams.events.onBrokerError"))res=TVNC.rcParams.events.onBrokerError(status);else $(window).trigger("onBrokerError",status)}catch(error){helper.console.warning("'onBrokerError' calling attached method fail. message: "+error.message,error,arguments)}}if(!res)if(response.license){if(TVNC.connected)TVNC.disconnect();let licenseError={title:consts.licenseError,errorType:_licenseTypes.ERR_TYPE_ERROR,errorCode:response.state,
errorMsg:response.description};if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onLicenseMsg==null)$(window).trigger("licenseMsg",licenseError);else TVNC.rcParams.events.onLicenseMsg(licenseError)}else{try{let oError={message:responseStr};if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onServerError==null)$(window).trigger("serverError",oError);else TVNC.rcParams.events.onServerError(oError);helper.console.log("'serverError' disconnecting. "+responseStr,arguments)}catch(error){helper.console.warning("'serverError' disconnecting. message: "+
error.message,error,arguments)}TVNC.disconnect()}else helper.console.log("The error was handled by the user",arguments)}}else{_gettingSeverUrl=false;setTimeout(function(){BTP_PCG_ERR=null;TVNC.connect(userid,password)},200)}})}}else{var response={"url":_url.baseUrl!=="/"?_url.baseUrl:""};setUrls(response);updateConnectionStatus({"action":1,"description":productId=="virtualui"?null:consts.establishingConn});_virtualPathProfile="";postConnect(userid,password)}};function supportCur(){return!(agentInfo.isSafari||
agentInfo.isMobile&&agentInfo.isIOS||agentInfo.isMSIE&&agentInfo.msieVersion<=11&&agentInfo.msieOSVersion<=7)}function keepHTTPAlive(status){_comm.disposePing("HTTP.ALIVE");if(status){let url=helper.url.parseUrl(location.href).toUrl("-a-r")+(productId==="thinrdp"?TVNC.apiUrl+"auth/":"")+"ping?id="+TVNC.rcParams.id;_comm.createPing("HTTP.ALIVE",TVNC.completeAjaxParams({"url":url,"cache":false,"timeout":3E3,"error":function(){helper.console.warning("Cannot keep http alive, failed. ",arguments)},"success":function(){helper.console.log("Http alive, response",
arguments)},"intervalTime":6E4}))}}this.checkSizeAndResolution=function(callback){clearTimeout(_checkSizeAndResolutionTimeoutId);if(TVNC.rcParams.resolution=="fittobrowser")if(window.environment.detectedWidth==0||window.environment.detectedHeight==0)_checkSizeAndResolutionTimeoutId=setTimeout(TVNC.checkSizeAndResolution,250,callback);else callback();else callback()};function fireCustomEvent(eventName,response,jqXHR,err){try{if(helper.object.existsPath(TVNC.rcParams,helper.string.format("events.{0}",
eventName)))TVNC.rcParams.events[eventName](response,err);else{eventName=eventName.replace("on");eventName=eventName[0].toLowerCase()+s.substring(1);$(window).trigger(eventName,jqXHR,err)}}catch(error){helper.console.warning(helper.string.format("'{0}' calling attached method fail. message: {1}",eventName,error.message),error,arguments)}}function getDisplaysInfo(){let w=environment.availWidth;let h=environment.availHeight;let t=0;let displays=[{id:0,width:w,height:h,surface:{top:t,left:0},physicalWidth:w,
physicalHeight:h,orientation:environment.currentOrientation,desktopScaleFactor:1,deviceScaleFactor:1,mainDisplay:true,name:""}];return displays}function sendDisplaysInfo(displays){if(TVNC.rcParams.mode!==_eMode.SKEY){displays=getPurgedDisplayManagerInfo(displays);helper.console.log(`Sending browser displays info: ${JSON.stringify(displays)}`,arguments);let checkPending=function(){if(!_pendingDisplayResize){_pendingDisplayResize=displays;_pendingsCommandsCallback.push(function(){sendDisplaysInfo(_pendingDisplayResize);
_pendingDisplayResize=null})}else _pendingDisplayResize=displays};if(_comm)if(_comm.state===Thinfinity.Communication.state.CONNECTED){helper.console.log(`cmd=brwrRsze: ${JSON.stringify(displays)}`,arguments);TVNC.sendEvent("cmd=brwrRsze&ms="+encodeURIComponent(JSON.stringify(displays))+"&id="+TVNC.rcParams.id)}else{if(_comm.state<Thinfinity.Communication.state.CLOSING)checkPending()}else checkPending()}}function checkServerControlMouse(){TVNC.rcParams.overrideCursor=false;if(TVNC.rcParams.serverControlMouse)_allowMouseCapture=
false;else _allowMouseCapture=true}async function initializeDisplayManager(){if(_displayManager){helper.console.log(`Re-use device displays`,arguments);return true}else{var _prevResize=null;if(!!TVNC.rcParams.playsession){TVNC.rcParams.overrideCursor=false;TVNC.rcParams.allowMouseCapture=false;TVNC.rcParams.serverControlMouse=true}_oInterface=(new Thinfinity.Object.Interface({defaultEventFire:{async:0}})).new(new Thinfinity.Object.IConfig({namespace:true,options:[Thinfinity.Object.IConfig.OPTIONS.DO_NOT_FULL_EXTEND_OBJECT],
object:TVNC,properties:[{source:"rcParams.active",ro:true},{source:"rcParams.mouseControl",ro:true},{source:"mouseBuffer.isAvailable",alias:"mouseBufferAvailable",ro:true},{source:"rcParams.hookMouse",ro:true},{source:"rcParams.mousePressAsRightButton",ro:true},{source:"rcParams.cursorVisible",ro:true},{source:"rcParams.remotePointer",ro:true},{source:"rcParams.viewLeft",ro:true},{source:"rcParams.viewTop",ro:true},{source:"rcParams.enableH264",ro:true},{source:"rcParams.enableGfx",ro:true},{source:"rcParams.hookKeyboard",
ro:true},{source:"rcParams.kbdUnicode",ro:true},{source:"rcParams.kbdLogKeys",ro:true},{source:"onlyKeyCode",ro:true,get:function(){return _onlyKeyCode}},{source:"rcParams.isCrossDomain",ro:true},{source:"allowOverrideCursor",ro:true,get:function(){return allowOverrideCursor}},{source:"allowMouseCapture",ro:true},{source:"rcParams.overrideCursor",ro:false},{source:"centered",ro:true},{source:"rcParams.centeredMode",ro:true},{source:"border",ro:true,get:function(){return{left:TVNC.rcParams.borderLeft,
top:TVNC.rcParams.borderTop,right:TVNC.rcParams.borderRight,bottom:TVNC.rcParams.borderBottom}}},{source:"rcParams.playsession",ro:true},{source:"isServerControlMouse",ro:true,get:function(){return!!TVNC.rcParams.playsession||TVNC.rcParams.serverControlMouse}},{source:"rcParams.id",ro:true,alias:"sid"},{source:getClipboardInterface().iObject,ro:true,alias:"clipboard"},{source:"canPasteFiles",ro:true,get:function(){return productId=="thinrdp"}},{source:"rdpMode",ro:true},{source:"productId",ro:true,
get:function(){return window.productId}},{source:"rcParams.fitmode",ro:true},{source:"rcParams.fitToBrowser",ro:true},{source:"rcParams.rfxEnabled",ro:true},{source:"rcParams.overflow",ro:true},{source:"maxSize",ro:true,get:function(){return{width:TVNC.rcParams.maxWidth,height:TVNC.rcParams.maxHeight}}},{source:"serverDPR",ro:true,get:function(){return serverDPR}},{source:"CUEnabled",ro:true,get:function(){return _CUEnabled}},{source:"rcParams.quality",ro:true},{source:"rcParams.pixelFormat"},"baseZIndex",
{source:"cursorCanvasX",get:function(){if(TVNC.cursorCanvas){var position=TVNC.findPos(TVNC.vncContainer);let l=0;try{l=parseInt(TVNC.cursorCanvas.style.left.replace("px",""),10)}catch(err){l=TVNC.cursorCanvas.offsetLeft}return l*_displayManager.processDisplayCmd("GET_SCALE")+position[0]}else return TVNC.mouseX},ro:true},{source:"cursorCanvasY",get:function(){if(TVNC.cursorCanvas){var position=TVNC.findPos(TVNC.vncContainer);let t=0;try{t=parseInt(TVNC.cursorCanvas.style.top.replace("px",""),10)}catch(err){t=
TVNC.cursorCanvas.offsetTop}return t*_displayManager.processDisplayCmd("GET_SCALE")+position[1]}else return TVNC.mouseY},ro:true},{source:"pictureType",get:function(){return _ePictureType}},{source:"rcParams.shadowed",ro:true},{source:"rcParams.mouseWheelDirection",ro:true},{source:"rcParams.maxWidth",ro:true},{source:"rcParams.maxHeight",ro:true},{source:"rcParams.mouseX",ro:false},{source:"rcParams.mouseY",ro:false},{source:"rcParams.viewWidth"},{source:"rcParams.viewHeight"},{source:"rcParams.mouseMoved",
ro:false},{source:"caret",ro:true},{source:"rcParams.multiRowMinSize",ro:true},{source:"rcParams.caretX",ro:false},{source:"rcParams.caretY",ro:false},{source:"rcParams.relativeTouch",ro:true},{source:"rcParams.scaled",ro:true},{source:"rcParams.resizeDesktop",ro:true},{source:"rcParams.resolution",ro:true},{source:"rcParams.isShadowSession",ro:true},{source:"availableAudio",get:function(){return _audioDriver?.available??false}},{source:"mobileKeyboardEnumKeys",ro:true,get:()=>Thinfinity?.Driver?.MobileKeyboard?.enumKeys}],
methods:[{alias:"sendKey",value:TVNC.sendKey},{alias:"sendText",value:TVNC.sendText},{alias:"sendCmd",value:TVNC.sendCmd},{alias:"sendFocus",value:sendTabFocusCmd},{alias:"sendWheel",value:TVNC.sendWheel},{alias:"inputAllowed",value:TVNC.inputAllowed},{alias:"sendEvent",value:TVNC.sendEvent},{alias:"sendMouse",value:function mouseEvent(x,y,button,action){if(TVNC.mouseX!=x||TVNC.mouseY!=y)TVNC.mouseMoved=true;TVNC.mouseX=x;TVNC.mouseY=y;if(action!=="move")TVNC.sendMouse(x,y,button,action)}},{alias:"registerCanvas",
value:addValidCanvas},{alias:"fireEvent",value:function(event,data){if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events[event]==null)$(window).trigger(event,[data]);else TVNC.rcParams.events[event]([data])}},{alias:"updateCanvasSize",value:TVNC.updateCanvasSize},{alias:"removeDevice",value:function(id){_displayManager.removeDevice(id)}},{alias:"zoom",value:value=>{_displayManager.fireEvent("zoom",value)}},{alias:"sendWheel",value:TVNC.sendWheel},{alias:"forceMouseMove",value:()=>{TVNC.mouseMoved=
true;TVNC.sendMouseMove();TVNC.mouseMoved=false}},{alias:"pressAndRelease",value:(x,y)=>{TVNC.sendMouse(x,y,2,"down");TVNC.sendMouse(x,y,2,"up");_displayManager.fireEvent("pressAndRelease",x,y)}}],events:{resize:function(displays){if(_prevResize!==displays)sendDisplaysInfo(displays);_prevResize=displays},disconnect:function(){Thinfinity.Popups.unblock();TVNC.disconnect()}}}));TVNC=_oInterface.original;if(productId==="thinvnc"){_oInterface.new.on("rcParams.serverControlMouse",checkServerControlMouse);
checkServerControlMouse()}let username="";let isSessionKey=TVNC.rcParams.mode===_eMode.SKEY;if(isSessionKey){TVNC.rcParams.enableH264=Thinfinity.global.variables.H264Enabled=="true";TVNC.rcParams.enableGfx=Thinfinity.global.variables.GfxEnabled=="true"&&!TVNC.rcParams.enableH264}let displayConfig=isSessionKey?{db:false,shadowingSession:true}:{username:username,model:TVNC.rcParams.profileKey};displayConfig.methods={sendCmd:TVNC.sendCmd};displayConfig.canBeOverridden=TVNC.rcParams?.multiMonitor?.canBeOverridden||
false;displayConfig.count=TVNC.rcParams?.multiMonitor?.count||1;_displayManager=new Thinfinity.Display.Manager(displayConfig,_oInterface.new);if(TVNC.rcParams.enableH264)_displayManager.limits={min:{width:800,height:600}};Object.defineProperty(TVNC,"zoomFactor",{enumerable:true,configurable:false,get:function(){return _displayManager.processDisplayCmd("GET_ZOOM_FACTOR")},set:function(value){return _displayManager.processDisplayCmd("SET_ZOOM_FACTOR",value)}});delete TVNC.getZoom;Object.defineProperty(TVNC,
"getZoom",{enumerable:true,configurable:false,writable:false,value:function(){return _displayManager.processDisplayCmd("GET_ZOOM_FACTOR")}});Object.defineProperty(TVNC,"zoomDesktop",{enumerable:true,configurable:false,writable:false,value:function(value){return _displayManager.processDisplayCmd("ZOOM_DESKTOP",value)}});Object.defineProperty(TVNC,"cursorCanvas",{enumerable:true,configurable:false,get:function(value){return _displayManager.processDisplayCmd("CURSOR_CANVAS")}});Object.defineProperty(TVNC,
"getMinZoomFactor",{enumerable:true,configurable:false,writable:false,value:function(){return _displayManager.processDisplayCmd("GET_MIN_ZOOM_FACTOR")}});Object.defineProperty(TVNC,"center",{enumerable:true,configurable:false,writable:false,value:function(){return _displayManager.processDisplayCmd("CENTER")}});Object.defineProperty(TVNC,"scale",{enumerable:true,configurable:false,get:function(){return _displayManager.processDisplayCmd("GET_SCALE")}});Object.defineProperty(TVNC,"getScale",{enumerable:true,
configurable:false,writable:false,value:function(){return _displayManager.processDisplayCmd("GET_SCALE")}});Object.defineProperty(TVNC,"zoomFactorReset",{enumerable:true,configurable:false,writable:false,value:function(){return _displayManager.processDisplayCmd("ZOOM_FACTOR_RESET")}});await _displayManager.sync();var createDisplayDevice=function(config){let mon={resolution:Thinfinity.Display.Device.RESOLUTION.FIT_TO_BROWSER,orientation:environment.currentOrientation,desktopScaleFactor:1,deviceScaleFactor:1,
mainDisplay:false,external:true,height:environment.availHeight,width:environment.availWidth,surface:{left:0,top:0},window:null};helper.object.parseAttributes(mon,config);return new Thinfinity.Display.Device(mon)};triggerCustomEvent("display.manager.ready");let displays=null;let restoreData=null;if(!isSessionKey){if(agentInfo.h264&&TVNC.rcParams.enableH264&&_displayManager)displays=_displayManager.getStoredConfiguration();helper.console.log(`recovering stored data: ${displays?JSON.stringify(displays):
"is empty"}`);if(!displays)restoreData=triggerCustomEvent("display.manager.restore.display.info")}else{TVNC.registerOOBCmd("monitorDefs",function(data){if(data?.monitorDefs?.items)_displayManager.syncDisplayInfo(data.monitorDefs.items)});_displayManager.on("syncCompleted",function(){setTimeout(function(){TVNC.refresh()},5E3)})}_displayManager.on("createCanvas",TVNC.createCanvas);if(!displays)displays=getDisplaysInfo();if(restoreData){helper.console.log(`getting displays from profile`);return await restoreData()}else{helper.console.log(`creating monitors...`);
let m=displays.find(function(d){return d.mainDisplay});m.parentElement=document.getElementById("deskdiv");if(displays){var proms=[];displays.forEach(async function(d){proms.push(_displayManager.addDevice(createDisplayDevice(d)))});let values=await Promise.all(proms);let any=false;var blockedMsg=null;values.forEach(function(res){if(res&&res.code!==Thinfinity.Display.Manager.RESPONSE_CODES.SUCCESS){if(res.code===Thinfinity.Display.Manager.RESPONSE_CODES.POPUP_BLOCKED)blockedMsg=res.message;helper.console.warning(`Something went wrong. ${res.message}`,
arguments)}else any=true});if(blockedMsg)values=await _displayManager.restoreDevices();return any}else throw new Error(`Cannot access to screens details.`);}}}function getPurgedDisplayManagerInfo(displays){if(!displays)displays=_displayManager.getDisplaysInfo();if(displays)displays.forEach(function(m){delete m.window;delete m.resolution;delete m.name;m.width=m.display.width;m.height=m.display.height;delete m.display;delete m.screen;if(m.surface){m.left=m.surface.left;m.top=m.surface.top}delete m.surface});
return displays}function postConnect(userid,password){BTP_PCS_STR=null;if(_isDisconnecting)return;TVNC.checkSizeAndResolution(function(){BTP_PCS_END=null;if([Thinfinity.Communication.state.READY,Thinfinity.Communication.state.SERVERCONNECTED,Thinfinity.Communication.state.RECONNECTING,Thinfinity.Communication.state.UNSTABLE,Thinfinity.Communication.state.LOST].indexOf(_comm.state)!=-1){TVNC.cacheLoaded=false;TVNC.startCmdToSend=false;if(TVNC.rcParams.profileKey)TVNC.initfs(TVNC.rcParams.profileKey);
else{var dbname=TVNC.rcParams.address||"";if(dbname==""||productId.toLowerCase()=="webfmx"||productId.toLowerCase()=="virtualui")TVNC.initfs(productId+"_dev");else{dbname=dbname.replace(".","_").replace(":","_");TVNC.initfs(dbname)}}try{if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onServerAuthenticationRequired==null)$(window).trigger("serverAuthenticationRequired");else TVNC.rcParams.events.onServerAuthenticationRequired()}catch(error){helper.console.warning("'onServerAuthenticationRequired' calling attached method fail. message: "+
error.message,error,arguments)}if(typeof userid=="undefined"&&TVNC.rcParams.userid!=null)userid=TVNC.rcParams.userid;if(typeof password=="undefined"&&TVNC.rcParams.password!=null)password=TVNC.rcParams.password;var cmd="cmd";var jsonQuery={};jsonQuery.cmd="connect";if(typeof userid!="undefined"){jsonQuery.userid=escape(userid);TVNC.userid=userid;if(typeof password!="undefined"){jsonQuery.password=escape(password);TVNC.password=password}}jsonQuery.tabid=_getServerUrl.id;jsonQuery.wscompression=TVNC.rcParams.wscompression;
if(TVNC.rcParams.ticket!="")jsonQuery.ticket=TVNC.rcParams.ticket;if(TVNC.rcParams.pin!="")jsonQuery.pin=TVNC.rcParams.pin;if(TVNC.rcParams.sessionKey!="")jsonQuery.sessionKey=TVNC.rcParams.sessionKey;if(TVNC.rcParams.externalId!="")jsonQuery.externalId=TVNC.rcParams.externalId;jsonQuery.destAddr=TVNC.rcParams.address;if(TVNC.rcParams.scraper!=null){jsonQuery.scraper=TVNC.rcParams.scraper;if(TVNC.rcParams.scraperArgs!=null)if(helper.object.getDataTypeOf(TVNC.rcParams.scraperArgs)=="json")helper.object.merge(TVNC.rcParams.scraperArgs,
jsonQuery,true);else TVNC.rcParams.scraperArgs.split("&").forEach(function(kvp){kvp=kvp.split("=");jsonQuery[kvp[0]]=kvp[1]})}jsonQuery.screenWidth=window.screen?.width||window.environment.rawWidth;jsonQuery.screenHeight=window.screen?.height||window.environment.rawHeight;if(typeof window.orientation=="undefined")window.orientation=90;jsonQuery.orientation=window.orientation;if(typeof TVNC.rcParams.lfn!="undefined"&&TVNC.rcParams.lfn!=null&&TVNC.rcParams.lfn!="")jsonQuery.lfn=TVNC.rcParams.lfn;if(TVNC.rcParams.resolution!=
"fixed"){var bw=window.environment.detectedWidth;var bh=window.environment.detectedHeight;if(helper.object.existsPath(self,"clientSettings.UseViewportSize")&&self.clientSettings.UseViewportSize){bw=window.environment.viewportWidth;bh=window.environment.viewportHeight}jsonQuery.browserWidth=bw;jsonQuery.browserHeight=bh}jsonQuery.ogg=true;jsonQuery.supportCur=supportCur();jsonQuery.gfx=agentInfo.gfx;jsonQuery.h264=agentInfo.h264;var callConnect=function(){if(_displayManager){jsonQuery.decoderType=
0;jsonQuery.buffersize=agentInfo.isMobile?22:100;let di=JSON.stringify(getPurgedDisplayManagerInfo());helper.console.log(`Sending monitors info: ${di}`,arguments);jsonQuery.monitors=di}var oturlpass=sessionStorage.getItem("oturlDataPass");if(oturlpass)jsonQuery.oturlpass=oturlpass;var url=_url.httpConnection+cmd+"?cmd=connect";if(TVNC.rcParams.id!=null)url+="&id="+TVNC.rcParams.id;if(TVNC.rcParams.sessionKey)url+="&sessionkey="+TVNC.rcParams.sessionKey;jsonQuery.id=TVNC.rcParams.id;var isLandscape=
window.environment.currentOrientation=="landscape"?true:false;jsonQuery.devicePixelRatio=window.environment.initialDevicePixelRatio||1;jsonQuery.isMobile=agentInfo.isMobile;jsonQuery.isLandscape=isLandscape;jsonQuery.supportsFullScreen=window.environment.supportsFullScreen;jsonQuery.webapp=window.environment.webapp;if(Thinfinity.VirtualChannels&&Thinfinity.VirtualChannels.localServer){jsonQuery.localServer=true;jsonQuery.channelList=Thinfinity.VirtualChannels.getRegisteredNodes(Thinfinity.VirtualChannels.ChannelOrigin.CLIENT).join(",")}var params=
{url:TVNC.getCrossDomainUrl(TVNC.addExtraParams(url)),dataType:helper.ajax.responseType.JSON,data:JSON.stringify(jsonQuery),timeout:7E4,withCredentials:true,error:function(err,status,jqXHR){_comm.serverConnected=false;var XHRstatus=jqXHR.status;BTP_PCR_ERR3=null;var strMsg=helper.string.sprintf(consts.connAttemptFailed,"\nHTTP status code "+jqXHR.status+" "+jqXHR.statusText);if(XHRstatus>=400)helper.console.warning(`${strMsg} - ${jqXHR.responseType==="json"?jqXHR.statusText:jqXHR.responseText}`);
else if(XHRstatus===0){strMsg=consts.urlCantReached+" "+consts.tryingAgain;updateConnectionStatus({"description":strMsg,"errstr":strMsg});window.setTimeout(function(){if(_comm.state<=Thinfinity.Communication.state.CLOSING&&!_isDisconnecting)TVNC.connect()},_restartConnectTimeout);return}else connection.first404IncomingTime=null;TVNC.xmlHttpJson=null;if(_comm.state<=Thinfinity.Communication.state.LOST&&(_fromBroker||XHRstatus==404)){BTP_PCR_RTY=null;helper.console.log("Connect was fail, trying to connect again. ");
window.setTimeout(function(){TVNC.connect()},_restartConnectTimeout)}else{TVNC.closeReconnectDiv();fireCustomEvent("onServerConnectionError",strMsg,jqXHR,err)}},success:function(data,status,jqXHR){if((jqXHR.getResponseHeader("content-type")||"").indexOf("text/html")!=-1){BTP_PCR_ERR4=null;reloadWnd();return}connection.first404IncomingTime=null;TVNC.xmlHttpJson=null;TVNC.onConnectResult(data)}};BTP_PCR_STR=null;serverCmdResultOrientation=null;TVNC.xmlHttpJson=_comm.post(TVNC.completeAjaxParams(params));
if(_comm.state===Thinfinity.Communication.state.RECONNECTING)fireCustomEvent("onServerConnecting",{"reconnecting":Thinfinity.Communication.state.getKey(_comm.state).toString()})};initializeDisplayManager().then(function(res){if(res)callConnect();else{let msg=consts.displayCannotBeInitialized;helper.console.warning(msg,arguments);msg+=`</br><button id="btnClose" onclick="window.location.href= "/";let btn = document.getElementById('btnClose'); btn.parentElement.removeChild(btn);">Close this window</button>`;
document.body.innerText="";helper.dom.appendJsonElement({"parentElement":document.body,"type":"div","attributes":{"class":"bye"},"content":msg});setTimeout(function(){window.location.href="/"},15E3)}}).catch(function(err){helper.console.warning(`${consts.displayManagerError} - ${err.message||err} - ${err.stack||""}`,arguments)})}else{var msg=helper.string.sprintf(consts.connAttemptFailed,"");fireCustomEvent("onServerConnectionError",msg);helper.console.warning(helper.string.format(msg+" - state: {0}",
Thinfinity.Communication.state.getKey(_comm.state).toString()),arguments)}})}function updateConnectionStatus(status){helper.console.log(JSON.stringify(status),arguments);status.reconnecting=connection.fromReconnection;try{if(status.errno===undefined)if(helper.object.existsPath(TVNC,"rcParams.events.onServerConnecting"))TVNC.rcParams.events.onServerConnecting(status);else $(window).trigger("serverConnecting");else if(helper.object.existsPath(TVNC,"rcParams.events.onServerConnectionError"))TVNC.rcParams.events.onServerConnectionError(status.errstr);
else $(window).trigger("serverConnectionError")}catch(error){helper.console.warning("'onServerConnecting' calling attached method fail. message: "+error.message,error,arguments)}}this.addExtraParams=function(url){return url};function reloadWnd(){$(window).off("onbeforeunload");_comm.dispose();window.onbeforeunload=e=>{return};setTimeout(function(){window.location.reload()},1E3)}this.getServerUrl=function(callback){if(callback&&_comm.state<=Thinfinity.Communication.state.CLOSING){if(_getServerUrl.forceNewRedirection)_getServerUrl.forceNewRedirectionUsed=
true;var gsUrl=TVNC.addExtraParams(_virtualPathProfile+"getServerUrl?id=")+_getServerUrl.id+(_getServerUrl.forceNewRedirection?"&forceNewRedirection=true":"");gsUrl+="&preferredBrokerId="+(sessionStorage.getItem(_preferredBrokerKey)||"");helper.console.log(helper.string.format("get server url {0}",gsUrl),arguments);let callTimeout=true;_comm.send({url:gsUrl,async:true,dataType:"json",timeout:3E4,success:function(obj){if(_comm.state<=Thinfinity.Communication.state.CLOSING)try{if(!obj)obj={"state":STATE_PENDING};
var er=false;var status={"state":obj.state,"description":consts.resolving};_getServerUrl.timeout=_getServerUrl.normal_timeout;if(obj.state==STATE_PENDING&&obj.vmcode&&obj.vmtext){_getServerUrl.timeout=_getServerUrl.vm_timeout;status.description=obj.vmtext}else if(obj.state==STATE_BUSY)status.description=consts.waitingForResources;else{if(obj.rdpInfo)switch(obj.rdpInfo.action){case RDP_NO_INFO:break;case RDP_LOGIN_START:status.description=consts.initializingSession;break;case RDP_LOGIN_END:status.description=
consts.sessionInitialized;break;case RDP_LOGIN_INFO:status.description=obj.rdpInfo.errstr;break;case RDP_LOGIN_ERROR:{status.description=consts.sessionInitializationError;status.errno=obj.rdpInfo.errno;status.errstr=obj.rdpInfo.errstr;er=true}}if(obj.redirect){_getServerUrl.forceNewRedirection=false;status.description=consts.connecting;updateConnectionStatus(status);callback({"url":obj.url,"gateway":obj.gateway,"brokerid":obj.brokerid||""});return}}if(!er&&obj.errmsg!=""&&obj.state==STATE_ERROR){status.description=
status.errstr=obj.errmsg;status.errno=obj.state;helper.console.warning(helper.string.format("Cannot connect - error: {0} - state: {1} - reload: {2}",status.description,obj.state,obj.refresh==undefined?"''":obj.refresh),arguments);if(obj.refresh){reloadWnd();return}}if(_comm.state!==Thinfinity.Communication.state.RECONNECTING)updateConnectionStatus(status);callback(status);if(obj.state!=STATE_ERROR)setTimeout(function(){TVNC.getServerUrl(callback)},_getServerUrl.timeout)}catch(e){status={"action":4,
"description":e.message};if(_comm.state!==Thinfinity.Communication.state.RECONNECTING)updateConnectionStatus(status);callback(status)}else callback({"description":consts.connectionNotStablished,"errno":Thinfinity.Communication.errorCode.NO_CONTENT,"errstr":consts.connectionNotStablished})},error:function(response,status,xhr){var XHRStatus=status??xhr.status;var status={"state":STATE_ERROR,"errno":XHRStatus,"description":"","errstr":""};var errstr=xhr.statusText&&xhr.statusText!=""?" ("+xhr.statusText+
")":"EMPTY";helper.console.log(helper.string.format("Error --\x3e getServerUrl - status: {0}",errstr),arguments);_gettingSeverUrl=false;if(_xhrStatusExitCodes.indexOf(XHRStatus)!=-1){switch(XHRStatus){case Thinfinity.Communication.errorCode.UNAUTHORIZED:status.errstr=consts.unknownUser;reloadWnd();break;default:status.description=consts.sessionInitializationError;status.errstr=errstr!=""?errstr:status.description;break}if(_comm.state!=Thinfinity.Communication.state.RECONNECTING)updateConnectionStatus(status);
callback(status);return}else switch(XHRStatus){case Thinfinity.Communication.errorCode.NOT_FOUND:if(TVNC.observable.isOTURLSession)if(_getServerUrl.retriesCount<_getServerUrl.oturlMaxRetries)_getServerUrl.retriesCount++;else{_getServerUrl.forceNewRedirection=false;TVNC.rcParams.events.onServerConnectionError(consts.invalidTicket);return}else{if(connection.reconnectingCount>connection.reconnectingMax){callTimeout=false;let recallGetServerUrl=function(){connection.reconnectingCount=0;TVNC.getServerUrl(callback)};
fetch(_url.baseUrl).then(res=>{if(res.status===200&&res.url.indexOf("/?signin")!==-1)reloadWnd();else setTimeout(recallGetServerUrl,2E3)}).catch(err=>{setTimeout(recallGetServerUrl,2E3)})}connection.reconnectingCount+=1}break}if(callTimeout)setTimeout(function(){TVNC.getServerUrl(callback)},2E3)}});_getServerUrl.forceNewRedirection=false}};this.ping=function(url,error,success,fnconnect){if(url.lastIndexOf("/")!=url.length-1)url+="/";url+="ping?xxx";_comm.send(TVNC.completeAjaxParams({url:TVNC.addExtraParams(url),
dataType:_defaultResponseType,async:false,cache:false,timeout:1E3,error:function(){if(helper.object.validate(error))error()},success:function(){var pathArray=url.split("/");TVNC.rcParams.protocol=pathArray[0];TVNC.rcParams.server=pathArray[2];if(helper.object.validate(success))success();fnconnect()}}))};this.onConnectResult=function(data){TVNC.xmlHttpJson=null;TVNC.connecting=false;TVNC.allowMouse=true;TVNC.closeReconnectDiv();let tryToConnectAgain=()=>{_connectResult.count++;if(_connectResult.count<
_connectResult.max)TVNC.reconnect();else try{let msg=consts.sessionInitializationError;if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onServerConnectionError==null)$(window).trigger("serverConnectionError",msg);else TVNC.rcParams.events.onServerConnectionError(msg);helper.console.warning(`connect result data is empty or null`);TVNC.disconnect();TVNC.dispose()}catch(error){helper.console.error("'onServerConnectionError' calling attached method fail.",error,arguments)}};if(data!=
""&&data)try{_comm.serverConnected=true;var doConnect=function(){if(!obj.id){let err=new Error(`Session ID is not valid: ${obj.id}`);helper.console.error(err.message,err,arguments)}if(obj.id&&TVNC.rcParams.id!=obj.id){ID.set(obj.id);TVNC.rcParams.id=obj.id;TVNC.removeCanvases();if(_fromBroker)keepHTTPAlive(true)}initializeImageQueue(obj.id);let objInstace=obj;let continueConnectResult=function(){obj=objInstace;if((connection.firstConnection||TVNC.wsEnabled)&&!TVNC.rcParams.forceAjax&&("WebSocket"in
window||"MozWebSocket"in window)){TVNC.connectWebSocket(false);if(obj.wolEnabled===true)_comm.wsWOL(true)}else{BTP_PA_STR=null;_comm.setChunkHandlers({"url":TVNC.addExtraParams("json?id="+TVNC.rcParams.id),"id":TVNC.rcParams.id,"success":ajaxSuccessHandler,"error":ajaxErrorHandler});_comm.start();TVNC.start()}connection.firstConnection=false;try{if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onServerConnect==null)$(window).trigger("serverConnect",obj);else TVNC.rcParams.events.onServerConnect(obj)}catch(error){helper.console.warning("'onServerConnect' calling attached method fail. message: "+
error.message,error,arguments)}};if(TVNC.rcParams.mode===_eMode.SKEY&&_displayManager&&obj?.monitorDefs?.items)if(TVNC.rcParams.events?.onDisplayInteractionRequired)TVNC.rcParams.events.onDisplayInteractionRequired(obj,continueConnectResult);else continueConnectResult();else continueConnectResult()};var redirecting=false;var obj=TVNC.crossDomain()?data:typeof data!="object"?JSON.parse(data):data;BTP_PCR_END1=null;if(obj.status&&typeof obj.status!="undefined"){if(obj.connectUrl){redirecting=true;TVNC.ping(obj.connectUrl,
function(e){if(obj.connectUrl2)TVNC.ping(obj.connectUrl2,function(e){if(obj.connectPin)_url.baseUrl="/"+obj.connectPin;else try{if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onServerRedirect==null)$(window).trigger("serverRedirect",[obj.connectUrl,obj]);else TVNC.rcParams.events.onServerRedirect(obj.connectUrl,obj)}catch(error){helper.console.warning("1 - 'onServerRedirect' calling attached method fail. message: "+error.message,error,arguments)}doConnect()},function(e){if(obj.connectPin)_url.baseUrl=
"/"+obj.connectPin;else try{if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onServerRedirect==null)$(window).trigger("serverRedirect",[obj.connectUrl2,obj]);else TVNC.rcParams.events.onServerRedirect(obj.connectUrl2,obj)}catch(error){helper.console.warning("2 - 'onServerRedirect' calling attached method fail. message: "+error.message,error,arguments)}},doConnect);else{if(obj.connectPin)_url.baseUrl="/"+obj.connectPin;else try{if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onServerRedirect==
null)$(window).trigger("serverRedirect",[obj.connectUrl,obj]);else TVNC.rcParams.events.onServerRedirect(obj.connectUrl,obj)}catch(error){helper.console.warning("3 - 'onServerRedirect' calling attached method fail. message: "+error.message,error,arguments)}doConnect()}},function(){try{if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onServerRedirect==null)$(window).trigger("serverRedirect",[obj.connectUrl,obj]);else TVNC.rcParams.events.onServerRedirect(obj.connectUrl,obj)}catch(error){helper.console.warning("4 - 'onServerRedirect' calling attached method fail. message: "+
error.message,error,arguments)}},doConnect)}else if(obj.connectPin)_url.baseUrl="/"+obj.connectPin;if(!redirecting)doConnect()}else if(obj.authStatus==3)try{if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onServerAuthenticationFailed==null)$(window).trigger("serverAuthenticationFailed",obj.errormsg);else TVNC.rcParams.events.onServerAuthenticationFailed(obj.errormsg)}catch(error){helper.console.warning("'onServerAuthenticationFailed' calling attached method fail. message: "+error.message,
error,arguments)}else if(obj.authStatus==4)try{BTP_PT_NC=null;if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onServerNeedCredentials==null)$(window).trigger("serverNeedCredentials",{"credentials":obj.credentials});else TVNC.rcParams.events.onServerNeedCredentials({"credentials":obj.credentials})}catch(error){helper.console.warning("'onServerNeedCredentials' calling attached method fail. message: "+error.message,error,arguments)}else if(obj.errormsg)if(obj.license){if(TVNC.connected)TVNC.disconnect();
let licenseError={title:consts.licenseError,errorType:_licenseTypes.ERR_TYPE_ERROR,errorCode:obj.state||1,errorMsg:obj.errormsg};if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onLicenseMsg==null)$(window).trigger("licenseMsg",licenseError);else TVNC.rcParams.events.onLicenseMsg(licenseError)}else{var idZero=typeof obj!="undefined"&&obj["id"]=="0";if(idZero&&!connection.fromReconnection){TVNC.disconnect();TVNC.dispose(undefined,{"code":-1,"message":obj.errormsg})}try{if(typeof TVNC.rcParams.events==
"undefined"||TVNC.rcParams.events.onServerConnectionError==null)$(window).trigger("serverConnectionError",helper.string.sprintf(consts.connAttemptFailed,obj.errormsg));else TVNC.rcParams.events.onServerConnectionError(helper.string.sprintf(consts.connAttemptFailed,obj.errormsg))}catch(error){helper.console.error("'onServerConnectionError' calling attached method fail.",error,arguments)}if(!idZero&&_comm.state!==Thinfinity.Communication.state.RECONNECTING){var status={"code":_enumCloseStatusReason.ERROR,
"message":obj.errormsg};if(productId=="ZSC")TVNC.dispose(false,status);else TVNC.dispose(undefined,status)}else if(idZero)return;else{clearTimeout(timeoutIdBeforeReconnect);timeoutIdBeforeReconnect=setTimeout(function(){TVNC.reconnect()},timeBeforeReconnect)}}else if(obj.id=="lnk"){TVNC.disconnect();TVNC.dispose();window.location.href=obj.url;return}else tryToConnectAgain();obj=null}catch(err){var msg=err;if(err.message)msg=err.message;logError("serverConnectionError: "+msg);try{if(typeof TVNC.rcParams.events==
"undefined"||TVNC.rcParams.events.onServerConnectionError==null)$(window).trigger("serverConnectionError",msg);else TVNC.rcParams.events.onServerConnectionError(msg)}catch(error){helper.console.error("'onServerConnectionError' calling attached method fail.",error,arguments)}}else tryToConnectAgain()};this.gup=function(name){var regex=new RegExp("[\\?&]"+name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]")+"=([^&#]*)","ig");var results=regex.exec(window.location.href);regex=null;if(results==null)return"";
else return results[1]};this.refresh=function(){TVNC.removeCanvases();_displayManager.fireEvent("resetCursor");TVNC.sendCmd("cmd=refresh")};function ajaxSuccessHandler(data){errorOccurs=0;TVNC.xmlHttpJson=null;if(data!=""&&data)try{if(typeof data.oob!="undefined"){TVNC.fireOOBCmd(data.cmd,data);setTimeout(TVNC.reload,1)}else{data.imgQueue=TVNC.imgQueue;TVNC.msgQueue.push(data);TVNC.buildImgQueue(data);TVNC.processNextScreen();data=null}}catch(err){logError("ajax error: "+err+"\n"+data)}else helper.console.warning("No data on success")}
function ajaxErrorHandler(e,xhr){if(TVNC.xmlHttpJson){TVNC.xmlHttpJson.abort();TVNC.xmlHttpJson=null}if(xhr.status==0&&xhr.statusText=="timeout")restart(true);else if(xhr.status==404)TVNC.connect();else setTimeout(TVNC.reload,1)}this.reload=function(){if(_comm.state>=Thinfinity.Communication.state.CLOSING)return;if(TVNC.useAjax)_comm.getNextChunk();else TVNC.sendAck()};this.clearMouse=function(){this.mouseMoved=false};this.wsSend=function(query,type,data){_comm.wsSend(query,type,data)};this.sendEvent=
function(query,jData){if(_comm.protocol===Thinfinity.Communication.protocol.WEBSOCKET)_comm.wsSend(query);else if(_comm.state<Thinfinity.Communication.state.UNSTABLE)_comm.send(TVNC.completeAjaxParams({"queueName":this.queueRequestName,"url":TVNC.addExtraParams(_url.httpConnection+"cmd?"+query),"async":true,"dataType":_defaultResponseType}));if(_registeredEventsServicesList[_enumEventsServices.SENDEVENT]&&jData){jData.timeStamp=(new Date).getTime();_registeredEventsServicesList[_enumEventsServices.SENDEVENT](jData)}};
this.sendKey=function(key,ch,action,location){if(TVNC.rcParams.active&&TVNC.rcParams.kbdControl)if(typeof TVNC.rcParams.events!="undefined"&&TVNC.rcParams.events.onSendKeys!=null)try{TVNC.rcParams.events.onSendKeys(key,ch,action)}catch(error){helper.console.error("'onSendKeys' calling attached method fail.",error,arguments)}else{if(TVNC.rcParams.kbdLogKeys===true)logDebug("sendKey("+key+", "+ch+", "+action+")");var jData={"cmd":"keyb","key":key,"action":action,"id":TVNC.rcParams.id,"char":escape(ch)};
var cmd="cmd=keyb&key="+key+"&action="+action+"&id="+TVNC.rcParams.id+"&char="+escape(ch);if(typeof location!="undefined"){cmd+="&location="+location;jData.location=location}TVNC.sendEvent(cmd,jData)}};this.sendFunctionKey=function(key){if(TVNC.rcParams.active&&TVNC.rcParams.kbdControl){var jData={"cmd":"fkey","key":encodeURIComponent(key),"id":TVNC.rcParams.id};TVNC.sendEvent("cmd=fkey&key="+encodeURIComponent(key)+"&id="+TVNC.rcParams.id,jData)}};this.sendText=function(text){for(var c=0;c<text.length;c++){TVNC.sendKey(0,
text.charCodeAt(c),"down",0);TVNC.sendKey(0,text.charCodeAt(c),"up",0)}};this.sendKeyStroke=function(key){TVNC.sendKeyDown(key);TVNC.sendKeyUp(key)};this.sendKeyDown=function(key){TVNC.sendKey(key,0,"down",0)};this.sendKeyUp=function(key){TVNC.sendKey(key,0,"up",0)};this.sendCtrlAltDel=function(){TVNC.sendFunctionKey("CtrlAltDel")};this.sendShiftCtrlEsc=function(){TVNC.sendFunctionKey("ShiftCtrlEsc")};this.sendShellExplorer=function(){TVNC.sendFunctionKey("WindowsExplorer")};this.sendShellRun=function(){TVNC.sendFunctionKey("Run")};
this.sendCtrlEsc=function(){TVNC.sendFunctionKey("CtrlEsc")};this.sendCut=function(){TVNC.sendFunctionKey("Cut")};this.sendCopy=function(){TVNC.sendFunctionKey("Copy")};this.sendPaste=function(){TVNC.sendFunctionKey("Paste")};this.translateMouseCoordX=function(x){return x};this.translateMouseCoordY=function(y){return y};this.sendMouse=function(x,y,button,action){if(TVNC.rcParams.active&&TVNC.rcParams.mouseControl&&TVNC.allowMouse){if(TVNC.useAjax&&action=="move"&&_comm.queueLength(TVNC.queueRequestName)>
0)return;TVNC.clearMouse();TVNC.lastMouseAction=action;x=parseInt(x,10)+TVNC.rcParams.viewLeft;y=parseInt(y,10)+TVNC.rcParams.viewTop;var tx=TVNC.translateMouseCoordX(x);var ty=TVNC.translateMouseCoordY(y);var jData={"cmd":"mouse","x":tx,"y":ty,"btn":button,"action":action,"id":TVNC.rcParams.id};TVNC.sendEvent("cmd=mouse&x="+tx+"&y="+ty+"&btn="+button+"&action="+action+"&id="+TVNC.rcParams.id,jData)}};this.sendMouseQueue=function(){clearTimeout(_mouseQueueTimeout);if(TVNC.rcParams.active&&TVNC.rcParams.mouseControl&&
TVNC.allowMouse){if(mouseBuffer.queue.length>0){var buffer=mouseBuffer.queue;if([Thinfinity.Communication.state.RECONNECTING,Thinfinity.Communication.state.UNSTABLE,Thinfinity.Communication.state.LOST].indexOf(_comm.state)!=-1)for(var i=buffer-length-1;i>=0;i--)if(buffer[i].action=="move"){var temp=buffer[i];buffer=[];buffer.push(temp);break}TVNC.lastMouseAction=buffer[buffer.length-1].action;var sBuffer=JSON.stringify(buffer);TVNC.sendEvent("cmd=mouse&data="+sBuffer+"&id="+TVNC.rcParams.id,{"cmd":"mouse",
"data":sBuffer,"id":TVNC.rcParams.id});mouseBuffer.queue=[]}_mouseQueueTimeout=setTimeout(TVNC.sendMouseQueue,10)}};this.sendMouseMove=function(){clearTimeout(_mouseQueueTimeout);if(TVNC.rcParams.active&&TVNC.rcParams.mouseControl&&!_avoidSendMouseMove){if(TVNC.mouseMoved)TVNC.sendMouse(TVNC.mouseX,TVNC.mouseY,0,"move");else if(TVNC.lastMouseAction=="move")TVNC.lastMouseAction="";_mouseQueueTimeout=setTimeout(TVNC.sendMouseMove,TVNC.rcParams.mouseMoveProcessInterval)}};this.sendWheel=function(deltaY,
deltaX){if(TVNC.rcParams.active&&TVNC.rcParams.mouseControl){var action="";var delta=0;if(deltaY!=0){action="wheel";delta=deltaY*_deltaYMultiplier}else{action="hwheel";delta=deltaX}var jData={"id":TVNC.rcParams.id,"action":action,"delta":delta};if(mouseBuffer.isAvailable)mouseBuffer.queue.push(jData);else TVNC.sendEvent("cmd=mouse&id="+TVNC.rcParams.id+"&action="+action+"&delta="+delta,jData)}};this.IsNumKey=function(code){return code>=96&&code<=111&&code!=108||code==144};this.isIMEKey=function(e){return(e.which||
e.keyCode)==229};this.isMacAltKey=function(e){return this.mac&&e.altKey};this.IsFunctionKey=function(keyCode){return keyCode>=112&&keyCode<=123||keyCode>=33&&keyCode<=40||keyCode>=45&&keyCode<=46||keyCode>=16&&keyCode<=20||keyCode>=91&&keyCode<=93||keyCode==13||keyCode==9||keyCode==8||keyCode==27||keyCode==144||keyCode==12||keyCode==224};this.hookKM=function(){if(!TVNC.MouseHooked){TVNC.MouseHooked=true;if(TVNC.rcParams.hookMouse);TVNC.bindKeyboardEvents()}};this.clearKbdMacInputTimer=function(){window.clearInterval(this.kbdMacInputTimer);
this.kbdMacInputTimer=null};this.inputAllowed=function(e){if(e&&_preventKeys.available)if(_preventKeys.keys[e.keyCode]){var modifiers=_preventKeys.keys[e.keyCode];var prevent=true;for(var mk in modifiers){prevent&=e[mk]===modifiers[mk];if(!prevent)break}if(prevent)return false}var isUIBlocked=$(".blockUI.blockOverlay:visible").length>0;var isIndex=false;if(productId=="ZSC"){if(emulcont==null)emulcont=document.getElementById("emulcont");if(emulcont&&parseInt(emulcont.style.left.replace("px",""),10)>
0)isIndex=true}return _comm.state<Thinfinity.Communication.state.UNSTABLE&&!isUIBlocked&&!isIndex&&(!TVNC.rcParams.useFocus||TVNC.inputEnabled)};this.bindKeyboardEvents=function(){TVNC.inputEnabled=true;if(TVNC.rcParams.hookKeyboard)if(TVNC.KeyboardHooked)_displayManager.focus();else{if(agentInfo.isMobile&&productId=="ZSC")return;TVNC.KeyboardHooked=true}};this.unbindKeyboardEvents=function(){TVNC.inputEnabled=false};this.mouseDown=function(x,y,button){_displayManager.fireEvent("mouseDown",x,y,button,
{async:false})};this.mouseUp=function(x,y,button){_displayManager.fireEvent("mouseUp",x,y,button,{async:false})};this.mouseMove=function(x,y){_displayManager.fireEvent("mouseMove",x,y,{async:false})};this.setFocus=function(X,Y){var position=TVNC.findPos(TVNC.vncContainer);let gs=_displayManager.processDisplayCmd("GET_SCALE");X=Math.round((X-position[0])/gs);Y=Math.round((Y-position[1])/gs);$('[id^="'+productId+'_"]').each(function(index){var win=$(this)[0];if(win.offsetLeft<=X&&win.offsetTop<=Y&&
win.offsetLeft+win.offsetWidth>=X&&win.offsetTop+win.offsetHeight>=Y)return win});return null};this.hasChildOfByClassName=function(classname,child){var elems=document.getElementsByClassName(classname);for(var i=0;i<elems.length;i++)if(elems[i].contains(child))return true;return false};this.getElementFromPoint=function(e){var x,y;if((e.changedTouches||e.touches)&&(e.changedTouches||e.touches).length>0){x=(e.changedTouches||e.touches)[0].pageX-document.body.offsetLeft;y=(e.changedTouches||e.touches)[0].pageY-
document.body.offsetTop}else if(e.clientX!=undefined||e.pageX!=undefined){x=e.clientX||e.pageX-document.body.offsetLeft;y=e.clientY||e.pageY-document.body.offsetTop}else if(e.pointers!=undefined&&e.pointers.length>0){x=e.pointers[0].pageX-document.body.offsetLeft;y=e.pointers[0].pageY-document.body.offsetTop}var idMask=productId+"_canvas_";var selectedElement=document.elementFromPoint(x,y);if(selectedElement&&(!helper.style.hasClass(selectedElement,"__uselocalmouse__")&&!TVNC.hasChildOfByClassName("__uselocalmouse__",
selectedElement)&&(selectedElement.tagName=="CANVAS"||selectedElement.name=="caret"||selectedElement.id=="caret"||selectedElement==TVNC.vncdiv||selectedElement.id.indexOf(idMask)!=-1||helper.style.hasClass(selectedElement,"ignoremouse"))))return null;else return selectedElement};this.setClipboardPosition=function(){};function isInsideOfArea(x,y,rad){return Math.pow(x,2)+Math.pow(y,2)<=rad}this.checkPacketIndex=function(pckIdx,groupIdx,eod){if(_lastPkt.idx==99&&pckIdx==0&&eod)_lastPkt.idx=-1;if(_lastPkt.idx==
-1&&_lastPkt.reset){_lastPkt.reset=false;_lastPkt.idx=pckIdx-1}if(_lastPkt.idx+1!=pckIdx){if(_lastPkt.idx+1<pckIdx){TVNC.logger.logWarning(helper.string.format("Missing pkt: {2} - last: {0}, current: {1}, groupIdx: {3}, UBRWID: {4}",_lastPkt.idx,pckIdx,_lastPkt.idx+1,groupIdx,TVNC.rcParams.UBRWID),"*");helper.console.warning(helper.string.format("Missing pkt: {2} - last: {0}, current: {1}, groupIdx: {3}, UBRWID: {4}",_lastPkt.idx,pckIdx,_lastPkt.idx+1,groupIdx,TVNC.rcParams.UBRWID),arguments)}else{TVNC.logger.logWarning(helper.string.format("Pkt treated - last: {0}, current: {1}, groupIdx: {2}, UBRWID: {3}",
_lastPkt.idx,pckIdx,groupIdx,TVNC.rcParams.UBRWID),"*");helper.console.warning(helper.string.format("Pkt treated - last: {0}, current: {1}, groupIdx: {2}, UBRWID: {3}",_lastPkt.idx,pckIdx,groupIdx,TVNC.rcParams.UBRWID),arguments)}if(eod)_lastPkt.idx=pckIdx;restartConnection()}else if(eod)_lastPkt.idx=pckIdx;else if(_lastPkt.idx==-1)_lastPkt.idx=0};this.getNextHighestZindex=function(obj){var highestIndex=0;var currentIndex=0;var elArray=Array();if(obj)elArray=obj.getElementsByTagName("*");else elArray=
document.getElementsByTagName("*");for(var i=0;i<elArray.length;i++){if(elArray[i].currentStyle)currentIndex=parseFloat(elArray[i].currentStyle["zIndex"]);else if(window.getComputedStyle)currentIndex=parseFloat(document.defaultView.getComputedStyle(elArray[i],null).getPropertyValue("z-index"));if(!isNaN(currentIndex)&&currentIndex>highestIndex)highestIndex=currentIndex}return highestIndex+1};function checkSplashPopup(){var elem=document.querySelector(_splashCssName);if(elem)if(elem.style.getPropertyValue("display")!=
"none"&&elem.style.getPropertyValue("visibility")!="hidden"){var b=elem.getBoundingClientRect();return b.x>0&&b.x<TVNC.rcParams.width&&b.y>0&&b.y<TVNC.rcParams.height&&b.height>0&&b.width>0}else return false;else return false}this.reconnect=function(){if(_comm.state>=Thinfinity.Communication.state.CLOSING)return;connection.fromReconnection=true;if(Thinfinity.Popups&&Thinfinity.Popups.growl)Thinfinity.Popups.growl.unblockAll();TVNC.processNextScreenEnabled=true;if(document.getElementById(TVNC.reconnectDivId)==
null){if(!TVNC.rcParams.overrideCursor)_displayManager.fireEvent("resetCursor");if(!_avoidConnectionLostPopup)TVNC.showReconnectDiv(true);try{if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onServerReconnect==null)$(window).trigger("serverReconnect");else TVNC.rcParams.events.onServerReconnect()}catch(error){helper.console.error("'onServerReconnect' calling attached method fail.",error,arguments)}if(TVNC.useAjax){if(TVNC.xmlHttpJson){TVNC.xmlHttpJson.abort();TVNC.xmlHttpJson=null}_comm.releaseQueue(TVNC.queueRequestName)}}if(helper.object.existsPath(TVNC,
"rcParams.scraperArgs")&&typeof TVNC.rcParams!="undefined"&&(TVNC.rcParams.resolution=="fittobrowser"||TVNC.rcParams.resolution=="fittoscreen")){var w=window.environment.detectedWidth;var h=window.environment.detectedHeight;if(helper.object.existsPath(self,"clientSettings.UseViewportSize")&&self.clientSettings.UseViewportSize){w=window.environment.viewportWidth;h=window.environment.viewportHeight}if(helper.object.getDataTypeOf(TVNC.rcParams.scraperArgs)=="json"){TVNC.rcParams.scraperArgs.browserWidth=
w;TVNC.rcParams.scraperArgs.browserHeight=h}else{TVNC.rcParams.scraperArgs=TVNC.removeBrowserSize(TVNC.rcParams.scraperArgs);TVNC.rcParams.scraperArgs+="&browserWidth="+w+"&browserHeight="+h}}TVNC.connect()};this.supportsHTML5Storage=function(){try{return"localStorage"in window&&window["localStorage"]!=null}catch(err){return false}};this.getStorageName=function(){var middle=this.rcParams.address?"_"+this.rcParams.address:"";return"thinvnc"+middle+"_prefs"};this.loadPreferences=function(){if(!this.supportsHTML5Storage())return;
try{var objJson=localStorage.getItem(this.getStorageName());var objData=JSON.parse(objJson);if(objData!=null&&typeof objData!="undefined")_onlyKeyCode=objData.onlykeycode!=null?objData.onlykeycode:_onlyKeyCode}catch(err){}};this.savePreferences=function(){if(!this.supportsHTML5Storage())return;try{var objData=new Object;objData.onlykeycode=_onlyKeyCode;var objJson=JSON.stringify(objData);localStorage.setItem(this.getStorageName(),objJson)}catch(err){}};this.applyParam=function(params,name,value){if(typeof value==
"object"&&value!=null){var obj=params[name];if(!obj)obj={};for(var v in value)obj[v]=value[v];params[name]=obj}else params[name]=value};this.setParams=function(dd,ee){for(var o in dd)this.applyParam(TVNC.rcParams,o,dd[o]);this.rcParams.events=ee;TVNC.rdpMode=this.rcParams.scraper=="RDP"};this.resolveAgent=function(){TVNC.majorVersion=agentInfo.majorVersion;TVNC.firefoxVersion=agentInfo.firefoxVersion;TVNC.mac=agentInfo.isMac;TVNC.ios=agentInfo.isIOS;TVNC.iosVersion=agentInfo.iosVersion;TVNC.iphone=
agentInfo.isIphone;TVNC.android=agentInfo.isAndroid;TVNC.hptablet=agentInfo.isHPTablet;TVNC.playbook=agentInfo.isPlaybook;TVNC.chromeOS=agentInfo.isChromeOS;TVNC.symbian=agentInfo.isSymbian;TVNC.firefox=agentInfo.isFirefox;TVNC.firefoxVersion=agentInfo.firefoxVersion;TVNC.opera=agentInfo.isOpera;TVNC.chrome=agentInfo.isChrome;TVNC.safari=agentInfo.isSafari;TVNC.msie=agentInfo.isMSIE;TVNC.msieVersion=agentInfo.msieVersion;TVNC.nokia=agentInfo.isNokiaBrowser;TVNC.mobile=agentInfo.isMobile&&!TVNC.rcParams.forceDesktop;
TVNC.touch=agentInfo.isTouch;TVNC.agentName=agentInfo.getAgentKey()};this.appendElement=function(parentElem,type,name,attrColl,content){var elem=document.createElement(type);if(name!=null&&name!=""){elem.setAttribute("name",name);elem.setAttribute("id",name)}for(var a in attrColl)if(a=="style"){var s=attrColl[a].split(";");s.forEach(function(item){var kvp=item.split(":");elem.style[helper.string.trim(kvp[0])]=helper.string.trim(kvp[1])})}else elem.setAttribute(a,attrColl[a]);if(content)elem.innerHTML=
content;parentElem.appendChild(elem);return elem};this.initfs=function(dbname){if(!this.rcParams.persistentCache){TVNC.cacheLoaded=true;TVNC.sendStart();return}if(typeof FS!="undefined"&&!TVNC.fs){TVNC.fs=new FS(dbname);TVNC.fs.init(function(){TVNC.fs.enumFiles(function(filename){TVNC.dbFiles.push(filename)},function(){TVNC.cacheLoaded=true;TVNC.sendStart()})},function(){delete TVNC.fs;TVNC.fs=null;TVNC.cacheLoaded=true;TVNC.sendStart()})}else{TVNC.cacheLoaded=true;TVNC.sendStart()}};this.applyParams=
function(dd){for(var o in dd)this.rcParams[o]=dd[o];TVNC.vncdivId=TVNC.rcParams.divId?TVNC.rcParams.divId:TVNC.vncdivId;TVNC.centered=TVNC.rcParams.centered;if(this.rcParams.showOnStart==false)if(Thinfinity.Popups&&Thinfinity.Popups.establishing.backgroundStyle===Thinfinity.Popups.establishing.backgroundStyles.NONE)TVNC.hide();TVNC.vncdiv=document.getElementById(TVNC.vncdivId);if(typeof TVNC.vncdiv=="undefined"||TVNC.vncdiv==null){var errorMsg="Container element is null or undefined, "+consts.technicalSupport;
logError(errorMsg);try{let oError={message:errorMsg};if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onServerError==null)$(window).trigger("serverError",oError);else TVNC.rcParams.events.onServerError(oError)}catch(error){helper.console.error("'onServerError' calling attached method fail.",error,arguments)}TVNC.disconnect();throw new Error(errorMsg);}if(!TVNC.vncdiv)throw new Error("the "+TVNC.vncdivId+" is not available");TVNC.savedMaxWidth=TVNC.rcParams.maxWidth;TVNC.savedMaxHeight=
TVNC.rcParams.maxHeight;if(TVNC.rcParams.fitmode==0||TVNC.rcParams.fitToBrowser==true){TVNC.vncdiv.style.position="relative";TVNC.vncdiv.style.overflow="hidden";TVNC.vncdiv.style.top="0px";TVNC.vncdiv.style.marginTop="0px";TVNC.vncdiv.style.left="0px";TVNC.vncdiv.style.marginLeft="0px"}};this.init=function(dd){TVNC.applyParams(dd);var tempForceAjax=TVNC.gup("forceAjax");if(tempForceAjax!=""){TVNC.rcParams.forceAjax=helper.object.convertTo(tempForceAjax,"boolean");_comm.protocol=Thinfinity.Communication.protocol.AJAX}TVNC.resolveAgent();
if(TVNC.rdpMode&&TVNC.centered&&agentInfo.isMobile&&window.environment.supportsFullScreen){TVNC.vncContainer=document.getElementById("vncContainer");if(TVNC.vncContainer==null){TVNC.vncContainer=document.createElement("div");TVNC.vncContainer.id="vncContainer";TVNC.vncContainer.style.margin="auto auto";TVNC.vncContainer.style.height="auto";TVNC.vncContainer.style.width="auto";TVNC.vncContainer.style.minWidth="100px";TVNC.vncContainer.style.minHeight="100px";TVNC.vncContainer.style.backgroundColor=
"transparent";TVNC.vncContainer.style.position="relative";TVNC.vncdiv.appendChild(TVNC.vncContainer)}}else TVNC.vncContainer=TVNC.vncdiv;function isEmbeddedPrinter(){try{return window&&window.parent&&window.parent.document.getElementsByClassName("embedded-printer-device-container").length>0}catch(error){return false}}if(helper.object.existsPath(window,"Thinfinity.VisualEffect")){function isSlideMode(){try{if(window!=window.parent&&typeof window.parent!="undefined")if(window.parent.document&&window.parent.document.getElementsByTagName){var iframes=
window.parent.document.getElementsByTagName("iframe");for(var ifrIdx=0;ifrIdx<iframes.length;ifrIdx++)if(iframes[ifrIdx].contentWindow.name==window.name)return true;iframes=null}}catch(error){}return false}if(!isEmbeddedPrinter())_visualEffect=new Thinfinity.VisualEffect({"id":"visualEffectContainer","container":productId=="ZSC"?isSlideMode()?document.body:document.getElementById("prnBefore")||TVNC.vncContainer:TVNC.vncContainer,"allowReconnectionDialog":true,"events":{"onCancel":function(){TVNC.closeReconnectDiv();
TVNC.disconnect();$(document).unbind();$("#"+TVNC.vncdivId).unbind()}}})}TVNC.supportsCanvas=!!document.createElement("canvas").getContext;if(!_url.baseUrl){var path=TVNC.rcParams.url?TVNC.rcParams.url:window.location.href;var pathArray=path.split("/");if(TVNC.rcParams.protocol==""||!TVNC.rcParams.protocol)TVNC.rcParams.protocol=pathArray[0];if(TVNC.rcParams.server==""||!TVNC.rcParams.server)TVNC.rcParams.server=pathArray[2];_url.baseUrl="/";for(i=3;i<pathArray.length-1;i++){_url.baseUrl+=pathArray[i];
_url.baseUrl+="/"}}TVNC.loadPreferences();clearTimeout(TVNC.emptyRecycleImgTimeout);TVNC.emptyRecycleImgTimeout=setTimeout(TVNC.emptyRecycleImg,TVNC.recycleImgTimeoutValue);for(i=0;i<12;i++)this.rdpGlyphArray[i]=Array(256);TVNC.registerOOBCmd("cookie",function(obj){var cookieString=obj&&obj.cookie?obj.cookie:null;if(cookieString&&typeof cookieString==="string"&&cookieString.trim().length>0){writeCookies(extractCookie(cookieString,true),true);syncCookies()}});TVNC.registerOOBCmd("aslwarning",function(obj){var secondsToClose=
obj&&obj.secondsToClose?obj.secondsToClose:null;if(secondsToClose&&secondsToClose>0){var unit=consts.minutes;var min=obj.secondsToClose/60;var val=null;var color="";if(min===1){unit=consts.minute;val=min}else if(min>1){min=Math.ceil(min);unit=consts.minutes;val=min}else{min=Math.trunc(min);unit=consts.seconds;color="color:red;";val=secondsToClose}var msg=helper.string.sprintf(consts.sessionTimeout,`<b style="${color}">${val}</b>`,unit);var data={"secondsToClose":secondsToClose,"minutesToClose":min,
"message":msg};if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onSessionTimeout==null)$(window).trigger("SessionTimeout",data);else TVNC.rcParams.events.onSessionTimeout(data)}});TVNC.registerOOBCmd("licenseMsg",function(obj){obj.title=consts.licenseError;if(obj&&obj.errorType===_licenseTypes.ERR_TYPE_ERROR){if(typeof obj.errorCode!="undefined"){helper.console.warning(helper.string.format("Error Code: {0}, Message: {1}",obj.errorCode,obj.errorMsg),arguments);if(TVNC.connected)TVNC.disconnect()}}else helper.console.warning(obj.title+
" "+obj.errorMsg,arguments);let res=false;if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onLicenseMsg==null)$(window).trigger("licenseMsg",obj);else res=TVNC.rcParams.events.onLicenseMsg(obj);if(!res)TVNC.dispose(undefined,{"title":obj.title,"message":obj.errorMsg})})};function getComponentSettings(callback){helper.ajax.get({"url":`${helper.url.parseUrl(location.href).toUrl("-a-r")}/component.settings.json`,"type":helper.ajax.responseType.JSON,"success":callback,"error":function(e,
status,xhr){callback(null)}})}function initializeComponents(permissions){var _isLegacy=typeof cookiePrefix==="undefined"||cookiePrefix!=="fmx"?false:typeof legacyVersion!="undefined"?legacyVersion:true;if(!_componentsInitialized&&Thinfinity.Component&&Thinfinity.Component.RegistrationServices&&!_isLegacy){var panelContructor=function(params){if(Thinfinity.Component.Panel)return new Thinfinity.Component.Panel({"parentElement":document.body,"params":params})};getComponentSettings(function(components){_componentRegistrationServices=
new Thinfinity.Component.RegistrationServices({"owner":TVNC,"permissions":permissions,"components":components,"constructors":{"PANEL":panelContructor},"getAuthorization":function(name,callback){callback(true)}});_componentsInitialized=true});helper.dom.addEvent(window,"thinfinity.components.registration.services.ready",function(){if(_oInterface)TVNC.registerComponentObject("OINTERFACE",_oInterface)})}}function sendCookiesCmd(success,error){var d=new Date;var n=d.getTime();var url=_url.httpConnection+
"cmd?id="+TVNC.rcParams.id+"&cmd=cookie&dt="+n;writeCookies(_syncCookies.data,false);_comm.post({"url":url,"data":'{"cookie":'+n+"}","type":"json","success":success,"error":error})}function getCurrentCookiePath(){return _url.brokerUrl.replace(/\/$/,"")}function getFullCookiePath(){return _url.baseUrl.replace(/\/$/,"")}function startCookiesSync(){clearTimeout(_syncCookies.syncCookiesTOUT);if(_syncCookies.syncCookiesEnabled)_syncCookies.syncCookiesTOUT=setTimeout(()=>{syncCookies(startCookiesSync)},
_syncCookies.syncCookiesTime)}function extractCookie(strCookies,singleCookie){let cookieData=null;let name=null;if(strCookies!=""){cookieData={};strCookies.split(";").forEach(c=>{let [k,v]=c.split("=");k=k.trim();if(singleCookie)if(!name){name=k;cookieData[name]={name,value:v,expires:null,path:getCurrentCookiePath(),domain:null,svalue:null,targetPath:getFullCookiePath()}}else{if(cookieData[name].hasOwnProperty(k))cookieData[name][k]=v}else cookieData[k]={name:k.trim(),value:v,expires:null,path:getCurrentCookiePath(),
domain:null,svalue:null,targetPath:getFullCookiePath()}})}return cookieData}function writeCookies(data,toLocal){if(data){let expDate=(new Date(Date.now()+750)).toUTCString();Object.keys(data).forEach(k=>{let c=data[k];document.cookie=`${c.name}=${c.value};name=${c.name};${toLocal?"":"expires='"+expDate+"';"}path=${toLocal?c.path:c.targetPath}`})}}function syncCookies(callback){if(_syncCookies.syncCookiesEnabled&&_comm.state===Thinfinity.Communication.state.CONNECTED){let hasChanged=false;let _data=
extractCookie(document.cookie,false);if(_data)Object.keys(_data).forEach(k=>{if(!hasChanged)if(!_syncCookies.data[k])hasChanged=true;else{let l=_syncCookies.data[k];let r=_data[k];if(l.value!=r.value||l.path!=r.path||l.domain!=r.domain||l.expires!=r.expires)hasChanged=true}});if(hasChanged){_syncCookies.data=_data;sendCookiesCmd(callback,callback)}else callback()}else callback()}function stopSyncCookies(){_syncCookies.syncCookiesEnabled=false;clearTimeout(_syncCookies.syncCookiesTOUT);_syncCookies.syncCookiesTOUT=
null}this.openPrnManager=function(url,showCancel){function onShow(msg){Thinfinity.Popups.unblock();if(typeof msg=="undefined")msg=["<div class='popup' id='printDlg'><div id='printIco'>&nbsp;</div><div id='printDlgMsg'>",consts.printedDocReady,"</div><br/><div class='divbuttons'><a id='prnWOpenDocBtn' class='popuplink'>open</a>","<span id='prnWShowAllGroup'>&nbsp; &nbsp; <a id='prnWShowAllBtn' class='popuplink'>",consts.showAll,"</a>",showCancel?"&nbsp; &nbsp; <a class='popuplink' id='prnWCloseBtn' >"+
consts.discard+"</a>":"","</div></div>"].join("");var popup=new Thinfinity.Popups.popup;popup.block("printDlg",msg,null,function(e){$("#prnWOpenDocBtn").on("click",function(){TVNC.printerManager.openDocuments(true)});$("#prnWShowAllBtn").on("click",function(){TVNC.printerManager.showAllPrintings(true)});$("#prnWCloseBtn").on("click",function(){TVNC.printerManager.discard(true)});setTimeout(TVNC.reload,1)})}function onShowAll(obj){TVNC.printingWindow=window.open("printings.html","printingWindow")}
function onClose(){$.unblockUI();if(!!TVNC.printingWindow&&!TVNC.printingWindow.location)TVNC.printingWindow=null}function onEnqueueDocument(obj){if(obj.count==1){$("#printDlgMsg").html(consts.printedDocReady);$("#prnWShowAllGroup").hide()}else{$("#printDlgMsg").html(helper.string.sprintf(consts.printedDocsReady,obj.count));$("#prnWShowAllGroup").show()}}function onDiscard(){if(!!TVNC.printingWindow)if(!TVNC.printingWindow.location)TVNC.printingWindow=null;else TVNC.printingWindow.location.href=TVNC.printingWindow.location.href}
function onCheckVisibility(){var v=$("#printDlg").width();return v>0}if(!TVNC.printerManager)TVNC.printerManager=new PrinterManager({"onShow":onShow,"onShowAll":onShowAll,"onClose":onClose,"onEnqueueDocument":onEnqueueDocument,"onDiscard":onDiscard,"onCheckVisibility":onCheckVisibility});TVNC.printerManager.enqueueDocument(url)};this.openPrnWindow=function(url,showCancel){if(typeof PrinterManager!="undefined")this.openPrnManager(url,showCancel);else{var msg="<div class='popup' id='printDlg'><div id='printIco'>&nbsp;</div><div>"+
consts.printedDocReady+"</div><br/><div class='divbuttons'><a class='popuplink' href='"+(url.url.indexOf("?"+_SIDName+"=")==-1?url.url:url.url.substring(0,url.url.indexOf("?"+_SIDName+"=")))+"' target='_blank' onclick='$.unblockUI()'>open</a>";if(showCancel)msg+="&nbsp; &nbsp; <a class='popuplink' onclick='$.unblockUI()'>discard</a>";msg+="</div></div>";Thinfinity.Popups.unblock();var popup=new Thinfinity.Popups.popup;popup.block("printDlg",msg,null,function(){setTimeout(TVNC.reload,1)})}};this.openLinkDlg=
function(url,caption){helper.console.warning("openLinkDlg is deprecated, use 'Thinfinity.OpenLinkPopup'");if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onOpenLink==null)$(window).trigger("OpenLink",obj);else TVNC.rcParams.events.onOpenLink(obj)};function changeAppFocus(value){var cmd="cmd=focus"+"&value="+value;logDebug('switch app - "CTRL + TAB", cmd:'+cmd);TVNC.sendCmd(cmd)}this.show=function(){helper.style.add(TVNC.vncdiv,{"display":"inherit"})};this.hide=function(){helper.style.add(TVNC.vncdiv,
{"display":"none"})};function removeFunctions(){TVNC.zoomDesktop(1)}function sendTabFocusCmd(monitorId,cmd,value){if(_comm.state==Thinfinity.Communication.state.CONNECTED){TVNC.sendCmd(`cmd=${cmd}&value=${value.toString()}${typeof monitorId!=="undefined"?"&monitorId="+monitorId:""}`);if(_registeredEventsServicesList[_enumEventsServices.SENDEVENT]&&cmd!=="visibilityState")_registeredEventsServicesList[_enumEventsServices.SENDEVENT]({"timeStamp ":(new Date).getTime(),"cmd":"focus","value":value.toString(),
"monitorId":monitorId})}if(cmd==="focus"||cmd==="tabvisible")triggerCustomEvent(value?"focus":"blur");if(TVNC.rcParams.clipboard&&TVNC.rcParams.synchronizeClipboard){let b=value===true||value==="visible";if(!b)_clipSynchronized=false;else if(document.hasFocus()){_clipSynchronized=true;_displayManager.fireEvent("synchronizeRemoteClipboard",{async:false})}}}if(productId=="ZSC"&&TVNC.rcParams.hookKeyboard&&!TVNC.KeyboardHooked&&TVNC.triggerCustomEvent==undefined)Object.defineProperty(TVNC,"triggerCustomEvent",
{"enumerable":false,"configurable":false,"writable":false,"value":triggerCustomEvent});_packetReceiver=new Thinfinity.PacketReceiver({properties:{async:this.wsAsyncRecv,asyncTimeout:this.wsAsyncRecvTimeout,checkPacketIndex:this.isPktIdxEnabled},methods:{getRawBinaryHandler},handlers:{0:processJson,1:screenImage,3:queueText,5:function(group,arrayView){if(_ePictureType!==_enumPictureType.H264){triggerCustomEvent("H264");_ePictureType=_enumPictureType.H264;removeFunctions()}var id=arrayView[1];TVNC.sendCmd(`cmd=fc-pre&idx=${arrayView[2]}&id=${id}`);
_displayManager.processData(id,arrayView[0],arrayView.subarray(3))},6:function(group,arrayView){if(TVNC.rcParams.events.onFileStream)TVNC.rcParams.events.onFileStream(arrayView)},8:function(group,arrayView){if(_ePictureType===_enumPictureType.H264)return;if(_ePictureType!==_enumPictureType.GFX){triggerCustomEvent("GFX");_ePictureType=_enumPictureType.GFX;_displayManager.processData(null,Thinfinity.Display.Manager.EVENT_TYPES.GFX_RDP_INITIALIZE);removeFunctions()}_displayManager.processData(null,arrayView[0],
arrayView.subarray(1))}}});_packetReceiver.on("warning",function(msg){helper.console.warning(msg+", UBRWID: "+TVNC.rcParams.UBRWID,arguments);TVNC.logger.logWarning(msg+", UBRWID: "+TVNC.rcParams.UBRWID)});_packetReceiver.on("restartConnection",restartConnection);Object.defineProperty(this,"registerCustomHandler",{"enumerable":false,"configurable":false,"writable":false,"value":_packetReceiver.registerHandler});function processJson(group,arrayView,json){json=json||TVNC.arbufToStringU8((new Zlib.RawInflate(arrayView)).decompress());
if(json==="{}")return;try{var obj=JSON.parse(json)}catch(err){logError("err: "+err);logError("json: "+json);return}json=null;obj.group=group;if(typeof obj.oob!="undefined"){if(TVNC.fireOOBCmd(obj.cmd,obj))return;if(obj.cmd=="getImgCache"){var cmd="cmd=imgCache";cmd+="&items="+getImageCacheList(cmd.compression);TVNC.sendCmd(cmd)}else if(obj.cmd=="getNativeClasses"){var cmd="cmd=nativeClasses";cmd+="&items="+TVNC.controlFactory.getClassList();TVNC.sendCmd(cmd)}else if(obj.cmd=="openUrl")if(typeof TVNC.rcParams.events==
"undefined"||TVNC.rcParams.events.onOpenLink==null)$(window).trigger("OpenLink",obj);else TVNC.rcParams.events.onOpenLink(obj);else if(obj.cmd=="showMsg")if(typeof TVNC.rcParams.events=="undefined"||TVNC.rcParams.events.onServerMessage==null)$(window).trigger("ServerMessage",obj);else TVNC.rcParams.events.onServerMessage(obj);else if(obj.cmd=="shadowingStatus")if(typeof TVNC.rcParams.events?.onShadowingStatus)TVNC.rcParams.events.onShadowingStatus(obj.shadowed);else $(window).trigger("ShadowingStatus",
obj.shadowed);else if(obj.cmd=="clisync"){if(TVNC.rcParams.clipboard&&TVNC.rcParams.synchronizeClipboard){_clipSynchronized=true;_displayManager.fireEvent("synchronizeLocalClipboard",obj,{async:false})}}else if(TVNC.controlFactory)TVNC.controlFactory.dispatchEvent(obj.oob,obj.cmd,obj)}else if(typeof obj.id!="undefined")TVNC.serverCmdResult(obj);else if(obj.preidx)TVNC.sendCmd("cmd=fc-pre&idx="+obj.preidx);else if(obj.status){obj.imgQueue=TVNC.imgQueue;TVNC.msgQueue.push(obj);TVNC.processNextScreen()}}
function screenImage(group,arrayView){var key=((arrayView[0]-48)*1E4|0)+((arrayView[1]-48)*1E3|0)+((arrayView[2]-48)*100|0)+((arrayView[3]-48)*10|0)+(arrayView[4]-48)|0;key=TVNC.getKeyFromCmd(group,key);var type=TVNC.arbufToStringU8(arrayView.subarray(5,9)).replace(/ /g,"");var hashLength=0;var hash="";dataIndex=9;var item=TVNC.getImageItem();if(type=="idec")item.fromImageDecoderData(arrayView.subarray(dataIndex),type,hash,key);else{if(arrayView[dataIndex]==58){++dataIndex;do++hashLength;while(arrayView[dataIndex+
hashLength]!=58);hash=TVNC.arbufToStringU8(arrayView.subarray(dataIndex,dataIndex+hashLength));dataIndex+=hashLength+1}item.fromImageArray(arrayView.subarray(dataIndex),type,hash,key)}}function queueText(buffer){var item=TVNC.getImageItem();item.encoded.data=buffer;TVNC.addToImgQueueAndExecute(TVNC.imgQueue,item)}if(window.eScript&&window.embedScriptLog&&window.embedScriptLog["thinvnc.sdk"]){this.eval=function(str){eval(str)};eScript.add(window.embedScriptLog["thinvnc.sdk"],this);if(window.browserTracking)browserTracking.on("disconnect",
function(){TVNC.disconnect();TVNC.dispose()})}Object.defineProperty(TVNC,"fromReconnection",{"enumerable":true,"configurable":false,"get":function(){return connection?connection.fromReconnection:false}});try{Thinfinity!=undefined}catch(e){Thinfinity={}}if(!Thinfinity.thinVncSdk)Object.defineProperty(Thinfinity,"thinVncSdk",{"enumerable":false,"configurable":false,"get":function(){return TVNC}});initialize();var _statusVariables=[{"name":"status","title":"Status","get":function(){return Thinfinity.Communication.state.getKey(_comm.state)},
"index":10},{"name":"protocol","title":"Protocol","get":function(){return Thinfinity.Communication.protocol.getKey(_comm.protocol)},"index":15},{"name":"forceAjax","title":"ForceAjax","get":function(){return TVNC&&TVNC.rcParams?TVNC.rcParams.forceAjax:"undefined"},"index":20},{"name":"h264","title":"Running H264","get":function(){return TVNC.H264},"index":30},{"name":"GFX","title":"Running GFX","get":function(){return TVNC.GFX},"index":30},{"name":"localServer","title":"LocalServer","get":function(){return Thinfinity&&
Thinfinity.VirtualChannels?Thinfinity.VirtualChannels.localServer:"undefined"},"index":45},{"name":"useAjax","title":"UseAjax","get":function(){return TVNC&&TVNC.observable?TVNC.observable.useAjax:"undefined"},"index":25},{"name":"resolution","title":"Resolution","get":function(){return TVNC&&TVNC.rcParams?TVNC.rcParams.resolution:"undefined"},"index":37},{"name":"soundStatus","title":"Sound Status","get":function(){if(TVNC&&TVNC.sound){var ctxAudio=TVNC.sound.audioContext||TVNC.sound.audioMozAudio;
if(ctxAudio&&ctxAudio.state)return ctxAudio.state}else return"undefined"},"index":41},{"name":"soundLastUpdate","title":"Sound Last Update","get":function(){return TVNC&&TVNC.sound?TVNC.sound.audioLastTicksUpdate:"undefined"},"index":42}];if(_ePictureType===_enumPictureType.H264)_statusVariables.push({"name":"decoder","title":"Decoder","get":function(){return _displayManager?_displayManager.decoderType:"undefined"},"index":31});try{window.dispatchEvent(new CustomEvent("addStatusAPIVariables",{"detail":_statusVariables}))}catch(error){}};
window.hasFocus=function(){if(productId=="ZSC"){var isIE11=agentInfo.isMSIE&&agentInfo.msieVersion<=11;if(isIE11)return document.hasFocus()&&document.body.contains(document.activeElement)&&document.activeElement.nodeName!="IFRAME";return document.hasFocus()&&document.contains(document.activeElement)&&document.activeElement.nodeName!="IFRAME"}else return document.hasFocus()}(function(){var method;var noop=function(){};var methods=["assert","clear","count","debug","dir","dirxml","error","exception",
"group","groupCollapsed","groupEnd","info","log","markTimeline","profile","profileEnd","table","time","timeEnd","timeStamp","trace","warn"];var length=methods.length;var console=window.console=window.console||{};while(length--){method=methods[length];if(typeof console[method]=="undefined")console[method]=noop}}());
(function(){var defaultTouchGestures=[{type:"pressAndTap",threshold:5,time:100,action:["mouseMove","doubleClick"]},{type:"panAndTap",threshold:15,direction:"DIRECTION_ALL",action:["mouseMove","doubleClick"]},{type:"tap",pointers:1,taps:1,action:["mouseMove","click",productId==="virtualui"?"focus":""]},{type:"pan",pointers:1,threshold:15,direction:"DIRECTION_ALL",action:"mouseMove"},{type:"pressAndRelease",pointers:1,threshold:5,time:450,action:["contextMenu"]},{type:"press",pointers:1,threshold:5,
time:450,action:["mouseMove","holdLeft"]},{type:"pan",pointers:3,threshold:0,action:"zoomPan"},{type:"pinch",pointers:2,threshold:0,action:"zoomOrWheel"},{type:"release",action:"releaseAll"},{type:"swipe","pointers":1,"threshold":10,velocity:.3,direction:"DIRECTION_RIGHT",action:"closeMenu"},{type:"swipeFromEdge","pointers":1,"threshold":10,velocity:.3,swipeDirection:"left",action:"menu"}];const gesturesOnStates=Thinfinity.GesturesConfigurator.onStates;function Mobile(){if(typeof window["__mobile__"]!=
"undefined")return window["__mobile__"];var self=this;var mobileReady=false;var button="left";var touchstate=0;var lastEvent=null;var stdKeyboardVisible=false;var extKeyboardVisible=false;var dialogVisible=false;var THIN=null;var ctrlDown=false;var altDown=false;var shiftDown=false;var backSpacePressed=false;var kbdTimer=null;var deltaCursorX=0;var deltaCursorY=0;var mouseScrollX=-1;var startMouseX=0;var startMouseY=0;var mouseScrollY=-1;var zoomStarted=false;var zoomEnabled=true;var zoomBottomLimit=
1;var zoomTopLimit=4;var relativeTouch=true;var divScrolling=true;var screenHeight=window.environment.availHeight||$(window).height();var screenWidth=window.environment.availWidth||$(window).width();var showToolbar=true;var insertNavigator=true;var kbScreenHeight=-1;var kbScreenWidth=-1;var scrollStarted=false;var touchkbdElem=null;var lastMouseClickPosition=null;var lastKey=-1;var imgMPath="images/m/";var replyTime=0;var mouseCenterIntervalId=null;var isNewConnection=true;var savedX;var savedY;var scrollingTOUT;
var resizeTOUT;var toolbarAvailable=false;var held=[];var _tba;var supportsFullScreenMode=typeof environment!="undefined"?environment.supportsFullScreen:agentInfo.supportsFullScreen(document.documentElement);var hasOrientationChanged=false;var interfaceProperties=null;var keyboardSettings={"intervalTime":1E3,"intervalId":null,"timeoutTime":1500,"timeoutId":null,"available":true};var getScrollLeft=document.documentElement?function(){return document.documentElement.scrollLeft}:function(){return window.pageXOffset};
var getScrollTop=document.documentElement?function(){return document.documentElement.scrollTop}:function(){return window.pageYOffset};var physicalKeyboard=null;var mouseMask=null;var contextMenu=null;var preventMobileKeyboardDisplay=false;var keyboardCaretWait=200;var _domHeight=window.screenHeight;var _winScrollY=0;var _showingStdKdb=false;var TouchManager=function(){var p={initialized:false,localGesturesInitialized:false,redirectionInitialized:false,redirectionServerSideSupported:false,listenElement:null,
localGesturesSettings:null,redirectSettings:null,gesturesConfigurator:null,fallbackCount:0,currentMode:"",currentLocalGesturesMethod:"",currentRedirectionMethod:"",currentRedirectionEventHandlers:{"Start":null,"Move":null,"End":null},currentRedirectionEvents:{"Start":null,"Move":null,"End":null},eventNamesByRedirectionMethod:{"Touch Events":{"Start":["touchstart"],"Move":["touchmove"],"End":["touchend"]},"Pointer Events":{"Start":[],"Move":[],"End":[]}},touchEventsCapable:function(){return!!("ontouchstart"in
window)},pointerEventsCapable:function(){var pointerEvents=this.eventNamesByRedirectionMethod["Pointer Events"];if(pointerEvents["Start"].length)return true;if(navigator.pointerEnabled&&navigator.maxTouchPoints>0){pointerEvents["Start"]=["pointerdown"];pointerEvents["Move"]=["pointermove"];pointerEvents["End"]=["pointerup","pointercancel"];return true}if(navigator.msPointerEnabled&&navigator.msMaxTouchPoints>0){pointerEvents["Start"]=["MSPointerDown"];pointerEvents["Move"]=["MSPointerMove"];pointerEvents["End"]=
["MSPointerUp","MSPointerCancel"];return true}return false},msTouchEventsCapable:function(){return agentInfo.isTabletMode&&document&&document.documentElement&&"onmsgesturestart"in document.documentElement},maxTouchPoints:function(){return navigator.maxTouchPoints||navigator.msMaxTouchPoints||0},addRedirectionEvents:function(owner,eventId){var eventHandlerName="touch"+eventId+"Redirection";var eventNames=this.eventNamesByRedirectionMethod[this.currentRedirectionMethod][eventId];var eventHandler=owner[eventHandlerName];
if(!this.listenElement||typeof eventNames=="undefined"||typeof eventHandler=="undefined")return;var wrappedEventHandler;if(this.currentRedirectionMethod=="Touch Events")wrappedEventHandler=eventId=="Start"||eventId=="End"?function(e){eventHandler.apply(owner,[e,e.changedTouches])}:function(e){eventHandler.apply(owner,[e,e.touches])};else wrappedEventHandler=function(e){if(e.pointerType!="touch")return;eventHandler.apply(owner,[e,[{pageX:e.clientX,pageY:e.clientY,identifier:e.pointerId}]])};for(var i=
0;i<eventNames.length;++i)this.listenElement.addEventListener(eventNames[i],wrappedEventHandler,false);this.currentRedirectionEventHandlers[eventId]=wrappedEventHandler},removeRedirectionEvents:function(eventId){if(this.currentRedirectionMethod&&this.currentRedirectionMethod!=""){var eventNames=this.eventNamesByRedirectionMethod[this.currentRedirectionMethod][eventId];if(!this.listenElement||typeof eventNames=="undefined")return;var wrappedEventHandler=this.currentRedirectionEventHandlers[eventId];
for(var i=0;i<eventNames.length;++i)this.listenElement.removeEventListener(eventNames[i],wrappedEventHandler,false)}},initLocalGestures:function(localGestureSettings){if(this.gesturesConfigurator!=null&&this.gesturesConfigurator.initialized)return;this.localGesturesInitialized=false;this.localGestureSettings=null;this.currentLocalGesturesMethod="";if(!this.gesturesConfigurator)this.gesturesConfigurator=new Thinfinity.GesturesConfigurator({listenElement:this.listenElement});if(this.gesturesConfigurator==
null){helper.console.error("TouchManager: Cannot initialize GesturesConfigurator, no local gesture processing.");return}this.localGestureSettings=localGestureSettings;this.currentLocalGesturesMethod="Hammer.js";this.localGesturesInitialized=true},initRedirection:function(redirectionSettings){this.redirectionSettings=redirectionSettings;this.currentRedirectionMethod=this.touchEventsCapable()?"Touch Events":"Pointer Events";this.redirectionInitialized=true;this.redirectionServerSideSupported=false},
startLocalGestures:function(owner){if(this.gesturesConfigurator.initialized)this.gesturesConfigurator.stopRecognition();if(owner.defaultGestures)this.gesturesConfigurator.set({gestures:owner.defaultGestures});this.gesturesConfigurator.set({"gestures":this.localGestureSettings});this.gesturesConfigurator.set({middleware:owner.gesturesMiddleware,middlewares:[],actions:owner.actions});this.gesturesConfigurator.startRecognition();this.currentMode="Local Gestures";owner.localGesturesStarted()},stopLocalGestures:function(owner){if(this.gesturesConfigurator)this.gesturesConfigurator.stopRecognition();
this.currentMode="";owner.localGesturesStopped()},startRedirection:function(owner){this.listenElement.style.touchAction="none";this.listenElement.style.msTouchAction="none";this.listenElement.onselectstart=function(){return false};this.addRedirectionEvents(owner,"Start");this.addRedirectionEvents(owner,"Move");this.addRedirectionEvents(owner,"End");this.currentMode="Redirection";owner.redirectionStarted()},stopRedirection:function(owner){this.removeRedirectionEvents("Start");this.removeRedirectionEvents("Move");
this.removeRedirectionEvents("End");if(this.listenElement){delete this.listenElement.style.touchAction;delete this.listenElement.style.msTouchAction}this.currentMode="";owner.redirectionStopped()}};var _useLocalGesture=false;var touch={touchCapable:function(){return true},maxTouchPoints:function(){return p.maxTouchPoints()},localGesturesInitialized:function(){return p.localGesturesInitialized},redirectionInitialized:function(){return p.redirectionInitialized},redirectionServerSideSupported:function(){return p.redirectionServerSideSupported},
getCurrentMode:function(){return p.currentMode},getCurrentRedirectionMethod:function(){return p.currentRedirectionMethod},getCurrentLocalGesturesMethod:function(){return p.currentLocalGesturesMethod},wasInitialized:function(){return p.initialized},refine:function(){var F=function(){};F.prototype=this;return new F},initialize:function(listenElement,localGestureSettings,redirectionSettings){if(this.wasInitialized()){helper.console.log("TouchManager: Already initialized, continue.");return}if(!listenElement){helper.console.error("TouchManager: Undefined listenElement, cannot initialize.");
return}if(!this.touchCapable()){helper.console.error("TouchManager: Touch capability not detected, cannot initialize.");return}if(listenElement.addEventListener=="undefined"){helper.console.error("TouchManager: listenElement.addEventListener() not supported, cannot initialize.");return}p.listenElement=listenElement;if(typeof localGestureSettings=="object")p.initLocalGestures(localGestureSettings);if(typeof redirectionSettings=="object")p.initRedirection(redirectionSettings);if(!this.redirectionInitialized()&&
!this.localGesturesInitialized()){helper.console.log("TouchManager: No touch handling method defined, cannot initialize.");return}this.printStatus(true);p.initialized=true;helper.console.log("TouchManager: Initialized.");this.reconfigureForLocalGestures()},serverSupportsRedirection:function(){if(!this.wasInitialized()){helper.console.error("TouchManager: Not initialized.");return}if(!this.redirectionInitialized()){helper.console.error("TouchManager: Redirection not initialized.");return}if(agentInfo.isMobile){p.redirectionServerSideSupported=
false;logDebug("TouchManager: Server supports touch redirection, but the device is mobile or surface reconfiguring to local gestures...");this.reconfigureForLocalGestures();helper.console.log("ThinVNCTouchManager::redirectionStopped()");$("#kitouchredir").hide();$("#kitouchredir + hr").hide()}else{p.redirectionServerSideSupported=true;helper.console.log("TouchManager: Server supports touch redirection, reconfiguring...");this.reconfigureForRedirection()}},printStatus:function(ignoreInitialized){if(!this.wasInitialized()&&
!ignoreInitialized){helper.console.log("TouchManager: Not initialized.");return}var yesNo=function(b,y,n){var s=b?"Yes":"No";if(b&&y)s+=y;else if(!b&&n)s+=n;return s};helper.console.log("TouchManager: Touch events capable? "+yesNo(p.touchEventsCapable())+".");helper.console.log("TouchManager: Pointer events capable? "+yesNo(p.pointerEventsCapable())+".");helper.console.log("TouchManager: Max. touch points: "+(this.maxTouchPoints()?this.maxTouchPoints():"not available")+".");helper.console.log("TouchManager: Local gestures initialized? "+
yesNo(this.localGesturesInitialized(),", using "+this.getCurrentLocalGesturesMethod())+".");helper.console.log("TouchManager: Redirection initialized? "+yesNo(this.redirectionInitialized(),", using "+this.getCurrentRedirectionMethod())+".")},toggleCurrentMode:function(){if(this.getCurrentMode()=="Redirection")this.reconfigureForLocalGestures();else if(this.getCurrentMode()=="Local Gestures")this.reconfigureForRedirection();else helper.console.error("TouchManager: Cannot toggle invalid current mode: "+
this.getCurrentMode())},reconfigureForLocalGestures:function(){_useLocalGesture=true;if(!this.wasInitialized()){helper.console.error("TouchManager: Not initialized. Cannot reconfigure for local gestures.");return}if(!this.localGesturesInitialized()){helper.console.log("TouchManager: Cannot switch to local gestures, mode not initialized. Reverting to redirect if available.");if(this.redirectionInitialized()&&this.redirectionServerSideSupported())this.reconfigureForRedirection();return}try{p.stopRedirection(this);
p.startLocalGestures(this)}catch(err){helper.console.error("TouchManager: Failed to initialize local gesture processing: "+err);if(p.fallbackCount++)return;helper.console.error("TouchManager: Reverting to touch redirection if available.");if(this.redirectionInitialized()&&this.redirectionServerSideSupported())this.reconfigureForRedirection();p.fallbackCount=0;return}p.fallbackCount=0;helper.console.log("TouchManager: Switched to local gestures.")},enableGestures:function(){if(_useLocalGesture==true&&
(p.gesturesConfigurator==null||!p.gesturesConfigurator.initialized)){p.initLocalGestures(p.localGestureSettings);p.startLocalGestures(this)}},disableGestures:function(){if(_useLocalGesture==true&&p.gesturesConfigurator!=null)p.stopLocalGestures(this)},reconfigureForRedirection:function(){_useLocalGesture=false;if(!this.wasInitialized()){helper.console.error("TouchManager: Not initialized. Cannot reconfigure for redirection.");return}if(!this.redirectionInitialized()||!this.redirectionServerSideSupported()){helper.console.log("TouchManager: Cannot switch to redirection, mode not initialized or no sever-side support. Reverting to local gestures if available.");
if(this.localGesturesInitialized())this.reconfigureForLocalGestures();return}try{p.stopLocalGestures(this);p.startRedirection(this)}catch(err){helper.console.error("TouchManager: Failed to initialize redirection of touch events: "+err);if(p.fallbackCount++)return;helper.console.error("TouchManager: Reverting to local gestures if available.");if(this.localGesturesInitialized())this.reconfigureForLocalGestures();p.fallbackCount=0;return}p.fallbackCount=0;helper.console.log("TouchManager: Switched to touch redirection.")},
dispose:function(){p.stopRedirection(this);p.stopLocalGestures(this);p.initialized=false},touchGesture:function(e){},panStartGesture:function(e){},panGesture:function(e){},panEndGesture:function(e){},swipeGesture:function(e){},tapGesture:function(e){},doubleTapGesture:function(e){},pressGesture:function(e){},releaseGesture:function(e){},transformStartGesture:function(e){},transformGesture:function(e){},transformEndGesture:function(e){},touchStartRedirection:function(e,touches){},touchMoveRedirection:function(e,
touches){},touchEndRedirection:function(e,touches){},localGesturesStarted:function(e){},localGesturesStopped:function(e){},redirectionStarted:function(e){},redirectionStopped:function(e){},gesturesConfiguratorCustomActions:[]};Object.defineProperty(touch,"gesturesConfigurator",{"enumerable":true,"configurable":false,"get":function(){return p.gesturesConfigurator}});return touch};function initialize(){if(agentInfo.isTouch)ThinVNCTouchManager=new TouchManager;if(agentInfo.isMobile){function addStylesheet(url,
media){var attrs={"rel":"stylesheet","type":"text/css","href":url};if(media)attrs["media"]=media;helper.dom.appendJsonElement({"parentElement":head,"type":"link","attributes":attrs})}var head=document.head;var bPath=Thinfinity.global.variables.basePath;addStylesheet(bPath+"css.m/keyb.css");addStylesheet(bPath+"css.m/keyb_port_320.css","only screen and (max-width: 479px)");addStylesheet(bPath+"css.m/keyb_land_480.css","only screen and (min-width: 480px) and (max-width:599px)");addStylesheet(bPath+
"css.m/keyb_port_600.css","only screen and (min-width: 600px) and (max-width:768px)");addStylesheet(bPath+"css.m/keyb_port_768.css","only screen and (min-width: 768px) and (max-width:799px)");addStylesheet(bPath+"css.m/keyb_land_800.css","only screen and (min-width: 800px) and (max-width:1023px)");addStylesheet(bPath+"css.m/keyb_land_1024.css","only screen and (min-width: 1024px)");if(insertNavigator)addStylesheet(bPath+"css.m/navigatorControl.css","only screen");if(window.productId=="thinvnc")addStylesheet(bPath+
"css.m/menu.css");helper.dom.interactive(function(){helper.style.add(document.body,"mobile");_domHeight=document.body.clientHeight})}}function isBlocked(){return $(".blockUI.blockMsg").length>0}function CtrlKeyToggle(){if($("#keyctrl").hasClass("disabledKey"))return;ctrlDown=!ctrlDown;if(ctrlDown)$("#keyctrl").addClass("selected");else $("#keyctrl").removeClass("selected")}function CtrlKeyOff(){ctrlDown=false;$("#keyctrl").removeClass("selected")}function AltKeyToggle(){if($("#keyalt").hasClass("disabledKey"))return;
altDown=!altDown;if(altDown)$("#keyalt").addClass("selected");else $("#keyalt").removeClass("selected")}function AltKeyOff(){altDown=false;$("#keyalt").removeClass("selected")}function ShiftKeyToggle(){if($("#keyshift").hasClass("disabledKey"))return;shiftDown=!shiftDown;if(shiftDown)$("#keyshift").addClass("selected");else $("#keyshift").removeClass("selected")}function ShiftKeyOff(){shiftDown=false;$("#keyshift").removeClass("selected")}function sendSpecialKeysBegin(){if(ctrlDown)THIN.sendKeyDown(17);
if(altDown)THIN.sendKeyDown(18);if(shiftDown)THIN.sendKeyDown(16)}function sendSpecialKeysEnd(){if(ctrlDown)THIN.sendKeyUp(17);if(altDown)THIN.sendKeyUp(18);if(shiftDown)THIN.sendKeyUp(16);CtrlKeyOff();AltKeyOff();ShiftKeyOff()}function sendExtKey(elem,key){if(key==46&&helper.object.existsPath(THIN,"rcParams.mobile.shortcuts.CtrlAltDel")&&THIN.rcParams.mobile.shortcuts.CtrlAltDel=="false"){CtrlKeyOff();AltKeyOff();ShiftKeyOff()}else{sendSpecialKeysBegin();THIN.sendKeyStroke(key);sendSpecialKeysEnd()}}
function sendCtrlAltDel(){THIN.sendCtrlAltDel()}function sendShiftCtrlEsc(){THIN.sendShiftCtrlEsc()}function sendShellExplorer(){THIN.sendShellExplorer()}function sendShellRun(){THIN.sendShellRun()}function sendCtrlEsc(){THIN.sendCtrlEsc()}function sendCut(){THIN.sendCut()}function sendCopy(){THIN.sendCopy()}function sendPaste(){THIN.sendPaste()}function cursorCanvasX(){return interfaceProperties.cursorCanvasX}function cursorCanvasY(){return interfaceProperties.cursorCanvasY}function getMouseScreenPosition(){let position=
THIN.findPos(THIN.vncContainer);var mouseScreenPosition={x:(cursorCanvasX()-position[0])/THIN.scale,y:(cursorCanvasY()-position[1])/THIN.scale};return mouseScreenPosition}function btnDblClickFromCtxMenu(){var p=THIN.findPos(THIN.vncContainer);var x=contextMenu.elem.x*THIN.scale+p[0];var y=contextMenu.elem.y*THIN.scale+p[1];btnLeftClick(x,y);btnLeftClick(x,y)}function btnLeftClick(x,y){var x1=getTouchXFixed();var y1=getTouchYFixed();mouseScrollX=x1;mouseScrollY=y1;x1=x;y1=y;THIN.mouseDown(x1,y1,0);
THIN.mouseUp(x1,y1,0)}function btnRightClick(){var x=cursorCanvasX();var y=cursorCanvasY();sendButtonRight(x,y)}function btnRightClickFromCtxMenu(){var p=THIN.findPos(THIN.vncContainer);sendButtonRight(contextMenu.elem.x*THIN.scale+p[0],contextMenu.elem.y*THIN.scale+p[1])}function sendButtonRight(x,y){var x1=getTouchXFixed();var y1=getTouchYFixed();mouseScrollX=x1;mouseScrollY=y1;x1=x;y1=y;THIN.mouseDown(x1,y1,2);THIN.mouseUp(x1,y1,2)}function hideExtKeyboard(){var extkeyboard=document.getElementById("extkeyboard");
extkeyboard.style.top="100%";extkeyboard.style.marginTop="2000px"}function openExtKeyboard(noslide){if(typeof noslide=="undefined")$("#extkeyboard").addClass("slide");else $("#extkeyboard").removeClass("slide");var extkeyboard=document.getElementById("extkeyboard");extkeyboard.style.top=$("body").height()+"px";extkeyboard.style.marginTop=-extkeyboard.offsetHeight+"px";extKeyboardVisible=true}function closeExtKeyboard(){hideExtKeyboard();hideExtKeys();extKeyboardVisible=false}function moveExtKeyboard(){if(!extKeyboardVisible)return}
function hideExtKeys(){if(showToolbar){var extkeys=document.getElementById("extkeys");extkeys.style.top=-extkeys.offsetHeight+"px"}}function ShowExtKeys(){if(productId=="webfmx"||productId=="virtualui")return;var extkeys=document.getElementById("extkeys");extkeys.style.top=(agentInfo.isIOS&&window.scrollY>55?window.scrollY:0)+"px";extkeys.style.left="50%";extkeys.style.marginLeft="-"+$("#extkeys").width()/2+"px"}function ShowStdKbd(force){_domHeight=document.body.clientHeight;_winScrollY=window.scrollY;
_showingStdKdb=true;if(preventMobileKeyboardDisplay&&!force)return;if(!physicalKeyboard)physicalKeyboard=THIN.mobileKeyboard.locationType==THIN.mobileKeyboard.enumLocationType.PHYSICALKEYBOARD;if(force)physicalKeyboard=false;var x=0;var y=0;if(keyboardSettings.available){stdKeyboardVisible=true;var fixH=0;x=THIN.caretX;y=THIN.caretY;if(productId=="virtualui"&&helper.object.existsPath(THIN,"caret.data.rw")==true&&THIN.caret.data.rw.b-THIN.caret.data.rw.t>THIN.multiRowMinSize){x=THIN.caret.data.r.l;
y=THIN.caret.data.r.t+(THIN.caret.data.r.b-THIN.caret.data.r.t);if(agentInfo.isIOS&&agentInfo.isSafari){THIN.caretX=x;THIN.caretY=y}}if(y<=0)if(productId!="webfmx"&&productId!="virtualui"&&lastMouseClickPosition!=null){y=lastMouseClickPosition.y+32||THIN.mouseY;x=lastMouseClickPosition.x+32||THIN.mouseX;y-=25}else{if(agentInfo.isIOS&&agentInfo.isSafari)fixH=-18;x=THIN.mouseX-5;y=THIN.mouseY+fixH}if(y<0)y=0;if(x<0)x=0;if(productId==="thinvnc"||productId=="thinrdp"){touchkbdElem.style.top=y+"px";document.body.height=
_domHeight*3+"px";let s=THIN.getScale()*y/1.5;window.scrollTo(0,s)}var prevOverflow=null;if(agentInfo.isAndroid&&agentInfo.isChrome&&document.body.style.overflow=="hidden"){prevOverflow=document.body.style.overflow;document.body.style.overflow="auto"}if(agentInfo.isFirefox)document.activeElement.blur();if(productId!="webfmx")touchkbdElem.style.left=x+"px";touchkbdElem.style.display="block";touchkbdElem.style.visibility="visible";touchkbdElem.focus();let hasMobileClass=helper.style.hasClass("mobile");
if(hasMobileClass)helper.style.removeClass(document.body,"mobile");setTimeout(function(){if(agentInfo.isIOS&&agentInfo.isSafari&&relativeTouch){fixH=25/THIN.getScale();var posY=THIN.caretY>0?THIN.caretY:THIN.mouseY;var physicalScreenY=(posY-(THIN.vncdiv.scrollTop+fixH))*THIN.getScale();physicalScreenY-=Math.round((window.environment.detectedHeight-48)/4)-fixH;try{var limit=Math.max(document.body.scrollHeight,document.body.offsetHeight,document.documentElement.clientHeight,document.documentElement.scrollHeight,
document.documentElement.offsetHeight)-window.innerHeight;limit=limit<0?0:limit;physicalScreenY=Math.abs(physicalScreenY)>limit?limit:physicalScreenY;if(Math.abs(window.scrollY-physicalScreenY)>50)window.scroll(0,physicalScreenY)}catch(e){}}if(hasMobileClass)helper.style.addClass(document.body,"mobile")},350);if(prevOverflow!=null)setTimeout(function(){document.body.style.overflow=prevOverflow},500);if(!physicalKeyboard&&(agentInfo.isWindows||agentInfo.isAndroid&&(!agentInfo.isChrome||agentInfo.isChrome&&
agentInfo.chromeVersion<"5.0.0"))){clearInterval(keyboardSettings.intervalId);keyboardSettings.timeoutId=null;clearTimeout(keyboardSettings.timeoutId);setTimeout(function(){keyboardSettings.intervalId=setInterval(function(){if(document.activeElement!=touchkbdElem){clearInterval(keyboardSettings.intervalId);$(touchkbdElem).blur();window.scrollY=0}},keyboardSettings.intervalTime)},keyboardSettings.timeoutTime)}if(agentInfo.isChrome)touchkbdElem.style.left="-1000px"}else;}function addKeyImg(row,img,
key,cells,callback,behavior,disabled){if(typeof cells=="undefined")cells=2;var attributes={};attributes["class"]=("key t"+cells).toString();var events={};if(disabled!=false)if(typeof callback!="undefined"&&callback!="")events["ontouchend"]=function(){if(typeof callback=="string")helper.object.eval(callback);else callback()};else events["ontouchend"]=function(){sendExtKey(this,key)};var elem=document.getElementById("extkeyboard_row"+row);if(elem){var td=helper.dom.createJsonElement({"type":"td","attributes":{"colSpan":cells}});
var div=helper.dom.createJsonElement({"type":"div","attributes":attributes,"events":events});var p=helper.dom.createJsonElement({"type":"p"});var img=helper.dom.createJsonElement({"type":"img","attributes":{"src":Thinfinity.global.variables.basePath+img}});p.appendChild(img);div.appendChild(p);td.appendChild(div);elem.appendChild(td);if(disabled==false)helper.style.add(div,"disabledKey")}}function addKey(row,text,key,cells,callback,behavior,disabled){if(typeof cells=="undefined")cells=2;var attributes=
{};attributes["class"]=("key t"+cells).toString();var events={};if(disabled!=false)if(typeof callback!="undefined"&&callback!="")events["ontouchend"]=function(){if(typeof callback=="string")helper.object.eval(callback);else callback()};else if(text!=""&&key!=0)events["ontouchend"]=function(){sendExtKey(this,key)};var elem=document.getElementById("extkeyboard_row"+row);if(elem){var td=helper.dom.createJsonElement({"type":"td","attributes":{"colSpan":cells}});var div=helper.dom.createJsonElement({"type":"div",
"attributes":attributes,"events":events});var p=helper.dom.createJsonElement({"type":"p","content":text});div.appendChild(p);td.appendChild(div);elem.appendChild(td);if(disabled==false)helper.style.add(div,"disabledKey")}}function addExtKey(row,text,key,cells,id,behavior,disabled){if(typeof cells=="undefined")cells=2;var attributes={};var events={};if(text!=""){attributes["class"]=("key t"+cells).toString();if(id!=parseInt(id))attributes["id"]=id;else if(disabled!=false)events["ontouchend"]=function(){sendExtKey(this,
id)}}var elem=document.getElementById("extkeys_row"+row);if(elem){var td=helper.dom.createJsonElement({"type":"td","attributes":{"colSpan":cells}});var div=helper.dom.createJsonElement({"type":"div","attributes":attributes,"events":events});var p=helper.dom.createJsonElement({"type":"p","content":text});div.appendChild(p);td.appendChild(div);elem.appendChild(td);if(disabled==false)helper.style.add(div,"disabledKey")}}function getRelativeX(X,isRelative){if(isRelative){savedX=X;X=X-startMouseX+cursorCanvasX();
X=X<0?0:X}return Math.round(X)}function getRelativeY(Y,isRelative){if(isRelative){savedY=Y;Y=Y-startMouseY+cursorCanvasY();Y=Y<0?0:Y}return Math.round(Y)}function mouseDown(button,X,Y,isRelative){var btn=0;lastY=Y;if(button=="right")btn=2;THIN.mouseDown(getRelativeX(X,isRelative)+deltaCursorX,getRelativeY(Y,isRelative)+deltaCursorY,btn)}function mouseUp(button,X,Y,isRelative){var btn=0;if(button=="right")btn=2;THIN.mouseUp(getRelativeX(X,isRelative)+deltaCursorX,getRelativeY(Y,isRelative)+deltaCursorY,
btn)}function mouseMove(X,Y,isRelative){var relX=getRelativeX(X,isRelative)+deltaCursorX;var relY=getRelativeY(Y,isRelative)+deltaCursorY;THIN.mouseMove(relX,relY)}function mouseMoveIntoView(){if(relativeTouch){var x=cursorCanvasX();var y=cursorCanvasY();var z=THIN.getZoom();if(x<=THIN.vncdiv.scrollLeft*z)x=THIN.vncdiv.scrollLeft*z;else if(x>=(THIN.rcParams.maxWidth+THIN.vncdiv.scrollLeft)*z)x=(THIN.rcParams.maxWidth+THIN.vncdiv.scrollLeft)*z;if(y<=THIN.vncdiv.scrollTop*z)y=THIN.vncdiv.scrollTop*
z;else if(y>=(THIN.rcParams.maxHeight+THIN.vncdiv.scrollTop)*z)y=(THIN.rcParams.maxHeight+THIN.vncdiv.scrollTop)*z;if(x!=cursorCanvasX()||y!=cursorCanvasY())THIN.mouseMove(x,y)}}function moveMouseToStart(){var maxTries=50;var count=0;clearInterval(mouseCenterIntervalId);mouseCenterIntervalId=setInterval(function(){count++;var mouseElem=document.getElementById(productId+"_canvas_0");if(mouseElem!=null){clearInterval(mouseCenterIntervalId);setTimeout(function(){var x=parseInt(window.environment.currentWidth/
2,10);var y=parseInt(window.environment.currentHeight/2,10);THIN.mouseMove(x,y)},250)}if(count>maxTries)clearInterval(mouseCenterIntervalId)},50)}function divScroll(X,Y){X=Math.round(X);Y=Math.round(Y);if(divScrolling){if(THIN.rcParams.maxWidth+X>THIN.rcParams.viewWidth)X=THIN.rcParams.viewWidth-THIN.rcParams.maxWidth;else if(X<0)X=0;if(THIN.rcParams.maxHeight+Y>THIN.rcParams.viewHeight)Y=THIN.rcParams.viewHeight-THIN.rcParams.maxHeight;else if(Y<0)Y=0;THIN.vncdiv.scrollLeft=X;THIN.vncdiv.scrollTop=
Y}else{X=getScrollLeft()+(mouseScrollX-X);Y=getScrollTop()+(mouseScrollY-Y);if(THIN.rcParams.maxWidth+X>THIN.rcParams.viewWidth)X=THIN.rcParams.viewWidth-THIN.rcParams.maxWidth;else if(X<0)X=0;if(THIN.rcParams.maxHeight+Y>THIN.rcParams.viewHeight)Y=THIN.rcParams.viewHeight-THIN.rcParams.maxHeight;else if(Y<0)Y=0;window.scroll(X,Y)}mouseScrollX=X;mouseScrollY=Y;return}function checkPointerType(ev){if(ev)switch(ev.pointerType){case "touch":return true;case "pen":return true;case "mouse":return false;
default:if(ev.changedTouches&&ev.changedTouches.length>0||ev.touches&&ev.touches.length>0)return true}return false}function checkUIAndPointerType(e){if(!checkPointerType(e))return false;return!helper.style.hasAnyParentsClass(e&&e.target?e.target:null,"uitaptarget ignoremouse")}function getRelativeTouchByPointerType(ev){return!relativeTouch||ev&&ev.pointerType==="pen"?false:relativeTouch}function getTouches(ev){if(ev){switch(ev.pointerType){case "touch":case "pen":if(ev.pointers.length>0)ev=ev.pointers[0];
else if(ev.changedPointers.length>0)ev=ev.changedPointers[0];break;case "mouse":break;default:if(ev.changedTouches&&ev.changedTouches.length>0)ev=ev.changedTouches[0];else if(ev.touches&&ev.touches.length>0)ev=ev.touches[0];break}return ev}else{logDebug("No event to get Touches!");return[{"x":-1,"y":-1}]}}function getTouchX(isRelative){return getTouchXFixed()+(isRelative?0:THIN.vncdiv.scrollLeft*THIN.getZoom())}function getTouchXFixed(){var t=getTouches(lastEvent);return parseInt(t.x||t.clientX||
t.pageX,10)+$(window).scrollLeft()}function getTouchY(isRelative){return getTouchYFixed()+(isRelative?0:THIN.vncdiv.scrollTop*THIN.getZoom())}function getTouchYFixed(){var t=getTouches(lastEvent);return parseInt(t.y||t.clientY||t.pageY,10)+getScrollTop()}function showMouseMask(x,y,cn,hide){if(mouseMask){mmmouseMaskclassName=cn;mouseMask.style.left=x+"px";mouseMask.style.top=y+"px";$(mouseMask).show();if(hide)window.setTimeout(hideMouseMask,25)}}function moveMouseMask(x,y){if(mouseMask){mouseMask.style.left=
x+"px";mouseMask.style.top=y+"px"}}function hideMouseMask(){$(mouseMask).hide()}function isTouchDevice(){try{document.createEvent("TouchEvent");return true}catch(e){return false}}function alignPanels(){if(stdKeyboardVisible&&isKeyboardVisible()||extKeyboardVisible){ShowExtKeys();if(extKeyboardVisible)openExtKeyboard(true)}else{hideExtKeys();if(!_showingStdKdb)$(touchkbdElem).blur()}}function adjustMainSize(){screenWidth=window.environment.detectedWidth;screenHeight=window.environment.detectedHeight}
function checkScreenSize(){if(!$("#touchkbd:focus")[0])window.scroll(0,1);adjustMainSize();moveExtKeyboard();alignPanels()}function zoom(value,forceZoom){var isKeyboardVsb=stdKeyboardVisible&&isKeyboardVisible();if(forceZoom||!isKeyboardVsb){if(!zoomEnabled)value=1;if(THIN.getZoom()!=value)THIN.zoomDesktop(value);THIN.rcParams.maxWidth=Math.round(screenWidth/value);THIN.rcParams.maxHeight=Math.round(screenHeight/value);if(THIN.rcParams.scaled){THIN.vncdiv.style.width=THIN.rcParams.viewWidth+"px";
THIN.vncdiv.style.height=THIN.rcParams.viewHeight+"px"}else{THIN.vncdiv.style.width=THIN.rcParams.maxWidth+"px";THIN.vncdiv.style.height=THIN.rcParams.maxHeight+"px"}}}function isKeyboardVisible(){var strmsg="";var tempKeyboardVisible=false;if(agentInfo.isTouch){if(agentInfo.isIOS&&agentInfo.ipadModel==="pro"&&THIN.mobileKeyboard)if(THIN.mobileKeyboard.locationType==THIN.mobileKeyboard.enumLocationType.PHYSICALKEYBOARD)return false;else return stdKeyboardVisible;if(agentInfo.isIOS||agentInfo.isWindows||
agentInfo.isAndroid&&(!agentInfo.isChrome||agentInfo.isChrome&&agentInfo.chromeVersion<"5.0.0"&&agentInfo.agentStr.indexOf("android 4.2.2")==-1))tempKeyboardVisible=document.activeElement!=undefined&&document.activeElement.id=="touchkbd"?true:false;else{var h=Math.max(environment.height,environment.currentHeight,window.screen.height);var dh=environment.detectedHeight;var kdbSize=200;if(agentInfo.isAndroid&&!agentInfo.isChrome&&agentInfo.agentStr.indexOf("android 4.2.2")!=-1)h=window.environment.rawHeight;
tempKeyboardVisible=Math.abs(h-dh)>=kdbSize}}else tempKeyboardVisible=false;return tempKeyboardVisible}function keyboardShortCut_click(){ShowExtKeys();ShowStdKbd(true)}function openMenuShortCut_click(){if(showToolbar&&toolbarAvailable)THIN.toolbar.show()}function initMobile(thin,ze,callbacks){var initialZoomFactor=null;var isToggling=false;showToolbar=typeof thin.rcParams.showToolbarMobile!="undefined"?thin.rcParams.showToolbarMobile:true;function toggleFullScreenMode(){if(isToggling==false){isToggling=
true;if(!window.environment.isFullscreen){if(initialZoomFactor==null)initialZoomFactor=THIN.getZoom();logDebug("Fullscreen Mode");window.environment.requestFullscreen(document.documentElement)}else{logDebug("Exit Fullscreen Mode");window.environment.exitFullscreen(document)}}setTimeout(function(){isToggling=false},1E3)}if(mobileReady)return;hideUrlBar();THIN=thin;preventMobileKeyboardDisplay=!!THIN.clientSettings&&THIN.clientSettings.PreventMobileKeyboardDisplay===true;if(productId=="virtualui"){var errMsg=
"ClientSettings.Mobile.KeyboardCaretWait is not a valid value [{0}]";try{var _caretTimeout=helper.object.getValue(THIN,"clientSettings.Mobile.KeyboardCaretWait",null);_caretTimeout=_caretTimeout!==null&&!isNaN(_caretTimeout)?parseInt(_caretTimeout):keyboardCaretWait;if(_caretTimeout>0)keyboardCaretWait=_caretTimeout;else helper.console.warning(helper.string.format(errMsg,_caretTimeout))}catch(err){helper.console.warning(helper.string.format(errMsg,_caretTimeout))}}var mobiletools=[];var measure="";
switch(THIN.rcParams.tbSize){case "medium":measure=" tbMedium";break;case "large":measure=" tbLarge"}if(ze!=undefined)zoomEnabled=ze;if(showToolbar){mobiletools.push('<div class="popup uitaptarget" id="closequestion" style="display:none;"><div class="header center"><h3>',consts.closeConnection,'</h3></div><div class="alertBody"><div id="disconnectedIco">&nbsp;</div>',consts.areYouSureCloseConn,'</div><br/><div class="divbuttons"><a class="popuplink selected" id="closeyes">',consts.yes,'</a>&nbsp;<a class="popuplink" id="closeno">',
consts.no,"</a></div></div>",'<table id="extkeys" cellspacing="0" cellpadding="0" class="slide uitaptarget" ><tr id="extkeys_row1"></tr></table>','<table id="extkeyboard" cellspacing="0" cellpadding="0" class="slide uitaptarget" style="position:fixed"><tr id="extkeyboard_row1"></tr><tr id="extkeyboard_row2"></tr>','<tr id="extkeyboard_row3"></tr><tr id="extkeyboard_row4"></tr></table>');$(document.body).append(mobiletools.join(""));function closeyes(e){e.preventDefault();e.stopPropagation();Thinfinity.Popups.unblockDialogs();
THIN.disconnect();return false}function closeno(e){e.preventDefault();e.stopPropagation();Thinfinity.Popups.unblockDialogs();return false}document.getElementById("closeyes").addEventListener("click",closeyes);document.getElementById("closeno").addEventListener("click",closeno);document.getElementById("closeyes").addEventListener("touchend",closeyes);document.getElementById("closeno").addEventListener("touchend",closeno)}touchkbdElem=$("<input>").attr({"type":"text","id":"touchkbd","title":consts.touchKeyboard,
"value":"","autocapitalize":"off","autocorrect":"off","autocomplete":"off","spellcheck":"false"}).css({"top":"-100px","left":"-1000px","font-size":"0.1px","width":"1px","height":"1px","z-index":-1,"position":"absolute"})[0];if(agentInfo.isAndroid&&agentInfo.isChrome)touchkbdElem.style.fontSize="1px";function attachVisualEffects(){if(THIN.vncContainer==null)setTimeout(attachVisualEffects,25);else{mouseMask=helper.dom.appendJsonElement({"parentElement":THIN.vncContainer,"type":"div","attributes":{"style":"display:none;position:absolute;z-index:900009;",
"id":"mouseMask"}});$(THIN.vncContainer).append(touchkbdElem)}}attachVisualEffects();if(showToolbar)if(insertNavigator){navControl=new csNavigatorControl({offset:100,onMove:function(X,Y){if(divScrolling){THIN.vncdiv.scrollLeft=Math.min(THIN.rcParams.viewWidth-THIN.rcParams.maxWidth,THIN.vncdiv.scrollLeft+X);THIN.vncdiv.scrollTop=Math.min(THIN.rcParams.viewHeight-THIN.rcParams.maxHeight,THIN.vncdiv.scrollTop+Y);mouseMoveIntoView()}else window.scroll(getScrollLeft()+X,getScrollTop()+Y);return},onZoomIn:function(){var scale=
THIN.getZoom()*1.1;zoomStarted=true;zoom(Math.max(Math.max(zoomBottomLimit,THIN.getMinZoomFactor()),Math.min(scale,zoomTopLimit)));zoomStarted=false},onZoomOut:function(){var scale=THIN.getZoom()/1.1;zoomStarted=true;zoom(Math.max(Math.max(zoomBottomLimit,THIN.getMinZoomFactor()),Math.min(scale,zoomTopLimit)));zoomStarted=false},onActualPixels:function(){var scale=1;zoomStarted=true;zoom(scale);zoomStarted=false},onShrinkToBrowser:function(){zoomEnabled=true;var scale=THIN.getMinZoomFactor();zoomStarted=
true;zoom(scale);zoomStarted=false},getZIndex:function(){return THIN.getNextHighestZindex(document.body)}});navControl.setMode(navControl.NCM_WINDROSE);navControl.insertPane()}window["setRelativeTouch"]=function(value){relativeTouch=value};setRelativeTouch(typeof THIN.rcParams.relativeTouch!="undefined"?THIN.rcParams.relativeTouch:true);var resizeMobileTimeoutId=null;var resizeMobile=function(){if(hasOrientationChanged)lastMouseClickPosition={x:0,y:0};clearTimeout(resizeMobileTimeoutId);resizeMobileTimeoutId=
setTimeout(function(){checkScreenSize();if(THIN.getZoom&&THIN.getMinZoomFactor){if(window.environment.isFullscreen){var zoomValue=THIN.getZoom();var zoomReset=THIN.zoomFactorReset();if(zoomValue<zoomReset)zoomValue=zoomReset;window.setTimeout(function(){zoom(zoomValue);if(THIN.rcParams.scaled){THIN.center();THIN.zoomDesktop();setTimeout(function(){zoom(THIN.scale)},1)}},100)}else{if(THIN.getZoom()==THIN.getMinZoomFactor())if(THIN.rcParams.scaled)zoom(THIN.zoomFactorReset());else zoom(THIN.getScale());
else zoom(THIN.getZoom());if(THIN.rcParams.scaled){THIN.center();THIN.zoomDesktop();setTimeout(function(){zoom(THIN.scale)},1)}}if(hasOrientationChanged)if(THIN.rcParams.resolution=="fittobrowser"&&THIN.resizeDesktop)THIN.resizeDesktop();else if(THIN.rcParams.resolution=="fittoscreen"&&THIN.refreshFitToScreen)THIN.refreshFitToScreen();hasOrientationChanged=false}},100)};window.addEventListener("orientationchange",function(){hasOrientationChanged=true;$(touchkbdElem).blur()});environment.on("orientationChange",
function(){resizeMobile()});environment.on("resizeComplete",function(){if(!(stdKeyboardVisible&&isKeyboardVisible()))resizeMobile()});function sendParams(mouseControl,remotePointer,pixelFormat){THIN.sendCmd("cmd=params&mouseControl="+mouseControl+"&kbdControl="+mouseControl+"&remotePointer="+remotePointer+"&pixelFormat="+pixelFormat)}function refreshButtonStates(){if(THIN.rcParams.active&&THIN.rcParams.mouseControl)$("#kimouse").fadeTo(0,1);else $("#kimouse").fadeTo(0,.4);if(THIN.rcParams.scaled)$("#scale").parent().removeClass("ui-btn-up-b").addClass("ui-btn-down-a");
else $("#scale").parent().removeClass("ui-btn-down-a").addClass("ui-btn-up-b");if(THIN.rcParams.pixelFormat==1)$("#colors").parent().removeClass("ui-btn-up-b").addClass("ui-btn-down-a");else $("#colors").parent().removeClass("ui-btn-down-a").addClass("ui-btn-up-b")}if(showToolbar){function setClick(id,callback){var elem=document.getElementById(id);if(elem)elem.addEventListener("click",function(e){e.preventDefault();e.stopPropagation();callback(e)},false)}_tba={sendCtrlAntDel:function(e){THIN.sendFunctionKey("CtrlAltDel")},
sendCtrlEsc:function(e){THIN.sendFunctionKey("ctrlEsc")},refreshScreen:function(e){if(THIN.rcParams.active)THIN.refresh()},toggleMonitor:function(e){THIN.setMonitor(THIN.rcParams.monitor+1)},toggleMouse:function(e){sendParams(!THIN.rcParams.mouseControl,THIN.rcParams.remotePointer,THIN.rcParams.pixelFormat)},toggleScaled:function(e){THIN.rcParams.scaled=!THIN.rcParams.scaled;THIN.zoomDesktop();refreshButtonStates()},showSettings:function(e){editAction=2;openPreferences()},showStdKbd:function(e){keyboardShortCut_click(true)},
toggleFullScreen:function(e){toggleFullScreenMode()},showExtKbd:function(e){openExtKeyboard();ShowExtKeys()},toggleTouchRedir:function(e){ThinVNCTouchManager.toggleCurrentMode()},sendRightClick:function(e){btnRightClick()},queryDisconnect:function(e){if(navControl.isVisible())navControl.hide();$.blockUI({message:$("#closequestion"),css:{"padding":0,"margin":0,"width":"100%","height":"100%","top":"0px","left":"0px","textAlign":"center","backgroundColor":"transparent","border":"none","cursor":"auto"},
centerX:true,centerY:true})}};if(agentInfo.isIOS&&agentInfo.isSafari){setClick("ctrlAltDel",_tba.sendCtrlAntDel);setClick("ctrlEsc",_tba.sendCtrlEsc);setClick("refresh",_tba.refreshScreen);setClick("monitor",_tba.toggleMonitor);setClick("kimouse",_tba.toggleMouse);setClick("kiscale",_tba.toggleScaled);setClick("kisettings",_tba.showSettings)}else{$("#ctrlAltDel").click(_tba.sendCtrlAntDel);$("#ctrlEsc").click(_tba.sendCtrlEsc);$("#refresh").click(_tba.refreshScreen);$("#monitor").click(_tba.toggleMonitor);
$("#kimouse").click(_tba.toggleMouse);$("#kiscale").click(_tba.toggleScaled);$("#kisettings").click(_tba.showSettings)}}if(productId=="virtualui"){Object.defineProperty(THIN,"showKeyboard",{"enumerable":true,"configurable":false,"writable":false,"value":keyboardShortCut_click});if(supportsFullScreenMode==true)Object.defineProperty(THIN,"toggleFullscreen",{"enumerable":true,"configurable":false,"writable":false,"value":toggleFullScreenMode})}if(!THIN.events)THIN.events={};THIN.events.onServerConnecting=
function(e){if(typeof callbacks!="undefined"&&callbacks.onServerConnecting)callbacks.onServerConnecting(e)};THIN.events.onSessionEnd=function(e){if(typeof callbacks!="undefined"&&callbacks.onSessionEnd)callbacks.onSessionEnd(e)};THIN.events.onServerConnectionError=function(e){$.unblockUI();if(typeof callbacks!="undefined"&&callbacks.onServerConnectionError)callbacks.onServerConnectionError(e)};THIN.events.onServerError=function(e){$.unblockUI();if(typeof callbacks!="undefined"&&callbacks.onServerError)callbacks.onServerError(e)};
THIN.events.onServerConnect=function(e){var previousText="x";var prevoustTextTimer=null;var isChrome229=agentInfo.isAndroid&&agentInfo.isChrome&&agentInfo.chromeVersion>="50.";zoom(1);hideUrlBar();adjustMainSize();$("#connectpanel").hide();$("#mainheader").hide();helper.dom.addEvent(window,"touchmove",function(e){if(!dialogVisible)e.preventDefault()},{"passive":false});touchkbdElem.value="";$(touchkbdElem).unbind("keyup");$(touchkbdElem).unbind("keydown");if(helper.object.existsPath(window,"Thinfinity.Driver.MobileKeyboard")){if(!THIN.mobileKeyboard)THIN.mobileKeyboard=
new Thinfinity.Driver.MobileKeyboard({"input":touchkbdElem,"output":THIN.sendKey,"methods":{"isPrintableKey":function(keyCode){return keyCode>=33&&keyCode<=126||keyCode>=193&&keyCode<=248},"isControlCharacter":function(keyCode){return keyCode>=0&&keyCode<=31}}})}else{touchkbdElem.value=agentInfo.isChromium&&agentInfo.majorVersion>=5?"":"x";$(touchkbdElem).keydown(function(e){key=e.which;if(key==9){THIN.sendKey(key,0,"down");THIN.sendKey(key,0,"up");e.preventDefault();THIN.lastKeyCode=key}else THIN.lastKeyCode=
0});$(touchkbdElem).keyup(function(e){var rt=(new Date).getTime();var key=e.which;var kcode=0;if(rt-replyTime>50||key!=lastKey){replyTime=rt;var str=touchkbdElem.value;var len=str.length;if(agentInfo.isChromium&&agentInfo.majorVersion<5){elem.value="";if(len<1){if(key==8||key==13){if(key==8&&backSpacePressed)return;sendSpecialKeysBegin();THIN.sendKey(key,0,"down");THIN.sendKey(key,0,"up");sendSpecialKeysEnd();if(key==8){backSpacePressed=true;window.setTimeout(function(){backSpacePressed=false},100)}}}else{sendSpecialKeysBegin();
for(var i=0;i<len;++i){key=str.charCodeAt(i);kcode=getFlatKeyCode(key);THIN.sendKey(kcode,key,"down");THIN.sendKey(kcode,key,"up")}sendSpecialKeysEnd()}}else if(len<2){if(THIN.lastKeyCode==9)return;if(key==0)key=len==0?8:13;if(isChrome229&&key==229)key=8;sendSpecialKeysBegin();if(agentInfo.isIOS==true&&agentInfo.isSafari==true&&str=="x"&&key!=8&&key!=13)sendSpecialKeysEnd();else{THIN.sendKey(key,0,"down");THIN.sendKey(key,0,"up");sendSpecialKeysEnd()}}else{sendSpecialKeysBegin();for(var i=1;i<len;++i){key=
str.charCodeAt(i);kcode=getFlatKeyCode(key);THIN.sendKey(kcode,key,"down");THIN.sendKey(kcode,key,"up")}sendSpecialKeysEnd()}lastKey=key;if(isChrome229)lastKey=e.which;touchkbdElem.value="x";touchkbdElem.selectionStart=touchkbdElem.selectionEnd=touchkbdElem.value.length}if(key==13&&(agentInfo.isWindows||agentInfo.isAndroid&&(!agentInfo.isChrome||agentInfo.isChrome&&agentInfo.chromeVersion<"5.0.0")))$(touchkbdElem).blur()});if(agentInfo.isAndroid&&agentInfo.isChrome&&agentInfo.chromeVersion=="5.1.1"&&
agentInfo.agentStr.indexOf("sm-g900t1")!=-1){$(touchkbdElem).unbind("keyup");touchkbdElem.onkeyup=function(e){var rt=(new Date).getTime();var key=e.which;var tempStr="";if(rt-replyTime>40||key!=lastKey){replyTime=rt;var str=touchkbdElem.value;tempStr=str.replace(previousText,"");var len=tempStr.length;if(len<1){if(THIN.lastKeyCode==9)return;if(key==0)key=len==0?8:13;sendSpecialKeysBegin();if(agentInfo.isIOS==true&&agentInfo.isSafari==true&&tempStr=="x"&&key!=8&&key!=13)sendSpecialKeysEnd();else{THIN.sendKey(key,
0,"down");THIN.sendKey(key,0,"up");sendSpecialKeysEnd()}}else{sendSpecialKeysBegin();for(var i=0;i<len;++i){key=tempStr.charCodeAt(i);THIN.sendKey(0,key,"down");THIN.sendKey(0,key,"up")}sendSpecialKeysEnd()}lastKey=key;previousText=str;clearTimeout(prevoustTextTimer);prevoustTextTimer=setTimeout(function(){previousText="x";touchkbdElem.value="x";touchkbdElem.selectionStart=touchkbdElem.selectionEnd=touchkbdElem.value.length},250)}if(key==13&&(agentInfo.isWindows||agentInfo.isAndroid&&(!agentInfo.isChrome||
agentInfo.isChrome&&agentInfo.chromeVersion<"5.0.0")))$(touchkbdElem).blur()}}}$(touchkbdElem).focus(function(){kbScreenHeight=window.environment.availHeight||$(window).height();kbScreenWidth=window.environment.availWidth||$(window).width();this.selectionStart=this.selectionEnd=this.value.length});$(touchkbdElem).blur(function(){if(!isKeyboardVisible())return;helper.style.addClass(document.body,"mobile");clearTimeout(keyboardSettings["timeoutId"]);clearInterval(keyboardSettings["intervalId"]);touchkbdElem.style.top=
"-100px";touchkbdElem.style.left="-1000px";_showingStdKdb=false;if(productId==="thinvnc"){document.body.height=_domHeight+"px";window.scrollTo(0,_winScrollY)}window.clearInterval(kbdTimer);if(stdKeyboardVisible){stdKeyboardVisible=false;hideExtKeys()}adjustMainSize();zoom(THIN.getZoom(),true)});if(typeof callbacks!="undefined"&&callbacks.onServerConnect)callbacks.onServerConnect(e)};THIN.events.onServerDisconnect=function(e){if(!isBlocked())if(e&&!e.isDefaultPrevented())if(window.name.substring(0,
8)=="RDPCONN_"){window.opener="x";window.close()}else window.location.href="/";else{if(kbdTimer)window.clearInterval(kbdTimer);$(touchkbdElem).blur()}if(THIN.mobileKeyboard)THIN.mobileKeyboard.dispose();if(typeof callbacks!="undefined"&&callbacks.onServerDisconnect)callbacks.onServerDisconnect(e);toolbarAvailable=helper.object.existsPath(THIN,"toolbar");if(window.environment.isFullscreen==true)toggleFullScreenMode()};THIN.events.onServerReconnect=function(e){if(typeof callbacks!="undefined"&&callbacks.onServerReconnect)callbacks.onServerReconnect(e);
toolbarAvailable=helper.object.existsPath(THIN,"toolbar")};THIN.events.onServerCommandResult=function(obj){if(THIN.connected){if(typeof THIN.rcParams.pin!="undefined"&&THIN.rcParams.pin!="")$("#mouse").button("disable");refreshButtonStates();if(typeof callbacks!="undefined"&&callbacks.onServerCommandResult)callbacks.onServerCommandResult(obj)}};THIN.events.onScreenReceived=function(obj){if(THIN.connected)if(typeof callbacks!="undefined"&&callbacks.onScreenReceived)callbacks.onScreenReceived(obj)};
THIN.events.onSessionStart=function(obj){if(THIN.connected){if(productId=="thinrdp"&&agentInfo.isMobile==true&&window.environment.fullScreenAvailable==true)if(window.environment.rawWidth==THIN.rcParams.viewWidth/window.environment.currentDevicePixelRatio+(window.environment.margin.left+window.environment.margin.right)&&window.environment.rawHeight==THIN.rcParams.viewHeight/window.environment.currentDevicePixelRatio+(window.environment.margin.top+window.environment.margin.bottom)){var zoomReset=THIN.zoomFactorReset();
zoomBottomLimit=zoomReset;zoom(zoomReset)}else;if(window.environment.isFullscreen==true){var zoomReset=THIN.zoomFactorReset();var zoomValue=THIN.getZoom();if(zoomValue<zoomReset)zoomValue=zoomReset}if(THIN.rcParams.viewWidth>window.environment.rawWidth||THIN.rcParams.viewHeight>window.environment.rawHeight)zoomBottomLimit=THIN.getScale();if(isNewConnection){interfaceMethods=THIN.display.managerInterface.methods;interfaceProperties=THIN.display.managerInterface.properties;THIN.display.managerInterface.on("onMouseAnimationFrameEnd",
function(){if(lastEvent&&getRelativeTouchByPointerType(lastEvent)){startMouseX=savedX;startMouseY=savedY}})}THIN.show();if(typeof callbacks!="undefined"&&callbacks.onSessionStart)callbacks.onSessionStart(obj);const buildToolbar=()=>{toolbarAvailable=helper.object.existsPath(THIN,"toolbar");addToolbarButtons()};THIN?.__thinMenuProps__?.ready(()=>{setTimeout(buildToolbar,2E3)});if(isNewConnection==true){isNewConnection=false;moveMouseToStart()}}};THIN.events.onConnectionLost=function(e){if(typeof callbacks!=
"undefined"&&callbacks.onConnectionLost)callbacks.onConnectionLost(e)};THIN.events.onConnectionRestored=function(e){if(typeof callbacks!="undefined"&&callbacks.onConnectionRestored)callbacks.onConnectionRestored(e)};var shortcut={};if(helper.object.existsPath(THIN,"rcParams.mobile.extendedKeyboard")&&THIN.rcParams.mobile.extendedKeyboard.enabled!=false&&THIN.rcParams.mobile.extendedKeyboard.keys)shortcut=THIN.rcParams.mobile.extendedKeyboard.keys;addKey(1,consts.F1,112,undefined,undefined,undefined,
shortcut.F1);addKey(1,consts.F2,113,undefined,undefined,undefined,shortcut.F2);addKey(1,consts.F3,114,undefined,undefined,undefined,shortcut.F3);addKey(1,consts.F4,115,undefined,undefined,undefined,shortcut.F4);addKey(1,consts.F5,116,undefined,undefined,undefined,shortcut.F5);addKey(1,consts.F6,117,undefined,undefined,undefined,shortcut.F6);addKey(1,consts.Esc,27,undefined,undefined,undefined,shortcut.Esc);addKey(1,consts.Print,42,undefined,undefined,undefined,shortcut.Print);addKey(1,consts.Scrlck,
44,undefined,undefined,undefined,shortcut.Scrlck);addKey(1,consts.Pause,19,undefined,undefined,undefined,shortcut.Pause);addKey(1,consts.NumL,144,undefined,undefined,undefined,shortcut.NumL);addKey(2,consts.F7,118,undefined,undefined,undefined,shortcut.F7);addKey(2,consts.F8,119,undefined,undefined,undefined,shortcut.F8);addKey(2,consts.F9,120,undefined,undefined,undefined,shortcut.F9);addKey(2,consts.F10,121,undefined,undefined,undefined,shortcut.F10);addKey(2,consts.F11,122,undefined,undefined,
undefined,shortcut.F11);addKey(2,consts.F12,123,undefined,undefined,undefined,shortcut.F12);addKey(2,consts.PgUp,33,undefined,undefined,undefined,shortcut.PgUp);addKey(2,consts.PgDn,34,undefined,undefined,undefined,shortcut.PgDn);addKeyImg(2,imgMPath+"arrow-up.png",38,undefined,undefined,undefined,shortcut.Up);addKey(2,consts.Return,13,4,undefined,undefined,undefined,shortcut.Return);addKey(3,consts.WinKey,0,4,sendCtrlEsc,undefined,shortcut.WinKey);addKey(3,consts.CtrlAltDel,0,4,sendCtrlAltDel,undefined,
shortcut.CtrlAltDel);addKey(3,consts.Computer,0,4,sendShellExplorer,undefined,shortcut.Computer);addKey(3,consts.Tab,9);addKeyImg(3,imgMPath+"arrow-left.png",undefined,undefined,undefined,37,shortcut.Left);addKeyImg(3,imgMPath+"arrow-down.png",undefined,undefined,undefined,40,shortcut.Down);addKeyImg(3,imgMPath+"arrow-right.png",undefined,undefined,undefined,39,shortcut.Right);addKeyImg(3,imgMPath+"querty.png",0,2,closeExtKeyboard);addExtKey(1,consts.Ctrl,0,2,"keyctrl",undefined,shortcut.Ctrl);addExtKey(1,
consts.Alt,0,2,"keyalt",undefined,shortcut.Alt);addExtKey(1,consts.Shift,0,2,"keyshift",undefined,shortcut.Shift);addExtKey(1,consts.Ins,0,2,45,undefined,shortcut.Ins);addExtKey(1,consts.Del,0,2,46,undefined,shortcut.Del);addExtKey(1,consts.BackSpace,8,2,8,undefined,shortcut.BackSpace);addExtKey(1,consts.Home,0,2,36,undefined,shortcut.Home);addExtKey(1,consts.End,0,2,35,undefined,shortcut.End);addExtKey(1,consts.Next,0,2,9,undefined,shortcut.Next);addExtKey(1,String.fromCharCode(9650),0,2,"keyCloseKeyboards",
undefined,undefined);$("#extkeys").css("margin-left","-"+$("#extkeys").width()/2+"px");$("div.key").bind("touchstart",function(e){if(!helper.style.hasClass(this,"disabledKey"))$(this).addClass("pressed")});$("div.key").bind("touchend",function(e){$(this).removeClass("pressed")});$("#keyctrl").bind("touchend",function(e){CtrlKeyToggle()});$("#keyalt").bind("touchend",function(e){AltKeyToggle()});$("#keyshift").bind("touchend",function(e){ShiftKeyToggle()});$("#keyCloseKeyboards").bind("touchend",function(e){if(extKeyboardVisible)closeExtKeyboard();
$(touchkbdElem).blur();hideExtKeys()});window.addEventListener("scroll",function(e){window.clearTimeout(scrollingTOUT);scrollingTOUT=setTimeout(function(){alignPanels()},66)},false);$(touchkbdElem).blur();if(showToolbar){hideExtKeys();hideExtKeyboard()}hideUrlBar();function configureVirtualKeyboard(bool){keyboardSettings["available"]=helper.object.convertTo(bool,"boolean")}Object.defineProperty(THIN,"virtualKeyboard",{"enumerable":true,"configurable":false,"set":function(bool){configureVirtualKeyboard(bool)},
"get":function(){return keyboardSettings["available"]}});if(THIN.rcParams!=undefined&&typeof THIN.rcParams.virtualKeyboard!="undefined")configureVirtualKeyboard(THIN.rcParams.virtualKeyboard);mobileReady=true}function addToolbarButtons(){if(showToolbar&&toolbarAvailable&&_tba){var mobileButtons=[];mobileButtons.push({"caption":"Right Click","attributes":{"id":"rightclickBtn","icon":"thin-rightclick","class":!THIN.rcParams.mouseControl?"lower-opacity":""},"handler":!THIN.rcParams.mouseControl?function(){}:
_tba.sendRightClick});if(!THIN.rcParams.disableExtKeys)mobileButtons.push({"caption":"Function Keyboard","attributes":{"id":"fnKeyboardBtn","icon":"thin-functionkeyboard","class":!THIN.rcParams.mouseControl?"lower-opacity":""},"handler":!THIN.rcParams.mouseControl?function(){}:_tba.showExtKbd});mobileButtons.push({"caption":"Keyboard","attributes":{"id":"keyboardBtn","icon":"thin-keyboard","class":!THIN.rcParams.mouseControl?"lower-opacity":""},"handler":!THIN.rcParams.mouseControl?function(){}:_tba.showStdKbd});
if(insertNavigator&&(!supportsFullScreenMode&&!agentInfo.isMobile))mobileButtons.push({"caption":"Navigator","attributes":{"id":"navigatorBtn","icon":"thin-inspector"},"handler":function(e){if(navControl.isVisible())navControl.hide();else navControl.show()}});if(helper.object.getValue(THIN.rcParams,"mobile.canChangeTouchMode",true,{ignoreCase:true})){if(THIN.toolbar.getToggledData().indexOf("touchModeBtn")!=-1)setRelativeTouch(false);mobileButtons.push({"caption":"Set Absolute Touch","attributes":{"icon":"thin-absolutetouch",
"id":"touchModeBtn"},"handler":()=>{if(relativeTouch)THIN.__thinMenuProps__.updateProperty({action:"touchModeBtn",caption:"Set Relative Touch",attributes:{"icon":"thin-relativetouch"}});else THIN.__thinMenuProps__.updateProperty({action:"touchModeBtn",caption:"Set Absolute Touch",attributes:{"icon":"thin-absolutetouch"}});setRelativeTouch(!relativeTouch)}})}if(supportsFullScreenMode&&productId!="webfmx"&&productId!="virtualui"&&(!agentInfo.isSafari||agentInfo.isSafari&&agentInfo.ipadModel==="pro"))if(!helper.object.getValue(THIN.rcParams,
"mobile.disableFullScreen",false,{ignoreCase:true}))mobileButtons.push({"caption":"Fullscreen","attributes":{"id":"fullscreenBtn","icon":"thin-enter-fullscreen"},"handler":_tba.toggleFullScreen});mobileButtons.push({"caption":"Touch Redirection","attributes":{"id":"touchRedirBtn","class":!THIN.rcParams.mouseControl?"lower-opacity":"","icon":"thin-touchredir"},"initialState":"hidden","handler":!THIN.rcParams.mouseControl?function(){}:_tba.toggleTouchRedir});mobileButtons.forEach(function(mb){THIN.__thinMenuProps__.addProperty({parent:null,
insertBefore:thinRDPconsts.options,action:mb.attributes.id,...mb})})}}function hideUrlBar(){window.setTimeout(function(){window.scroll(0,1);adjustMainSize()},1500)}function initTouchDevice(){self.initTouchManager(agentInfo.isTouch)}function getFlatKeyCode(charCode){var fv=0;switch(true){case charCode==170||charCode>=192&&charCode<=198||charCode>=224&&charCode<=230||charCode>=256&&charCode<=257||charCode>=260&&charCode<=261:fv=65;break;case charCode>=200&&charCode<=203||charCode>=232&&charCode<=235||
charCode>=274&&charCode<=275||charCode>=278&&charCode<=281:fv=69;break;case charCode>=204&&charCode<=207||charCode>=236&&charCode<=239||charCode>=298&&charCode<=299||charCode>=302&&charCode<=303:fv=73;break;case charCode==186||charCode>=210&&charCode<=214||charCode==216||charCode>=242&&charCode<=246||charCode==248||charCode>=332&&charCode<=333||charCode>=338&&charCode<=339:fv=79;break;case charCode>=217&&charCode<=220||charCode>=249&&charCode<=252||charCode>=362&&charCode<=363:fv=85;break;case charCode==
231||charCode==199||charCode>=262&&charCode<=263||charCode>=268&&charCode<=269:fv=67;break;case charCode>=323&&charCode<=324:fv=209;break}return fv}this.initTouchManager=function(useLocalGestures){var redirectionSettings={};ThinVNCTouchManager["redirectionStarted"]=function(){if(showToolbar&&toolbarAvailable){THIN.toolbar.updateElem({"attributes":{"id":"touchRedirBtn"},"visible":true,"toggleState":true});THIN.toolbar.updateElem({"attributes":{"id":"rightclickBtn"},"visible":false})}$(THIN.cursorCanvas).hide()};
ThinVNCTouchManager["redirectionStopped"]=function(){if(showToolbar&&toolbarAvailable){THIN.toolbar.updateElem({"attributes":{"id":"touchRedirBtn"},"toggleState":false});THIN.toolbar.updateElem({"attributes":{"id":"rightclickBtn"},"visible":true})}$(THIN.cursorCanvas).show()};if(useLocalGestures){var tapPosThreshold=25;var previousMouseX=-9999;var previousMouseY=-9999;var previousTapTime=0;var lastScale=null;var pinchGestureMinDistance=20;var wheelGestureMinDistance=20;var swipeFingerCount=3;var gesture=
null;var oldGesture=null;var captureStartEvent=null;var captureDistanceX=0;var captureDistanceY=0;var wheelSettings={"axis":null,"direction":null,"previousValue":null,"thresholdStartDetection":15,"thresholdDistance":2,"stepValue":120,"lastScale":null,"inverted":typeof THIN.rcParams.mouseWheelDirection!="undefined"?THIN.rcParams.mouseWheelDirection==-1:false,"elapsedTime":0,"lasttimeSent":0,"sentTime":150};contextMenu={"elem":null,"items":[{"id":"btnDoubleClick","handler":btnDblClickFromCtxMenu,"text":"Double click",
"icon":null},{"id":"btnRightClick","handler":btnRightClickFromCtxMenu,"text":"Right click","icon":null},{"id":"btnVKeyboard","handler":keyboardShortCut_click,"text":"Open keyboard","icon":null},{"id":"btnOpenMenu","handler":openMenuShortCut_click,"text":"Open menu","icon":null}],"timeoutId":null,"autoHideTime":2E3,"autoHideArea":150,"zIndex":889E3};const _actionsCtx={init:{"wheel":{beforeTriggered:false}}};if(agentInfo.isChromium&&agentInfo.agentStr.indexOf("android 4.2.2")!=-1)$(document).click(function(e){var elem=
(relativeTouch?document.elementFromPoint(cursorCanvasX(),cursorCanvasY()):null)||e.target;var tapElement=e&&e.target?e.target:null;if($(elem).hasClass("taptarget")||$(elem.parentElement).hasClass("taptarget")||$(elem).hasClass("disabled")){$(elem).trigger("tap");return}if($(elem).hasClass("ignoremouse")||$(elem.parentElement).hasClass("ignoremouse"))return;if($(tapElement).hasClass("uitaptarget")||$(tapElement).parents().hasClass("uitaptarget"))return;var currentTime=(new Date).getTime();if(currentTime-
previousTapTime>50){previousTapTime=currentTime;lastEvent=e;var x=getTouchXFixed();var y=getTouchYFixed();if(!zoomStarted){button="left";touchstate=1;try{mouseScrollX=x;mouseScrollY=y;if(relativeTouch){startMouseX=cursorCanvasX();startMouseY=cursorCanvasY()}else{startMouseX=getTouchX(relativeTouch);startMouseY=getTouchY(relativeTouch)}var x=startMouseX;var y=startMouseY;if(typeof THIN.onTap!="undefined"){THIN.onTap(x,y);e.preventDefault()}}finally{touchstate=0}if(touchstate==3)mouseMoveIntoView()}}else return});
function isRangePosition(e){var x=e.clientX||e.pageX;var y=e.clientY||e.pageY;var r=x>previousMouseX+tapPosThreshold?true:x<previousMouseX-tapPosThreshold?true:y>previousMouseY+tapPosThreshold?true:y<previousMouseY-tapPosThreshold?true:false;previousMouseX=x;previousMouseY=y;return!r}function getGesture(e){var ret=null;if(e&&e.pointers.length>1){var fc=e.pointers.length;if(fc>=swipeFingerCount)ret="swipe";else{var wheelDistance=Math.max(Math.abs(captureStartEvent.center.x-e.center.x),Math.abs(captureStartEvent.center.y-
e.center.y));var pinchDistance=Math.max(Math.abs(Math.abs(e.pointers[0].clientX-e.pointers[1].clientX)-captureDistanceX),Math.abs(Math.abs(e.pointers[0].clientY-e.pointers[1].clientY)-captureDistanceY));if(pinchDistance>pinchGestureMinDistance&&wheelDistance<wheelGestureMinDistance)ret="pinch";else if(wheelDistance>wheelGestureMinDistance&&pinchDistance<pinchGestureMinDistance)ret="wheel"}}return ret}function multiGestureEnds(){if(zoomStarted)window.setTimeout(function(){zoomStarted=false},300);oldGesture=
gesture=null;if(touchstate==3)mouseMoveIntoView();wheelSettings.axis=null;captureStartEvent=null;captureDistanceX=0;captureDistanceY=0;clearTimeout(gestureTimeout);scrollLeftCapture=null;scrollTopCapture=null}function createContextMenu(){contextMenu.elem=helper.dom.appendJsonElement({"parentElement":THIN.vncContainer,"type":"div","id":"contextMenu","attributes":{"class":"context-menu contextmenu"}});contextMenu.items.forEach(function(item){var itemElem=helper.dom.appendJsonElement({"parentElement":contextMenu.elem,
"type":"div","attributes":{"class":"item contextmenu","id":item.id},"events":{"click":function(){}}});itemElem.handler=item.handler;helper.dom.appendJsonElement({"parentElement":itemElem,"type":"div","attributes":{"class":"icon contextmenu"}});helper.dom.appendJsonElement({"parentElement":itemElem,"type":"div","attributes":{"class":"line contextmenu"}});helper.dom.appendJsonElement({"parentElement":itemElem,"type":"div","attributes":{"class":"text contextmenu"},"content":item.text})})}function showContextMenu(x,
y){if(!contextMenu.elem)createContextMenu();contextMenu.elem.x=x;contextMenu.elem.y=y;var zIndex=helper.style.getAttribute(THIN.cursorCanvas,"z-index");if(zIndex!="")zIndex=parseInt(zIndex,10)-10;else zIndex=contextMenu.zIndex;contextMenu.elem.style.zIndex=zIndex;contextMenu.elem.style.visibility="hidden";contextMenu.elem.style.display="block";var size=helper.size.get(contextMenu.elem);var margin=15;if(margin+size.width+x-THIN.vncdiv.scrollLeft>THIN.rcParams.maxWidth)x=THIN.vncdiv.scrollLeft+THIN.rcParams.maxWidth-
(size.width+margin);if(margin+size.height+y-THIN.vncdiv.scrollTop>THIN.rcParams.maxHeight)y=THIN.vncdiv.scrollTop+THIN.rcParams.maxHeight-(size.height+margin);contextMenu.elem.style.left=x+"px";contextMenu.elem.style.top=y+"px";contextMenu.elem.querySelectorAll(".item.contextmenu").forEach(function(itemElem){helper.style.removeClass(itemElem,"selected")});THIN.avoidSendMouseMove=true;contextMenu.elem.style.visibility="visible"}function isContextMenuVisible(){return contextMenu.elem&&contextMenu.elem.style.display!=
"none"}function getItem(elem){if(elem.className.indexOf("item contextmenu")!=-1)return elem;else if(elem.className.indexOf(".context-menu.contextmenu")!=-1)return;else if(elem.parentElement.className.indexOf("item contextmenu")!=-1)return elem.parentElement;else return null}function checkContextMenu(e,isTap){if(isContextMenuVisible()){var x,y=0;var elem=null;var relativeTouchFromPointer=getRelativeTouchByPointerType(e);let mPosition=getMouseScreenPosition();x=mPosition.x;y=mPosition.y;if(!relativeTouchFromPointer)elem=
e.target;if(Math.abs(x-contextMenu.elem.x)+Math.abs(y-contextMenu.elem.y)>contextMenu.autoHideArea){hideContextMenu(true);return false}if(relativeTouchFromPointer)elem=document.elementFromPoint(cursorCanvasX()-THIN.vncdiv.scrollLeft*THIN.scale,cursorCanvasY()-THIN.vncdiv.scrollTop*THIN.scale);if(elem&&elem.className.indexOf("contextmenu")!=-1){var item=getItem(elem);if(item)if(isTap){if(!relativeTouchFromPointer)setTimeout(function(){helper.style.add(item,"selected")},1);if(item.handler){document.body.focus();
hideContextMenu(true);item.handler()}}else if(item.className.indexOf("selected")==-1){contextMenu.elem.querySelectorAll(".item.contextmenu").forEach(function(itemElem){helper.style.removeClass(itemElem,"selected")});helper.style.add(item,"selected")}return true}else if(isTap)hideContextMenu(true);return false}else return false}function hideContextMenu(immediately){clearTimeout(contextMenu.timeoutId);if(contextMenu.elem&&contextMenu.elem.style.display!="none"){if(immediately===true){THIN.avoidSendMouseMove=
false;contextMenu.elem.style.display="none"}else contextMenu.timeoutId=setTimeout(function(){THIN.avoidSendMouseMove=false;contextMenu.elem.style.display="none"},contextMenu.autoHideTime);return false}}var scrollLeftCapture=null;var scrollTopCapture=null;var gestureTimeout=null;var _actionsProcessors={"pinchStart":function(e){hideContextMenu();oldGesture=gesture=null;if(e&&e.pointers.length>1){e.srcEvent.stopPropagation();e.srcEvent.preventDefault()}clearTimeout(gestureTimeout);captureStartEvent=
e;captureDistanceX=Math.abs(captureStartEvent.pointers[0].clientX-captureStartEvent.pointers[1].clientX);captureDistanceY=Math.abs(captureStartEvent.pointers[0].clientY-captureStartEvent.pointers[1].clientY);lastEvent=e;startMouseX=getTouchX(relativeTouch);startMouseY=getTouchY(relativeTouch);if(!zoomStarted){button="left";touchstate=1}lastScale=THIN.getZoom()},"pinchMove":function(e){if(gesture==null){oldGesture=gesture;gesture=getGesture(e);clearTimeout(gestureTimeout);gestureTimeout=setTimeout(function(){var newGesture=
getGesture(e);if(newGesture!=gesture&&gesture!=null){captureStartEvent=e;captureDistanceX=Math.abs(captureStartEvent.pointers[0].clientX-captureStartEvent.pointers[1].clientX);captureDistanceY=Math.abs(captureStartEvent.pointers[0].clientY-captureStartEvent.pointers[1].clientY)}if(gesture!==newGesture)oldGesture=gesture;gesture=newGesture},3E3)}},"zoomPanStart":function(e){hideContextMenu();oldGesture=gesture=null;clearTimeout(gestureTimeout);captureStartEvent=e;captureDistanceY=Math.abs(captureStartEvent.pointers[0].clientY-
captureStartEvent.pointers[1].clientY);captureDistanceX=Math.abs(captureStartEvent.pointers[0].clientX-captureStartEvent.pointers[1].clientX);lastEvent=e;startMouseX=getTouchX(relativeTouch);startMouseY=getTouchY(relativeTouch)},"zoomPanMove":function(e){if(gesture==null){oldGesture=gesture;gesture=getGesture(e);clearTimeout(gestureTimeout);gestureTimeout=setTimeout(function(){var newGesture=getGesture(e);if(newGesture!=gesture&&gesture!=null){captureStartEvent=e;captureDistanceX=Math.abs(captureStartEvent.pointers[0].clientX-
captureStartEvent.pointers[1].clientX);captureDistanceY=Math.abs(captureStartEvent.pointers[0].clientY-captureStartEvent.pointers[1].clientY)}if(gesture!==newGesture)oldGesture=gesture;gesture=newGesture},3E3)}},"screenPan":function(e){if(!THIN.rcParams.scaled&&!isContextMenuVisible())if(divScrolling){let th=5;var mX=THIN.mouseX;let sl=THIN.vncdiv.scrollLeft;let mw=THIN.rcParams.maxWidth;let vw=THIN.rcParams.viewWidth;var mY=THIN.mouseY;let st=THIN.vncdiv.scrollTop;let mh=THIN.rcParams.maxHeight;
let vh=THIN.rcParams.viewHeight;if(sl<mX+th-mw||mX<sl&&sl>mX-sl){mX=mX<sl?mX:mX+th-mw;if(mw+mX>vw)mX=vw-mw;else if(mX<0)mX=0;THIN.vncdiv.scrollLeft=mX}if(st<mY+th-mh||mY<st&&st>mY-st){mY=mY<st?mY:mY+th-mh;if(mh+mY>vh)mY=vh-mh;else if(mY<0)mY=0;THIN.vncdiv.scrollTop=mY}}else{var sl=getScrollLeft();var st=getScrollTop();var sw=screenWidth;var sh=screenHeight;if(sl<THIN.mouseX-sw||THIN.mouseX<sl&&sl>THIN.mouseX-sl)sl=THIN.mouseX<sl?THIN.mouseX:THIN.mouseX-sw;if(st<THIN.mouseY-sh||THIN.mouseY<st&&st>
THIN.mouseY-st)st=THIN.mouseY<st?THIN.mouseY:THIN.mouseY-sh;window.scroll(sl,st)}},"hold":function(e,btn){var relativeTouchFromPointer=getRelativeTouchByPointerType(e);if(!isContextMenuVisible()&&held.indexOf(btn)===-1){held.push(btn);mouseDown(btn,startMouseX,startMouseY,relativeTouchFromPointer)}},"release":function(e,btn){var relativeTouchFromPointer=getRelativeTouchByPointerType(e);if(held.indexOf(btn)!==-1){held=held.filter(function(t){return t!==btn});mouseUp(btn,startMouseX,startMouseY,relativeTouchFromPointer)}}};
var actions=ThinVNCTouchManager["actions"]={"zoomPan":function(e){var eType=e&&e.type?e.type.toUpperCase():null;if(eType.indexOf("START")!=-1)_actionsProcessors.zoomPanStart.call(this,e);else if(eType.indexOf("MOVE")!=-1)_actionsProcessors.zoomPanMove.call(this,e);else if(eType.indexOf("END")!=-1||eType.indexOf("CANCEL")!=-1)multiGestureEnds();else{lastEvent=e;var deltaX=(captureStartEvent.center.x-e.center.x)/THIN.zoomFactor;var deltaY=(captureStartEvent.center.y-e.center.y)/THIN.zoomFactor;if(scrollTopCapture==
null)scrollTopCapture=THIN.vncdiv.scrollTop;if(scrollLeftCapture==null)scrollLeftCapture=THIN.vncdiv.scrollLeft;var sl=scrollLeftCapture+deltaX;var st=scrollTopCapture+deltaY;divScroll(sl,st);touchstate=3}},"zoomOrWheel":function(e,actionArgs){var eType=e&&e.type?e.type.toUpperCase():null;if(eType.indexOf("START")!=-1)_actionsProcessors.pinchStart.call(this,e);else if(eType.indexOf("MOVE")!=-1)_actionsProcessors.pinchMove.call(this,e);else if(eType.indexOf("END")!=-1||eType.indexOf("CANCEL")!=-1)multiGestureEnds();
else if(gesture=="pinch")actions.zoom.call(this,e,actionArgs);else if(gesture=="wheel")actions.wheel.handler.call(this,e,actionArgs)},"key":function(e,{code,ch=0,direction,loc=0}={}){const ucKeys=Object.keys(THIN.mobileKeyboard.enumKeys).reduce((acc,t)=>({...acc,[t.toUpperCase()]:THIN.mobileKeyboard.enumKeys[t]}),{});code=typeof code=="string"?ucKeys[code.toUpperCase()]??null:code;THIN.sendKey(code,ch,direction,loc)},"wheel":{on:"ALL",handler:function(e,{direction="VERTICAL",gesture:acgesture="PAN",
stepValue=wheelSettings.stepValue,speedRelative,stepValue:stepValueOg,triggerAction=()=>{},sensitivity}={}){const {type,additionalEvent,scale}={...e,type:e.type.toUpperCase(),additionalEvent:e.additionalEvent?.toUpperCase()};if(!_actionsCtx["wheel"])_actionsCtx["wheel"]={..._actionsCtx.init.wheel};acgesture=acgesture?.toUpperCase?.()??"PAN";const matchingACGestures={"ZOOM":"pinch","PAN":"wheel"};if(type.includes("START")){_actionsProcessors.pinchStart.call(this,e);if(acgesture=="ZOOM")wheelSettings.lastScale=
null;_actionsCtx["wheel"].beforeTriggered=false;sensitivity.reset()}else if(type.includes("MOVE")){if(gesture!==null)if(matchingACGestures[acgesture]==gesture)if(oldGesture==null&&!_actionsCtx["wheel"].beforeTriggered){triggerAction(gesturesOnStates.BEFORE);_actionsCtx["wheel"].beforeTriggered=true}else triggerAction(gesturesOnStates.WHILE);_actionsProcessors.pinchMove.call(this,e);if(acgesture=="ZOOM"&&matchingACGestures[acgesture]==gesture){let pinchDirection=wheelSettings.lastScale!=null?wheelSettings.lastScale>=
scale?-1:1:null;pinchDirection=!pinchDirection&&additionalEvent?additionalEvent.split("_")[1]?.includes("IN")?-1:1:pinchDirection;if(pinchDirection){let wheelX,wheelY=0;wheelSettings.lastScale=scale;const step=stepValue*pinchDirection;wheelX=direction=="HORIZONTAL"?step:0;wheelY=direction=="VERTICAL"?step:0;if(sensitivity.isValid())THIN.sendWheel(wheelY,wheelX);sensitivity.call()}}}else if(type.includes("END")){if(gesture!==null&&matchingACGestures[acgesture]==gesture)triggerAction(gesturesOnStates.AFTER);
multiGestureEnds();if(acgesture=="ZOOM")wheelSettings.lastScale=null}else{if(["PAN"].includes(acgesture))if(gesture!==null&&matchingACGestures[acgesture]==gesture)triggerAction(gesturesOnStates.WHILE);if(acgesture=="PAN"&&matchingACGestures[acgesture]==gesture){if(wheelSettings.axis==null){if(Math.abs(e.deltaY)>wheelSettings.thresholdStartDetection)wheelSettings.axis="vertical";else if(Math.abs(e.deltaX)>wheelSettings.thresholdStartDetection)wheelSettings.axis="horizontal";wheelSettings.previousValue=
0}var step=0;if(wheelSettings.axis!=null){if(typeof THIN.rcParams.mouseWheelStepValue!="undefined"&&wheelSettings.stepValue!=THIN.rcParams.mouseWheelStepValue&&THIN.rcParams.mouseWheelStepValue>0)wheelSettings.stepValue=THIN.rcParams.mouseWheelStepValue;if(typeof THIN.rcParams.mouseWheelDirection!="undefined")wheelSettings.inverted=THIN.rcParams.mouseWheelDirection==-1;function getStep(deltaAxis,speedAxis,{stepValue=null,speedRelative=true}={}){var delta=Math.abs(deltaAxis-wheelSettings.previousValue);
speedAxis=Math.abs(speedAxis);if(delta>wheelSettings.thresholdDistance){if(wheelSettings.axis=="vertical")if(deltaAxis<wheelSettings.previousValue)wheelSettings.direction=!wheelSettings.inverted?-1:1;else wheelSettings.direction=!wheelSettings.inverted?1:-1;else if(deltaAxis<wheelSettings.previousValue)wheelSettings.direction=!wheelSettings.inverted?1:-1;else wheelSettings.direction=!wheelSettings.inverted?-1:1;var v=Math.abs(speedAxis);step=speedRelative?v<.05?1:v<.08?2:3:1;step*=wheelSettings.stepValue*
wheelSettings.direction;wheelSettings.previousValue=deltaAxis;return step}else return 0}var xStep=0,yStep=0;if(wheelSettings.axis=="horizontal")xStep=getStep(e.deltaX,e.velocityX,{stepValue:stepValueOg,speedRelative:speedRelative??(stepValueOg??true)===true});else if(wheelSettings.axis=="vertical")yStep=getStep(e.deltaY,e.velocityY,{stepValue:stepValueOg,speedRelative:speedRelative??(stepValueOg??true)===true});if(xStep!=0||yStep!=0){var t=(new Date).getTime();if(t-wheelSettings.lasttimeSent>wheelSettings.sentTime){if(sensitivity.isValid()){THIN.sendWheel(yStep,
xStep);wheelSettings.lasttimeSent=t}sensitivity.call()}}}}}}},"zoom":function(e){var eType=e&&e.type?e.type.toUpperCase():null;if(eType.indexOf("START")!=-1)_actionsProcessors.pinchStart.call(this,e);else if(eType.indexOf("MOVE")!=-1)_actionsProcessors.pinchMove.call(this,e);else if(eType.indexOf("END")!=-1||eType.indexOf("CANCEL")!=-1)multiGestureEnds();else{if(THIN.rcParams.scaled)return;if(scrollStarted)return;var scale=e.scale||e.gesture.scale;if(scale<1)scale=scale*1.075;else scale=scale*.955;
var dif=Math.abs(1-scale);if(!scrollStarted&&dif>.1||dif>.2){zoomStarted=true;var mouseScreenPosition=getMouseScreenPosition();var absX=mouseScreenPosition.x;var absY=mouseScreenPosition.y;var screenX=absX-THIN.vncdiv.scrollLeft;var screenY=absY-THIN.vncdiv.scrollTop;var pX=screenX*100/THIN.rcParams.maxWidth;var pY=screenY*100/THIN.rcParams.maxHeight;zoom(Math.max(Math.max(zoomBottomLimit,THIN.getMinZoomFactor()),Math.min(lastScale*scale,zoomTopLimit)));var sL=absX-THIN.rcParams.maxWidth*pX/100;var sT=
absY-THIN.rcParams.maxHeight*pY/100;THIN.vncdiv.scrollLeft=sL;THIN.vncdiv.scrollTop=sT}lastEvent=e}},"mouseMove":function(e){lastEvent=e;var relativeTouchFromPointer=getRelativeTouchByPointerType(e);if(relativeTouchFromPointer){if(e&&e.type&&e.type.toUpperCase().indexOf("PAN")!=-1)if(e.type.toUpperCase().indexOf("START")!=-1){startMouseX=getTouchX(relativeTouchFromPointer)-e.deltaX;startMouseY=getTouchY(relativeTouchFromPointer)-e.deltaY}else{if(e.type.toUpperCase().indexOf("MOVE")!=-1)mouseMove(getTouchX(relativeTouchFromPointer),
getTouchY(relativeTouchFromPointer),relativeTouchFromPointer)}else{startMouseX=getTouchX(relativeTouchFromPointer)-e.deltaX;startMouseY=getTouchY(relativeTouchFromPointer)-e.deltaY}_actionsProcessors.screenPan(e)}else{if(e&&e.type&&e.type.toUpperCase().indexOf("PAN")!=-1&&e.type.toUpperCase().indexOf("MOVE")===-1)return;startMouseX=getTouchX(relativeTouchFromPointer);startMouseY=getTouchY(relativeTouchFromPointer);mouseMove(startMouseX,startMouseY,relativeTouchFromPointer);THIN.mouseMoved=true;THIN.sendMouseMove();
THIN.mouseMoved=false}},"click":function(e){if(checkContextMenu(e,true))return;if(!zoomStarted){var x=getTouchXFixed();var y=getTouchYFixed();button="left";touchstate=1;var relativeTouchFromPointer=getRelativeTouchByPointerType(e);try{mouseScrollX=x;mouseScrollY=y;var x=startMouseX;var y=startMouseY;if(productId=="virtualui"){var headerBtnElem=THIN.getElementFromPoint({"touches":[{"pageX":x,"pageY":y}]});if(headerBtnElem&&headerBtnElem.parentElement!=null&&headerBtnElem.parentElement.className=="buttons"){$(headerBtnElem).click();
e.preventDefault();return}}var mPosition=getMouseScreenPosition();if(relativeTouchFromPointer)showMouseMask(mPosition.x+32,mPosition.y+32,"clickEffect",true);else showMouseMask(x/THIN.getZoom(),y/THIN.getZoom(),"clickEffect",true);mouseDown(button,x,y,relativeTouchFromPointer);mouseUp(button,x,y,relativeTouchFromPointer);if(productId!="webfmx"&&productId!="virtualui")lastMouseClickPosition=mPosition}finally{touchstate=0}if(touchstate==3)mouseMoveIntoView()}},"holdLeft":function(e){_actionsProcessors.hold(e,
"left")},"holdRight":function(e){_actionsProcessors.hold(e,"right")},"releaseLeft":function(e){_actionsProcessors.release(e,"left")},"releaseRight":function(e){_actionsProcessors.release(e,"right")},"releaseAll":function(e){actions.releaseLeft(e);actions.releaseRight(e)},"contextMenu":function(e){var mx,my;var relativeTouchFromPointer=getRelativeTouchByPointerType(e);var p=THIN.findPos(THIN.vncContainer);var x=relativeTouchFromPointer?cursorCanvasX():startMouseX;var y=relativeTouchFromPointer?cursorCanvasY():
startMouseY;mx=(x-p[0])/THIN.scale;my=(y-p[1])/THIN.scale;showContextMenu(mx,my)},"doubleClick":function(e){var relativeTouchFromPointer=getRelativeTouchByPointerType(e);var x=relativeTouchFromPointer?cursorCanvasX():startMouseX;var y=relativeTouchFromPointer?cursorCanvasY():startMouseY;btnLeftClick(x,y);btnLeftClick(x,y)},"rightClick":function(e){var relativeTouchFromPointer=getRelativeTouchByPointerType(e);var x=relativeTouchFromPointer?cursorCanvasX():startMouseX;var y=relativeTouchFromPointer?
cursorCanvasY():startMouseY;sendButtonRight(x,y)},"keyboard":keyboardShortCut_click,"menu":openMenuShortCut_click,"closeMenu":function(e){THIN.toolbar.hide()},"focus":function(e){var coords=THIN.caret.rw;var relativeTouchFromPointer=getRelativeTouchByPointerType(e);var tempX=relativeTouchFromPointer?cursorCanvasX():startMouseX;var tempY=relativeTouchFromPointer?cursorCanvasY():startMouseY;if(productId=="virtualui"){tempY/=THIN.getZoom();tempX/=THIN.getZoom()}if(typeof coords!="undefined"&&coords.b-
coords.t<THIN.multiRowMinSize&&coords.t<=tempY&&tempY<=coords.b&&coords.l<=tempX&&tempX<=coords.r){THIN.caretY=coords.t+(coords.b-coords.t)/2;THIN.caretX=coords.l;ShowStdKbd()}else{var url="webfmx/getcaret?sessionid="+THIN.rcParams.id+"&x="+tempX+"&y="+tempY+"&timeout="+keyboardCaretWait;$.ajax({url:url,async:false,cache:false,dataType:"html",error:function(jqXHR,err){logDebug("error:"+JSON.stringify(jqXHR))},success:function(data){if(data){data=JSON.parse(data);if(data.cmd==28){ShowStdKbd();return}if(data.cmd==
24)$("#touchkbd").blur();else{coords=data.rw;if(coords.t<=tempY&&tempY<=coords.b&&coords.l<=tempX&&tempX<=coords.r){THIN.caretY=coords.t+(coords.b-coords.t)/2;THIN.caretX=coords.l;THIN.caret.data=data;ShowStdKbd()}else $("#touchkbd").blur()}}else if(agentInfo.isMobile&&THIN.mobileKeyboard&&THIN.mobileKeyboard.locationType!==THIN.mobileKeyboard.enumLocationType.VIRTUALKEYBOARD)$("#touchkbd").blur()}})}}};var actionsCompatibility=[{name:"focus",products:["virtualui"]}];actionsCompatibility.forEach(function(t){if(ThinVNCTouchManager["actions"][t.name]&&
!t.products.includes(productId))delete ThinVNCTouchManager["actions"][t.name]});ThinVNCTouchManager["gesturesMiddleware"]=function(e){return checkUIAndPointerType(e)};ThinVNCTouchManager["defaultGestures"]=helper.object.clone(defaultTouchGestures);ThinVNCTouchManager["defaultGestures"].filter(function(t){return t.type==="swipe"})[0].middleware=function(e,details){var tapElement=e&&e.target?e.target:null;var menuClass="thin-menu-container";if($(tapElement).hasClass(menuClass)||$(tapElement).parents().hasClass(menuClass))return true;
return false};ThinVNCTouchManager["touchStartRedirection"]=function(e,touches){e.preventDefault();THIN.redirectTouches("begin",touches)};ThinVNCTouchManager["touchMoveRedirection"]=function(e,touches){e.preventDefault();THIN.redirectTouches("update",touches)};ThinVNCTouchManager["touchEndRedirection"]=function(e,touches){e.preventDefault();THIN.redirectTouches("end",touches)}}var localGestures=[...(helper.object.getValue(window,"customSettings.touch.gestures",[],{ignoreCase:true})??[]),...(helper.object.getValue(window.THIN,
"clientSettings.mobile.gestures",null,{ignoreCase:true})??[]),...(helper.object.getValue(window.THIN?.rcParams,"mobile.gestures",null,{ignoreCase:true})??[]),...(helper.object.getValue(window,"customSettings.mobile.gestures",[],{ignoreCase:true})??[])];ThinVNCTouchManager.initialize(document.body,localGestures,{})};function sendRightClick(){_tba.sendRightClick()}initialize();var mobile={};Object.defineProperty(mobile,"initMobile",{"enumerable":true,"configurable":false,"writable":false,"value":initMobile});
Object.defineProperty(mobile,"initTouchDevice",{"enumerable":true,"configurable":false,"writable":false,"value":initTouchDevice});Object.defineProperty(mobile,"adjustMainSize",{"enumerable":true,"configurable":false,"writable":false,"value":adjustMainSize});Object.defineProperty(mobile,"sendRightClick",{"enumerable":true,"configurable":false,"writable":false,"value":sendRightClick});Object.defineProperty(mobile,"zoom",{"enumerable":true,"configurable":false,"writable":false,"value":zoom});Object.defineProperty(mobile,
"screenWidth",{"enumerable":true,"configurable":false,"get":function(){return screenWidth}});Object.defineProperty(mobile,"screenHeight",{"enumerable":true,"configurable":false,"get":function(){return screenHeight}});Object.defineProperty(mobile,"divScrolling",{"enumerable":true,"configurable":false,"get":function(){return divScrolling}});Object.defineProperty(mobile,"ShowStdKbd",{"enumerable":true,"configurable":false,"value":ShowStdKbd});Object.defineProperty(mobile,"showExtKbd",{"enumerable":true,
"configurable":false,"value":function(){_tba.showExtKbd()}});Object.defineProperty(mobile,"isKeyboardVisible",{"enumerable":true,"configurable":false,"value":isKeyboardVisible});window["__mobile__"]=mobile;return mobile}try{Thinfinity!=undefined}catch(e){Thinfinity={}}Object.defineProperty(Mobile,"defaultTouchGestures",{"enumerable":true,"configurable":false,"get":function(){return defaultTouchGestures}});Thinfinity.Mobile=Mobile})();var initMobile;var initTouchDevice;var adjustMainSize;var zoom;
var screenHeight;var screenWidth;var divScrolling;var ShowStdKbd;var showExtKbd;var isKeyboardVisible;var mobileInstance;var ThinVNCTouchManager=null;
(function(){mobileInstance=new Thinfinity.Mobile;initMobile=mobileInstance.initMobile;initTouchDevice=mobileInstance.initTouchDevice;adjustMainSize=mobileInstance.adjustMainSize;zoom=mobileInstance.zoom;screenHeight=mobileInstance.screenHeight;screenWidth=mobileInstance.screenWidth;divScrolling=mobileInstance.divScrolling;ShowStdKbd=mobileInstance.ShowStdKbd;showExtKbd=mobileInstance.ShowStdKbd;isKeyboardVisible=mobileInstance.isKeyboardVisible})();
(function(){function ThinRDP(serverUrl,runOptions){var _thinrdp=null;var _DEFAULTS={"GATEWAY_PORT":3389,"SCREENMODE":ThinRDP.resolution.FIT_TO_BROWSER,"IMAGE_QUALITY":ThinRDP.imageQuality.OPTIMUM,"BPP":ThinRDP.colorDepth.HIGH_COLOR,"SOUND_QUALITY":ThinRDP.soundQuality.OPTIMUM,"DISKNAME":"ThinDisk","KBD_LAYOUT":1033,"MIN_DRAG_DISTANCE":32,"HOLD_DELAY_MS":75,"TLS_VERSION":ThinRDP.TLSVersion.TLS_V1_2,"ICON":"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAB3UlEQVRYR+3WO6jPYRzH8ddJKJcQExZks2BBBgZFQmKQkEUGRbkll0ySQmFQDISQTrkMp1CyoJQzGFwGBkkk5Z7LcelT3yMLw9/pfwb/Z/rdnufzfj7f59f306aXR1sv62sBdDvQD32bXI4ufA7ACCzHaPxoEkR0n+NkLqZjL67hRZMAhmA2dgdgDjZgPe43CWAUDuFcN0DE1zYZ4DDaWwAtB1oOtBz4bx0YimW401sORLc/uhoBOI+v6eW4h7u4gamYjy/Vah/iFl5iFibhNd7iGW7jXSMAEe4o0ZHVTXdiLHYg12m3M3ETu7Adk3EV4zGxvu0IQPryZmzCg7+04wgnxXzEPpzCOOzBQQwvoWHog5XYWICrMBD7a07mH8CxAEzD0bIzFv1pnMb1sv8pXuE7rtT8JdiGwbVALL+IFZiLhXhU7qRM69AZgEFYiilF/ieAE5Wa3pcDqWUyRCw/WwtuRRzIWFRJK4EnbkzApTofnXiSCNhILP+ALThSAjOwppyMA6uRkLugDl1KmxInbwb20+87bATgOM7gMsaUeP6EnI15eFOlSei8gMdYXADtVcJfDI0ApMY5kKlj5g+oxb/VzvMsu837fJeRfz6j+/6fAHo0tzbiQAugRx34CezClNE4VMIPAAAAAElFTkSuQmCC",
"APPLICATION_ACTION":ThinRDP.applicationAction.NONE,"VISUAL_EFFECTS":2};function initialize(){if(typeof serverUrl=="undefined")serverUrl="";if(runOptions==null||typeof runOptions==="undefined"){helper.console.log(helper.string.format("Cannot initialize 'ThinRDP' class, arguments is null or undefined."),arguments);runOptions={};runOptions.mode=ThinRDP.mode.API}var dType=helper.object.getDataTypeOf(runOptions);if(dType!=="json"){var msg=helper.string.format("Mismatch version, cannot initialize ThinRDP, find: '{0}' where JSON is expected.",
dType);helper.console.warning(msg,arguments);throw new Error(msg);}if(runOptions.oturl&&runOptions.oturl!="")runOptions.mode=ThinRDP.mode.OTURL;if(typeof runOptions.mode==="undefined")runOptions.mode=ThinRDP.mode.SDK;if(runOptions.mode!==ThinRDP.mode.API){if(!runOptions.sourceWindow||runOptions.sourceWindow==="")runOptions.sourceWindow=window.name!=""?window.name:window.id!=""?window.id:window;if(!runOptions.targetWindow||runOptions.targetWindow==="")runOptions.targetWindow=null;var pk=helper.object.getValue(runOptions,
"profileKey",null);var ad=helper.object.getValue(runOptions,"profile.general.address",null);if(runOptions.mode===ThinRDP.mode.SDK&&!pk&&!ad){var msg=helper.string.format("Cannot initialize ThinRDP, profileKey or custom profile are undefined or null","");helper.console.warning(msg,arguments);throw new Error(msg);}else if(runOptions.mode===ThinRDP.mode.SKEY&&!runOptions.sessionKey&&runOptions.sessionKey==""){var msg=helper.string.format("Cannot initialize ThinRDP, sessionKey is missing","");helper.console.warning(msg,
arguments);throw new Error(msg);}runOptions.fullscreen=helper.object.convertTo(runOptions.fullscreen||false,"boolean")}if(runOptions.mode===ThinRDP.mode.HOST)ThinRDPCore.prototype=new ThinVNC;_thinrdp=new ThinRDPCore(serverUrl,runOptions);return _thinrdp}function ThinRDPCore(){var self=this;var _fireExternalEvents={};var PING_TIMEOUT=3E4;var _runRemote=false;var _playbackStarted=false;var _growlBeingRecordedPopup=null;var _showSaveFilePickerKey="__#thinfinity.showSaveFilePickerKey__";var _resolutionModeEnum=
helper.object.createEnum({"QUERY_STRING":"query","JSON":"json"});var _autoConnectMode=[ThinRDP.mode.OTURL,ThinRDP.mode.SDK,ThinRDP.mode.SKEY];if(runOptions.mode===ThinRDP.mode.HOST&&(runOptions.profileKey||helper.object.getValue(runOptions,"general.address",null)))_autoConnectMode.push(ThinRDP.mode.HOST);ThinRDPCore.prototype.enableCmdCache=true;ThinRDPCore.prototype.wsSendReady=true;self.baseApiUrl=Thinfinity.global.variables.basePath==="/"?Thinfinity.global.variables.basePath:window.location.pathname.split(Thinfinity.global.variables.basePath)[0]+
Thinfinity.global.variables.basePath;if(typeof serverUrl!="undefined"&&serverUrl)self.baseUrl=serverUrl;else{var path=this.rcParams&&this.rcParams.url?this.rcParams.url:helper.url.parseUrl(window.location.href).toUrl("-h-a-r");var pathArray=path.split("/");var baseApiUrl=self.baseApiUrl.replaceAll("/","");if(baseApiUrl.length>10){var apiPos=pathArray.findIndex(function(s){return s===baseApiUrl});if(apiPos!==-1)self.baseApiUrl="/"}if(this.rcParams){if(this.rcParams.protocol==""||!this.rcParams.protocol)this.rcParams.protocol=
pathArray[0];if(this.rcParams.server==""||!this.rcParams.server){var pIdx=-1;try{var prof=JSON.parse(decodeURIComponent(Thinfinity.global.variables.data));if(prof.virtualpath)pIdx=pathArray.findIndex(function(p){return p===prof.virtualpath});else{var i=len=pathArray.length-1;while(i>0&&pIdx==-1){if(pathArray[i]!=="")pIdx=i;i--}}var fpath=pathArray.slice(1,pIdx).filter(function(p){return p!==""});var basePath=Thinfinity.global.variables.basePath;if(basePath.length>1){basePath=basePath.split("/").filter(function(p){return p!==
""});if(basePath.length>0){var fIdx=fpath.findIndex(function(s){return s===basePath[basePath.length-1]});if(fIdx!==-1)fpath=fpath.slice(0,fIdx)}}this.rcParams.server=fpath.join("/")}catch(err){throw new Error(`${thinRDPconsts.cannotParseServerURL}`);}}}self.baseUrl="/";for(i=3;i<pathArray.length-1;i++)self.baseUrl+=pathArray[i]+"/";ThinRDPCore.prototype.baseUrl=self.baseUrl}ThinRDPCore.prototype.setCookie=function(data,path){if(data&&data.SID){var expDate=new Date;expDate.setDate(expDate.getDate()+
365);document.cookie=helper.string.format(cookiePrefix+"_SID={0}; expires={1}; path={2}",data.SID,expDate.toString(),path||"/")}};_runRemote=[ThinRDP.mode.SDK,ThinRDP.mode.OTURL].indexOf(runOptions.mode)!=-1;this.gettingCredentials=false;this.authenticated=false;this.lastUpdate=null;this.apiUrl="__base__/";var _queryVersion="version=2021";this.updateLastUpdate=function(newDate){if(this.lastUpdate!=null&&this.events.onLastUpdateChanged)this.events.onLastUpdateChanged(this.authenticated);this.lastUpdate=
newDate};if(self.baseUrl.charAt(self.baseUrl.length-1)!="/")self.baseUrl+="/";var WORKERS_PATH=("thinrdp"===productId?"":"../")+"common/workers/";var RBD_THREAD_COUNT=4;var RBD_WORK_TIMEOUT=1E4;var RID_THREAD_COUNT=4;var RID_WORK_TIMEOUT=1E4;var RJD_USE_BLOB_URL=false;var RFX_USE_PARALLEL_DECODER=false;var PRFX_COMMAND_TIMEOUT=0;var PRFX_DECODER_TIMEOUT=0;var PRFX_DECODER_THREAD_COUNT=4;var RFX_WORK_TIMEOUT=0;var waitToResize=400;var downloadIdx=0;var rdpView=null;var mouseInstance=null;var _isRecoveringConnection=
false;var ifrRemoteDownloadFile=null;var clipboardDownloadFiles=null;function getRemoteAppProfiles(){THIN.getProfiles(ThinRDP.profileType.PUBLIC,function(data){},Thinfinity.LabelConfig.root)}this.acquireRdpDesktopCanvas=function(){if(self.rdpDesktopCanvas)return true;self.rdpDesktopCanvas=document.getElementById("thinrdp_canvas_0");if(!self.rdpDesktopCanvas)return false;if(!self.rdpDesktopCanvas.getContext){self.rdpDesktopCanvas=self.rdpDesktopCanvas.childNodes[0];if(!self.rdpDesktopCanvas.getContext)return false}self.rdpDesktopContext=
self.rdpDesktopCanvas.getContext("2d");return true};if(this.registerImageDecoder){this.registerImageDecoder(32,function(item){if(!self.acquireRdpDesktopCanvas()){item.loadFailed();logError("RDP image key "+item.idx+" cannot be processed: RDP desktop canvas not available");return}if(!self.rdpBitmapDecoderThreads)self.rdpBitmapDecoderThreads=new ThreadPool(RBD_THREAD_COUNT,WORKERS_PATH+"thinrdp.bmpworker.js",RBD_WORK_TIMEOUT);self.rdpBitmapDecoderThreads.doWork(item.encoded,[item.encoded.data],function(oEvent){item.setCanvas(self.rdpDesktopContext,
oEvent.data);oEvent.data=null;item.loadSucceeded();self.processNextScreen()},function(oEvent){item.loadFailed();logError("RDP image key "+item.idx+" failed to load")})});this.registerImageDecoder(33,function(item){if(!self.acquireRdpDesktopCanvas()){item.loadFailed();logError("RFX image key "+item.idx+" cannot be processed: RDP desktop canvas not available");return}if(!self.rfxImageDecoderThreads)self.rfxImageDecoderThreads=new ThreadPool(RID_THREAD_COUNT,WORKERS_PATH+"thinrdp.frfximageworker.js",
RID_WORK_TIMEOUT);self.rfxImageDecoderThreads.doWork(item.encoded,[item.encoded.data],function(oEvent){item.setCanvas(self.rdpDesktopContext,oEvent.data);delete oEvent.data;oEvent.data=null;item.loadSucceeded();self.processNextScreen()},function(oEvent){item.loadFailed();logError("RFX image key "+item.idx+" failed to load")})});if(RJD_USE_BLOB_URL)this.registerImageDecoder(34,function(item){var arData=new Uint8Array(item.encoded.data,item.encoded.offset,item.encoded.size);var blob=new Blob([arData],
{type:"image/jpeg"});var objectUrl=window.URL.createObjectURL(blob);arData=null;blob=null;item.setImg(function(){window.URL.revokeObjectURL(objectUrl);item.loadSucceeded();self.processNextScreen()},function(){window.URL.revokeObjectURL(objectUrl);item.loadFailed();logError("Fast JPEG image key "+item.idx+" failed to load")},objectUrl)});else this.registerImageDecoder(34,function(item){item.setImg(function(){item.loadSucceeded();self.processNextScreen()},function(){item.loadFailed();logError("Fast JPEG image key "+
item.idx+" failed to load")},self.u8ArrayToDataUri("image/jpeg",new Uint8Array(item.encoded.data,item.encoded.offset,item.encoded.size)))})}if(this.registerRawBinaryHandler){if(RFX_USE_PARALLEL_DECODER)self.registerRawBinaryHandler([16646144],function(input){if(!self.acquireRdpDesktopCanvas()){logError("cannot execute RemoteFX parallel frame decoder: RDP desktop canvas not available");return}if(!self.rdpRemoteFXCommandThreads)self.rdpRemoteFXCommandThreads=new ThreadPool(1,WORKERS_PATH+"thinrdp.pfrfxcommandworker.js",
PRFX_COMMAND_TIMEOUT);if(!self.rdpRemoteFXDecoderThreads)self.rdpRemoteFXDecoderThreads=new ThreadPool(PRFX_DECODER_THREAD_COUNT,WORKERS_PATH+"thinrdp.pfrfxdecoderworker.js",PRFX_DECODER_TIMEOUT);var command={"groupCount":PRFX_DECODER_THREAD_COUNT,"srcOffset":4,"commandData":input};self.rdpRemoteFXCommandThreads.doWork(command,[input],function(oEvent){var frameX=oEvent.data["x"];var frameY=oEvent.data["y"];var frameWidth=oEvent.data["w"];var frameHeight=oEvent.data["h"];var frameClipW=oEvent.data["cw"];
var frameClipH=oEvent.data["ch"];var frameIdx=oEvent.data["idx"];var usedGroups=oEvent.data["usedGroups"];var processedGroups=0;var frameImage=self.rdpDesktopContext.createImageData(frameWidth,frameHeight);for(var i=0;i<usedGroups;++i){var groupData=oEvent.data["groupsData"][i];delete oEvent.data["groupsData"][i];self.rdpRemoteFXDecoderThreads.doWork(groupData,[groupData],function(oEvent){var height=oEvent.data["height"];var yOffset=oEvent.data["yoffs"];var pixels=oEvent.data["pixels"];frameImage.data.set(new Uint8ClampedArray(pixels),
yOffset*frameWidth*4);pixels=null;oEvent.data["pixels"]=null;delete oEvent.data;++processedGroups;if(processedGroups==usedGroups)helper.animationFrame.request(function(){self.rdpDesktopContext.putImageData(frameImage,frameX,frameY,0,0,frameClipW,frameClipH);frameImage=null})},function(oEvent){logError("error processing decoder for remotefx frame group "+i+".")})}delete oEvent.data},function(oEvent){logError("error processing commands for remotefx.")});command=null});else self.registerRawBinaryHandler([16646144],
function(input){if(!self.acquireRdpDesktopCanvas()){logError("cannot execute RemoteFX frame decoder: RDP desktop canvas not available");return}if(!self.rdpRemoteFXDecoderThreads)self.rdpRemoteFXDecoderThreads=new ThreadPool(1,WORKERS_PATH+"thinrdp.frfxworker.js",RFX_WORK_TIMEOUT);self.rdpRemoteFXDecoderThreads.doWork(input,[input],function(oEvent){var frameDataU8=new Uint8Array(oEvent.data);var x=frameDataU8[0]|frameDataU8[1]<<8;var y=frameDataU8[2]|frameDataU8[3]<<8;var w=frameDataU8[4]|frameDataU8[5]<<
8;var h=frameDataU8[6]|frameDataU8[7]<<8;var cw=frameDataU8[8]|frameDataU8[9]<<8;var ch=frameDataU8[10]|frameDataU8[11]<<8;var idx=frameDataU8[12]|frameDataU8[13]<<8|frameDataU8[14]<<16|frameDataU8[15]<<24;frameDataU8=null;var frameImage=self.rdpDesktopContext.createImageData(w,h);frameImage.data.set(new Uint8ClampedArray(oEvent.data,16,w*h*4));helper.animationFrame.request(function(){self.rdpDesktopContext.putImageData(frameImage,x,y,0,0,cw,ch);frameImage=null})},function(oEvent){logError("RemoteFX frame decoder failed")})});
self.registerRawBinaryHandler([16580608],function(input){if(!self.acquireRdpDesktopCanvas()){logError("cannot process RemoteFX JPEG frame: RDP desktop canvas not available");return}var params=new Uint8Array(input,4,input.byteLength-4);var x=params[0]|params[1]<<8;var y=params[2]|params[3]<<8;var cw=params[4]|params[5]<<8;var ch=params[6]|params[7]<<8;params=null;var img=new Image;img.onerror=function(){logError("RemoteFX JPEG frame failed to load")};img.onload=function(){helper.animationFrame.request(function(){self.rdpDesktopContext.drawImage(img,
0,0,cw,ch,x,y,cw,ch);img=null})};img.src=self.u8ArrayToDataUri("image/jpeg",new Uint8Array(input,12,input.byteLength-12))});self.registerRawBinaryHandler([16515328,16515584],function(input){self.tsLinkForwardDataToClientWs(input)})}this.tsLinkWsInstances=0;this.tsLinkForwardDataToHost=function(data){if(self.useAjax){logError("TSLink cannot run when using AJAX.");return}self.wsSend(data)};this.tsLinkForwardDataToClientWs=function(data){if(!self.tsLinkWebSocketAvailable()){logError("TSLink websocket unavailable, cannot deliver host data to client.");
return}self.tsLinkWs.send(data)};this.tsLinkWebSocketAvailable=function(){return self.tsLinkWs&&self.tsLinkWs.readyState==1?true:false};this.tsLinkCloseWebSocket=function(){if(self.tsLinkWs){if(self.tsLinkWs.readyState==1)self.tsLinkWs.close();delete self.tsLinkWs}if(self.tsLinkWsRetryId){clearInterval(self.tsLinkWsRetryId);delete self.tsLinkWsRetryId}console.log("TSLink websocket closed.")};this.tsLinkOpenWebSocket=function(){if(self.useAjax){logError("TSLink cannot run when using AJAX.");return}if(self.tsLinkWebSocketAvailable()){logError("TSLink websocket already initialized.");
return}try{if(helper.webSocket)helper.webSocket("ws://127.0.0.1:28443","arraybuffer").then(function(ws){self.tsLinkWs=ws;self.tsLinkWs.onopen=function(event){console.log("TSLink websocket ready.");if(self.tsLinkWsRetryId){clearInterval(self.tsLinkWsRetryId);delete self.tsLinkWsRetryId}};self.tsLinkWs.onclose=function(event){console.log("--\x3e tsLinkWs.onclose code: "+event.code+", reason: "+event.reason+", wasClean: "+event.wasClean);if(self.tsLinkWsInstances&&!self.tsLinkWsRetryId){self.tsLinkWsRetryId=
setInterval(self.tsLinkOpenWebSocket,3E3);logError("TSLink websocket closed with open instances. Reopening in 3 seconds...")}};self.tsLinkWs.onmessage=function(event){self.tsLinkForwardDataToHost(event.data)};self.tsLinkWs.onerror=function(event){if(!self.tsLinkWsRetryId)self.tsLinkWsRetryId=setInterval(self.tsLinkOpenWebSocket,3E3);logError("TSLink websocket error. Reopening in 3 seconds...")}});else throw new Error(consts.notSupportHTML5);}catch(err){if(!self.tsLinkWsRetryId)self.tsLinkWsRetryId=
setInterval(self.tsLinkOpenWebSocket,3E3);logError("Error creating TSLink websocket object (port blocked?). Retrying in 3 seconds...");return}};this.connectRemoteFilesystem=function(){return;var server=self.rcParams.server?self.rcParams.server:window.location.host;var wsServer="://"+server+self.baseUrl+self.rcParams.id;if(self.getProtocol()=="https:")wsServer="wss"+wsServer;else wsServer="ws"+wsServer;var postData={"wsServer":wsServer,"sid":self.rcParams.id,"UBRWID":self.rcParams.UBRWID};$.ajax({type:"POST",
url:"http://localhost:28444/rfs/connect",dataType:"json",async:true,data:$.param(postData),error:function(jqXHR,err){logError("Error contacting ThinRDP Plugins.");return}})};this.isCrossDomain=function(){if(typeof self.rdParams!="undefined")return self.rdParams.isCrossDomain;if(!self.baseUrl.match("http"))return false;url=self.baseUrl;var re=new RegExp(/^(http|https):\/\/([^:]+)(:\d+)?/i);var urlParts=re.exec(url);var locationParts=re.exec(window.location.href);var urlParts=helper.url.parseUrl(url);
var locationParts=helper.url.parseUrl(window.location.href);if(typeof urlParts=="undefined"||typeof locationParts=="undefined")return false;if(urlParts.protocol!=locationParts.protocol)return true;if(urlParts.hostname!=locationParts.hostname)return true;if((urlParts.port?urlParts.port:urlParts.protocol=="http"?":80":":443")!=(locationParts.port?locationParts.port:locationParts.protocol=="http"?":80":":443"))return true;return false};this.extractURLDomain=function(url){var urlParts=url.split("/");
var host=null;if(urlParts[0].match("http")!=null)host=urlParts[2];else host=urlParts[0];if(host.match(":")!=null)host=host.split(":")[0];if(host.match("[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}.[0-9]{1,3}")!=null)if(host=="127.0.0.1")return"localhost";else return host;if(host.match(".")!=null){var hitems=host.split(".");if(hitems.length<3)return host;else return hitems[hitems.length-2]+"."+hitems[hitems.length-1]}else return host};this.loadCredentialsDialog=function(callback){self.loadSHTML("thinrdp.credentialsdialog.shtml",
function(html){var div=document.createElement("div");div.innerHTML=html;div=div.firstElementChild||div.firstChild;document.body.appendChild(div);callback(div)},function(msg){alert(msg.status+"("+msg.statusText+")")})};this.loadSHTML=function(fileUrl,successHandler,failHandler){var params={url:fileUrl,async:true,dataType:"html",success:successHandler,error:failHandler};$.ajax(self.completeAjaxParams(params))};this.getDefaultProfile=function(){return{"name":"","publickey":"","virtualpath":"","icon":_DEFAULTS.ICON,
"clipboard":true,"users":[],"password":"****************","loadbalanceInfo":"","host":{"address":"","port":_DEFAULTS.GATEWAY_PORT,"username":"","password":"","visualeffects":_DEFAULTS.VISUAL_EFFECTS,"screenres":_DEFAULTS.SCREENMODE,"imgquality":_DEFAULTS.IMAGE_QUALITY,"bpp":_DEFAULTS.BPP,"unicodekbd":true,"console":false,"credentials":1,"kbdlayout":_DEFAULTS.KBD_LAYOUT,"appmode":_DEFAULTS.APPLICATION_ACTION,"appcmdline":"","showonstart":true,"appcmdargs":"","appworkdir":"","persistentcache":false,
"websocketcompression":true,"relativetouch":agentInfo.isMobile,"nonnlaonerror":false,"dragDist":_DEFAULTS.MIN_DRAG_DISTANCE,"enableRemoteFx":false,"enableTouchRedirection":false,"touchDragDelay":_DEFAULTS.HOLD_DELAY_MS,"saveRDSessions":false,"forceTLSVersion":_DEFAULTS.TLS_VERSION,"smartSizing":true,"resizedesktop":true,"monitor":{"enabled":false}},"gateway":{"port":_DEFAULTS.GATEWAY_PORT},"reconnectonresize":false,"printer":{"enabled":false,"setasdefault":true,"name":consts.ThinRDPPrinter,"driver":consts.MicrosoftXPSV4},
"disk":{"enabled":false,"name":_DEFAULTS.DISKNAME,"autodownload":false},"sound":{"enabled":false,"quality":_DEFAULTS.SOUND_QUALITY},"scraperId":"rdp","remoteId":"","restriction":{"action":0,"iplist":[]}}};this.clearParams=function(){this.rdParams={"targetWindow":"_self","exitURL":"about:blank","url":self.baseUrl,"postPage":"rdp.html","isCrossDomain":this.isCrossDomain(),"remoteView":null,"runRemote":null,"computer":null,"username":"","password":"","playsession":null,"credsave":true,"disableNLA":false,
"forceTLSVersion":null,"destType":"","destInfo":"","credentials":"","startprg":_DEFAULTS.APPLICATION_ACTION,"command":"","cmdargs":"","showOnStart":true,"canLogout":false,"directory":"","timeZone":"","profileKey":null,"profilePass":null,"overrideDefaults":false,"printerList":null,"universalPrinter":false,"width":$(window).width(),"height":$(window).height(),"resolution":"fittobrowser","bpp":_DEFAULTS.BPP,"console":false,"experience":{"enableRemoteFx":false,"enableTouchRedirection":false,"desktopbackground":false,
"visualstyles":true,"menuwindowanimation":false,"fontsmoothing":false,"desktopcomposition":false,"showwindowcontent":false},"hidePointer":false,"relativeTouch":agentInfo.isMobile,"dragDist":_DEFAULTS.MIN_DRAG_DISTANCE,"unicodeKeyboard":true,"kbdMode":"RDP","remoteApps":null,"kbdLayout":_DEFAULTS.KBD_LAYOUT,"scaled":false,"centered":true,"fitToBrowser":true,"clientAck":-1,"divId":"rdpdiv","maxWidth":0,"maxHeight":0,"hookMouse":true,"hookKeyboard":true,"clipboard":true,"printer":{"enabled":false,"setasdefault":true,
"name":null,"driver":null},"disk":{"enabled":false,"name":_DEFAULTS.DISKNAME,"autodownload":true},"sound":{"enabled":false,"quality":_DEFAULTS.SOUND_QUALITY},"imagequality":_DEFAULTS.IMAGE_QUALITY,"createToolbar":true,"showToolbar":true,"tcpReadCount":1,"tcpReadWait":20,"filterCmds":false,"forceDesktop":false,"scraper":"RDP","savesession":false,"checkBeforeWindowClose":true,"rfsMountPoints":null,"noSsnDialog":false,"noShowConnectionClosePopup":false,"noShowConnectionDisconnectPopup":false,"microphoneNoiseThreshold":.0025,
"reconnectOnResize":false,"resizeDesktop":false,"disableDisconnect":false,"events":{"onExecRemoteApp":null,"onServerConnecting":null,"onExecResult":null,"onRemoteCommand":null,"onFileReady":null,"onFileStream":null,"onSessionEnd":null,"onSessionStart":null,"onServerDisconnect":null,"onServerConnectionError":null,"onServerRedirect":null,"onServerConnect":null,"onDisplayInteractionRequired":null,"onServerError":null,"onBrokerError":null,"onQueryDisconnect":null,"onUploadComplete":null,"onUploadCanceled":null,
"onUploadFailed":null,"onPlaybackStart":null,"onPlaybackEnds":null,"onShareSession":null,"onPropertyChange":null,"onLicenseMsg":null,"onWakeOnLan":null,"onWaitForVM":null,"onFileDownload":null,"onCopy":null,"onPaste":null,"onCut":null,"onSessionTimeout":null,"onReconnectionAttempt":null,"onShadowingStatus":null,"onConnectionLost":null,"onConnectionRestored":null},"permissions":{"analytics":false,"canShareSession":true,"expandToolbar":false,"showFileTransfer":true,"enableSendKeys":true,"showSettings":false},
shadowed:false}};this.serverValues={rfxEnabled:false,ftPath:"",diskName:"",plugins:{},dynamicplugins:{}};this.clearParams();this.username=null;this.password=null;this.sessionTimer=null;this.restoreWindowPopup=null;function createRemoteDownload(){if(!ifrRemoteDownloadFile){ifrRemoteDownloadFile=helper.dom.appendJsonElement({"parentElement":document.body,"type":"iframe","attributes":{"style":"height:1px;width:1px;left:-50px;top:-50px;position:absolute;"}});ifrRemoteDownloadFile.src=THIN.httpConnection+
"remoteDownloadfile.html?_gwsid="+Thinfinity.global.variables.gwsid}}function RestoreWindowPopup(){var _ref=this;var _timer=null;var _timeout=500;var _over=false;var _icon=null;var _popup=null;var _draggable=null;var _isDragging=false;var _wndList=new Array;function resolveTouch(e){hideWindowList(e)}function showWindowList(e){if(_isDragging)return;if(e.stopPropagation)e.stopPropagation();function getX(e,measure){var x=typeof e.pageX!="undefined"?e.pageX:(e.changedTouches||e.touches)[0].pageX;x-=12;
if(x<0)x=0;return measure?x+measure:x}function getY(e,measure){var y=typeof e.pageY!="undefined"?e.pageY:(e.changedTouches||e.touches)[0].pageY;y-=_wndList.length*30+8;if(y<0)y=0;return measure?y+measure:y}_popup.style.top=getY(event,"px");_popup.style.left=getX(event,"px");_popup.style.display="block";_over=true;_timer=window.setTimeout(hidePopup,_timeout);window.setTimeout(function(){document.body.addEventListener("touchstart",resolveTouch,true)},10)}function hideWindowList(e){_over=helper.style.hasClass((e||
event).srcElement,"minWndItem");hidePopup()}function hidePopup(e){if(!_over){if(_timer)window.clearTimeout(_timer);_timer=null;_popup.style.display="none";document.body.removeEventListener("touchstart",resolveTouch)}}function showIcon(){_icon.style.display="block"}function hideIcon(){_icon.style.display="none"}function selectWindow(event){event.stopPropagation();var elem=event.target||event.srcElement;quitOver();hidePopup();var wndId=elem.id.substring(elem.id.indexOf("_")+1);self.sendCmd("cmd=restore&wnd="+
wndId);removeWindow(wndId)}function addWindow(wndId,wndTitle){var itemId="wndItem_"+wndId;helper.dom.appendJsonElement({"parentElement":_popup,"type":"div","attributes":{"class":"minWndItem","style":"cursor:pointer;","id":itemId},"events":{"click":selectWindow,"touchstart":selectWindow},"content":wndTitle});_wndList.push({"id":wndId,"title":wndTitle});showIcon()}function removeWindow(wndId){var itemId="wndItem_"+wndId;helper.dom.removeEvent(document.getElementById(itemId),"click",selectWindow);_popup.removeChild(document.getElementById(itemId));
for(var i=0;i<_wndList.length;i++)if(_wndList[i].id==wndId){delete _wndList[i];_wndList.splice(i,1);break}hidePopup();if(_wndList.length==0)hideIcon()}function dragIcon(){_isDragging=true;if(_popup.style.display!="none"){_over=false;hidePopup()}}function dropIcon(){_isDragging=false}function initialize(){var taskbar=document.getElementById("taskbar");if(!taskbar)taskbar=helper.dom.appendJsonElement({"parentElement":self.vncdiv,"type":"div","attributes":{"class":"ignoremouse","id":"taskbar"}});_icon=
document.getElementById("restoreWndIcon");if(!_icon){_icon=helper.dom.appendJsonElement({"parentElement":taskbar,"type":"div","attributes":{"class":"icon ignoremouse taptarget","id":"restoreWndIcon"},"events":{"click":showWindowList,"touchstart":showWindowList}});helper.dom.appendJsonElement({"parentElement":_icon,"type":"img","attributes":{"src":"images/btnrestore.png","style":"cursor:pointer;","title":"Restore window"}});if(typeof Thinfinity!="undefined"&&Thinfinity.Draggable)_draggable=new Thinfinity.Draggable({"container":taskbar,
"dragElem":_icon,"key":"RestoreWndIconPos","initialPos":{"x":5,"y":environment.currentHeight-50},"events":{"drag":dragIcon,"drop":dropIcon}})}_popup=document.getElementById("minimizedWindowsList");if(!_popup){_popup=helper.dom.appendJsonElement({"parentElement":self.vncdiv,"type":"div","attributes":{"id":"minimizedWindowsList"}});_popup.style.display="none"}helper.dom.addEvent(_popup,"mouseover",resetTimer);helper.dom.addEvent(_popup,"mouseenter",resetTimer);helper.dom.addEvent(_popup,"mouseout",
quitOver);helper.dom.addEvent(_popup,"mouseleave",quitOver)}function quitOver(e){_over=false;window.clearTimeout(_timer);_timer=window.setTimeout(hidePopup,_timeout)}function resetTimer(){window.clearTimeout(_timer);_over=true}initialize();Object.defineProperty(_ref,"addWindow",{"writable":false,"value":addWindow});Object.defineProperty(_ref,"removeWindow",{"writable":false,"value":removeWindow});return _ref}this.events={onExecRemoteApp:function(obj){fireExternalEvent("onExecRemoteApp",obj,function(preventExecution){if(preventExecution!==
true)if(self.rdParams.events.onExecRemoteApp)self.rdParams.events.onExecRemoteApp(obj);else $(window).trigger("execRemoteApp",[obj])})},onExecResult:function(obj){var data={};if(obj){var d=obj.length>0?obj[0]:obj;data.exename=d.exename;data.message=d.rctext;data.rc=d.rc;if(data.rc==0)self.show()}fireExternalEvent("onExecResult",obj,function(preventExecution){if(preventExecution!==true)if(self.rdParams.events.onExecResult)self.rdParams.events.onExecResult(obj);else $(window).trigger("execResult",[obj])})},
onRemoteCommand:function(obj){if(obj){if(typeof obj.showdesktop!="undefined"){var div=document.getElementById(self.rcParams.divId);if(div){if(obj.showdesktop=="true")THIN.show();if(obj.showdesktop=="false")THIN.hide()}}if(typeof obj.showft!="undefined")self.serverValues.ftPath=obj.showft;if(typeof obj.hideft!="undefined"&&self.serverValues&&self.serverValues.ftPath)delete self.serverValues.ftPath;if(typeof obj.diskname!="undefined")self.serverValues.diskName=obj.diskname;if(typeof obj.pluginchanged!=
"undefined"){var p=obj.pluginchanged;self.serverValues.dynamicplugins[p.name]=p.action;if(p.name=="drdynvc/Microsoft::Windows::RDS::Input"){if(p.action=="created"){logDebug("Thin server supports touch redirection, enabling in TouchManager.");self?.display?.manager?.fireEvent("serverSupportsRedirection")}}else if(p.name.search(/drdynvc\/Cybelesoft::TSLink::(Echo|RemoteFS)/)==0)if(p.action=="created"){if(!self.tsLinkWsInstances)self.tsLinkOpenWebSocket();++self.tsLinkWsInstances}else if(p.action=="closed"){--self.tsLinkWsInstances;
if(!self.tsLinkWsInstances)self.tsLinkCloseWebSocket()}}if(typeof obj.event!="undefined")if(obj.event=="railNonMonitoredDesktopEvent"||obj.event=="railStartedEvent")if(self.rdParams.events.onInteractionRequired)self.rdParams.events.onInteractionRequired(obj);else $(window).trigger("interactionRequired",[obj]);if(typeof obj.wndMinimized!="undefined"){if(!self.restoreWindowPopup)self.restoreWindowPopup=new RestoreWindowPopup;self.restoreWindowPopup.addWindow(obj.wndMinimized.wndId,obj.wndMinimized.title!=
""?obj.wndMinimized.title:self.rdParams.connectionName)}if(typeof obj.wndClosed!="undefined")if(self.restoreWindowPopup)self.restoreWindowPopup.removeWindow(obj.wndClosed.wndId);if(typeof obj.diskuse!="undefined"&&(obj.diskuse&1)==1&&self.rdParams.permissions.showFileTransfer)self.fileUpload.init();if(self.rdParams.events.onRemoteCommand)self.rdParams.events.onRemoteCommand(obj);else $(window).trigger("remoteCommand",[obj])}},onFileDownload:function(fileNames,saveAs){var file=fileNames[0];var fileName=
(file.download||file).replace(/\\/gi,"/");var hasUrl=typeof file.url!=="undefined";var downloadName=null;var aFileName=fileName.split("/");downloadName=aFileName[aFileName.length-1];for(i=0;i<aFileName.length;i++)aFileName[i]=encodeURIComponent(aFileName[i]);fileName=aFileName.join("/");var dfUrl=hasUrl?file.url:self.httpConnection+"ft/"+fileName;var preventExecution=self.rdParams.events.onFileDownload?self.rdParams.events.onFileDownload({url:dfUrl,downloadName:downloadName,fileName:fileName})||false:
false;if(!preventExecution){var downloadWithVirtualLink=function(url,downloadName,callback){if(agentInfo.isMSIE||agentInfo.isFirefox)callback(false);else try{if(ifrRemoteDownloadFile){var msgHnd=function(e){if(e&&e.data&&e.data.cmd==="downloadFileStatus"){helper.dom.removeEvent(window,"message",msgHnd);let res=true;if(file.clipboard===true)clipboardDownloadFiles=null;if(e.data.result instanceof TypeError){let resultMsg=e.data.result.message||e.data.result;if(resultMsg){helper.console.warning(resultMsg,
arguments);res=false}}callback(res)}};helper.dom.removeEvent(window,"message");helper.dom.addEvent(window,"message",msgHnd);ifrRemoteDownloadFile.contentWindow.postMessage({"cmd":"downloadFile","url":url,"downloadName":downloadName,"saveAs":saveAs},"*")}else callback(false)}catch(err){helper.dom.removeEvent(window,"message",msgHnd);helper.console.log("Cannot download file remotely, postMessage fails: "+err.message||err,arguments);callback(false)}};var downloadURL=function downloadURL(url){if(agentInfo.isMSIE)window.open(url);
else{var downloadIframe=document.createElement("iframe");downloadIframe.id="hiddenDownloader"+downloadIdx++;downloadIframe.style.visibility="hidden";document.body.appendChild(downloadIframe);downloadIframe.src=url;window.setTimeout(function(){document.body.removeChild(document.getElementById(downloadIframe.id))},5E3)}};downloadWithVirtualLink(dfUrl,downloadName,function(result){if(!result)downloadURL(dfUrl);else self.downloadList.downloadNextFile()})}processRDPCrossMessages("onFileDownload",fileNames)},
onFileReady:function(objprn){fireExternalEvent("onFileReady",objprn,function(preventExecution){if(preventExecution!==true)if(self.rdParams.events.onFileReady)self.rdParams.events.onFileReady(objprn.url);else if(typeof objprn.obj!="undefined")self.newPrintDialog(objprn.obj);else self.openPrnWindow(objprn,true)})},onFileStream:function(data){fireExternalEvent("onFileStream",data,function(preventExecution){if(preventExecution!==true&&self.rdParams.events.onFileStream)self.rdParams.events.onFileStream(data)})},
onSessionEnd:function(obj){fireExternalEvent("onSessionEnd",obj,function(preventExecution){if(preventExecution!==true)if(self.rdParams.events.onSessionEnd)self.rdParams.events.onSessionEnd(obj);else $(window).trigger("sessionEnd",obj)});disposeView()},onServerConnecting:function(status){fireExternalEvent("onServerConnecting",status,function(preventExecution){if(preventExecution!==true)if(self.rdParams.events.onServerConnecting)self.rdParams.events.onServerConnecting(status);else $(window).trigger("ServerConnecting",
status)})},onServerCommandEvent:function(obj){var handled=false;if(typeof obj.respId=="undefined")return handled;switch(obj.respId){case 1:self.downloadList.list.rows=obj.items;self.downloadList.downloadDialog();handled=true;break;case 2:self.ssnShare.enabled=obj.items.length>0;if(self.ssnShare.enabled){var ssnData=obj.items[0];var baseServerUrl=_runRemote?self.baseUrl.substr(0,self.baseUrl.length-1):helper.url.parseUrl(window.location.href).toUrl("-a-r-vp");if(baseServerUrl&&baseServerUrl.substr(baseServerUrl.length-
1,1)=="/"&&ssnData.shareURL&&ssnData.shareURL.substr(0,1)=="/")ssnData.shareURL=ssnData.shareURL.substr(1,ssnData.shareURL.length-1);baseServerUrl=baseServerUrl.substr(0,baseServerUrl.length-1)+Thinfinity.global.variables.basePath;var bUrl=Thinfinity.global.variables.basePath.split("/").filter(function(p){return p!==""});var sUrl=ssnData.shareURL.split("/").filter(function(p){return p!==""});if(bUrl[bUrl.length-1]===sUrl[0])ssnData.shareURL=sUrl.slice(1,sUrl.length).join("/");self.ssnShare.shareURL=
baseServerUrl+ssnData.shareURL;self.ssnShare.expirationDate=ssnData.expiration;self.ssnShare.password=ssnData.password;self.ssnShare.key=ssnData.key;self.ssnShare.flags=ssnData.flags}if(self.rdParams.events&&self.rdParams.events.onShareSession)if(self.ssnShare.enabled)self.rdParams.events.onShareSession({"url":self.ssnShare.shareURL,"pwd":ssnData.password});else self.ssnShare.getSharing();else if(self.rdParams.noSsnDialog)if(self.ssnShare.enabled)fireExternalEvent("onShareSession",{"url":self.ssnShare.shareURL,
"pwd":self.ssnShare.password},function(preventExecution){if(!preventExecution)self.ssnShare.openDialog()});else self.ssnShare.getSharing();else self.ssnShare.openDialog();handled=true;break;case 3:self.showTrafficData(obj);break}return handled},onServerError:function(oError){if(oError.brokerDown===true&&oError.temp===true&&document.referrer!="")self.rdParams.exitURL=document.referrer;if(oError?.credentials){self.events.onServerNeedCredentials(oError);self.__proto__.endingsession=false;self.__proto__.connected=
false}else if(self.rdParams.events.onServerError)self.rdParams.events.onServerError(oError);else $(window).trigger("serverError",oError);processRDPCrossMessages("onServerError",oError)},onSessionStart:function(obj){self.__proto__.connected=true;if(obj.rfxEnabled)self.serverValues.rfxEnabled=true;if(typeof obj.isShadowSession!="undefined")THIN.rcParams.isShadowSession=obj.isShadowSession;if(!THIN.rcParams.isShadowSession&&obj.beingRecorded===true)if(!_growlBeingRecordedPopup)_growlBeingRecordedPopup=
Thinfinity.Popups.growl({"message":thinRDPconsts.beingRecorded,"icon":false,"type":Thinfinity.Popups.growl.type.WARNING});if((!agentInfo.isMobile||helper.object.getValue(self.rcParams,"mobile.smartSizing",false,{ignoreCase:true})&&(self.rcParams.viewWidth>=environment.viewportWidth||self.rcParams.viewHeight>=environment.viewportHeight||self.rcParams.viewWidth>=environment.viewportHeight||self.rcParams.viewHeight>=environment.viewportWidth))&&typeof obj.smartSizing!="undefined"&&obj.smartSizing!=self.rdParams.scaled)if(typeof customSettings==
"undefined"||typeof customSettings.scaled=="undefined")self.rcParams.scaled=self.rdParams.scaled=obj.smartSizing;if(agentInfo.isMobile&&zoom)setTimeout(function(){zoom(THIN.scale)},500);if(THIN.rdParams.startprg===ThinRDP.applicationAction.NONE)THIN.show();fireExternalEvent("onSessionStart",obj,function(preventExecution){if(preventExecution!==true)if(self.rdParams.events.onSessionStart)self.rdParams.events.onSessionStart(obj);else $(window).trigger("sessionStart",obj);if(self.rdParams.rfsMountPoints!=
null)self.connectRemoteFilesystem();else self.rdParams.rfsMountPoints=""});createRemoteDownload()},onServerCommandResult:function(obj){if(typeof obj.isShadowSession!="undefined")THIN.rcParams.isShadowSession=obj.isShadowSession;if(obj.soundEnabled)self.rdParams.sound.enabled=true;self.isOTURLSession=obj.isOTURLSession;var iq;if(obj.imageMethod==3)iq=4;else if(helper.object.isNumber(obj.imageQuality))iq=parseInt(obj.imageQuality,10);else iq=0;if(iq!=self.rdParams.imagequality)self.rdParams.imagequality=
iq;if(!document.getElementById(productId+"_canvas_1")){var win={"left":0,"top":0,"width":self.rcParams.viewWidth,"height":self.rcParams.viewHeight,"hwnd":1,"zidx":0};self.createCanvas(win)}fireExternalEvent("onServerCommandResult",obj,function(preventExecution){if(preventExecution!==true)if(self.rdParams.events.onServerCommandResult)self.rdParams.events.onServerCommandResult(obj);else $(window).trigger("serverCommandResult",obj)})},onServerDisconnect:function(){if(_growlBeingRecordedPopup)_growlBeingRecordedPopup.destroy();
fireExternalEvent("onServerDisconnect",null,function(preventExecution){if(preventExecution!==true)if(!self.gettingCredentials){self.hide();if(self.rdParams.events.onServerDisconnect)self.rdParams.events.onServerDisconnect();else $(window).trigger("serverDisconnect")}})},onBrokerError:function(obj){var response=false;if(obj.errno===404&&obj.temp===true){response=true;if(obj.originalEvent==1){delete obj.originalEvent;fireExternalEvent("onBrokerError",obj)}else if(self.rdParams.events.onBrokerError)response=
self.rdParams.events.onBrokerError(obj);else $(window).trigger("onBrokerError",obj)}return response},onServerConnectionError:function(errorMsg){fireExternalEvent("onServerConnectionError",errorMsg,function(preventExecution){if(preventExecution!==true)if(self.rdParams.events.onServerConnectionError)self.rdParams.events.onServerConnectionError(errorMsg);else $(window).trigger("serverConnectionError",errorMsg)});disposeView()},onServerRedirect:function(url,obj){fireExternalEvent("onServerRedirect",[url,
obj],function(preventExecution){if(preventExecution!==true)if(self.rdParams.events.onServerRedirect)self.rdParams.events.onServerRedirect(url,obj);else $(window).trigger("serverRedirect",[url,obj])})},onServerConnect:function(obj){fireExternalEvent("onServerConnect",obj,function(preventExecution){if(preventExecution!==true)if(self.rdParams.events.onServerConnect)self.rdParams.events.onServerConnect(obj);else $(window).trigger("serverConnect",obj)})},onDisplayInteractionRequired:function(obj,callback){if(self.rdParams.events.onDisplayInteractionRequired)self.rdParams.events.onDisplayInteractionRequired(obj,
callback)},onServerNeedCredentials:function(obj){self.connecting=false;Thinfinity.Popups.establishing.hide();self.authenticateUser(obj);processRDPCrossMessages("onServerNeedCredentials",obj)},onConnectionKindChange:function(){processRDPCrossMessages("onConnectionKindChange")},onKeyCode:function(e){var kcode=e.which||e.keyCode;if(kcode>=96&&kcode<=105&&kcode!=110)kcode-=48;return kcode},onKeyDown:function(e){var keybinfo={"type":e.type,"altKey":e.altKey,"ctrlKey":e.ctrlKey,"charCode":e.charCode,"keyCode":e.keyCode,
"which":e.which,"shiftKey":e.shiftKey,"metaKey":e.metaKey};var kcode=self.keyCode(e);if(self.IsFunctionKey(kcode)||(e.altKey||e.ctrlKey)&&e.altKey!=e.ctrlKey||!self.rcParams.kbdUnicode){self.sendKey(kcode,0,"down");e.stopPropagation();e.preventDefault()}self.lastKeyCode=kcode},onKeyPress:function(e){var charCode=self.opera?e.which:e.charCode;var keybinfo={"type":e.type,"altKey":e.altKey,"ctrlKey":e.ctrlKey,"charCode":e.charCode,"keyCode":e.keyCode,"which":e.which,"shiftKey":e.shiftKey,"metaKey":e.metaKey};
if(self.rcParams.kbdUnicode){var kcode=self.keyCode(e);if(kcode!=0&&self.IsFunctionKey(self.lastKeyCode)||(e.altKey||e.ctrlKey)&&e.altKey!=e.ctrlKey){e.stopPropagation();e.preventDefault();return}if(self.onlyKeyCode)self.sendKey(self.lastKeyCode,0,"down");else self.sendKey(self.lastKeyCode,charCode,"down");e.stopPropagation();e.preventDefault()}},onKeyUp:function(e){var keybinfo={"type":e.type,"altKey":e.altKey,"ctrlKey":e.ctrlKey,"charCode":e.charCode,"keyCode":e.keyCode,"which":e.which,"shiftKey":e.shiftKey,
"metaKey":e.metaKey};var kcode=self.keyCode(e);if(self.keyCodeSend==0)self.sendKey(0,self.lastKeyCode,"up");else self.sendKey(kcode,0,"up");self.lastKeyCode=0;if(self.firefox&&e.altKey)self.sendKey(18,0,"up");e.stopPropagation();e.preventDefault()},onPlaybackStart:function(){self.display.manager.fireEvent("playbackStart");if(self.rdParams.events.onPlaybackStart)self.rdParams.events.onPlaybackStart()},onPlaybackEnds:function(message){if(self.rdParams.events.onPlaybackEnds)self.rdParams.events.onPlaybackEnds(message)},
onDesktopResize:function(data){if(window!=window.top&&self.rdParams.publishproperties){var obj={"property":"REMOTE_DESKTOP_SIZE","sourceName":window.name,"values":data};window.parent.postMessage(obj,"*")}},onLastUpdateChanged:null,onLicenseMsg:function(obj){fireExternalEvent("onLicenseMsg",obj,function(preventExecution){if(preventExecution!==true)if(self.rdParams.events.onMessage)self.rdParams.events.onLicenseMsg(obj);else $(window).trigger("licenseMsg",[obj])})},onWakeOnLan:function(obj){obj.message=
thinRDPconsts.waitingWakeOnLan;fireExternalEvent("onWakeOnLan",obj,function(preventExecution){if(self.rdParams.events.onWakeOnLan)self.rdParams.events.onWakeOnLan(obj);else $(window).trigger("onWakeOnLan",obj)})},onWaitForVM:function(obj){obj.message=thinRDPconsts.waitingWaitForVM;fireExternalEvent("onWaitForVM",obj,function(preventExecution){if(self.rdParams.events.onWaitForVM)self.rdParams.events.onWaitForVM(obj);else $(window).trigger("onWaitForVM",obj)})},onReconnectionAttempt:function(obj){obj.message=
thinRDPconsts.reconnectionAttempt;fireExternalEvent("onReconnectionAttempt",obj,function(preventExecution){if(self.rdParams.events.onReconnectionAttempt)self.rdParams.events.onReconnectionAttempt(obj);else $(window).trigger("onReconnectionAttempt",obj)})},onCopy:function(obj){fireExternalEvent("copy",obj,function(preventExecution){if(preventExecution!==true)return self.rdParams.events.onCopy?self.rdParams.events.onCopy(obj):$(window).trigger("onCopy",obj)})},onPaste:function(obj){fireExternalEvent("paste",
obj,function(preventExecution){if(preventExecution!==true)return self.rdParams.events.onPaste?self.rdParams.events.onPaste(obj):$(window).trigger("onPaste",obj)})},onCut:function(obj){fireExternalEvent("cut",obj,function(preventExecution){if(preventExecution!==true)return self.rdParams.events.onCut?self.rdParams.events.onCut(obj):$(window).trigger("onCut",obj)})},onCopyFiles:function(data){if(self.rdParams.events.onCopyFiles)self.rdParams.events.onCopyFiles(data)},onSessionTimeout:function(obj){fireExternalEvent("onSessionTimeout",
obj,function(preventExecution){if(self.rdParams.events.onSessionTimeout)self.rdParams.events.onSessionTimeout(obj);else $(window).trigger("onSessionTimeout",obj)})},onShadowingStatus:function(shadowed){fireExternalEvent("onShadowingStatus",shadowed,function(preventExecution){if(preventExecution!==true)if(self.rdParams.events.onShadowingStatus)self.rdParams.events.onShadowingStatus(shadowed);else $(window).trigger("onShadowingStatus",[shadowed])})},onConnectionLost:function(data){if(self.rdParams.events.onConnectionLost)return self.rdParams.events.onConnectionLost(data);
else $(window).trigger("onConnectionLost",[data])},onConnectionRestored:function(data){if(self.rdParams.events.onConnectionRestored)return self.rdParams.events.onConnectionRestored(data);else $(window).trigger("onConnectionRestored",[data])}};this.completeAjaxParams=function(params){if(self.isCrossDomain()){params.beforeSend=function(xhr){xhr.withCredentials=true};params.crossDomain=true}return params};this.encryptedLogin=function(credentials,success,fail,context){var result=false;var querystr="login?credentials="+
encodeURIComponent(this.credentials);if(typeof context!="undefined")querystr=querystr+"&context="+context;this.credentials=credentials;var params={url:self.baseUrl+querystr,async:true,dataType:"html",error:function(jqXHR,err){result=false;fail()},success:function(data){var obj=JSON.parse(data);if(obj.rc==0){result=true;self.pingStart();success()}else{result=false;fail()}}};$.ajax(self.completeAjaxParams(params));return result};this.login=function(username,password,context,success,fail,redirect){var querystr=
"auth/login";var a=username.split("\\");var brokerid="";if(window.productName.indexOf(" Online")>0&&a.length==2&&!helper.object.isNumber(a[0])){brokerid="WEB:"+a[0];querystr=brokerid+"/"+querystr}this.username=username;this.password=password;var params={type:"post",url:self.baseUrl+self.apiUrl+querystr,contentType:"application/json",data:JSON.stringify({username:username,password:password,context:context||""}),async:true,cache:false,dataType:"html",error:function(jqXHR,err){if(jqXHR&&jqXHR.responseText)try{err=
JSON.parse(jqXHR.responseText);err=err.error||{}}catch(e){err={}}fail(err)},success:function(data){try{var obj=JSON.parse(data);obj=obj.data||obj.error||{};if(brokerid!="")$.ajax({type:"patch",async:true,cache:false,url:self.baseUrl,headers:{"x-thinfinity-poolid":brokerid}});if(typeof obj.redirectUri!="undefined"){if(window?.defaultSettings?.proxyAdjust2FAUri){var redirectUrl=helper.url.parseUrl(obj.redirectUri);var currentLocation=helper.url.parseUrl(location);if(redirectUrl.origin!==currentLocation.origin&&
!!redirectUrl.hostname&&!!currentLocation.origin){helper.console.warning(thinRDPconsts.reverseProxyMissingHeaders,arguments);obj.redirectUri=currentLocation.toUrl("-a-p-o")+(redirectUrl.virtualPath.startsWith("/")?redirectUrl.virtualPath.substring(1):redirectUrl.virtualPath);if(!obj.redirectUri.startsWith("/"))obj.redirectUri="/"+obj.redirectUri}}let res=false;if(typeof redirect==="function")try{res=redirect(obj.redirectUri)}catch(error){logError("login redirect handler error. "+error.message);res=
false}let href=location.href;if(href.indexOf("#")>-1)obj.redirectUri+=`#${href.split("#")[1]}`;if("data"in obj&&obj.data!=="")post(obj.redirectUri,{data:JSON.stringify(obj.data)});else if(!res)window.location=obj.redirectUri;return}if(obj&&obj.rc==0||"data"in obj&&typeof obj.data.renderURI!="undefined")success(obj);else fail(obj)}catch(error){fail(error)}}};$.ajax(self.completeAjaxParams(params))};this.logout=function(success,fail){var params={url:self.baseUrl+self.apiUrl+"auth/logout",cache:false,
async:true,dataType:"html",success:function(obj){if(typeof success!="undefined")success(obj)},error:function(jqXHR,textStatus){if(typeof fail!="undefined")fail(jqXHR)},timeout:3E3};$.ajax(self.completeAjaxParams(params))};this.getLoginMethods=function(success,fail){$.ajax({url:self.baseUrl+self.apiUrl+"auth/loginmethods",async:true,cache:false,dataType:"html",contentType:"application/json",error:function(jqXHR,err){fail()},success:function(data){var obj=typeof data!="object"?JSON.parse(data):data;
success(obj)}})};this.changePassword=function(username,oldPassword,newPassword,success,fail){this.username=username;this.password=newPassword;var params={"url":self.baseUrl+self.apiUrl+"auth/changepassword","method":"POST","async":true,"cache":false,"dataType":"html","contentType":"application/json","data":JSON.stringify({username:username,password:oldPassword,newpassword:newPassword}),"error":function(jqXHR,err){fail(JSON.parse(jqXHR.responseText).error)},"success":function(){success()}};$.ajax(self.completeAjaxParams(params))};
this.radiusChallengeResponse=function(username,originalMsg,response,success,fail){var params={"url":self.baseUrl+self.apiUrl+"auth/login","method":"POST","async":true,"cache":false,"dataType":"html","contentType":"application/json","data":JSON.stringify({context:"Radius",username:username,password:"",parent:originalMsg,answer:response}),"error":function(jqXHR,err){let error;if(jqXHR&&jqXHR.responseText){try{error=JSON.parse(jqXHR.responseText).error}catch{}fail(error)}fail()},"success":function(data){success(data)}};
$.ajax(self.completeAjaxParams(params))};this.profileType=_profileTypes;this.getRequestProfile=function(profileType){return profileType==self.profileType.TEMP?"temp=true":profileType==self.profileType.MRU?"mru=true":profileType==self.profileType.PRIVATE?"priv=true":profileType==self.profileType.FILTER?"filter=true":profileType==self.profileType.WEBMANAGER?"webmgr=true":"mru=false"};this.findMember=function(member,callback){var result=null;var reqURL=self.baseUrl+self.apiUrl+"members/"+encodeURIComponent(member);
var params={url:reqURL,async:true,cache:false,dataType:"html",statusCode:{500:function(error){callback(helper.string.format("Error: {0} - Message: {1}",error.status,error.statusText))},401:function(){callback(result)},404:function(data){result=JSON.parse(data&&data.responseText?data.responseText:"{}");callback(result)},200:function(data){result=JSON.parse(data);callback(result)}}};$.ajax(self.completeAjaxParams(params))};this.getUserInfo=function(callback){helper.ajax.get({url:self.baseUrl+self.apiUrl+
"auth/getUserInfo",async:true,cache:false,withCredentials:true,dataType:helper.ajax.responseType.JSON,success:function(res,status,xhr){if(status===200)_thinrdp.authenticated=!!res.data.username;callback(res)},error:callback})};this.getUserInfoAsync=async function(){return new Promise(function(resolve,reject){self.getUserInfo(function(res){resolve(res)})})};this.getVMModels=function(callback){helper.ajax.get({url:self.baseApiUrl+`__cloud__/models`,async:true,cache:false,withCredentials:true,dataType:helper.ajax.responseType.JSON,
success:callback,error:callback})};this.getVMLinkModels=function(callback){helper.ajax.get({url:self.baseApiUrl+`__cloud__/models/links`,async:true,cache:false,withCredentials:true,dataType:helper.ajax.responseType.JSON,success:callback,error:callback})};this.getDomainServices=function(success,failure){helper.ajax.get({"url":self.baseUrl+self.apiUrl+"dirsvc/settings","async":true,"cache":false,"withCredentials":true,"dataType":helper.ajax.responseType.JSON,"success":success,"error":function(err,status,
jqXHR){failure({"status":status,"message":err.message})}})};this.searchUsers=function(requestData,success,failure){helper.ajax.post({"url":self.baseUrl+self.apiUrl+"dirsvc/search","data":requestData,"async":true,"cache":false,"withCredentials":true,"dataType":helper.ajax.responseType.JSON,"success":success,"error":function(err,status,jqXHR){failure({"status":status,"message":err.message})}})};this.commitTransaction=function(id,callback){var _id=id!==""?id.toString():"*";var callArgs={"url":self.baseApiUrl+
self.apiUrl+`profiles/${_id}/commit`,"dataType":helper.ajax.responseType.JSON,"cache":false,"withCredentials":true,"success":callback,"error":callback};helper.ajax.post(callArgs)};this.rollbackTransaction=function(id,callback){var _id=id!==""?id.toString():"*";var callArgs={"url":self.baseUrl+self.apiUrl+`profiles/${_id}/rollback`,"dataType":helper.ajax.responseType.JSON,"cache":false,"withCredentials":true,"success":callback,"error":callback};helper.ajax.post(callArgs)};this.getIcon=function(iconURI,
success,error){var callArgs={url:"/__base__/images",dataType:helper.ajax.responseType.JSON,cache:false,data:{source:iconURI},success:function(res,status,xhr){let img=helper.object.getValue(res,"data.image",null);if(img){img="data:image/png;base64,"+img;success(img,status,xhr)}else error("No item data",xhr)},error:error};helper.ajax.post(callArgs)};this.getProfiles=function(profileType,callback,labelId,opts){var result=null;opts=helper.object.extend({filter:{text:"",scraper:"*",showDisabled:true,showHidden:true},
viewAs:null},opts||{});var reqURL=self.baseApiUrl+self.apiUrl+"profiles/search"+(_queryVersion?"?"+_queryVersion:"");var params={url:reqURL,method:"POST",async:true,cache:false,dataType:"html",contentType:"application/json",data:JSON.stringify({"workspace":[self.profileType.PUBLIC,self.profileType.WEBMANAGER].indexOf(profileType)!==-1?"_pub":"_priv","labelid":labelId,"mode":"compact","filter":{"text":opts.filter.text,"scraper":opts.filter.scraper,"showDisabled":opts.filter.showDisabled,"showHidden":opts.filter.showHidden,
...(opts.filter.bookingPov?{"bookingPov":opts.filter.bookingPov}:{})},"params":[],"viewAs":!!opts.viewAs?opts.viewAs:profileType===self.profileType.WEBMANAGER?"_all":"_self"}),statusCode:{500:function(error){callback(helper.string.format("Error: {0} - Message: {1}",error.status,error.statusText))},401:function(){callback(result)},200:function(data){result=JSON.parse(data);result=result.data||{};if(result&&result.labels&&result.labels instanceof Array){if(Thinfinity.LabelConfig&&profileType===self.profileType.PUBLIC&&
result.labels.length===0)if(!labelId)result.labels.push(Thinfinity.LabelConfig.root);result.labels.forEach(function(elem){elem.profileType=profileType==self.profileType.WEBMANAGER?self.profileType.PUBLIC:profileType})}callback(result)}}};$.ajax(self.completeAjaxParams(params))};this.getLabels=function(labelId,profileType,callback,opts){var result=null;opts=helper.object.extend({viewAs:null},opts||{});var reqURL=self.baseApiUrl+self.apiUrl+"labels"+(_queryVersion?"?"+_queryVersion:"");var params={url:reqURL,
async:true,cache:false,method:"GET",type:"get",dataType:"html",data:{"workspace":[self.profileType.PUBLIC,self.profileType.MRU,self.profileType.WEBMANAGER].indexOf(profileType)!==-1?"_pub":"_priv","viewAs":!!opts.viewAs?opts.viewAs:profileType===self.profileType.WEBMANAGER?"_all":"_self"},statusCode:{500:function(error){callback(helper.string.format("Error: {0} - Message: {1}",error.status,error.statusText))},401:function(){callback(result)},200:function(data){result=JSON.parse(data);result=result.data&&
result.data.items?result.data.items:{};if(result&&result instanceof Array){if(Thinfinity.LabelConfig&&profileType===self.profileType.MRU&&result.length===0)if(!labelId)result.push(Thinfinity.LabelConfig.root);result.forEach(function(elem){elem.profileType=profileType})}callback(result)}}};$.ajax(self.completeAjaxParams(params))};this.newLabel=function(data,profileType,success,fail){var result=null;if(typeof profileType!="number")profileType=self.profileType.MRU;var reqURL=self.baseUrl+self.apiUrl+
"labels";var data={data:data,workspace:[self.profileType.PUBLIC,self.profileType.MRU,self.profileType.WEBMANAGER].indexOf(profileType)!==-1?"_pub":"_priv"};var params={url:reqURL,method:"POST",async:true,cache:false,contentType:"application/json",data:JSON.stringify(data),complete:function(jqXHR,textStatus){var jqXHRDetails={status:jqXHR.status,statusText:jqXHR.statusText};switch(jqXHR.status){case 201:var res=jqXHR.responseJSON;res=res.data||{};success(res);break;case 401:fail(result,jqXHRDetails);
break;case 500:fail(helper.string.format("Error: {0} - Message: {1}",jqXHR.status,jqXHR.statusText),jqXHRDetails);break;default:fail(jqXHR.statusText,jqXHRDetails);break}}};$.ajax(self.completeAjaxParams(params))};this.updateLabel=function(data,profileType,success,fail){var result=null;if(typeof profileType!="number")profileType=self.profileType.MRU;var reqURL=self.baseUrl+self.apiUrl+"labels/"+data.id+"?workspace="+([self.profileType.PUBLIC,self.profileType.MRU,self.profileType.WEBMANAGER].indexOf(profileType)!==
-1?"_pub":"_priv");var data={data:data};var params={url:reqURL,method:"PUT",async:true,cache:false,contentType:"application/json",data:JSON.stringify(data),complete:function(jqXHR,textStatus){var jqXHRDetails={status:jqXHR.status,statusText:jqXHR.statusText};switch(jqXHR.status){case 200:success(jqXHR.responseJSON);break;case 401:fail(result,jqXHRDetails);break;case 500:fail(helper.string.format("Error: {0} - Message: {1}",jqXHR.status,jqXHR.statusText),jqXHRDetails);break;default:fail(jqXHR.statusText,
jqXHRDetails);break}}};$.ajax(self.completeAjaxParams(params))};this.removeLabel=function(labelId,profileType,success,fail){var result=null;var reqURL=self.baseUrl+self.apiUrl+"labels/"+labelId+"?workspace="+([self.profileType.PUBLIC,self.profileType.MRU,self.profileType.WEBMANAGER].indexOf(profileType)!==-1?"_pub":"_priv");var params={method:"DELETE",url:reqURL,async:true,cache:false,dataType:"json",complete:function(jqXHR,textStatus){var jqXHRDetails={status:jqXHR.status,statusText:jqXHR.statusText};
switch(jqXHR.status){case 200:success(jqXHR.responseJSON);break;case 401:fail(result,jqXHRDetails);break;case 500:fail(helper.string.format("Error: {0} - Message: {1}",jqXHR.status,jqXHR.statusText),jqXHRDetails);break;default:fail(jqXHR.statusText,jqXHRDetails);break}}};$.ajax(self.completeAjaxParams(params))};this.getProfile=function(publickey,profileType,callback,extraParams){var result=null;var reqURL=self.baseApiUrl+self.apiUrl+"profiles/"+publickey+(_queryVersion?"?"+_queryVersion:"")+(extraParams?
"&"+extraParams:"");var params={url:reqURL,method:"GET",cache:false,async:true,dataType:"json",data:{"workspace":[self.profileType.PUBLIC,self.profileType.WEBMANAGER].indexOf(profileType)!==-1?"_pub":"_priv"},statusCode:{500:function(error){callback(helper.string.format("Error: {0} - Message: {1}",error.status,error.statusText))},400:function(){callback({})},200:function(data){data=data.data||{};callback(data)}}};$.ajax(self.completeAjaxParams(params))};this.extendAuth=function(url,callback){const reqURL=
self.baseApiUrl+self.apiUrl+"auth/extend";return fetch(reqURL,{method:"POST",body:JSON.stringify({"url":url}),headers:{"Content-type":"application/json"}}).then(j=>j.json()).then(res=>{let token=res?.data?.token??null;return token?reqURL+"/"+token:null})};this.getProfileCredentials=function(publickey,success,failure){var result=null;var reqURL=self.baseApiUrl+self.apiUrl+"profiles/"+publickey+"/credentials?workspace=_pub"+(_queryVersion?"&"+_queryVersion:"");var params={url:reqURL,method:"GET",cache:false,
async:true,dataType:"json",statusCode:{500:function(error){(failure||success)(helper.string.format("Error: {0} - Message: {1}",error.status,error.statusText))},400:function(){(failure||success)({})},404:function(data){(failure||success)(data.responseJSON?data.responseJSON.error.message:error.statusText)},200:function(data){data=data.data||{};success(data)}}};$.ajax(self.completeAjaxParams(params))};this.updateProfileCredentials=function(publickey,obj,success,fail){var reqURL=self.baseApiUrl+self.apiUrl+
"profiles/"+publickey+"/credentials";var data={workspace:"_pub",data:obj};var params={method:""==obj.username+obj.password?"DELETE":"PUT",url:reqURL,cache:false,async:true,contentType:"application/json",data:JSON.stringify(data),complete:function(jqXHR,textStatus){var jqXHRDetails={status:jqXHR.status,statusText:jqXHR.statusText};switch(jqXHR.status){case 200:var res=jqXHR.responseJSON;success(res);break;default:fail(jqXHRDetails);break}}};$.ajax(self.completeAjaxParams(params))};this.newProfile=
function(profile,profileType,success,fail){var result=null;if(typeof profileType!="number")profileType=self.profileType.MRU;var reqURL=self.baseApiUrl+self.apiUrl+"profiles";var data={data:profile,workspace:profileType==self.profileType.TEMP?"_temp":[self.profileType.PUBLIC,self.profileType.WEBMANAGER].indexOf(profileType)!==-1?"_pub":"_priv",model:profile.model?profile.model:""};delete profile.id;delete profile.publickey;delete profile.model;var params={url:reqURL,method:"POST",async:true,contentType:"application/json",
data:JSON.stringify(data),complete:function(jqXHR,textStatus){var jqXHRDetails={status:jqXHR.status,statusText:jqXHR.statusText};switch(jqXHR.status){case 201:var res=jqXHR.responseJSON;res=res.data||{};success(res);break;case 400:fail(result,jqXHRDetails);break;case 500:fail(helper.string.format("Error: {0} - Message: {1}",jqXHR.status,jqXHR.statusText),jqXHRDetails);break;default:fail(jqXHR.statusText,jqXHRDetails);break}}};$.ajax(self.completeAjaxParams(params))};this.updateProfile=function(profile,
profileType,success,fail){var result=null;if(typeof profileType!="number")profileType=self.profileType.MRU;var reqURL=self.baseApiUrl+self.apiUrl+"profiles/"+profile.publickey;var data={data:profile,workspace:[self.profileType.PUBLIC,self.profileType.WEBMANAGER].indexOf(profileType)!==-1?"_pub":"_priv"};var params={url:reqURL,method:"PUT",async:true,contentType:"application/json",data:JSON.stringify(data),complete:function(jqXHR,textStatus){var jqXHRDetails={status:jqXHR.status,statusText:jqXHR.statusText};
switch(jqXHR.status){case 200:success(jqXHR.responseJSON);break;case 400:fail(result,jqXHRDetails);break;case 500:fail(helper.string.format("Error: {0} - Message: {1}",jqXHR.status,jqXHR.statusText),jqXHRDetails);break;default:fail(jqXHR.statusText,jqXHRDetails);break}}};$.ajax(self.completeAjaxParams(params))};this.removeProfile=function(publickey,profileType,callback){var result=null;var reqURL=self.baseApiUrl+self.apiUrl+"profiles/"+publickey+"?workspace="+([self.profileType.PUBLIC,self.profileType.WEBMANAGER].indexOf(profileType)!==
-1?"_pub":"_priv");var params={method:"DELETE",url:reqURL,cache:false,async:true,contentType:"application/json",complete:function(jqXHR,textStatus){var jqXHRDetails={status:jqXHR.status,statusText:jqXHR.statusText};switch(jqXHR.status){case 200:var res=jqXHR.responseJSON;callback(res,jqXHRDetails);break;case 401:callback(result,jqXHRDetails);break;case 500:callback(helper.string.format("Error: {0} - Message: {1}",jqXHR.status,jqXHR.statusText),jqXHRDetails);break;default:callback(jqXHR.statusText,
jqXHRDetails);break}}};$.ajax(self.completeAjaxParams(params))};this.pingStart=function(){if(!self.sessionTimer)self.sessionTimer=setTimeout(function(){if(self){var params={url:self.baseUrl+self.apiUrl+"auth/ping",async:true,timeout:5E3,dataType:"html",error:function(){self.sessionTimer=null;self.pingStart()},statusCode:{500:function(error){window.location.reload();return},200:function(data){result=JSON.parse(data);if(_thinrdp.authenticated!=result.authenticated)if(result.authenticated)_thinrdp.authenticated=
result.authenticated;else{window.location.reload();return}if(_thinrdp.lastUpdate!=result.lastupdate)_thinrdp.updateLastUpdate(result.lastupdate);self.sessionTimer=null;self.pingStart()}}};$.ajax(self.completeAjaxParams(params))}},PING_TIMEOUT)};this.pingStop=function(){clearTimeout(self.sessionTimer);self.sessionTimer=null};this.fillTimeZoneInfo=function(params){var rightNow=new Date;var rightStr=rightNow.getFullYear()+"-"+("0"+(rightNow.getMonth()+1)).slice(-2)+"-"+("0"+rightNow.getDate()).slice(-2)+
" "+rightNow.toTimeString();var temp;var Jan1=new Date(rightNow.getFullYear(),0,1,0,0,0,0);temp=Jan1.toUTCString();temp=temp.substring(0,temp.lastIndexOf(" "));var Jan2=new Date(temp);var Jul1=new Date(rightNow.getFullYear(),6,1,0,0,0,0);temp=Jul1.toUTCString();temp=temp.substring(0,temp.lastIndexOf(" "));var Jul2=new Date(temp);var standard_offset=(Jan1-Jan2)/(1E3*60);var daylight_offset=(Jul1-Jul2)/(1E3*60);rightStr+="|"+(standard_offset-daylight_offset);if(standard_offset!=daylight_offset){var Cur1=
new Date(rightNow.getFullYear(),rightNow.getMonth(),rightNow.getDate(),rightNow.getHours(),rightNow.getMinutes(),rightNow.getSeconds(),0);temp=Cur1.toUTCString();temp=temp.substring(0,temp.lastIndexOf(" "));var Cur2=new Date(temp);var current_offset=(Cur1-Cur2)/(1E3*60);if(current_offset==(standard_offset>daylight_offset?standard_offset:daylight_offset))rightStr+="|1";else rightStr+="|0"}else rightStr+="|0";params.timeZone=rightStr};this.applyParam=function(params,name,value){if(typeof value=="object"&&
value!=null)if(value instanceof Array)params[name]=value.slice(0);else{var obj=params[name];if(!obj)obj={};for(var v in value)obj[v]=value[v];params[name]=obj}else params[name]=value};function refreshFitToScreen(){var useDisp=self.serverValues.dynamicplugins["drdynvc/Microsoft::Windows::RDS::DisplayControl"];if(typeof useDisp!="undefined"&&useDisp=="created"){var ww=window.environment.rawWidth||window.screen.width;var wh=window.environment.rawHeight||window.screen.height;if(helper.object.existsPath(self,
"clientSettings.UseViewportSize")&&self.clientSettings.UseViewportSize){ww=window.environment.viewportWidth;wh=window.environment.viewportHeight}self.sendEvent("cmd=brwrRsze&w="+ww+"&h="+wh+"&id="+self.rcParams.id)}else self.restart()}function resizeDesktop(){if(self&&self.connected){if(typeof resizeTimeout!="undefined")window.clearTimeout(resizeTimeout);resizeTimeout=window.setTimeout(function(){var ww=window.environment.detectedWidth;var wh=window.environment.detectedHeight;if(helper.object.existsPath(self,
"clientSettings.UseViewportSize")&&self.clientSettings.UseViewportSize){ww=window.environment.viewportWidth;wh=window.environment.viewportHeight}if((agentInfo.isMobile||self.rdParams.resizeDesktop)&&self.rcParams.resolution==="fittobrowser"){var useDisp=self.serverValues.dynamicplugins["drdynvc/Microsoft::Windows::RDS::DisplayControl"];if(typeof useDisp!="undefined"&&useDisp=="created"){helper.console.log("calling notifyNewSize");self.sendEvent("cmd=brwrRsze&w="+ww+"&h="+wh+"&id="+self.rcParams.id)}}if(self.rdParams.reconnectOnResize){helper.console.log("actual restartToNewSize");
self.restart(ww,wh,"resize")}if(!agentInfo.isMobile&&self.rcParams.centered)self.center()},waitToResize<500?500:waitToResize)}}function parseProfile(incomingProfile){var scraper=(incomingProfile.scraperId||"RDP").toUpperCase();var outputProfile={};var editor=new Thinfinity.Profile.Editor({"API":ThinRDP,"type":scraper,"mode":"SILENT","profile":incomingProfile});if(incomingProfile.profileKey)editor.mergeData(outputProfile);else outputProfile=editor.mergeData();return outputProfile}this.getEventsHandlerList=
function(eventObj){var list=[];if(eventObj!=null)for(var eventName in eventObj)if(eventObj[eventName]!=null)list.push(eventName);return list};function getTargetIframe(params){var iframe=null;var divId=params.divId?document.getElementById(params.divId):null;var target=divId?divId:helper.object.getHTMLType(params.targetWindow)!=null?params.targetWindow:typeof params.targetWindow=="string"?document.getElementById(params.targetWindow):null;if(_isRecoveringConnection)target=document.getElementById(self.rdParams.targetWindow);
var targetName="iframe_"+runOptions.mode+"_"+helper.utils.getGUID();if(target===null)target=document.body;if(target instanceof HTMLIFrameElement){iframe=target;targetName=(iframe.name||iframe.id)!=""?iframe.name||iframe.id:targetName}else if(target instanceof HTMLElement)iframe=helper.dom.appendJsonElement({"type":"iframe","parentElement":target,"attributes":{"id":targetName,"style":"width:100%;height:100%;position:absolute;margin:0px;padding:0px;border:0px;"}});self.rdParams.targetWindow=targetName;
if(_runRemote)rdpView.linkageConnection.setTargetWindow(self.rdParams.targetWindow);if(runOptions.fullscreen)environment.requestFullscreen(iframe);return{"iframe":iframe,"target":target}}function createTemporalProfile(profileParams){function applyValue(value,target,propString,convertFunc){if(typeof value!="undefined"&&value!=null){var t=target;var prop=propString.split(".");for(var p=0;p<prop.length-1;p++){if(!t[prop[p]])t[prop[p]]={};t=t[prop[p]]}t[prop[prop.length-1]]=convertFunc?convertFunc(value):
value}}function getTempProfile(profile,profileType,success,fail){var frmNP=helper.dom.appendJsonElement({"type":"iframe","parentElement":document.body,"attributes":{"style":"position: absolute; height: 1px; width: 1px; left: -100px;top: -100px; visibility: hidden;z-index:-1;"}});frmNP.onload=function(){var _id=(new Date).getTime().toString();var fnMessage=function(e){if(e.data&&e.data.id===_id){if(e.data.data)success(e.data.data);else fail(e.data.message);helper.dom.removeEvent(window,"onmessage",
fnMessage);document.body.removeChild(frmNP)}};helper.dom.addEvent(window,"onmessage",fnMessage);frmNP.contentWindow.postMessage({"profile":profile,"profileType":profileType,"id":_id},"*")};var turl=self.baseUrl;if(turl.lastIndexOf("/")!=turl.length-1)turl+="/";turl+="getTempProfile.html";frmNP.src=turl}var newProfile=_runRemote&&serverUrl!=""&&serverUrl!=window.location.origin?getTempProfile:self.newProfile;var profile=parseProfile(profileParams.profile||profileParams);if(helper.object.getValue(profileParams,
"profile.general.username",null)&&helper.object.getValue(profileParams,"profile.general.password",null)&&helper.object.getValue(profileParams,"profile.general.credentials",-1)==-1)profileParams.credentials=profile.credentials=ThinRDP.credential.USE_DEFINED;newProfile(profile,self.profileType.TEMP,function(p){var url=helper.url.parseUrl(runOptions.mode===ThinRDP.mode.SDK&&self.baseUrl!==""?self.baseUrl:window.location.href).toUrl("-a-r")+p.urlKey+"/";var elems=getTargetIframe(profileParams);if(elems.iframe){if(elems.target){if(window.getComputedStyle(elems.target,
null).getPropertyValue("visibility")==="hidden")elems.target.style.visibility="visible";if(window.getComputedStyle(elems.target,null).getPropertyValue("display")==="none")elems.target.style.display="block"}elems.iframe.src=url;if(runOptions.mode!=ThinRDP.mode.HOST)rdpView.linkageConnection.start(elems.iframe.contentWindow);if(runOptions.success)setTimeout(function(){runOptions.success()},10)}else throw"Not implemented";},function(e){helper.console.log(e)})}this.connect=function(params){if(typeof params===
"undefined")params=runOptions;if(!_isRecoveringConnection)if(runOptions.mode===ThinRDP.mode.SDK&&!(params&&(params.profileKey||helper.object.getValue(params,"profile.general.address",null)||helper.object.getValue(params,"computer",null)))){var message=thinRDPconsts.establishConnectionMissingKeyData;if(helper.object.existsPath(params,"events.onServerConnectionError"))params.events.onServerConnectionError(message);else helper.console.error(message,arguments);if(runOptions.failure)setTimeout(function(){runOptions.failure(message)},
10);return}window.environment.ready(function(){if(!_isRecoveringConnection){if(params&&typeof params.port==="undefined"&&typeof params.computer!=="undefined"){var rePort=new RegExp(/:[0-9]{1,}/g);var result=rePort.exec(params.computer);if(result){params.computer=params.computer.replace(rePort,"");params.port=result[0].replace(/:/g,"")}}var iq=typeof params.imagequality=="undefined"?1:parseInt(params.imagequality,10);switch(iq){case 0:params.imageMethod=2;params.quality=100;params.rleThreshold=85;
break;case 1:params.imageMethod=2;params.quality=85;params.rleThreshold=85;break;case 2:params.imageMethod=2;params.quality=55;params.rleThreshold=85;break;case 3:params.imageMethod=0;params.quality=25;break;case 4:params.imageMethod=3;break}self.clearParams();for(var p in params)self.applyParam(self.rdParams,p,params[p]);if(typeof customSettings!="undefined"){for(var customProp in customSettings)self.rdParams[customProp]=customSettings[customProp];[{binding:["noShowPopupsOnClose","noShowConnectionClosePopup"],
to:"noShowConnectionClosePopup"}].forEach(item=>{item.binding.forEach(bind=>{if(customSettings.hasOwnProperty(bind))self.rdParams[item.to]=customSettings[bind]})})}if(helper.object.existsPath(window,"customSettings.mobile.extendedKeyboard.enabled"))self.rdParams["disableExtKeys"]=!window.customSettings.mobile.extendedKeyboard.enabled;if((self.rdParams.resizeDesktop||self.rdParams.reconnectOnResize)&&!agentInfo.isMobile);if(typeof self.rdParams.publishproperties=="undefined")self.rdParams.publishproperties=
typeof self.rdParams.events!="undefined"&&!!self.rdParams.events.onPropertyChange;self.rdParams.externalEvents=self.getEventsHandlerList(self.rdParams.events);self.rdParams.externalEvents.push("onBrokerError");self.fillTimeZoneInfo(self.rdParams)}if(runOptions.mode===ThinRDP.mode.OTURL){var elems=getTargetIframe(self.rdParams);if(elems.iframe){elems.iframe.src=serverUrl+runOptions.oturl;rdpView.linkageConnection.start(elems.iframe.contentWindow);if(runOptions.success)setTimeout(function(){runOptions.success()},
10);return}}if([ThinRDP.mode.OTURL,ThinRDP.mode.SDK].indexOf(runOptions.mode)!=-1)createTemporalProfile(params);else if(runOptions.mode===ThinRDP.mode.SKEY){var form=self.buildForm();self.rdParams.credentials=form.elements["credentials"].value;if(self.rdParams.brokerData)document.getElementById("ThinRDPForm").elements["brokerData"].value=self.rdParams.brokerData;document.getElementById("ThinRDPForm").elements["data"].value=encodeURIComponent(JSON.stringify(self.rdParams));form.target=self.rdParams.targetWindow==
"*"?self.buildTargetName():self.rdParams.targetWindow;var proto=self.rdParams.postPage.split(":");form.action=(proto[0]=="http"||proto[0]=="https"?"":self.baseUrl)+self.rdParams.postPage;if(self.rdParams.sourceWindow&&self.rdParams.targetWindow)form.action+=(form.action.indexOf("?")==-1?"?":"&")+"sourceWindow="+self.rdParams.sourceWindow+"&targetWindow="+self.rdParams.targetWindow;self.form=form;form.submit()}else{self.setParams(self.rdParams,self.events);self.registerDrawCommands();if(self.rdParams.logWindow){var scr=
document.createElement("SCRIPT");scr.setAttribute("type","text/javascript");scr.setAttribute("src","js/msgLogger.js");document.head.appendChild(scr)}function callConnect(){self.completeConnection();if(self.rdParams.disabledNLA||!self.rdParams.askForCredentials||self.rdParams.username!=""&&self.rdParams.password!="")doConnect();else self.authenticateUser({"credentials":{"username":self.rdParams.username,"password":self.rdParams.password}})}setTimeout(function(){callConnect()},150)}})};this.registerDrawCommands=
function(){this.registerDrawCmd("CM",function(cmd,win,context){if(!_playbackStarted){self.events.onPlaybackStart();_playbackStarted=true}if(self.overrideCursor)self.overrideCursor=false;if(!self.playbackController)self.playbackController=new PlaybackController({"owner":self,"useAjax":function(){return self.useAjax},"getAjaxUrl":"","sendEvent":self.sendEvent,"wsSend":self.wsSend,"id":self.rcParams.id,"onClientUpdate":function(obj){try{self.rcParams.mouseControl=false;if(self.clipboard)self.clipboard.dispose();
if(self.DesktopResize)self.DesktopResize(obj["Settings"]["width"],obj["Settings"]["height"],1);self.center();self.rdParams.viewLeft=0;self.rdParams.viewRight=obj["Settings"]["width"];self.rdParams.viewTop=0;self.rdParams.viewBottom=obj["Settings"]["height"];self.rdParams.viewWidth=obj["Settings"]["width"];self.rdParams.viewHeight=obj["Settings"]["height"];self.rdParams.maxWidth=obj["Settings"]["width"];self.rdParams.maxHeight=obj["Settings"]["height"];self.rdParams.resolution=obj["Settings"]["width"]+
"x"+obj["Settings"]["height"];self.rcParams.width=obj["Settings"]["width"];self.rcParams.height=obj["Settings"]["height"];self.rcParams.resolution=self.rdParams.resolution;self.zoomDesktop()}catch(err){console.log(err)}},"onMouseUpdate":function(m){self.display.manager.processDisplayCmd("PLAYBACK_MOUSE_MOVE",m.mon||0,m)}});self.playbackController.update(cmd.code,cmd.text)});this.registerDrawCmd("PC",function(cmd,win,context){var plugin=self.serverValues.plugins[cmd.pn];var sp;if(!plugin)plugin=self.serverValues.plugins[cmd.pn]=
{"subplugins":null};if(typeof cmd.spn!="undefined"){if(!plugin.subplugins)plugin.subplugins={};var sp=plugin.subplugins[cmd.dt];if(!sp)sp=plugin.subplugins[cmd.dt]={};sp[cmd.spn]={"dynamic":cmd.d,"enabled":cmd.e}}else{plugin["deviceType"]=cmd.dt;plugin["dynamic"]=cmd.d;plugin["enabled"]=cmd.e}});this.registerDrawCmd("SM",function(cmd,win,context){var smENUM=["debug","info","warning","error","exception","fatal"];if(cmd.k==3){var jData={"action":"alert","data":cmd,"title":thinRDPconsts.productDescription};
fireExternalEvent("onMessage",jData,function(preventExecution){if(preventExecution!==true)if(typeof THIN.rdParams.events=="undefined"||THIN.rdParams.events.onMessage==null)$(window).trigger("printDialog",jData);else if(THIN.rdParams.events.onMessage(jData)!==true)Thinfinity.Popups.alert(cmd.m,thinRDPconsts.productDescription,"","","","",false)})}else helper.console.log("ServerMessage - [kind: "+smENUM[cmd.k]+", code: "+cmd.e+", message: '"+cmd.m+"']")})};this.completeConnection=function(){if(agentInfo.isMobile&&
!self.rdParams.forceDesktop){self.maxWidth=self.rcParams.width;self.maxHeight=self.rcParams.height;self.rcParams.hookKeyboard=false;self.rcParams.scaled=false;mouseInstance=new Thinfinity.Mobile;mouseInstance.initMobile(self,true,{onServerConnecting:self.events.onServerConnecting,onSessionEnd:self.events.onSessionEnd,onServerConnectionError:self.events.onServerConnectionError,onServerError:self.events.onServerError,onServerConnect:self.events.onServerConnect,onServerDisconnect:self.events.onServerDisconnect,
onServerCommandResult:self.events.onServerCommandResult,onSessionStart:self.events.onSessionStart});mouseInstance.initTouchDevice()}if(self.__proto__==null)self.__proto__=Object.getPrototypeOf(self);self.__proto__.init.call(self,{scraper:self.rdParams.scraper,scraperArgs:self.buildArgs(self.rdParams,_resolutionModeEnum.JSON)})};function doConnect(avoidConnect){self.gettingCredentials=false;fireExternalEvent("onServerConnecting",null,function(preventExecution){if(preventExecution!==true)if(self.rdParams.events.onServerConnecting)self.rdParams.events.onServerConnecting({"reconnecting":false});
else $(window).trigger("establishingConnection")});self.applyParams({"scraper":self.rdParams.scraper,"scraperArgs":self.buildArgs(self.rdParams,_resolutionModeEnum.JSON)});self.pingStop();if(avoidConnect!==true)self.__proto__.connect.call(self)}this.getImgQuality=function(){return self.rdParams.imagequality};this.setImgQuality=function(value){self.rdParams.imagequality=parseInt(value,10);switch(self.rdParams.imagequality){case 0:self.rdParams.imageMethod=1;self.rdParams.quality=100;break;case 1:self.rdParams.imageMethod=
2;self.rdParams.quality=80;break;case 2:self.rdParams.imageMethod=2;self.rdParams.quality=55;break;case 3:self.rdParams.imageMethod=0;self.rdParams.quality=40;break;case 4:self.rdParams.imageMethod=3;self.rdParams.quality=0;break}this.sendCmd("cmd=params&response=false&imagequality="+self.rdParams.imagequality);if(typeof saveConnectionSettings!="undefined")saveConnectionSettings(self)};this.restart=function(w,h,op){self.reset();if(typeof w!="undefined")self.rdParams.width=w;if(typeof h!="undefined")self.rdParams.height=
h;var altArgs="";if(typeof op!="undefined")altArgs+="&op="+op;var args="cmd=start&subcmd=restart"+altArgs+self.buildResolutionArgs();self.start(args)};this.buildResolutionArgs=function(resolutionMode,appendObj){if(typeof resolutionMode=="undefined")resolutionMode=_resolutionModeEnum.QUERY_STRING;var fitMode=appendObj||{};if(typeof this.agentName=="undefined")this.resolveAgent();var screenWidth=window.environment.rawWidth||window.screen.width;var screenHeight=window.environment.rawHeight||window.screen.height;
var w=window.environment.detectedWidth;var h=window.environment.detectedHeight;if(self.rdParams.resolution==ThinRDP.resolution.FIT_TO_BROWSER||self.rdParams.resolution==="fittobrowser")fitMode.fitmode=0;else if(self.rdParams.resolution==ThinRDP.resolution.FIT_TO_SCREEN||self.rdParams.resolution==="fittoscreen")fitMode.fitmode=2;else if(self.rdParams.resolution==ThinRDP.resolution.CUSTOM){w=self.rdParams.width;h=self.rdParams.height;fitMode.fitmode=1}else if(self.rdParams.resolution.indexOf("x")>0){fitMode.fitmode=
1;var res=self.rdParams.resolution.split("x");w=res[0];h=res[1]}fitMode.browserWidth=w;fitMode.browserHeight=h;fitMode.screenWidth=screenWidth;fitMode.screenHeight=screenHeight;return resolutionMode===_resolutionModeEnum.QUERY_STRING?helper.object.jsonToString(fitMode):fitMode};this.buildArgs=function(params,resolutionMode){if(typeof resolutionMode==undefined)resolutionMode=_resolutionModeEnum.QUERY_STRING;var buildedArgs={};if(self.rdParams.profileKey){buildedArgs.profileKey=self.rdParams.profileKey;
if(self.rdParams.profilePass)buildedArgs.profilePass=self.rdParams.profilePass;this.buildResolutionArgs(resolutionMode.JSON,buildedArgs);if(self.rdParams.computer!=null)buildedArgs.rdpcomputer=self.rdParams.computer;if(self.rdParams.username!="")buildedArgs.rdpusername=self.rdParams.username;if(self.rdParams.password!="")buildedArgs.rdppassword=self.rdParams.password;if(self.rdParams.credsave)buildedArgs.rdpcredsave=self.rdParams.credsave;if(customSettings&&typeof customSettings.noSaveCredentials!=
"undefined")self.rdParams.credsave=!customSettings.noSaveCredentials;if(self.rdParams.credentials!="")buildedArgs.credentials=self.rdParams.credentials;if(self.rdParams.savesession!="")buildedArgs.savesession=self.rdParams.savesession;if(typeof self.rdParams.playsession!="undefined"&&self.rdParams.playsession!=null)buildedArgs.playsession=self.rdParams.playsession;if(self.rdParams.disableNLA!="")buildedArgs.rdpdisablenla=self.rdParams.disableNLA;if(self.rdParams.forceTLSVersion!=null&&self.rdParams.forceTLSVersion!=
"")buildedArgs.rdptlsversion=self.rdParams.forceTLSVersion;if(self.rdParams.destType!=""){self.rdParams.destType=self.rdParams.destType.toUpperCase();if(self.rdParams.destType=="VMID"){buildedArgs.rdpdesttype=self.rdParams.destType;buildedArgs.rdpdestinfo=self.rdParams.destInfo}else if(self.rdParams.destType=="RDS"){buildedArgs.rdpdesttype=self.rdParams.destType;buildedArgs.rdpdestinfo=self.rdParams.destInfo}}if(self.rdParams.startprg!=""&&self.rdParams.startprg!="0"){buildedArgs.rdpappmode=self.rdParams.startprg;
if(self.rdParams.command!="")buildedArgs.rdpcommand=self.rdParams.command;if(self.rdParams.showOnStart!="undefined")buildedArgs.showonstart=self.rdParams.showOnStart}if(self.rdParams.timeZone!="")buildedArgs.timezone=self.rdParams.timeZone;if(self.rdParams.kbdMode!="")buildedArgs.rdpkbdmode=self.rdParams.kbdMode;if(typeof self.rdParams.kbdLayout!="undefined"&&self.rdParams.kbdLayout!=1033)buildedArgs.rdpkbdlayout=self.rdParams.kbdLayout;if(self.rdParams.overrideDefaults){buildedArgs.overrideDefaults=
true;if(self.rdParams.directory!="")buildedArgs.rdpdirectory=self.rdParams.directory;if(self.rdParams.cmdargs!="")buildedArgs.rdpcmdargs=self.rdParams.cmdargs;if(typeof params.bpp!="undefined")buildedArgs.bpp=params.bpp;if(typeof params.console!="undefined")buildedArgs.console=params.console;if(typeof params.unicodeKeyboard!="undefined")buildedArgs.rdpkbdunicode=self.rdParams.unicodeKeyboard;if(typeof params.experience!="undefined"){if(typeof params.experience.enableRemoteFx!="undefined")buildedArgs.enablerfx=
self.rdParams.experience.enableRemoteFx;if(typeof params.experience.enableTouchRedirection!="undefined")buildedArgs.entouchredir=self.rdParams.experience.enableTouchRedirection;if(typeof params.experience.desktopbackground!="undefined")buildedArgs.vedesktopbackground=self.rdParams.experience.desktopbackground;if(typeof params.experience.visualstyles!="undefined")buildedArgs.vevisualstyles=self.rdParams.experience.visualstyles;if(typeof params.experience.menuwindowanimation!="undefined")buildedArgs.vemnuwndanimation=
self.rdParams.experience.menuwindowanimation;if(typeof params.experience.fontsmoothing!="undefined")buildedArgs.vefontsmoothing=self.rdParams.experience.fontsmoothing;if(typeof params.experience.showwindowcontent!="undefined")buildedArgs.veshowwndcontent=self.rdParams.experience.showwindowcontent;if(typeof params.experience.desktopcomposition!="undefined")buildedArgs.vedesktopcomposition=self.rdParams.experience.desktopcomposition}if(typeof params.clipboard!="undefined")buildedArgs.clipboard=params.clipboard;
if(typeof params.reconnectOnResize!="undefined")buildedArgs.reconnectonresize=params.reconnectOnResize;if(typeof params.resizeDesktop!="undefined")buildedArgs.resizedesktop=params.resizeDesktop;if(typeof params.printer!="undefined"){if(typeof params.printer.enabled!="undefined")buildedArgs.prnenabled=params.printer.enabled;if(typeof params.printer.setasdefault!="undefined")buildedArgs.prnsetasdefault=params.printer.setasdefault;if(typeof params.printer.name!="undefined"&&self.rdParams.printer.name)buildedArgs.prnname=
params.printer.name;if(typeof params.printer.driver!="undefined"&&self.rdParams.printer.driver)buildedArgs.prndriver=params.printer.driver}if(typeof params.disk!="undefined"){if(typeof params.disk.enabled!="undefined")buildedArgs.diskenabled=params.disk.enabled;if(typeof params.disk.name!="undefined"&&self.rdParams.disk.name)buildedArgs.diskname=params.disk.name;if(typeof params.disk.autodownload!="undefined")buildedArgs.autodownload=params.disk.autodownload}if(typeof params.sound!="undefined")if(typeof params.sound.enabled!=
"undefined"){if(params.sound.enabled)params.sound.enabled=self.availableAudio;buildedArgs.sndenabled=params.sound.enabled;if(params.sound.enabled&&typeof params.sound.quality!="undefined")buildedArgs.sndquality=params.sound.quality.toString()}}}else{if(!self.rdParams.profileKey||self.rdParams.computer){if(self.rdParams.computer!="")buildedArgs.rdpcomputer=self.rdParams.computer;if(self.rdParams.width*self.rdParams.height>0)self.buildResolutionArgs(resolutionMode.JSON,buildedArgs);if(self.rdParams.username!=
"")buildedArgs.rdpusername=self.rdParams.username;if(self.rdParams.password!="")buildedArgs.rdppassword=self.rdParams.password;if(self.rdParams.credentials!="")buildedArgs.credentials=self.rdParams.credentials;if(self.rdParams.savesession!="")buildedArgs.savesession=self.rdParams.savesession;if(typeof self.rdParams.playsession!="undefined"&&self.rdParams.playsession!=null)buildedArgs.playsession=self.rdParams.playsession;if(self.rdParams.startprg!=""&&self.rdParams.startprg!="0"){buildedArgs.rdpappmode=
self.rdParams.startprg;if(self.rdParams.command!="")buildedArgs.rdpcommand=self.rdParams.command;if(self.rdParams.directory!="")buildedArgs.rdpdirectory=self.rdParams.directory;if(self.rdParams.cmdargs!="")buildedArgs.rdpcmdargs=self.rdParams.cmdargs;if(self.rdParams.showOnStart!="undefined")buildedArgs.showonstart=self.rdParams.showOnStart}buildedArgs.bpp=self.rdParams.bpp;buildedArgs.console=self.rdParams.console;buildedArgs.vedesktopbackground=self.rdParams.experience.desktopbackground;buildedArgs.vevisualstyles=
self.rdParams.experience.visualstyles;buildedArgs.vemnuwndanimation=self.rdParams.experience.menuwindowanimation;buildedArgs.vefontsmoothing=self.rdParams.experience.fontsmoothing;buildedArgs.veshowwndcontent=self.rdParams.experience.showwindowcontent;buildedArgs.vedesktopcomposition=self.rdParams.experience.desktopcomposition;buildedArgs.rdpkbdunicode=self.rdParams.unicodeKeyboard;if(self.rdParams.kbdLayout&&self.rdParams.kbdLayout!=1033)buildedArgs.rdpkbdlayout=self.rdParams.kbdLayout;if(typeof params.relativeTouch!=
"undefined")buildedArgs.relativetouch=self.rdParams.relativeTouch;if(typeof params.experience!="undefined"){if(typeof params.experience.enableRemoteFx!="undefined")buildedArgs.enablerfx=self.rdParams.experience.enableRemoteFx;if(typeof params.experience.enableTouchRedirection!="undefined")buildedArgs.entouchredir=self.rdParams.experience.enableTouchRedirection}}if(typeof self.rdParams.clipboard!="undefined")buildedArgs.clipboard=self.rdParams.clipboard;if(typeof self.rdParams.reconnectOnResize!="undefined")buildedArgs.reconnectonresize=
self.rdParams.reconnectOnResize;if(typeof self.rdParams.resizeDesktop!="undefined")buildedArgs.resizedesktop=self.rdParams.resizeDesktop;if(typeof self.rdParams.disableNLA!="undefined"&&self.rdParams.disableNLA!="")buildedArgs.rdpdisablenla=self.rdParams.disableNLA;if(typeof self.rdParams.forceTLSVersion!="undefined"&&self.rdParams.forceTLSVersion!=null&&self.rdParams.forceTLSVersion!="")buildedArgs.rdptlsversion=self.rdParams.forceTLSVersion;if(typeof self.rdParams.printer.enabled!="undefined"){buildedArgs.prnenabled=
self.rdParams.printer.enabled;if(self.rdParams.printer.enabled){buildedArgs.prnsetasdefault=self.rdParams.printer.setasdefault;if(self.rdParams.printer.name)buildedArgs.prnname=self.rdParams.printer.name;if(self.rdParams.printer.driver)buildedArgs.prndriver=self.rdParams.printer.driver}}if(typeof self.rdParams.disk.enabled!="undefined"){buildedArgs.diskenabled=self.rdParams.disk.enabled;if(self.rdParams.disk.enabled&&self.rdParams.disk.name)buildedArgs.diskname=self.rdParams.disk.name;if(self.rdParams.disk.enabled&&
self.rdParams.disk.autodownload!="undefined")buildedArgs.autodownload=self.rdParams.disk.autodownload}if(typeof self.rdParams.sound.enabled!="undefined"){if(params.sound.enabled)params.sound.enabled=self.availableAudio;buildedArgs.sndenabled=self.rdParams.sound.enabled;if(self.rdParams.sound.enabled&&self.rdParams.sound.quality)buildedArgs.sndquality=self.rdParams.sound.quality}if(typeof self.rdParams.uniqueBrowserId!="undefined")buildedArgs.uniqueBrowserId=self.rdParams.uniqueBrowserId}buildedArgs.supportsRFXDecoder=
agentInfo.supportsRFXDecoder;buildedArgs.tcpReadCount=self.rdParams.tcpReadCount;buildedArgs.tcpReadWait=self.rdParams.tcpReadWait;buildedArgs.filterCmds=self.rdParams.filterCmds;buildedArgs.canLogout=self.rdParams.canLogout;if(self.rdParams.printerList)buildedArgs.printerList=self.rdParams.printerList;if(typeof self.rdParams.universalPrinter!="undefined")buildedArgs.universalPrinter=self.rdParams.universalPrinter;buildedArgs.browserTouchCapable=1;buildedArgs.browserMaxTouchPoints=5;if(typeof self.rdParams.playThisRDSession!=
"undefined")buildedArgs.playThisRDSession=self.rdParams.playThisRDSession;if(self.rdParams.rfsMountPoints!=null)buildedArgs.rfsMountPoints=self.rdParams.rfsMountPoints;return resolutionMode===_resolutionModeEnum.QUERY_STRING?helper.object.jsonToString(buildedArgs):buildedArgs};this.buildTargetName=function(){var d=new Date;return"RDPCONN_"+(d.getFullYear()*1E4+d.getMonth()*100+d.getDate()).toString(16).toUpperCase()+"_"+(d.getHours()*360+d.getMinutes()*60+d.getSeconds()).toString(16).toUpperCase()};
this.buildForm=function(){var form=document.getElementById("ThinRDPForm");if(!form){form=helper.dom.appendJsonElement({"parentElement":document.body,"type":"form","attributes":{"id":"ThinRDPForm","name":"ThinRDPForm","method":"POST"}});helper.dom.appendJsonElement({"parentElement":form,"type":"input","attributes":{"id":"credentials","name":"credentials","type":"hidden","value":""}});helper.dom.appendJsonElement({"parentElement":form,"type":"input","attributes":{"id":"brokerData","name":"brokerData",
"type":"hidden","value":""}});helper.dom.appendJsonElement({"parentElement":form,"type":"input","attributes":{"id":"data","name":"data","type":"hidden","value":""}})}return form};this.getOwnReference=function(callback){if(callback)callback(self)};this.callDisconnect=function(silent){if(silent===true)self.disconnect();else fireExternalEvent("onQueryDisconnect",null,function(preventExecution){if(preventExecution!==true)if(self.rdParams.events.onQueryDisconnect)self.rdParams.events.onQueryDisconnect(self.doDisconnect);
else self.disconnect()})};this.doDisconnect=function(){var dologout=document.getElementById("dologout");self.rdParams.canLogout=dologout?dologout.checked:false;self.disconnect()};this.createRow=function(container,title,value){var row=helper.dom.appendJsonElement({"parentElement":container,"type":"div","attributes":{"class":"row"}});helper.dom.appendJsonElement({"parentElement":row,"type":"div","attributes":{"class":"colLabel"},"content":title+":"});helper.dom.appendJsonElement({"parentElement":row,
"type":"div","attributes":{"class":"colData"},"content":value})};this.showEnvironmentData=function(){var aValues={"Allow clipboard":self.rdParams.clipboard.toString(),"Auto download new files":(self.rdParams.disk.enabled?self.rdParams.disk.autodownload:false).toString(),"Base URL":self.baseUrl,"Bits per pixels":self.rdParams.bpp,"Client ACK":self.rdParams.clientAck,"Connection name":self.rdParams.connectionName,"Console mode":self.rdParams.console.toString(),"Disable NLA":self.rdParams.disableNLA.toString(),
"Force TLS Version":self.rdParams.forceTLSVersion?self.rdParams.forceTLSVersion.toString():"","Disk":self.rdParams.disk.enabled?"Enabled ("+self.rdParams.disk.name+")":"Disabled","File transfer path":self.serverValues.ftPath,"Fit to Browser":self.rdParams.fitToBrowser.toString(),"Force desktop":self.rdParams.forceDesktop.toString(),"Image Method":self.rdParams.imageMethod,"Image Quality":["Highest","Optimum","Good","Fastest"][self.getImgQuality()],"Is cross domain":self.rdParams.isCrossDomain.toString(),
"One time URL session":self.isOTURLSession.toString(),"Quality &amp; RLE Threshold":self.rdParams.quality+", "+self.rdParams.rleThreshold,"RemoteFX enabled":agentInfo.supportsRFXDecoder?self.serverValues.rfxEnabled.toString():"Not supported by browser","Run remote":_runRemote.toString(),"Save session":self.rdParams.savesession.toString(),"Sound":self.rdParams.sound.enabled?"Enabled, quality = "+self.rdParams.sound.quality:"Disabled","Touch redirection enabled":!self.rdParams.experience?"false":self.rdParams.experience.enableTouchRedirection.toString(),
"Unicode keyboard":self.rdParams.unicodeKeyboard,"Use Ajax":self.useAjax.toString(),"WS compression":(self.rdParams.wscompression==1).toString()};var container=helper.dom.createJsonElement({"type":"div"});for(var p in aValues)this.createRow(container,p,aValues[p]);var jData={"action":"info","title":"Info","message":thinRDPconsts.wEnvironmentData,"data":aValues};fireExternalEvent("onMessage",jData,function(preventExecution){if(preventExecution!==true)if(typeof THIN.rdParams.events=="undefined"||THIN.rdParams.events.onMessage==
null)$(window).trigger("printDialog",jData);else if(THIN.rdParams.events.onMessage(jData)!==true)Thinfinity.Popups.choice(null,"","wEnvironmentData"," ",thinRDPconsts.wEnvironmentData,container,[consts.ok+":selected"],"","",false,false)})};this.getTrafficData=function(){this.sendServerCmd("cmd","cmd=stats")};this.showTrafficData=function(obj){var aValues={"HTTP bytes sent":obj.webBytesSend,"HTTP bytes received":obj.webBytesRecv,"Web packages sent":obj.webPackageSend,"Web packages received":obj.webPackageReceive,
"RDP bytes sent":obj.rdpSend,"RDP bytes received":obj.rdpRecv};var container=helper.dom.createJsonElement({"type":"div"});for(var p in aValues)this.createRow(container,p,aValues[p]);var jData={"action":"info","title":"Info","message":thinRDPconsts.wTrafficData,"data":aValues};fireExternalEvent("onMessage",jData,function(preventExecution){if(preventExecution!==true)if(typeof THIN.rdParams.events=="undefined"||THIN.rdParams.events.onMessage==null)$(window).trigger("printDialog",jData);else if(THIN.rdParams.events.onMessage(jData)!==
true)Thinfinity.Popups.choice(null,"","wTrafficData"," ",thinRDPconsts.wTrafficData,container,[consts.ok+":selected"],"","",false,false)})};this.hostToName=function(){return self.baseUrl.replace(/[\.:\/]/g,"")};this.attachCredentialsPopup=function(data,authenticationCallback){function process(popupData){self.credPopup=popupData;self.refreshCredentialsPopup(data);$("#signInBtn").bind("click",function(){self.completeAuthentication()});$("#cancelSingInBtn").bind("click",function(){self.cancelAuthentication()});
$("#credentialsDialog").bind("keydown",function(e){switch(e.keyCode){case 13:self.completeAuthentication();break;case 27:self.cancelAuthentication();break}});if(authenticationCallback)authenticationCallback()}var popupData=document.getElementById("credentialsDialog");if(popupData)process(popupData);else self.loadCredentialsDialog(process)};this.refreshCredentialsPopup=function(data){self.credPopup.querySelector("#authusername").value=data?.credentials?.username??"";if(customSettings?.noSaveCredentials===
true){document.getElementById("saveCredentials").checked=false;document.getElementById("saveCredRow").style.setProperty("display","none")}else if(data?.credentials?.save)self.credPopup.querySelector("#saveCredRow").style.display="table-row";self.setAuthMessage(data.message||data.msg||"")};this.setAuthMessage=function(message){if(!message)$("#authErrMessage").html("").addClass("hidden");else $("#authErrMessage").html(message).removeClass("hidden")};this.completeAuthentication=function(){$(window).unbind("keydown");
self.rdParams.username=document.getElementById("authusername").value;self.rdParams.password=document.getElementById("authpassword").value;self.rdParams.credsave=document.getElementById("saveCredentials").checked;document.getElementById("authusername").value="";document.getElementById("authpassword").value="";Thinfinity.Popups.unblockDialogs();if(this.android){window.scroll(0,1);this.tempHeight=$(window).height();window.setTimeout(function(){self.completeConnectionDeferred()},500)}else doConnect()};
this.cancelAuthentication=function(){$(window).unbind("keydown");document.getElementById("authusername").value="";document.getElementById("authpassword").value="";Thinfinity.Popups.unblockDialogs();disposeView();processRDPCrossMessages("onLoginCancel",null);if(self.rdParams.events.onLoginCancel)self.rdParams.events.onLoginCancel();else $(window).trigger("LoginCancel")};this.completeConnectionDeferred=function(){if(this.tempHeight!=$(window).height()){this.tempHeight=$(window).height();window.setTimeout(function(){self.completeConnectionDeferred()},
10)}else doConnect()};this.sendCustomShortcut=function(keys){for(var k=0;k<keys.length;k++)if(keys[k].action=="down")self.sendKeyDown(keys[k].key);else if(keys[k].action=="up")self.sendKeyUp(keys[k].key);else if(keys[k].action=="type")self.sendText(keys[k].text);else if(keys[k].action=="fkey")self.sendFunctionKey(keys[k].key);else self.sendKeyStroke(keys[k].key)};function processRDPCrossMessages(cmd,obj,gui){if(obj&&rdpView.linkageConnection.isConnected)rdpView.linkageConnection.commands.sendCrossEvent({"cmd":cmd,
"data":JSON.parse(JSON.stringify(obj)),"gui":gui});else self.responseCrossMessage({"gui":gui,"preventExecution":false})}this.responseCrossMessage=function(data){if(data&&data.gui&&_fireExternalEvents[data.gui]){_fireExternalEvents[data.gui](data.preventExecution);clearTimeout(_fireExternalEvents[data.gui].expire);delete _fireExternalEvents[data.gui]}};this.receiveCrossEvent=function(data){var preventExecution=false;if(self.rdParams.events[data.cmd]){try{preventExecution=self.rdParams.events[data.cmd](data.data)}catch(error){}if(preventExecution!==
true)preventExecution=false}rdpView.linkageConnection.commands.responseCrossEvent({"gui":data.gui,"preventExecution":preventExecution})};function fireExternalEvent(cmd,data,callback,maxWaitTime){var gui=null;if(typeof self.rdParams.externalEvents!="undefined"&&self.rdParams.externalEvents.indexOf(cmd)!=-1){if(callback){gui=helper.utils.generateGUID(10);_fireExternalEvents[gui]=callback;if(maxWaitTime)_fireExternalEvents[gui].expire=setTimeout(function(){if(_fireExternalEvents[gui]){_fireExternalEvents[gui]("aborted");
delete _fireExternalEvents[data.gui]}},maxWaitTime)}processRDPCrossMessages(cmd,data,gui)}else if(callback)callback(cmd,data)}this.authenticateUser=function(data){function showAuthenticationDialog(){var jData={"action":"needCredentials","data":{"message":data},"title":thinRDPconsts.productDescription};fireExternalEvent("onMessage",jData,function(preventExecution){if(preventExecution!==true)if(typeof THIN.rdParams.events=="undefined"||THIN.rdParams.events.onMessage==null)$(window).trigger("printDialog",
jData);else if(THIN.rdParams.events.onMessage(jData)!==true){var popup=new Thinfinity.Popups.popup;popup.block("credentialsDialog",$(self.credPopup),null,focusAuthenticationField,null)}})}this.gettingCredentials=true;if(!this.credPopup)self.attachCredentialsPopup(data,showAuthenticationDialog);else{self.refreshCredentialsPopup(data);showAuthenticationDialog()}};function focusAuthenticationField(){var nameField=document.getElementById("authusername");if(nameField.offsetWidth==0)window.setTimeout(focusAuthenticationField,
10);else if(nameField.value=="")nameField.focus();else document.getElementById("authpassword").focus()}function disposeView(){setTimeout(function(){if(rdpView){rdpView.linkageConnection.commands.dispose();setTimeout(function(){rdpView=null},500)}},150)}function suppressMouseTouchEvent(e){try{if(window["TouchEvent"]&&e&&e instanceof TouchEvent){if(e.preventDefault)e.preventDefault();if(e.stopPropagation)e.stopPropagation()}}catch(err){helper.console.warning("[suppressMouseTouchEvent] Failed while trying to handle touch and mouse events. ",
arguments)}}this.fileUpload={maxUploadCount:3,toUpload:0,uploaded:0,nextUploadIdx:0,uploading:0,uploadErrors:null,filesUploading:null,uploadErrors:null,onClear:null,onFileAdd:null,onUploadFinish:null,progressBar:null,progressContainerID:"FUProgressContainer",init:function(startDrag){this.clear();if(typeof startDrag=="undefined")startDrag=true;if(startDrag&&window.File&&window.FileReader&&window.FileList&&window.Blob)self.dragDrop.init(startDrag)},clear:function(){this.toUpload=0;this.uploaded=0;this.nextUploadIdx=
0;this.uploading=0;this.filesUploading=new Array;if(this.progressBar!=null){for(var pb=0;pb<this.progressBar.length;pb++)if(this.progressBar[pb]){this.progressBar[pb].remove();delete this.progressBar[pb]}var fupc=document.getElementById(this.progressContainerID);if(fupc)fupc.parentElement.removeChild(fupc);document.getElementById("fileToUpload").form.reset()}this.progressBar=null;if(this.onClear)this.onClear()},add:function(file){for(var i=0;i<this.filesUploading.length;i++)if(this.filesUploading[i]&&
this.filesUploading[i].name==file.name)return;this.filesUploading=this.filesUploading.concat(file);if(this.onFileAdd)this.onFileAdd(file)},getFilenames:function(){if(!this.filesUploading)return"";else{var names=[];for(var f=0;f<this.filesUploading.length;f++)if(this.filesUploading[f])names.push(this.filesUploading[f].name);return names.join(",")}},filesToUploadCount:function(){var count=0;for(var i=0;i<this.filesUploading.length;i++)if(this.filesUploading[i])count++;return count},startNextUploads:function(){var startFrom=
this.nextUploadIdx;for(var i=startFrom;i<this.filesUploading.length;i++){if(this.uploading>=this.maxUploadCount)break;if(!this.filesUploading[i])continue;this.uploadFile(this.filesUploading[i],i);this.nextUploadIdx++;this.uploading++}},startUploading:function(){if(this.uploading==0){this.uploaded=0;this.nextUploadIdx=0;this.uploadErrors=new Array}this.toUpload=this.filesToUploadCount();for(var i=0;i<this.filesUploading.length;i++)if(this.filesUploading[i])this.addProgress(this.filesUploading[i],i);
this.startNextUploads()},uploadFile:function(file,idx){if(typeof FormData!="undefined"){var fd=new FormData;fd.append("fileToUpload",file);helper.ajax.post({"url":self.httpConnection+"ft/"+(self.serverValues.ftPath!=""?self.serverValues.ftPath+"/":"")+"\\"+encodeURIComponent(file.name)+(self.serverValues.diskName==""?"":"?diskname="+self.serverValues.diskName),"beforeSend":function(xhr){if(typeof window.addEventListener!="undefined"){xhr.upload.addEventListener("progress",function(evt){if(!self.fileUpload.uploadProgress(evt,
file,idx))xhr.abort()},false);xhr.addEventListener("load",function(evt){self.fileUpload.uploadComplete(evt,file,idx)},false);xhr.addEventListener("error",function(evt){self.fileUpload.uploadFailed(evt,file,idx)},false);xhr.addEventListener("abort",function(evt){self.fileUpload.uploadCanceled(evt,file,idx)},false)}else if(typeof window.attachEvent!="undefined"){xhr.upload.attachEvent("progress",function(evt){if(!self.fileUpload.uploadProgress(evt,file,idx))xhr.abort()},false);xhr.attachEvent("load",
function(evt){self.fileUpload.uploadComplete(evt,file,idx)});xhr.attachEvent("error",function(evt){self.fileUpload.uploadFailed(evt,file,idx)});xhr.attachEvent("abort",function(evt){self.fileUpload.uploadCanceled(evt,file,idx)})}xhr.setRequestHeader("X-Request-Condition","no-webdav");xhr.setRequestHeader("X-Request-Sanitize","false")},"data":fd,"timeout":0})}else{var ulFrame=document.getElementById("upload_frame");ulFrame.onload=function(evt){self.fileUpload.uploadComplete(evt,file,idx)};var fuForm=
document.getElementById("_fuForm");fuForm.action=self.httpConnection+"ft/"+(self.serverValues.ftPath!=""?self.serverValues.ftPath+"/":"")+"\\"+(typeof file.name=="undefined"?file.split(/(\\|\/)/g).pop():file.name)+"?reqcondition=no-webdav"+(self.serverValues.diskName==""?"":"&diskname="+self.serverValues.diskName);fuForm.submit()}},getFilename:function(file){if(typeof file=="undefined")return"";if(typeof file.name!="undefined")return file.name;return file.replace(/C:\\fakepath\\/i,"")},uploadProgress:function(evt,
file,idx){self.__recvPingResponse();if(!this.progressBar||!this.progressBar[idx]){logDebug("uploadProgress: adding missing progressBar.");self.fileUpload.addProgress(file,idx);this.filesUploading[idx]=file;this.toUpload=this.filesToUploadCount();this.uploading++;if(this.nextUploadIdx<=idx)this.nextUploadIdx=idx+1}if(evt.lengthComputable){var pc=parseInt(evt.loaded/evt.total*100);this.progressBar[idx].maxValue=100;this.progressBar[idx].setPos(pc)}else{this.progressBar[idx].maxValue=0;this.progressBar[idx].setMessage(thinRDPconsts.uploading);
if(typeof this.progressBar[idx].firstTime=="undefined"){this.progressBar[idx].firstTime=true;helper.console.warning("Unable to compute progress");console.log(file);console.log(evt)}}return true},uploadComplete:function(evt,file,idx){var fu=self.fileUpload;var src=evt.sourceElement||evt.target;if(src&&src.status!=200)if(!src.responseXML)if(typeof src.readyState=="undefined"||src.readyState!="complete"){fu.uploadFailed(evt,file,idx);return}else this.progressBar[idx].setPos(100);else if(!src.responseText.match(/200 OK/)){fu.uploadFailed(evt,
file,idx);return}if(self.rdParams&&self.rdParams.events.onUploadComplete)self.rdParams.events.onUploadComplete();else $(window).trigger("uploadComplete");logDebug("uploadComplete "+idx);fu.uploading--;fu.uploaded++;if(fu.uploaded==fu.toUpload)fu.uploadFinish();else fu.startNextUploads()},uploadFailed:function(evt,file,idx){var fu=self.fileUpload;if(self.rdParams.events.onUploadFailed)self.rdParams.events.onUploadFailed();else $(window).trigger("uploadFailed",evt);var src=evt.sourceElement||evt.target;
var sError=helper.string.sprintf("Error %s (%s) uploading '%s'",src.status,src.statusText,file.name);fu.uploadErrors.push(sError);logDebug("upload failed "+idx+": "+sError);this.progressBar[idx].setClass("failed");fu.uploading--;fu.uploaded++;if(fu.uploaded==fu.toUpload)fu.uploadFinish();else fu.startNextUploads()},uploadCanceled:function(evt,file,idx){var fu=self.fileUpload;if(self.rdParams.events.onUploadCanceled)self.rdParams.events.onUploadCanceled();else $(window).trigger("uploadCanceled");logDebug("upload canceled "+
idx);if(!this.progressBar||!this.progressBar[idx]){logError("uploadCanceled: progressBar not assigned.");return}this.progressBar[idx].setClass("failed");fu.uploading--;fu.uploaded++;if(fu.uploaded==fu.toUpload)fu.uploadFinish();else fu.startNextUploads()},uploadFinish:function(){if(this.onUploadFinish)this.onUploadFinish(this);else{function clearFileUpload(){self.fileUpload.clear();Thinfinity.Popups.unblock()}var jData={"action":"uploadFinish","message":this.uploadErrors.length==0?thinRDPconsts.uploadCompleted:
thinRDPconsts.uploadCompletedWithErrors,"title":thinRDPconsts.productDescription,"response":{"callback":function(){clearFileUpload()}}};fireExternalEvent("onMessage",jData,function(preventExecution){if(preventExecution!==true)if(typeof THIN.rdParams.events=="undefined"||THIN.rdParams.events.onMessage==null)$(window).trigger("printDialog",jData);else if(THIN.rdParams.events.onMessage(jData)!==true)Thinfinity.Popups.alert(jData.message,thinRDPconsts.productDescription,"disconnectedDlg","","",clearFileUpload,
false)},2E3)}},progressContainer:function(){var fuc=document.getElementById(this.progressContainerID);if(!fuc)fuc=helper.dom.appendJsonElement({"parentElement":document.body,"type":"div","attributes":{"id":this.progressContainerID}});return fuc},addProgress:function(file,idx){if(!this.progressBar)this.progressBar=new Array;for(var pb of this.progressBar)if(pb&&pb.fileName==file.name)return;var fuc=this.progressContainer();var pb=new ProgressBar({"id":this.progressContainerID,"idx":idx,"fileName":file.name,
"background-color":"#FF0","barHeight":"20px","mask":"<span class='upfilename'>"+file.name+" ("+this.formatedSize(file.size)+")</span><span class='upfilepercent'>$d%</span>"});pb.init();pb.setMessage(file.name+" ("+this.formatedSize(file.size)+")");this.progressBar[idx]=pb},formatedSize:function(val){var unit=" KB";if(val>1048576){val=val/1048576;unit=" MB"}else val=val/1024;return Math.ceil(val*100)/100+unit}},this.dragDrop={disabled:false,initialized:false,init:function(autoStart){if(this.disabled)return;
if(typeof autoStart=="")autoStart=true;if(autoStart)this.start()},start:function(){if(this.disabled)return;if(this.initialized)return;var deskDiv=document.body;if(typeof window.addEventListener!="undefined"){deskDiv.addEventListener("dragenter",this.dragEnter,false);deskDiv.addEventListener("dragleave",this.dragLeave,false);deskDiv.addEventListener("dragover",this.noopHandler,false);deskDiv.addEventListener("drop",this.drop,false)}else;this.initialized=true},stop:function(){var deskDiv=document.body;
if(typeof window.removeEventListener!="undefined"){deskDiv.removeEventListener("dragenter",this.dragEnter,false);deskDiv.removeEventListener("dragleave",this.dragLeave,false);deskDiv.removeEventListener("dragover",this.noopHandler,false);deskDiv.removeEventListener("drop",this.drop,false)}else;this.initialized=false},noopHandler:function(evt){evt.stopPropagation();evt.preventDefault()},dragEnter:function(evt){},dragLeave:function(evt){},drop:function(evt){Thinfinity.Popups.unblockDialogs();self.dragDrop.noopHandler(evt);
var files=evt.dataTransfer.files;if(files.length>0){for(var i=0;i<files.length;i++)self.fileUpload.add(files[i]);self.fileUpload.startUploading()}}},this.downloadList={files:null,selCount:0,rowOver:function(obj){$(obj).addClass("downloadRowOver")},rowOut:function(obj){$(obj).removeClass("downloadRowOver")},rowClick:function(obj,file){if(!!file.selected){file.selected=false;$(obj).removeClass("downloadRowSelected")}else{file.selected=true;$(obj).addClass("downloadRowSelected")}self.downloadList.selCount=
$(".downloadRowSelected").length;if(self.downloadList.isValid())$("#downloadBtnOk").removeClass("disabled");else $("#downloadBtnOk").addClass("disabled")},isValid:function(){if(self.msie)return this.selCount==1;else return this.selCount>0},isImage:function(url){var aName=url.split(".");switch(aName[aName.length-1]){case "jpe":case "jpeg":case "jpg":case "png":case "bmp":case "tif":case "gif":return true;default:return false}},pushFiles:function(arr,data,clip){var prePath=self.serverValues.ftPath==
""?"":self.serverValues.ftPath+"/";for(var idx in data){f=data[idx];if(f.selected)arr.push({download:prePath+f.download,url:f.url,clipboard:clip})}},doDownloadFiles:function(button){if(!self.downloadList.isValid())return false;$(button).addClass("disabled");this.files=new Array;this.pushFiles(this.files,self.downloadList.list.rows,false);self.downloadList.downloadNextFile()},downloadNextFile:function(){if(self.downloadList.files==null)return;var chkSFP=document.getElementById("chkSaveFilePicker");
if(self.downloadList.files.length>0)self.events.onFileDownload([self.downloadList.files.shift()],chkSFP&&chkSFP.checked);else Thinfinity.Popups.unblockDialogs()},list:{clearItems:function(){this.rows=[]},addItem:function(filename,size,date){this.rows.push({filename:filename,size:size,date:date})},formatSize:function(val){var unit=" KB";if(val>1048576){val=val/1048576;unit=" MB"}else val=val/1024;return Math.ceil(val*100)/100+unit},buildTable:function(data,columns){var tableBox=helper.dom.createJsonElement({"type":"div",
"attributes":{"class":"tablebox"}});var htmlTable=helper.dom.appendJsonElement({"parentElement":tableBox,"type":"table"});if(data.length==0){helper.style.add(tableBox,"nodata");var tr=helper.dom.appendJsonElement({"parentElement":htmlTable,"type":"tr"});var td=helper.dom.appendJsonElement({"parentElement":tr,"type":"td","content":thinRDPconsts.driveEmpty})}else{helper.style.add(htmlTable,"headTable");var thead=helper.dom.appendJsonElement({"parentElement":htmlTable,"type":"thead"});var tr=helper.dom.appendJsonElement({"parentElement":thead,
"type":"tr","attributes":{"class":"downloadHeader"}});var th=helper.dom.appendJsonElement({"parentElement":tr,"type":"th","attributes":{"class":"downloadTitle"},"content":columns[0]||""});var th=helper.dom.appendJsonElement({"parentElement":tr,"type":"th","attributes":{"class":"downloadSize"},"content":columns[1]||""});var th=helper.dom.appendJsonElement({"parentElement":tr,"type":"th","attributes":{"class":"downloadDate"},"content":columns[2]||""});var bodyBox=helper.dom.appendJsonElement({"parentElement":tableBox,
"type":"div","attributes":{"class":"bodyBox"}});htmlTable=helper.dom.appendJsonElement({"parentElement":bodyBox,"type":"table","attributes":{"class":"bodyTable"}});var tbody=helper.dom.appendJsonElement({"parentElement":htmlTable,"type":"tbody"});for(var i=0;i<data.length;i++){r=data[i];var tr=helper.dom.appendJsonElement({"parentElement":tbody,"type":"tr","events":{"onmouseover":function(e){self.downloadList.rowOver(e.target.parentElement)},"onmouseout":function(e){self.downloadList.rowOut(e.target.parentElement)},
"ontouchend,onclick":function(e){suppressMouseTouchEvent(e);self.downloadList.rowClick(e.target.parentElement,data[e.target.parentElement.rowIdx])}}});tr.rowIdx=i;helper.dom.appendJsonElement({"parentElement":tr,"type":"td","attributes":{"class":"downloadTitle"},"content":r.filename});helper.dom.appendJsonElement({"parentElement":tr,"type":"td","attributes":{"class":"downloadSize"},"content":this.formatSize(r.size)});helper.dom.appendJsonElement({"parentElement":tr,"type":"td","attributes":{"class":"downloadDate"},
"content":r.date})}}return tableBox}},openDownload:function(){this.list.clearItems();self.sendServerCmd("cmd","cmd=diskfiles")},downloadDialog:function(){var msg=helper.dom.createJsonElement({"type":"div","attributes":{"id":"downloadDialog","class":"popup"}});helper.dom.appendJsonElement({"parentElement":msg,"type":"div","attributes":{"class":"header"},"content":thinRDPconsts.selectDownloadFiles});var tc=helper.dom.appendJsonElement({"parentElement":msg,"type":"div","attributes":{"id":"filesTableCont",
class:this.list.rows.length===0?"empty":""}});tc.appendChild(self.downloadList.list.buildTable(this.list.rows,[thinRDPconsts.thindisk,thinRDPconsts.size,thinRDPconsts.date]));var divbuttons=helper.dom.appendJsonElement({"parentElement":msg,"type":"div","attributes":{"class":"divbuttons"}});var onDownloadClick=function(e){suppressMouseTouchEvent(e);self.downloadList.doDownloadFiles(e.srcElement)};var onCancelClick=function(e){suppressMouseTouchEvent(e);$.unblockUI.call(arguments)};var saveFilePickerContainer=
helper.dom.appendJsonElement({"parentElement":divbuttons,"type":"div","attributes":{"class":"saveFilePickerContainer"}});var ssfp=helper.storage.get(_showSaveFilePickerKey)||false;var chkSFP=helper.dom.appendJsonElement({"parentElement":saveFilePickerContainer,"type":"input","attributes":{"id":"chkSaveFilePicker",type:"checkbox"},events:{"onchange":function(e){helper.storage.set(_showSaveFilePickerKey,this.checked||false)}}});if(ssfp)chkSFP.setAttribute("checked",ssfp);helper.dom.appendJsonElement({"parentElement":saveFilePickerContainer,
"type":"label","attributes":{for:"chkSaveFilePicker","class":""},"content":thinRDPconsts.askToDownload});helper.dom.appendJsonElement({"parentElement":divbuttons,"type":"a","attributes":{"id":"downloadBtnOk","class":"popuplink disabled"},"content":thinRDPconsts.download,"events":{"onclick":onDownloadClick,"ontouchend":onDownloadClick}});helper.dom.appendJsonElement({"parentElement":divbuttons,"type":"a","attributes":{"class":"popuplink selected"},"content":thinRDPconsts.cancel,"events":{"onclick":onCancelClick,
"ontouchend":onCancelClick}});$.blockUI({message:msg,css:{"padding":0,"margin":0,"width":"100%","height":"100%","top":"0px","left":"0px","textAlign":"center",backgroundColor:"transparent",border:"none",cursor:"auto"},centerX:true,centerY:true})}},this.ssnShare={dialogVisible:function(){return document.getElementById("shareDialog")&&parseInt($("#shareDialog").width(),10)!=0},popup:null,shareURL:"",expiration:30,key:"",expirationDate:null,password:"",flags:{},openSsnShare:function(){self.sendServerCmd("cmd",
"cmd=getSsnshare")},getSharing:function(obj){if(this.shareURL=="")self.sendServerCmd("cmd","cmd=setSsnshare&enabled=true&expiration="+this.expiration)},openDialog:function(){if(this.dialogVisible()){$("#urlShare").val(this.shareURL);$("#ssnPassword").val(this.password)}else{var msg=helper.dom.createJsonElement({"type":"div","attributes":{"id":"shareDialog","class":"popup"}});var header=helper.dom.appendJsonElement({"parentElement":msg,"type":"div","attributes":{"class":"header"},"content":thinRDPconsts.shareSession});
var shareDialogCont=helper.dom.appendJsonElement({"parentElement":msg,"type":"div","attributes":{"id":"shareDialogCont"}});var shareDiv=helper.dom.appendJsonElement({"parentElement":shareDialogCont,"type":"div","attributes":{"class":"shareDiv"}});var row=helper.dom.appendJsonElement({"parentElement":shareDiv,"type":"div"});helper.dom.appendJsonElement({"parentElement":row,"type":"label","attributes":{"id":"sharingSessionLegend"},"content":thinRDPconsts.sharingSessionLegend});var table=helper.dom.appendJsonElement({"parentElement":shareDiv,
"type":"div","attributes":{"class":"table"}});row=helper.dom.appendJsonElement({"parentElement":table,"type":"div","attributes":{"class":"table-row"}});helper.dom.appendJsonElement({"parentElement":row,"type":"div","attributes":{"class":"table-cell ssnLabel"},"content":thinRDPconsts.sharingAddress+": "});var inputCell=helper.dom.appendJsonElement({"parentElement":row,"type":"div","attributes":{"class":"table-cell"}});var shareInput=helper.dom.appendJsonElement({"parentElement":inputCell,"type":"input",
"attributes":{"id":"urlShare","type":"text","readOnly":true,"value":this.shareURL}});var shareInputCpyBtn=helper.dom.appendJsonElement({"parentElement":inputCell,"type":"span","attributes":{"id":"shareInputCpyBtn","class":"shareFormBtn thin-copy"}});row=helper.dom.appendJsonElement({"parentElement":table,"type":"div","attributes":{"class":"table-row"}});helper.dom.appendJsonElement({"parentElement":row,"type":"div","attributes":{"class":"table-cell ssnLabel"},"content":thinRDPconsts.password+": "});
inputCell=helper.dom.appendJsonElement({"parentElement":row,"type":"div","attributes":{"class":"table-cell"}});var passInput=helper.dom.appendJsonElement({"parentElement":inputCell,"type":"input","attributes":{"id":"ssnPassword","type":"text","readOnly":true,"value":this.password}});passInputCpyBtn=helper.dom.appendJsonElement({"parentElement":inputCell,"type":"span","attributes":{"id":"passInputCpyBtn","class":"shareFormBtn thin-copy"}});var divbuttons=helper.dom.appendJsonElement({"parentElement":msg,
"type":"div","attributes":{"class":"divbuttons"}});var a=helper.dom.appendJsonElement({"parentElement":divbuttons,"type":"a","attributes":{"class":"popuplink","id":"btnOkShare"},"content":thinRDPconsts.ok});var jData={"action":"shareScreen","message":thinRDPconsts.shareSession,"legend":thinRDPconsts.sharingSessionLegend,"address":this.shareURL,"password":this.password,"title":thinRDPconsts.productDescription,"response":{"callback":function(){self.ssnShare.closeDialog()}}};self.ssnShare.getSharing();
fireExternalEvent("onMessage",jData,function(preventExecution){if(preventExecution!==true)if(typeof THIN.rdParams.events=="undefined"||THIN.rdParams.events.onMessage==null)$(window).trigger("printDialog",jData);else if(THIN.rdParams.events.onMessage(jData)!==true){popup=new Thinfinity.Popups.popup(self);popup.noPropagateEvents=false;popup.block("shareDialog",msg,null,function(){$("#urlShare, #ssnPassword").focus(function(){var $this=$(this);$this.select();$this.mouseup(function(){$this.unbind("mouseup");
return false})});$("#shareInputCpyBtn").click(function(){self.ssnShare.copyContentOf("#urlShare")});$("#passInputCpyBtn").click(function(){self.ssnShare.copyContentOf("#ssnPassword")});helper.dom.addEvent(document.getElementById("btnOkShare"),["touchend","click"],function(e){suppressMouseTouchEvent(e);self.ssnShare.closeDialog()})})}})}},closeDialog:function(){popup.unblock(function(){if(self.KeyboardHandler&&self.KeyboardHandler.kbdInput)self.KeyboardHandler.kbdInput.focus()})},copyContentOf:function(target){$(target).select();
value=function(obj){return obj?obj.toString():""}(window.getSelection());if(navigator.clipboard&&!agentInfo.isFirefox)navigator.clipboard.writeText(value);else try{result=document.execCommand("copy")}catch(err){console.log("Oops, unable to copy")}window.getSelection().removeAllRanges();return false}};this.getRemoteDesktopSize=function(){var div=self.vncdiv;return{"width":div.offsetWidth,"height":div.offsetHeight}};ThinRDPCore.prototype.dragDrop=self.dragDrop;Object.defineProperty(self,"DEFAULT_ICON",
{"enumerable":false,"configurable":false,"get":function(){return _DEFAULTS.ICON}});Object.defineProperty(self,"resizeDesktop",{"enumerable":false,"configurable":false,"writable":false,"value":resizeDesktop});Object.defineProperty(self,"refreshFitToScreen",{"enumerable":false,"configurable":false,"writable":false,"value":refreshFitToScreen});if(_runRemote)rdpView=new Thinfinity.RDPView({"mode":Thinfinity.RDPView.mode.REMOTE,"thinrdp":self});else if(runOptions.mode==ThinRDP.mode.HOST)rdpView=new Thinfinity.RDPView({"mode":Thinfinity.RDPView.mode.HOST,
"thinrdp":self});if(runOptions.events){var observablesEvents=[{"name":"onWidthChange","eventName":"viewWidth","eventType":"changed"},{"name":"onHeightChange","eventName":"viewHeight","eventType":"changed"}];for(var i=0,l=observablesEvents.length;i<l;i++)if(runOptions.events[observablesEvents[i].name]){var evt=observablesEvents[i];rdpView.model.on(evt.eventName,evt.eventType,runOptions.events[evt.name])}}if(_autoConnectMode.indexOf(runOptions.mode)!=-1)self.connect(runOptions);else if(runOptions.success)setTimeout(function(){runOptions.success()},
10);if(!_runRemote)THIN=this;if(runOptions.mode===ThinRDP.mode.API||runOptions.mode===ThinRDP.mode.SKEY)return THIN;else return rdpView.model}function ThinRDPAdminClass(owner){var statsUrl="stats/";var _ref=this;owner=owner||_thinrdp;function getStatistics(query,onsuccess,onerror){sendCommand(owner,statsUrl+"query",query,onsuccess,onerror)}function send(command,query,onsuccess,onerror){sendCommand(owner,statsUrl+command,query,onsuccess,onerror)}Object.defineProperty(_ref,"getStatistics",{"enumerable":true,
"configurable":false,"writable":false,"value":getStatistics});Object.defineProperty(_ref,"sendCommand",{"enumerable":true,"configurable":false,"writable":false,"value":send})}function ThinRDPRecordingsClass(owner){var recordsUrl="RDPSession/";var _ref=this;owner=owner||_thinrdp;function getRecordings(query,onsuccess,onerror){sendCommand(owner,recordsUrl+"GetList",query,onsuccess,onerror)}function deleteRecordings(aItems,onsuccess,onerror){sendCommand(owner,recordsUrl+"delete","items="+aItems.join(","),
onsuccess,onerror)}Object.defineProperty(_ref,"getRecordings",{"enumerable":true,"configurable":false,"writable":false,"value":getRecordings});Object.defineProperty(_ref,"deleteRecordings",{"enumerable":true,"configurable":false,"writable":false,"value":deleteRecordings})}function ThinRDPDetectRemoteFilesystemClass(dontRetry){return;if(self.rdParams.rfsMountPoints!=null)return;var pluginData=null;var params={url:"http://localhost:28444/rfs/mounts",async:!dontRetry,timeout:3E3,cache:false,dataType:"html",
error:function(jqXHR,err){},success:function(data){pluginData=data;self.rdParams.rfsMountPoints=data}};$.ajax(self.completeAjaxParams(params));return pluginData}function getBaseServerUrl(owner){return owner?owner.baseUrl:""}function sendCommand(owner,cmd,query,onsuccess,onerror){var params={url:getBaseServerUrl(owner)+cmd+"?"+query,async:true,cache:false,dataType:"html",error:function(jqXHR,err){if(typeof onerror!="undefined"){if(err=="error")err=jqXHR.statusText;onerror(err)}},success:function(data){if(typeof onsuccess!=
"undefined")onsuccess(data)}};if(owner&&owner.completeAjaxParams)params=owner.completeAjaxParams(params);$.ajax(params)}function post(path,params,method){method=method||"post";var form=document.createElement("form");form.setAttribute("method",method);form.setAttribute("action",path);for(var key in params)if(params.hasOwnProperty(key)){var hiddenField=document.createElement("input");hiddenField.setAttribute("type","hidden");hiddenField.setAttribute("name",key);hiddenField.setAttribute("value",params[key]);
form.appendChild(hiddenField)}document.body.appendChild(form);form.submit()}try{initialize()}catch(e){if(runOptions&&runOptions.failure)runOptions.failure(e.message);else throw new Error(e.message);}if(!ThinRDP.Admin)Object.defineProperty(ThinRDP,"Admin",{"enumerable":true,"configurable":false,"get":function(){return ThinRDPAdminClass}});if(!ThinRDP.Recordings)Object.defineProperty(ThinRDP,"Recordings",{"enumerable":true,"configurable":false,"get":function(){return ThinRDPRecordingsClass}});return _thinrdp}
var _edition=helper.object.createEnum({"SMALL_BUSINESS":0,"STANDARD":1,"ENTERPRISE":2,"CLOUD":3});var _modeEnum=helper.object.createEnum({"HOST":0,"API":1,"SKEY":2,"OTURL":10,"SDK":11});var _TLSVersions=helper.object.createEnum("NEGOTIATE","TLS_V1_0","TLS_V1_1","TLS_V1_2","TLS_V1_3");var _credentialsModes=helper.object.createEnum("USE_AUTH","ASK","USE_DEFINED");var _applicationActions=helper.object.createEnum("NONE","START_PROGRAM","RUN_REMOTEAPP");var _profileTypes=helper.object.createEnum("PUBLIC",
"PRIVATE","MRU","TEMP","FILTER","WEBMANAGER");var _profileKind=helper.object.createEnum("RDP","WEBLINK","RDWEB","RDWEBAPP","RDPLABEL");var _resolution=helper.object.createEnum("CUSTOM","FIT_TO_BROWSER","FIT_TO_SCREEN","640x480","800x600","1024x768","1280x720","1280x768","1280x1024","1440x900","1440x1050","1600x1200","1680x1050","1920x1080","1920x1200");var _imageQuality=helper.object.createEnum("HIGHEST","OPTIMUM","GOOD","FASTEST");var _soundQuality=helper.object.createEnum("HIGHEST","OPTIMUM","GOOD",
"FASTEST");var _bpp=helper.object.createEnum("LOW_COLOR","HIGH_COLOR15","HIGH_COLOR","TRUE_COLOR24","TRUE_COLOR32");var _visualEffect=helper.object.createEnum({"DESKTOP_BACKGROUND":1,"VISUAL_STYLES":2,"MENU_WND_ANIMATION":4,"FONT_SMOOTHING":8,"SHOW_WND_CONTENT":16,"DESKTOP_COMPOSITION":32});var _registeredPlugins={};function registerPlugin(name,plugin){var rname="";if(name)rname=name.toUpperCase();if(_registeredPlugins[rname]==undefined){_registeredPlugins[rname]={"plugin":plugin,"name":name};if(!ThinRDP[name])ThinRDP[name]=
plugin}}function unregisterPlugin(name){if(name)name=name.toUpperCase();if(_registeredPlugins[name]!=undefined){var rname=_registeredPlugins[name].name;delete _registeredPlugins[name];if(ThinRDP[rname])delete ThinRDP[rname]}}Object.defineProperty(ThinRDP,"registerPlugin",{"enumerable":false,"configurable":false,"writable":false,"value":registerPlugin});Object.defineProperty(ThinRDP,"unregisterPlugin",{"enumerable":false,"configurable":false,"writable":false,"value":unregisterPlugin});Object.defineProperty(ThinRDP,
"mode",{"enumerable":true,"configurable":false,"get":function(){return _modeEnum}});Object.defineProperty(ThinRDP,"TLSVersion",{"enumerable":true,"configurable":false,"get":function(){return _TLSVersions}});Object.defineProperty(ThinRDP,"credential",{"enumerable":true,"configurable":false,"get":function(){return _credentialsModes}});Object.defineProperty(ThinRDP,"profileType",{"enumerable":true,"configurable":false,"get":function(){return _profileTypes}});Object.defineProperty(ThinRDP,"profileKind",
{"enumerable":true,"configurable":false,"get":function(){return _profileKind}});Object.defineProperty(ThinRDP,"applicationAction",{"enumerable":true,"configurable":false,"get":function(){return _applicationActions}});Object.defineProperty(ThinRDP,"resolution",{"enumerable":true,"configurable":false,"get":function(){return _resolution}});Object.defineProperty(ThinRDP,"imageQuality",{"enumerable":true,"configurable":false,"get":function(){return _imageQuality}});Object.defineProperty(ThinRDP,"soundQuality",
{"enumerable":true,"configurable":false,"get":function(){return _soundQuality}});Object.defineProperty(ThinRDP,"colorDepth",{"enumerable":true,"configurable":false,"get":function(){return _bpp}});Object.defineProperty(ThinRDP,"visualEffect",{"enumerable":true,"configurable":false,"get":function(){return _visualEffect}});Object.defineProperty(ThinRDP,"edition",{"enumerable":true,"configurable":false,"get":function(){return _edition}});window.ThinRDP=ThinRDP})();
(function(){var k=void 0,aa=this;function r(c,d){var a=c.split("."),b=aa;!(a[0]in b)&&b.execScript&&b.execScript("var "+a[0]);for(var e;a.length&&(e=a.shift());)!a.length&&d!==k?b[e]=d:b=b[e]?b[e]:b[e]={}}var t="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Uint32Array&&"undefined"!==typeof DataView;function u(c){var d=c.length,a=0,b=Number.POSITIVE_INFINITY,e,f,g,h,l,n,m,p,s,x;for(p=0;p<d;++p)c[p]>a&&(a=c[p]),c[p]<b&&(b=c[p]);e=1<<a;f=new (t?Uint32Array:Array)(e);
g=1;h=0;for(l=2;g<=a;){for(p=0;p<d;++p)if(c[p]===g){n=0;m=h;for(s=0;s<g;++s)n=n<<1|m&1,m>>=1;x=g<<16|p;for(s=n;s<e;s+=l)f[s]=x;++h}++g;h<<=1;l<<=1}return[f,a,b]}function w(c,d){this.g=[];this.h=32768;this.c=this.f=this.d=this.k=0;this.input=t?new Uint8Array(c):c;this.l=!1;this.i=y;this.p=!1;if(d||!(d={}))d.index&&(this.d=d.index),d.bufferSize&&(this.h=d.bufferSize),d.bufferType&&(this.i=d.bufferType),d.resize&&(this.p=d.resize);switch(this.i){case A:this.a=32768;this.b=new (t?Uint8Array:Array)(32768+
this.h+258);break;case y:this.a=0;this.b=new (t?Uint8Array:Array)(this.h);this.e=this.u;this.m=this.r;this.j=this.s;break;default:throw Error("invalid inflate mode");}}var A=0,y=1;w.prototype.t=function(){for(;!this.l;){var c=B(this,3);c&1&&(this.l=!0);c>>>=1;switch(c){case 0:var d=this.input,a=this.d,b=this.b,e=this.a,f=d.length,g=k,h=k,l=b.length,n=k;this.c=this.f=0;if(a+1>=f)throw Error("invalid uncompressed block header: LEN");g=d[a++]|d[a++]<<8;if(a+1>=f)throw Error("invalid uncompressed block header: NLEN");
h=d[a++]|d[a++]<<8;if(g===~h)throw Error("invalid uncompressed block header: length verify");if(a+g>d.length)throw Error("input buffer is broken");switch(this.i){case A:for(;e+g>b.length;){n=l-e;g-=n;if(t)b.set(d.subarray(a,a+n),e),e+=n,a+=n;else for(;n--;)b[e++]=d[a++];this.a=e;b=this.e();e=this.a}break;case y:for(;e+g>b.length;)b=this.e({o:2});break;default:throw Error("invalid inflate mode");}if(t)b.set(d.subarray(a,a+g),e),e+=g,a+=g;else for(;g--;)b[e++]=d[a++];this.d=a;this.a=e;this.b=b;break;
case 1:this.j(ba,ca);break;case 2:for(var m=B(this,5)+257,p=B(this,5)+1,s=B(this,4)+4,x=new (t?Uint8Array:Array)(C.length),Q=k,R=k,S=k,v=k,M=k,F=k,z=k,q=k,T=k,q=0;q<s;++q)x[C[q]]=B(this,3);if(!t){q=s;for(s=x.length;q<s;++q)x[C[q]]=0}Q=u(x);v=new (t?Uint8Array:Array)(m+p);q=0;for(T=m+p;q<T;)switch(M=D(this,Q),M){case 16:for(z=3+B(this,2);z--;)v[q++]=F;break;case 17:for(z=3+B(this,3);z--;)v[q++]=0;F=0;break;case 18:for(z=11+B(this,7);z--;)v[q++]=0;F=0;break;default:F=v[q++]=M}R=t?u(v.subarray(0,m)):
u(v.slice(0,m));S=t?u(v.subarray(m)):u(v.slice(m));this.j(R,S);break;default:throw Error("unknown BTYPE: "+c);}}return this.m()};var E=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],C=t?new Uint16Array(E):E,G=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],H=t?new Uint16Array(G):G,I=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],J=t?new Uint8Array(I):I,K=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,
4097,6145,8193,12289,16385,24577],L=t?new Uint16Array(K):K,N=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],O=t?new Uint8Array(N):N,P=new (t?Uint8Array:Array)(288),U,da;U=0;for(da=P.length;U<da;++U)P[U]=143>=U?8:255>=U?9:279>=U?7:8;var ba=u(P),V=new (t?Uint8Array:Array)(30),W,ea;W=0;for(ea=V.length;W<ea;++W)V[W]=5;var ca=u(V);function B(c,d){for(var a=c.f,b=c.c,e=c.input,f=c.d,g=e.length,h;b<d;){if(f>=g)throw Error("input buffer is broken");a|=e[f++]<<b;b+=8}h=a&(1<<d)-1;c.f=
a>>>d;c.c=b-d;c.d=f;return h}function D(c,d){for(var a=c.f,b=c.c,e=c.input,f=c.d,g=e.length,h=d[0],l=d[1],n,m;b<l&&!(f>=g);)a|=e[f++]<<b,b+=8;n=h[a&(1<<l)-1];m=n>>>16;if(m>b)throw Error("invalid code length: "+m);c.f=a>>m;c.c=b-m;c.d=f;return n&65535}w.prototype.j=function(c,d){var a=this.b,b=this.a;this.n=c;for(var e=a.length-258,f,g,h,l;256!==(f=D(this,c));)if(256>f)b>=e&&(this.a=b,a=this.e(),b=this.a),a[b++]=f;else{g=f-257;l=H[g];0<J[g]&&(l+=B(this,J[g]));f=D(this,d);h=L[f];0<O[f]&&(h+=B(this,
O[f]));b>=e&&(this.a=b,a=this.e(),b=this.a);for(;l--;)a[b]=a[b++-h]}for(;8<=this.c;)this.c-=8,this.d--;this.a=b};w.prototype.s=function(c,d){var a=this.b,b=this.a;this.n=c;for(var e=a.length,f,g,h,l;256!==(f=D(this,c));)if(256>f)b>=e&&(a=this.e(),e=a.length),a[b++]=f;else{g=f-257;l=H[g];0<J[g]&&(l+=B(this,J[g]));f=D(this,d);h=L[f];0<O[f]&&(h+=B(this,O[f]));b+l>e&&(a=this.e(),e=a.length);for(;l--;)a[b]=a[b++-h]}for(;8<=this.c;)this.c-=8,this.d--;this.a=b};w.prototype.e=function(){var c=new (t?Uint8Array:
Array)(this.a-32768),d=this.a-32768,a,b,e=this.b;if(t)c.set(e.subarray(32768,c.length));else{a=0;for(b=c.length;a<b;++a)c[a]=e[a+32768]}this.g.push(c);this.k+=c.length;if(t)e.set(e.subarray(d,d+32768));else for(a=0;32768>a;++a)e[a]=e[d+a];this.a=32768;return e};w.prototype.u=function(c){var d,a=this.input.length/this.d+1|0,b,e,f,g=this.input,h=this.b;c&&("number"===typeof c.o&&(a=c.o),"number"===typeof c.q&&(a+=c.q));2>a?(b=(g.length-this.d)/this.n[2],f=258*(b/2)|0,e=f<h.length?h.length+f:h.length<<
1):e=h.length*a;t?(d=new Uint8Array(e),d.set(h)):d=h;return this.b=d};w.prototype.m=function(){var c=0,d=this.b,a=this.g,b,e=new (t?Uint8Array:Array)(this.k+(this.a-32768)),f,g,h,l;if(0===a.length)return t?this.b.subarray(32768,this.a):this.b.slice(32768,this.a);f=0;for(g=a.length;f<g;++f){b=a[f];h=0;for(l=b.length;h<l;++h)e[c++]=b[h]}f=32768;for(g=this.a;f<g;++f)e[c++]=d[f];this.g=[];return this.buffer=e};w.prototype.r=function(){var c,d=this.a;t?this.p?(c=new Uint8Array(d),c.set(this.b.subarray(0,
d))):c=this.b.subarray(0,d):(this.b.length>d&&(this.b.length=d),c=this.b);return this.buffer=c};r("Zlib.RawInflate",w);r("Zlib.RawInflate.prototype.decompress",w.prototype.t);var X={ADAPTIVE:y,BLOCK:A},Y,Z,$,fa;if(Object.keys)Y=Object.keys(X);else for(Z in Y=[],$=0,X)Y[$++]=Z;$=0;for(fa=Y.length;$<fa;++$)Z=Y[$],r("Zlib.RawInflate.BufferType."+Z,X[Z])}).call(this);
(function(){var n=void 0,u=!0,aa=this;function ba(e,d){var c=e.split("."),f=aa;!(c[0]in f)&&f.execScript&&f.execScript("var "+c[0]);for(var a;c.length&&(a=c.shift());)!c.length&&d!==n?f[a]=d:f=f[a]?f[a]:f[a]={}}var C="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Uint32Array&&"undefined"!==typeof DataView;function K(e,d){this.index="number"===typeof d?d:0;this.d=0;this.buffer=e instanceof(C?Uint8Array:Array)?e:new (C?Uint8Array:Array)(32768);if(2*this.buffer.length<=
this.index)throw Error("invalid index");this.buffer.length<=this.index&&ca(this)}function ca(e){var d=e.buffer,c,f=d.length,a=new (C?Uint8Array:Array)(f<<1);if(C)a.set(d);else for(c=0;c<f;++c)a[c]=d[c];return e.buffer=a}K.prototype.a=function(e,d,c){var f=this.buffer,a=this.index,b=this.d,k=f[a],m;c&&1<d&&(e=8<d?(L[e&255]<<24|L[e>>>8&255]<<16|L[e>>>16&255]<<8|L[e>>>24&255])>>32-d:L[e]>>8-d);if(8>d+b)k=k<<d|e,b+=d;else for(m=0;m<d;++m)k=k<<1|e>>d-m-1&1,8===++b&&(b=0,f[a++]=L[k],k=0,a===f.length&&(f=
ca(this)));f[a]=k;this.buffer=f;this.d=b;this.index=a};K.prototype.finish=function(){var e=this.buffer,d=this.index,c;0<this.d&&(e[d]<<=8-this.d,e[d]=L[e[d]],d++);C?c=e.subarray(0,d):(e.length=d,c=e);return c};var ga=new (C?Uint8Array:Array)(256),M;for(M=0;256>M;++M){for(var R=M,S=R,ha=7,R=R>>>1;R;R>>>=1)S<<=1,S|=R&1,--ha;ga[M]=(S<<ha&255)>>>0}var L=ga;function ja(e){this.buffer=new (C?Uint16Array:Array)(2*e);this.length=0}ja.prototype.getParent=function(e){return 2*((e-2)/4|0)};ja.prototype.push=
function(e,d){var c,f,a=this.buffer,b;c=this.length;a[this.length++]=d;for(a[this.length++]=e;0<c;)if(f=this.getParent(c),a[c]>a[f])b=a[c],a[c]=a[f],a[f]=b,b=a[c+1],a[c+1]=a[f+1],a[f+1]=b,c=f;else break;return this.length};ja.prototype.pop=function(){var e,d,c=this.buffer,f,a,b;d=c[0];e=c[1];this.length-=2;c[0]=c[this.length];c[1]=c[this.length+1];for(b=0;;){a=2*b+2;if(a>=this.length)break;a+2<this.length&&c[a+2]>c[a]&&(a+=2);if(c[a]>c[b])f=c[b],c[b]=c[a],c[a]=f,f=c[b+1],c[b+1]=c[a+1],c[a+1]=f;else break;
b=a}return{index:e,value:d,length:this.length}};function ka(e,d){this.e=ma;this.f=0;this.input=C&&e instanceof Array?new Uint8Array(e):e;this.c=0;d&&(d.lazy&&(this.f=d.lazy),"number"===typeof d.compressionType&&(this.e=d.compressionType),d.outputBuffer&&(this.b=C&&d.outputBuffer instanceof Array?new Uint8Array(d.outputBuffer):d.outputBuffer),"number"===typeof d.outputIndex&&(this.c=d.outputIndex));this.b||(this.b=new (C?Uint8Array:Array)(32768))}var ma=2,T=[],U;for(U=0;288>U;U++)switch(u){case 143>=
U:T.push([U+48,8]);break;case 255>=U:T.push([U-144+400,9]);break;case 279>=U:T.push([U-256+0,7]);break;case 287>=U:T.push([U-280+192,8]);break;default:throw"invalid literal: "+U;}ka.prototype.h=function(){var e,d,c,f,a=this.input;switch(this.e){case 0:c=0;for(f=a.length;c<f;){d=C?a.subarray(c,c+65535):a.slice(c,c+65535);c+=d.length;var b=d,k=c===f,m=n,g=n,p=n,v=n,x=n,l=this.b,h=this.c;if(C){for(l=new Uint8Array(this.b.buffer);l.length<=h+b.length+5;)l=new Uint8Array(l.length<<1);l.set(this.b)}m=k?
1:0;l[h++]=m|0;g=b.length;p=~g+65536&65535;l[h++]=g&255;l[h++]=g>>>8&255;l[h++]=p&255;l[h++]=p>>>8&255;if(C)l.set(b,h),h+=b.length,l=l.subarray(0,h);else{v=0;for(x=b.length;v<x;++v)l[h++]=b[v];l.length=h}this.c=h;this.b=l}break;case 1:var q=new K(C?new Uint8Array(this.b.buffer):this.b,this.c);q.a(1,1,u);q.a(1,2,u);var t=na(this,a),w,da,z;w=0;for(da=t.length;w<da;w++)if(z=t[w],K.prototype.a.apply(q,T[z]),256<z)q.a(t[++w],t[++w],u),q.a(t[++w],5),q.a(t[++w],t[++w],u);else if(256===z)break;this.b=q.finish();
this.c=this.b.length;break;case ma:var B=new K(C?new Uint8Array(this.b.buffer):this.b,this.c),ra,J,N,O,P,Ia=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],W,sa,X,ta,ea,ia=Array(19),ua,Q,fa,y,va;ra=ma;B.a(1,1,u);B.a(ra,2,u);J=na(this,a);W=oa(this.j,15);sa=pa(W);X=oa(this.i,7);ta=pa(X);for(N=286;257<N&&0===W[N-1];N--);for(O=30;1<O&&0===X[O-1];O--);var wa=N,xa=O,F=new (C?Uint32Array:Array)(wa+xa),r,G,s,Y,E=new (C?Uint32Array:Array)(316),D,A,H=new (C?Uint8Array:Array)(19);for(r=G=0;r<wa;r++)F[G++]=
W[r];for(r=0;r<xa;r++)F[G++]=X[r];if(!C){r=0;for(Y=H.length;r<Y;++r)H[r]=0}r=D=0;for(Y=F.length;r<Y;r+=G){for(G=1;r+G<Y&&F[r+G]===F[r];++G);s=G;if(0===F[r])if(3>s)for(;0<s--;)E[D++]=0,H[0]++;else for(;0<s;)A=138>s?s:138,A>s-3&&A<s&&(A=s-3),10>=A?(E[D++]=17,E[D++]=A-3,H[17]++):(E[D++]=18,E[D++]=A-11,H[18]++),s-=A;else if(E[D++]=F[r],H[F[r]]++,s--,3>s)for(;0<s--;)E[D++]=F[r],H[F[r]]++;else for(;0<s;)A=6>s?s:6,A>s-3&&A<s&&(A=s-3),E[D++]=16,E[D++]=A-3,H[16]++,s-=A}e=C?E.subarray(0,D):E.slice(0,D);ea=
oa(H,7);for(y=0;19>y;y++)ia[y]=ea[Ia[y]];for(P=19;4<P&&0===ia[P-1];P--);ua=pa(ea);B.a(N-257,5,u);B.a(O-1,5,u);B.a(P-4,4,u);for(y=0;y<P;y++)B.a(ia[y],3,u);y=0;for(va=e.length;y<va;y++)if(Q=e[y],B.a(ua[Q],ea[Q],u),16<=Q){y++;switch(Q){case 16:fa=2;break;case 17:fa=3;break;case 18:fa=7;break;default:throw"invalid code: "+Q;}B.a(e[y],fa,u)}var ya=[sa,W],za=[ta,X],I,Aa,Z,la,Ba,Ca,Da,Ea;Ba=ya[0];Ca=ya[1];Da=za[0];Ea=za[1];I=0;for(Aa=J.length;I<Aa;++I)if(Z=J[I],B.a(Ba[Z],Ca[Z],u),256<Z)B.a(J[++I],J[++I],
u),la=J[++I],B.a(Da[la],Ea[la],u),B.a(J[++I],J[++I],u);else if(256===Z)break;this.b=B.finish();this.c=this.b.length;break;default:throw"invalid compression type";}return this.b};function qa(e,d){this.length=e;this.g=d}var Fa=function(){function e(a){switch(u){case 3===a:return[257,a-3,0];case 4===a:return[258,a-4,0];case 5===a:return[259,a-5,0];case 6===a:return[260,a-6,0];case 7===a:return[261,a-7,0];case 8===a:return[262,a-8,0];case 9===a:return[263,a-9,0];case 10===a:return[264,a-10,0];case 12>=
a:return[265,a-11,1];case 14>=a:return[266,a-13,1];case 16>=a:return[267,a-15,1];case 18>=a:return[268,a-17,1];case 22>=a:return[269,a-19,2];case 26>=a:return[270,a-23,2];case 30>=a:return[271,a-27,2];case 34>=a:return[272,a-31,2];case 42>=a:return[273,a-35,3];case 50>=a:return[274,a-43,3];case 58>=a:return[275,a-51,3];case 66>=a:return[276,a-59,3];case 82>=a:return[277,a-67,4];case 98>=a:return[278,a-83,4];case 114>=a:return[279,a-99,4];case 130>=a:return[280,a-115,4];case 162>=a:return[281,a-131,
5];case 194>=a:return[282,a-163,5];case 226>=a:return[283,a-195,5];case 257>=a:return[284,a-227,5];case 258===a:return[285,a-258,0];default:throw"invalid length: "+a;}}var d=[],c,f;for(c=3;258>=c;c++)f=e(c),d[c]=f[2]<<24|f[1]<<16|f[0];return d}(),Ga=C?new Uint32Array(Fa):Fa;function na(e,d){function c(a,c){var b=a.g,d=[],f=0,e;e=Ga[a.length];d[f++]=e&65535;d[f++]=e>>16&255;d[f++]=e>>24;var g;switch(u){case 1===b:g=[0,b-1,0];break;case 2===b:g=[1,b-2,0];break;case 3===b:g=[2,b-3,0];break;case 4===
b:g=[3,b-4,0];break;case 6>=b:g=[4,b-5,1];break;case 8>=b:g=[5,b-7,1];break;case 12>=b:g=[6,b-9,2];break;case 16>=b:g=[7,b-13,2];break;case 24>=b:g=[8,b-17,3];break;case 32>=b:g=[9,b-25,3];break;case 48>=b:g=[10,b-33,4];break;case 64>=b:g=[11,b-49,4];break;case 96>=b:g=[12,b-65,5];break;case 128>=b:g=[13,b-97,5];break;case 192>=b:g=[14,b-129,6];break;case 256>=b:g=[15,b-193,6];break;case 384>=b:g=[16,b-257,7];break;case 512>=b:g=[17,b-385,7];break;case 768>=b:g=[18,b-513,8];break;case 1024>=b:g=[19,
b-769,8];break;case 1536>=b:g=[20,b-1025,9];break;case 2048>=b:g=[21,b-1537,9];break;case 3072>=b:g=[22,b-2049,10];break;case 4096>=b:g=[23,b-3073,10];break;case 6144>=b:g=[24,b-4097,11];break;case 8192>=b:g=[25,b-6145,11];break;case 12288>=b:g=[26,b-8193,12];break;case 16384>=b:g=[27,b-12289,12];break;case 24576>=b:g=[28,b-16385,13];break;case 32768>=b:g=[29,b-24577,13];break;default:throw"invalid distance";}e=g;d[f++]=e[0];d[f++]=e[1];d[f++]=e[2];var k,m;k=0;for(m=d.length;k<m;++k)l[h++]=d[k];t[d[0]]++;
w[d[3]]++;q=a.length+c-1;x=null}var f,a,b,k,m,g={},p,v,x,l=C?new Uint16Array(2*d.length):[],h=0,q=0,t=new (C?Uint32Array:Array)(286),w=new (C?Uint32Array:Array)(30),da=e.f,z;if(!C){for(b=0;285>=b;)t[b++]=0;for(b=0;29>=b;)w[b++]=0}t[256]=1;f=0;for(a=d.length;f<a;++f){b=m=0;for(k=3;b<k&&f+b!==a;++b)m=m<<8|d[f+b];g[m]===n&&(g[m]=[]);p=g[m];if(!(0<q--)){for(;0<p.length&&32768<f-p[0];)p.shift();if(f+3>=a){x&&c(x,-1);b=0;for(k=a-f;b<k;++b)z=d[f+b],l[h++]=z,++t[z];break}0<p.length?(v=Ha(d,f,p),x?x.length<
v.length?(z=d[f-1],l[h++]=z,++t[z],c(v,0)):c(x,-1):v.length<da?x=v:c(v,0)):x?c(x,-1):(z=d[f],l[h++]=z,++t[z])}p.push(f)}l[h++]=256;t[256]++;e.j=t;e.i=w;return C?l.subarray(0,h):l}function Ha(e,d,c){var f,a,b=0,k,m,g,p,v=e.length;m=0;p=c.length;a:for(;m<p;m++){f=c[p-m-1];k=3;if(3<b){for(g=b;3<g;g--)if(e[f+g-1]!==e[d+g-1])continue a;k=b}for(;258>k&&d+k<v&&e[f+k]===e[d+k];)++k;k>b&&(a=f,b=k);if(258===k)break}return new qa(b,d-a)}function oa(e,d){var c=e.length,f=new ja(572),a=new (C?Uint8Array:Array)(c),
b,k,m,g,p;if(!C)for(g=0;g<c;g++)a[g]=0;for(g=0;g<c;++g)0<e[g]&&f.push(g,e[g]);b=Array(f.length/2);k=new (C?Uint32Array:Array)(f.length/2);if(1===b.length)return a[f.pop().index]=1,a;g=0;for(p=f.length/2;g<p;++g)b[g]=f.pop(),k[g]=b[g].value;m=Ja(k,k.length,d);g=0;for(p=b.length;g<p;++g)a[b[g].index]=m[g];return a}function Ja(e,d,c){function f(a){var b=g[a][p[a]];b===d?(f(a+1),f(a+1)):--k[b];++p[a]}var a=new (C?Uint16Array:Array)(c),b=new (C?Uint8Array:Array)(c),k=new (C?Uint8Array:Array)(d),m=Array(c),
g=Array(c),p=Array(c),v=(1<<c)-d,x=1<<c-1,l,h,q,t,w;a[c-1]=d;for(h=0;h<c;++h)v<x?b[h]=0:(b[h]=1,v-=x),v<<=1,a[c-2-h]=(a[c-1-h]/2|0)+d;a[0]=b[0];m[0]=Array(a[0]);g[0]=Array(a[0]);for(h=1;h<c;++h)a[h]>2*a[h-1]+b[h]&&(a[h]=2*a[h-1]+b[h]),m[h]=Array(a[h]),g[h]=Array(a[h]);for(l=0;l<d;++l)k[l]=c;for(q=0;q<a[c-1];++q)m[c-1][q]=e[q],g[c-1][q]=q;for(l=0;l<c;++l)p[l]=0;1===b[c-1]&&(--k[0],++p[c-1]);for(h=c-2;0<=h;--h){t=l=0;w=p[h+1];for(q=0;q<a[h];q++)t=m[h+1][w]+m[h+1][w+1],t>e[l]?(m[h][q]=t,g[h][q]=d,w+=
2):(m[h][q]=e[l],g[h][q]=l,++l);p[h]=0;1===b[h]&&f(h)}return k}function pa(e){var d=new (C?Uint16Array:Array)(e.length),c=[],f=[],a=0,b,k,m,g;b=0;for(k=e.length;b<k;b++)c[e[b]]=(c[e[b]]|0)+1;b=1;for(k=16;b<=k;b++)f[b]=a,a+=c[b]|0,a<<=1;b=0;for(k=e.length;b<k;b++){a=f[e[b]];f[e[b]]+=1;m=d[b]=0;for(g=e[b];m<g;m++)d[b]=d[b]<<1|a&1,a>>>=1}return d}ba("Zlib.RawDeflate",ka);ba("Zlib.RawDeflate.prototype.compress",ka.prototype.h);var Ka={NONE:0,FIXED:1,DYNAMIC:ma},V,La,$,Ma;if(Object.keys)V=Object.keys(Ka);
else for(La in V=[],$=0,Ka)V[$++]=La;$=0;for(Ma=V.length;$<Ma;++$)La=V[$],ba("Zlib.RawDeflate.CompressionType."+La,Ka[La])}).call(this);
function ProgressBar(params){if(!(params&&params.id))return null;this.divId=params.id;this.divIdx=params.idx?params.idx:"";this.fileName=params.fileName?params.fileName:"";this.barContainer=document.getElementById(this.divId);if(!this.barContainer)return null;this.backgroundColor=!params.backgroundColor?"auto":params.backgroundColor;this.color=!params.color?"auto":params.color;this.height=!params.height?"auto":params.height;this.width=!params.width?"auto":params.width;this.barHeight=!params.barHeight?
"auto":params.barHeight;this.mask=!params.mask?"$d%":params.mask;this.pos=0;this.maxValue=0;this.message=null;this.progress=null;this.container=null;this.init=function(){if(this.height!="auto")this.barContainer.style.height=this.height;if(this.width!="auto")this.barContainer.style.width=this.width;if(!this.progress){this.container=document.createElement("div");this.container.className="progressbar_container";this.progress=document.createElement("div");if(this.barHeight!="auto")this.progress.style.height=
this.barHeight;this.progress.style.zIndex=0;this.progress.id=this.divId+"_bar"+this.divIdx;this.progress.className="progressbar_bar";this.container.appendChild(this.progress);this.barContainer.appendChild(this.container);if(this.backgroundColor!="auto")this.progress.style.backgroundColor=this.backgroundColor;this.message=document.createElement("DIV");if(this.color!="auto")this.message.style.color=this.color;this.message.id=this.divId+"_msg"+this.divIdx;this.message.className="progressbar_msg";this.container.appendChild(this.message)}this.progress.style.width=
"1px";this.message.innerHTML="0%"};this.setMessage=function(message){this.message.innerHTML=message};this.setPos=function(value){this.pos=value;if(this.maxValue==0)if(value==0)this.progress.style.width="0%";else{this.progress.style.width="10%";var left=this.progress.offsetLeft;if(left>this.barContainer.offsetWidth*.9)left=0;else left+=this.progress.offsetWidth;this.progress.style.left=left+"px";this.setMessage("")}else{this.progress.style.left="0px";var percent=Math.round(Math.min(100,value*100/this.maxValue));
this.progress.style.width=+percent+"%";this.setMessage(this.mask.replace("$d",percent))}};this.show=function(){this.barContainer.style.visibility="visible"};this.hide=function(){this.barContainer.style.visibility="hidden"};this.remove=function(){this.container.removeChild(this.progress);this.container.removeChild(this.message);this.barContainer.removeChild(this.container)};this.setClass=function(value){$(this.progress).addClass(value)};this.removeClass=function(value){$(this.progress).removeClass(value)};
return this}
var FS=function(dbname){var indexedDB=window.indexedDB||window.webkitIndexedDB||window.mozIndexedDB||window.OIndexedDB||window.msIndexedDB,IDBTransaction=window.IDBTransaction||window.webkitIDBTransaction||window.OIDBTransaction||window.msIDBTransaction,dbVersion=2,sessionId=0;var CacheLimit=5E3;var request,db,canUse=function(){return typeof indexedDB!="undefined"},buidDate=function(d){var dd=(d.getDate()<10?"0":"")+d.getDate();var mm=(1+d.getMonth()<10?"0":"")+(1+d.getMonth());var yy=d.getFullYear();
var hh=(d.getHours()<10?"0":"")+d.getHours();var nn=(d.getMinutes()<10?"0":"")+d.getMinutes();var ss=(d.getSeconds()<10?"0":"")+d.getSeconds();return yy+mm+dd+hh+nn+ss};clearCache=function(items){if(items.length<=CacheLimit)return;var totalDays=0;var totalHits=0;var maxDays=0;for(var i=0;i<items.length;i++){var d=items[i].lastTime;var itemDate=new Date(d.substr(0,4),d.substr(4,2)-1,d.substr(6,2),d.substr(8,2),d.substr(10,2),d.substr(12,2));items[i].days=(new Date-itemDate)/(1E3*60*60*24);if(items[i].days>
maxDays)maxDays=items[i].days;totalDays+=items[i].days;totalHits+=items[i].hits}for(var i=0;i<items.length;i++)items[i].score=items[i].hits*100/totalHits+(maxDays-items[i].days*100/totalDays);items.sort(function(a,b){return a.score-b.score});var transaction=db.transaction(["info"],"readwrite");for(var i=0;i<items.length-CacheLimit;i++){var newInfo={"lastTime":items[i].lastTime,"sessionId":items[i].sessionId,"hits":items[i].hits,"deleted":1};transaction.objectStore("info").put(newInfo,items[i].id)}};
enumFiles=function(collect,end){var objectInfo=db.transaction(["info"],"readonly").objectStore("info");if(objectInfo==null){if(end)end();return}if(objectInfo["count"]!=undefined){var count=objectInfo.count();count.onsuccess=function(){var recordCount=count.result-1;doEnumFiles(recordCount,collect,end)};count.onerror=function(event){if(end)end()}}else{var countCursor=objectInfo.openCursor();var recordCount=0;countCursor.onsuccess=function(event){var cursor=event.target.result;if(cursor){var key=cursor.key;
if(key!="cache")recordCount++;cursor["continue"]()}else doEnumFiles(recordCount,collect,end)}}};doEnumFiles=function(recordCount,collect,end){if(recordCount<=0){if(end)end()}else{var cacheItems=[];var transaction=db.transaction(["info"],"readwrite");var trCursor=transaction.objectStore("info").openCursor();trCursor.onsuccess=function(event){var cursor=event.target.result;if(cursor){var key=cursor.key;if(key!="cache"){var req=transaction.objectStore("info").get(key);req.onsuccess=function(event){var curInfo=
event.target.result;if(typeof curInfo!="undefined"){if(typeof curInfo.deleted!="undefined"&&curInfo.deleted==1){var trDelete=db.transaction(["data","info"],"readwrite");trDelete.objectStore("data")["delete"](key);trDelete.objectStore("info")["delete"](key);recordCount--}else{cacheItems.push({"id":key,"lastTime":curInfo.lastTime,"sessionId":curInfo.sessionId,"hits":curInfo.hits,"deleted":0});collect(key)}if(cacheItems.length>=recordCount){if(end)end();clearCache(cacheItems)}}}}cursor["continue"]()}};
trCursor.onerror=function(event){if(end)end()}}},write=function(filename,blob){var transaction=db.transaction(["data"],"readwrite");var put=transaction.objectStore("data").put(blob,filename);var today=buidDate(new Date);var newInfo={"lastTime":today,"sessionId":sessionId,"hits":0,"deleted":0};var trInfo=db.transaction(["info"],"readwrite");trInfo.objectStore("info").put(newInfo,filename)},read=function(filename,success){var transaction=db.transaction(["data"],"readonly");transaction.objectStore("data").get(filename).onsuccess=
function(event){var trInfo=db.transaction(["info"],"readwrite");trInfo.objectStore("info").get(filename).onsuccess=function(e){var today=buidDate(new Date);var hits=1;var info=e.target.result;if(typeof info!="undefined"&&typeof info.hits!="undefined")hits=info.hits+1;var newInfo={"lastTime":today,"sessionId":sessionId,"hits":hits,"deleted":0};trInfo.objectStore("info").put(newInfo,filename)};var imgFile=event.target.result;success(imgFile)}},init=function(success,error){if(!canUse()){error("not supported");
return}var createObjectStore=function(dataBase){console.log("Creating objectStore");dataBase.createObjectStore("data");dataBase.createObjectStore("info")};request=indexedDB.open(dbname,dbVersion);request.onerror=function(event){console.log("Error creating/accessing IndexedDB database");if(error)error(event)};request.onsuccess=function(event){console.log("Success creating/accessing IndexedDB database");db=request.result;db.onerror=function(event){console.log("Error creating/accessing IndexedDB database")};
if(db.setVersion)if(db.version!=dbVersion){var setVersion=db.setVersion(dbVersion);setVersion.onsuccess=function(){createObjectStore(db)}}var transaction=db.transaction(["info"],"readwrite");var req=transaction.objectStore("info").get("cache");req.onsuccess=function(event){var savedSession=event.target.result;if(typeof savedSession=="undefined")savedSession={"sessionId":sessionId};sessionId=++savedSession.sessionId;transaction.objectStore("info").put(savedSession,"cache")};req.onerror=function(event){sessionId=
0;var savedSession=event.target.result;savedSession.sessionId=sessionId;transaction.objectStore("info").put(savedSession,"cache")};if(success)success()};request.onupgradeneeded=function(event){createObjectStore(event.target.result)}};return{enumFiles:enumFiles,init:init,write:write,read:read,canUse:canUse}};
function PrinterManager(eventHandlers){function PrinterQueue(){var _documents=[];var _onUpdate=null;function searchDocument(obj){var d=_documents.length-1;while(d>-1&&_documents[d].url!=obj.url)d--;return d}function push(obj){try{return _documents.push(obj)}catch(error){helper.console.error(error,arguments)}finally{if(_onUpdate)_onUpdate({"action":"enqueue","document":obj.url,"documents":getList(),"count":_documents.length})}}function remove(obj){try{var p=searchDocument(obj);if(p>-1){_documents.splice(p,
1);if(_onUpdate)_onUpdate({"action":"remove","document":obj.url,"documents":getList(),"count":_documents.length})}}catch(error){helper.console.error(error,arguments)}return _documents.length}function shift(){var obj=_documents.shift()||null;if(_onUpdate)_onUpdate({"action":"shift","document":obj.url,"documents":getList(),"count":_documents.length});return obj}function setOnUpdate(f){if(typeof f=="function")_onUpdate=f}function getList(){if(!_documents||_documents.length==0)return null;else return _documents.slice(0)}
function clean(){_documents=[];if(_onUpdate)_onUpdate({"action":"clean","documents":getList(),"count":_documents.length})}Object.defineProperty(this,"count",{enumerable:false,configurable:false,get:function(){return _documents.length}});Object.defineProperty(this,"list",{enumerable:true,configurable:false,get:getList});Object.defineProperty(this,"push",{enumerable:false,configurable:false,writable:false,value:push});Object.defineProperty(this,"shift",{enumerable:false,configurable:false,writable:false,
value:shift});Object.defineProperty(this,"remove",{enumerable:false,configurable:false,writable:false,value:remove});Object.defineProperty(this,"onUpdate",{enumerable:false,configurable:false,set:setOnUpdate});Object.defineProperty(this,"clean",{enumerable:false,configurable:false,writable:false,value:clean});return this}var visible=false;var _printerQueue=null;var _events={"onShow":null,"onEnqueueDocument":null,"onClose":null,"onShowAll":null,"onDiscard":null,"onCheckVisibility":null};function processPrintingEvents(ev){if(typeof ev!=
"undefined")if(ev.data.action=="PRINTINGLIST")ev.source.postMessage(_printerQueue.list,"*");else if(ev.data.action=="DOCPRINTED"){_printerQueue.remove(ev.data);ev.source.postMessage(ev.data,"*")}}function initialize(eventHandlers){_printerQueue=new PrinterQueue;for(var ev in _events)if(eventHandlers[ev])_events[ev]=eventHandlers[ev];if(window.attachEvent)window.attachEvent("onmessage",processPrintingEvents);else window.addEventListener("message",processPrintingEvents)}function isVisible(){if(_events["onCheckVisibility"])visible=
_events["onCheckVisibility"]();return visible}function add(obj){_printerQueue.push(obj);if(!isVisible()){if(_events.onShow)_events.onShow();visible=true}if(_events.onEnqueueDocument)_events.onEnqueueDocument({"count":_printerQueue.count,"url":obj.url,"title":obj.title})}function shift(){return _printerQueue.shift()}function openDocuments(doClose){var w=window;while(_printerQueue.count){var obj=shift();window.open(obj.url,"_blank");w.focus()}if(!!doClose)close()}function showAllPrintings(doClose){if(_events.onShowAll)_events.onShowAll({"documents":_printerQueue.list});
if(!!doClose)close()}function discard(doClose){_printerQueue.clean();if(_events.onDiscard)_events.onDiscard();if(!!doClose)close()}function close(){if(_events.onClose)_events.onClose()}function onClose(){visible=false}Object.defineProperty(this,"enqueueDocument",{enumerable:false,configurable:false,writable:false,value:add});Object.defineProperty(this,"getFirstDocument",{enumerable:false,configurable:false,writable:false,value:shift});Object.defineProperty(this,"openDocuments",{enumerable:false,configurable:false,
writable:false,value:openDocuments});Object.defineProperty(this,"close",{enumerable:false,configurable:false,writable:false,value:close});Object.defineProperty(this,"discard",{enumerable:false,configurable:false,writable:false,value:discard});Object.defineProperty(this,"showAllPrintings",{enumerable:false,configurable:false,writable:false,value:showAllPrintings});Object.defineProperty(this,"onClose",{enumerable:false,configurable:false,writable:false,value:onClose});initialize(eventHandlers);return this}
(function(view){var Uint8Array=view.Uint8Array,HTMLCanvasElement=view.HTMLCanvasElement,canvas_proto=HTMLCanvasElement&&HTMLCanvasElement.prototype,is_base64_regex=/\s*;\s*base64\s*(?:;|$)/i,to_data_url="toDataURL",base64_ranks,decode_base64=function(base64){var len=base64.length,buffer=new Uint8Array(len/4*3|0),i=0,outptr=0,last=[0,0],state=0,save=0,rank,code,undef;while(len--){code=base64.charCodeAt(i++);rank=base64_ranks[code-43];if(rank!==255&&rank!==undef){last[1]=last[0];last[0]=code;save=save<<
6|rank;state++;if(state===4){buffer[outptr++]=save>>>16;if(last[1]!==61)buffer[outptr++]=save>>>8;if(last[0]!==61)buffer[outptr++]=save;state=0}}}return buffer};if(Uint8Array)base64_ranks=new Uint8Array([62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,0,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51]);if(HTMLCanvasElement&&!canvas_proto.toBlob){canvas_proto.toBlob=function(callback,
type){if(!type)type="image/png";if(this.mozGetAsFile){callback(this.mozGetAsFile("canvas",type));return}if(this.msToBlob&&/^\s*image\/png\s*(?:$|;)/i.test(type)){callback(this.msToBlob());return}var args=Array.prototype.slice.call(arguments,1),dataURI=this[to_data_url].apply(this,args),header_end=dataURI.indexOf(","),data=dataURI.substring(header_end+1),is_base64=is_base64_regex.test(dataURI.substring(0,header_end)),blob;if(Blob.fake){blob=new Blob;if(is_base64)blob.encoding="base64";else blob.encoding=
"URI";blob.data=data;blob.size=data.length}else if(Uint8Array)if(is_base64)blob=new Blob([decode_base64(data)],{type:type});else blob=new Blob([decodeURIComponent(data)],{type:type});callback(blob)};if(canvas_proto.toDataURLHD)canvas_proto.toBlobHD=function(){to_data_url="toDataURLHD";var blob=this.toBlob();to_data_url="toDataURL";return blob};else canvas_proto.toBlobHD=canvas_proto.toBlob}})(typeof self!=="undefined"&&self||typeof window!=="undefined"&&window||this.content||this);
